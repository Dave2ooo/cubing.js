{
  "version": 3,
  "sources": ["../../../src/cubing/alg/parser/parser-pegjs.js", "../../../src/cubing/kpuzzle/parser/parser-pegjs.js", "../../../src/cubing/index.ts", "../../../src/cubing/alg/index.ts", "../../../src/cubing/alg/debug.ts", "../../../src/cubing/alg/algorithm/alg-part.ts", "../../../src/cubing/alg/algorithm/block-move.ts", "../../../src/cubing/alg/operation.ts", "../../../src/cubing/alg/traversal.ts", "../../../src/cubing/alg/example.ts", "../../../src/cubing/alg/json.ts", "../../../src/cubing/alg/validation.ts", "../../../src/cubing/alg/parser/parser.js", "../../../src/cubing/alg/parser/index.ts", "../../../src/cubing/alg/keyboard.ts", "../../../src/cubing/alg/url.ts", "../../../src/cubing/bluetooth/index.ts", "../../../src/cubing/bluetooth/transformer.ts", "../../../src/cubing/bluetooth/bluetooth-puzzle.ts", "../../../src/cubing/bluetooth/debug.ts", "../../../src/cubing/bluetooth/gan.ts", "../../../src/cubing/kpuzzle/index.ts", "../../../src/cubing/kpuzzle/transformations.ts", "../../../src/cubing/kpuzzle/kpuzzle.ts", "../../../src/cubing/kpuzzle/canonicalize.ts", "../../../src/cubing/kpuzzle/definitions/svg-inlined/2x2x2.kpuzzle.svg.ts", "../../../src/cubing/kpuzzle/definitions/svg-inlined/3x3x3.kpuzzle.svg.ts", "../../../src/cubing/kpuzzle/definitions/svg-inlined/3x3x3-ll.kpuzzle.svg.ts", "../../../src/cubing/kpuzzle/definitions/svg-inlined/pyraminx.kpuzzle.svg.ts", "../../../src/cubing/kpuzzle/definitions/svg-inlined/sq1-hyperorbit.kpuzzle.svg.ts", "../../../src/cubing/kpuzzle/definitions/svg-inlined/clock.kpuzzle.svg.ts", "../../../src/cubing/kpuzzle/definitions/index.ts", "../../../src/cubing/kpuzzle/puzzle_definitions.ts", "../../../src/cubing/kpuzzle/parser/parser-shim.js", "../../../src/cubing/kpuzzle/parser/parser.ts", "../../../src/cubing/kpuzzle/svg.ts", "../../../src/cubing/bluetooth/unsafe-raw-aes.ts", "../../../src/cubing/bluetooth/unsafe-raw-aes.ts", "../../../src/cubing/bluetooth/gan.ts", "../../../src/cubing/bluetooth/giiker.ts", "../../../src/cubing/bluetooth/giiker.ts", "../../../src/cubing/bluetooth/gocube.ts", "../../../src/cubing/bluetooth/gocube.ts", "../../../src/cubing/bluetooth/connect.ts", "../../../src/cubing/bluetooth/keyboard.ts", "../../../src/cubing/protocol/index.ts", "../../../src/cubing/protocol/binary/orbit-indexing.ts", "../../../src/cubing/protocol/binary/binary3x3x3.ts", "../../../src/cubing/protocol/binary/hex.ts", "../../../src/cubing/puzzle-geometry/index.ts", "../../../src/cubing/puzzle-geometry/Perm.ts", "../../../src/cubing/puzzle-geometry/Perm.ts", "../../../src/cubing/puzzle-geometry/PermOriSet.ts", "../../../src/cubing/puzzle-geometry/Quat.ts", "../../../src/cubing/puzzle-geometry/Quat.ts", "../../../src/cubing/puzzle-geometry/PlatonicGenerator.ts", "../../../src/cubing/puzzle-geometry/Puzzles.ts", "../../../src/cubing/puzzle-geometry/interfaces.ts", "../../../src/cubing/puzzle-geometry/NotationMapper.ts", "../../../src/cubing/puzzle-geometry/FaceNameSwizzler.ts", "../../../src/cubing/puzzle-geometry/PuzzleGeometry.ts", "../../../src/cubing/puzzle-geometry/SchreierSims.ts", "../../../src/cubing/stream/index.ts", "../../../src/cubing/stream/websocket-proxy.ts", "../../../src/cubing/twisty/index.ts", "../../../src/cubing/twisty/dom/viewers/Twisty3DCanvas.ts", "../../../src/cubing/twisty/animation/RenderScheduler.ts", "../../../src/cubing/twisty/dom/element/node-custom-element-shims.ts", "../../../src/cubing/twisty/dom/element/node-custom-element-shims.ts", "../../../src/cubing/twisty/dom/element/ManagedCustomElement.ts", "../../../src/cubing/twisty/dom/viewers/canvas.ts", "../../../src/cubing/twisty/dom/viewers/Twisty3DCanvas.css.ts", "../../../src/cubing/twisty/dom/viewers/vendor/OrbitControls.js", "../../../src/cubing/twisty/dom/viewers/TwistyOrbitControls.ts", "../../../src/vendor/node_modules/three/examples/jsm/libs/stats.module.js", "../../../src/cubing/twisty/dom/viewers/Twisty3DCanvas.ts", "../../../app/twizzle/move-counter.ts", "../../../src/cubing/twisty/3D/puzzles/Cube3D.ts", "../../../src/cubing/twisty/animation/easing.ts", "../../../src/cubing/twisty/dom/TwistyPlayerConfig.ts", "../../../src/cubing/twisty/dom/element/ElementConfig.ts", "../../../src/cubing/twisty/dom/element/ElementConfig.ts", "../../../src/cubing/twisty/dom/element/ElementConfig.ts", "../../../src/cubing/twisty/dom/element/ClassListManager.ts", "../../../src/cubing/twisty/dom/viewers/TwistyViewerWrapper.css.ts", "../../../src/cubing/twisty/dom/viewers/TwistyViewerWrapper.ts", "../../../src/cubing/twisty/dom/TwistyPlayerConfig.ts", "../../../src/cubing/twisty/3D/TAU.ts", "../../../src/cubing/twisty/3D/puzzles/stickerings.ts", "../../../src/cubing/twisty/3D/puzzles/Cube3D.ts", "../../../src/cubing/twisty/3D/puzzles/PG3D.ts", "../../../src/cubing/twisty/3D/puzzles/PG3D.ts", "../../../src/cubing/twisty/3D/Twisty3DScene.ts", "../../../src/cubing/twisty/3D/puzzles/KPuzzleWrapper.ts", "../../../src/cubing/twisty/animation/alg/CursorTypes.ts", "../../../src/cubing/twisty/animation/alg/CursorTypes.ts", "../../../src/cubing/twisty/animation/alg/AlgDuration.ts", "../../../src/cubing/twisty/animation/alg/AlgIndexer.ts", "../../../src/cubing/twisty/animation/alg/TreeAlgIndexer.ts", "../../../src/cubing/twisty/animation/alg/AlgCursor.ts", "../../../src/cubing/twisty/animation/Timeline.ts", "../../../src/cubing/twisty/dom/controls/buttons.css.ts", "../../../src/cubing/twisty/dom/controls/buttons.ts", "../../../src/cubing/twisty/dom/controls/TwistyScrubber.css.ts", "../../../src/cubing/twisty/dom/controls/TwistyScrubber.ts", "../../../src/cubing/twisty/dom/TwistyPlayer.css.ts", "../../../src/cubing/twisty/dom/viewers/Twisty2DSVGView.css.ts", "../../../src/cubing/twisty/dom/viewers/Twisty2DSVG.ts", "../../../src/cubing/twisty/dom/TwistyPlayer.ts", "../../../src/cubing/twisty/animation/alg/SimpleAlgIndexer.ts", "../../../src/cubing/twisty/animation/stream/timeline-move-calculation-draft.ts"],
  "sourcesContent": ["// Generated by PEG.js v0.11.0-master.f69239d, https://pegjs.org/\n\n\"use strict\";\n\nfunction peg$subclass(child, parent) {\n  function C() { this.constructor = child; }\n  C.prototype = parent.prototype;\n  child.prototype = new C();\n}\n\nfunction peg$SyntaxError(message, expected, found, location) {\n  this.message = message;\n  this.expected = expected;\n  this.found = found;\n  this.location = location;\n  this.name = \"SyntaxError\";\n\n  // istanbul ignore next\n  if (typeof Error.captureStackTrace === \"function\") {\n    Error.captureStackTrace(this, peg$SyntaxError);\n  }\n}\n\npeg$subclass(peg$SyntaxError, Error);\n\npeg$SyntaxError.buildMessage = function(expected, found) {\n  var DESCRIBE_EXPECTATION_FNS = {\n    literal: function(expectation) {\n      return \"\\\"\" + literalEscape(expectation.text) + \"\\\"\";\n    },\n\n    class: function(expectation) {\n      var escapedParts = expectation.parts.map(function(part) {\n        return Array.isArray(part)\n          ? classEscape(part[0]) + \"-\" + classEscape(part[1])\n          : classEscape(part);\n      });\n\n      return \"[\" + (expectation.inverted ? \"^\" : \"\") + escapedParts + \"]\";\n    },\n\n    any: function() {\n      return \"any character\";\n    },\n\n    end: function() {\n      return \"end of input\";\n    },\n\n    other: function(expectation) {\n      return expectation.description;\n    },\n\n    not: function(expectation) {\n      return \"not \" + describeExpectation(expectation.expected);\n    }\n  };\n\n  function hex(ch) {\n    return ch.charCodeAt(0).toString(16).toUpperCase();\n  }\n\n  function literalEscape(s) {\n    return s\n      .replace(/\\\\/g, \"\\\\\\\\\")\n      .replace(/\"/g,  \"\\\\\\\"\")\n      .replace(/\\0/g, \"\\\\0\")\n      .replace(/\\t/g, \"\\\\t\")\n      .replace(/\\n/g, \"\\\\n\")\n      .replace(/\\r/g, \"\\\\r\")\n      .replace(/[\\x00-\\x0F]/g,          function(ch) { return \"\\\\x0\" + hex(ch); })\n      .replace(/[\\x10-\\x1F\\x7F-\\x9F]/g, function(ch) { return \"\\\\x\"  + hex(ch); });\n  }\n\n  function classEscape(s) {\n    return s\n      .replace(/\\\\/g, \"\\\\\\\\\")\n      .replace(/\\]/g, \"\\\\]\")\n      .replace(/\\^/g, \"\\\\^\")\n      .replace(/-/g,  \"\\\\-\")\n      .replace(/\\0/g, \"\\\\0\")\n      .replace(/\\t/g, \"\\\\t\")\n      .replace(/\\n/g, \"\\\\n\")\n      .replace(/\\r/g, \"\\\\r\")\n      .replace(/[\\x00-\\x0F]/g,          function(ch) { return \"\\\\x0\" + hex(ch); })\n      .replace(/[\\x10-\\x1F\\x7F-\\x9F]/g, function(ch) { return \"\\\\x\"  + hex(ch); });\n  }\n\n  function describeExpectation(expectation) {\n    return DESCRIBE_EXPECTATION_FNS[expectation.type](expectation);\n  }\n\n  function describeExpected(expected) {\n    var descriptions = expected.map(describeExpectation);\n    var i, j;\n\n    descriptions.sort();\n\n    if (descriptions.length > 0) {\n      for (i = 1, j = 1; i < descriptions.length; i++) {\n        if (descriptions[i - 1] !== descriptions[i]) {\n          descriptions[j] = descriptions[i];\n          j++;\n        }\n      }\n      descriptions.length = j;\n    }\n\n    switch (descriptions.length) {\n      case 1:\n        return descriptions[0];\n\n      case 2:\n        return descriptions[0] + \" or \" + descriptions[1];\n\n      default:\n        return descriptions.slice(0, -1).join(\", \")\n          + \", or \"\n          + descriptions[descriptions.length - 1];\n    }\n  }\n\n  function describeFound(found) {\n    return found ? \"\\\"\" + literalEscape(found) + \"\\\"\" : \"end of input\";\n  }\n\n  return \"Expected \" + describeExpected(expected) + \" but \" + describeFound(found) + \" found.\";\n};\n\nfunction peg$parse(input, options) {\n  options = options !== undefined ? options : {};\n\n  var peg$FAILED = {};\n\n  var peg$startRuleFunctions = { start: peg$parsestart };\n  var peg$startRuleFunction = peg$parsestart;\n\n  var peg$c0 = \"'\";\n  var peg$c1 = \"R++\";\n  var peg$c2 = \"R--\";\n  var peg$c3 = \"D++\";\n  var peg$c4 = \"D--\";\n  var peg$c5 = \"-\";\n  var peg$c6 = \"[\";\n  var peg$c7 = \"]\";\n  var peg$c8 = \"(\";\n  var peg$c9 = \")\";\n  var peg$c10 = \"//\";\n  var peg$c11 = \".\";\n\n  var peg$r0 = /^[0-9]/;\n  var peg$r1 = /^[_A-Za-z]/;\n  var peg$r2 = /^[,:]/;\n  var peg$r3 = /^[^\\n\\r]/;\n  var peg$r4 = /^[\\n\\r]/;\n  var peg$r5 = /^[ ]/;\n\n  var peg$e0 = peg$classExpectation([[\"0\", \"9\"]], false, false);\n  var peg$e1 = peg$literalExpectation(\"'\", false);\n  var peg$e2 = peg$literalExpectation(\"R++\", false);\n  var peg$e3 = peg$literalExpectation(\"R--\", false);\n  var peg$e4 = peg$literalExpectation(\"D++\", false);\n  var peg$e5 = peg$literalExpectation(\"D--\", false);\n  var peg$e6 = peg$classExpectation([\"_\", [\"A\", \"Z\"], [\"a\", \"z\"]], false, false);\n  var peg$e7 = peg$literalExpectation(\"-\", false);\n  var peg$e8 = peg$literalExpectation(\"[\", false);\n  var peg$e9 = peg$classExpectation([\",\", \":\"], false, false);\n  var peg$e10 = peg$literalExpectation(\"]\", false);\n  var peg$e11 = peg$literalExpectation(\"(\", false);\n  var peg$e12 = peg$literalExpectation(\")\", false);\n  var peg$e13 = peg$literalExpectation(\"//\", false);\n  var peg$e14 = peg$classExpectation([\"\\n\", \"\\r\"], true, false);\n  var peg$e15 = peg$classExpectation([\"\\n\", \"\\r\"], false, false);\n  var peg$e16 = peg$literalExpectation(\".\", false);\n  var peg$e17 = peg$classExpectation([\" \"], false, false);\n\n  var peg$f0 = function(characters) { return parseInt(characters.join(\"\"), 10); };\n  var peg$f1 = function(repetition) { return -repetition; };\n  var peg$f2 = function() { return -1; };\n  var peg$f3 = function(megaminx_scramble_move) { return megaminx_scramble_move };\n  var peg$f4 = function(characters) { return typeof(characters) === \"string\" ? characters : characters.join(\"\"); };\n  var peg$f5 = function(family) { return {type: \"blockMove\", family: family}; };\n  var peg$f6 = function(innerLayer, family) { return {type: \"blockMove\", family: family, innerLayer: innerLayer}; };\n  var peg$f7 = function(outerLayer, innerLayer, family) { return {type: \"blockMove\", family: family, outerLayer: outerLayer, innerLayer: innerLayer}; };\n  var peg$f8 = function(a, separator, b) { return {\"type\": separator === \",\" ? \"commutator\" : \"conjugate\", \"A\": a, \"B\": b}; };\n  var peg$f9 = function(nestedSequence) { return {\"type\": \"group\", \"nestedSequence\": nestedSequence}; };\n  var peg$f10 = function(repeatable_unit, amount) { repeatable_unit.amount = amount; return repeatable_unit; };\n  var peg$f11 = function(repeatable_unit) { repeatable_unit.amount = 1; return repeatable_unit; };\n  var peg$f12 = function(body) { return {type: \"comment\", comment: body.join(\"\")}; };\n  var peg$f13 = function() { return {\"type\": \"newLine\"}; };\n  var peg$f14 = function() { return {\"type\": \"pause\"}; };\n  var peg$f15 = function(segment_part, segment) { return [segment_part].concat(segment); };\n  var peg$f16 = function(segment_part) { return [segment_part]; };\n  var peg$f17 = function(segment, unit_list) { return segment.concat(unit_list); };\n  var peg$f18 = function(unit_list) { return {\"type\": \"sequence\", \"nestedUnits\": unit_list}; };\n  var peg$f19 = function() { return {\"type\": \"sequence\", \"nestedUnits\": []}; };\n\n  var peg$currPos = 0;\n  var peg$savedPos = 0;\n  var peg$posDetailsCache = [{ line: 1, column: 1 }];\n  var peg$expected = [];\n  var peg$silentFails = 0;\n\n  var peg$result;\n\n  if (\"startRule\" in options) {\n    if (!(options.startRule in peg$startRuleFunctions)) {\n      throw new Error(\"Can't start parsing from rule \\\"\" + options.startRule + \"\\\".\");\n    }\n\n    peg$startRuleFunction = peg$startRuleFunctions[options.startRule];\n  }\n\n  function text() {\n    return input.substring(peg$savedPos, peg$currPos);\n  }\n\n  function offset() {\n    return peg$savedPos;\n  }\n\n  function range() {\n    return [peg$savedPos, peg$currPos];\n  }\n\n  function location() {\n    return peg$computeLocation(peg$savedPos, peg$currPos);\n  }\n\n  function expected(description, location) {\n    location = location !== undefined\n      ? location\n      : peg$computeLocation(peg$savedPos, peg$currPos);\n\n    throw peg$buildStructuredError(\n      [peg$otherExpectation(description)],\n      input.substring(peg$savedPos, peg$currPos),\n      location\n    );\n  }\n\n  function error(message, location) {\n    location = location !== undefined\n      ? location\n      : peg$computeLocation(peg$savedPos, peg$currPos);\n\n    throw peg$buildSimpleError(message, location);\n  }\n\n  function peg$literalExpectation(text, ignoreCase) {\n    return { type: \"literal\", text: text, ignoreCase: ignoreCase };\n  }\n\n  function peg$classExpectation(parts, inverted, ignoreCase) {\n    return { type: \"class\", parts: parts, inverted: inverted, ignoreCase: ignoreCase };\n  }\n\n  function peg$anyExpectation() {\n    return { type: \"any\" };\n  }\n\n  function peg$endExpectation() {\n    return { type: \"end\" };\n  }\n\n  function peg$otherExpectation(description) {\n    return { type: \"other\", description: description };\n  }\n\n  function peg$computePosDetails(pos) {\n    var details = peg$posDetailsCache[pos];\n    var p;\n\n    if (details) {\n      return details;\n    } else {\n      p = pos - 1;\n      while (!peg$posDetailsCache[p]) {\n        p--;\n      }\n\n      details = peg$posDetailsCache[p];\n      details = {\n        line: details.line,\n        column: details.column\n      };\n\n      while (p < pos) {\n        if (input.charCodeAt(p) === 10) {\n          details.line++;\n          details.column = 1;\n        } else {\n          details.column++;\n        }\n\n        p++;\n      }\n\n      peg$posDetailsCache[pos] = details;\n\n      return details;\n    }\n  }\n\n  var peg$VALIDFILENAME = typeof options.filename === \"string\" && options.filename.length > 0;\n  function peg$computeLocation(startPos, endPos) {\n    var loc = {};\n\n    if ( peg$VALIDFILENAME ) loc.filename = options.filename;\n\n    var startPosDetails = peg$computePosDetails(startPos);\n    loc.start = {\n      offset: startPos,\n      line: startPosDetails.line,\n      column: startPosDetails.column\n    };\n\n    var endPosDetails = peg$computePosDetails(endPos);\n    loc.end = {\n      offset: endPos,\n      line: endPosDetails.line,\n      column: endPosDetails.column\n    };\n\n    return loc;\n  }\n\n  function peg$begin() {\n    peg$expected.push({ pos: peg$currPos, variants: [] });\n  }\n\n  function peg$expect(expected) {\n    var top = peg$expected[peg$expected.length - 1];\n\n    if (peg$currPos < top.pos) { return; }\n\n    if (peg$currPos > top.pos) {\n      top.pos = peg$currPos;\n      top.variants = [];\n    }\n\n    top.variants.push(expected);\n  }\n\n  function peg$end(invert) {\n    var expected = peg$expected.pop();\n    var top = peg$expected[peg$expected.length - 1];\n    var variants = expected.variants;\n\n    if (top.pos !== expected.pos) { return; }\n\n    if (invert) {\n      variants = variants.map(function(e) {\n        return e.type === \"not\" ? e.expected : { type: \"not\", expected: e };\n      });\n    }\n\n    Array.prototype.push.apply(top.variants, variants);\n  }\n\n  function peg$buildSimpleError(message, location) {\n    return new peg$SyntaxError(message, null, null, location);\n  }\n\n  function peg$buildStructuredError(expected, found, location) {\n    return new peg$SyntaxError(\n      peg$SyntaxError.buildMessage(expected, found),\n      expected,\n      found,\n      location\n    );\n  }\n\n  function peg$buildError() {\n    var expected = peg$expected[0];\n    var failPos = expected.pos;\n\n    return peg$buildStructuredError(\n      expected.variants,\n      failPos < input.length ? input.charAt(failPos) : null,\n      failPos < input.length\n        ? peg$computeLocation(failPos, failPos + 1)\n        : peg$computeLocation(failPos, failPos)\n    );\n  }\n\n  function peg$parsestart() {\n    var s0;\n\n    var rule$expects = function (expected) {\n      if (peg$silentFails === 0) peg$expect(expected);\n    }\n\n    s0 = peg$parseSEQUENCE();\n\n    return s0;\n  }\n\n  function peg$parseNUMBER() {\n    var s0, s1, s2;\n\n    var rule$expects = function (expected) {\n      if (peg$silentFails === 0) peg$expect(expected);\n    }\n\n    s0 = peg$currPos;\n    s1 = [];\n    rule$expects(peg$e0);\n    if (peg$r0.test(input.charAt(peg$currPos))) {\n      s2 = input.charAt(peg$currPos);\n      peg$currPos++;\n    } else {\n      s2 = peg$FAILED;\n    }\n    if (s2 !== peg$FAILED) {\n      while (s2 !== peg$FAILED) {\n        s1.push(s2);\n        rule$expects(peg$e0);\n        if (peg$r0.test(input.charAt(peg$currPos))) {\n          s2 = input.charAt(peg$currPos);\n          peg$currPos++;\n        } else {\n          s2 = peg$FAILED;\n        }\n      }\n    } else {\n      s1 = peg$FAILED;\n    }\n    if (s1 !== peg$FAILED) {\n      peg$savedPos = s0;\n      s1 = peg$f0(s1);\n    }\n    s0 = s1;\n\n    return s0;\n  }\n\n  function peg$parseAMOUNT() {\n    var s0, s1, s2;\n\n    var rule$expects = function (expected) {\n      if (peg$silentFails === 0) peg$expect(expected);\n    }\n\n    s0 = peg$currPos;\n    s1 = peg$parseNUMBER();\n    if (s1 !== peg$FAILED) {\n      rule$expects(peg$e1);\n      if (input.charCodeAt(peg$currPos) === 39) {\n        s2 = peg$c0;\n        peg$currPos++;\n      } else {\n        s2 = peg$FAILED;\n      }\n      if (s2 !== peg$FAILED) {\n        peg$savedPos = s0;\n        s0 = peg$f1(s1);\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    if (s0 === peg$FAILED) {\n      s0 = peg$parseNUMBER();\n      if (s0 === peg$FAILED) {\n        s0 = peg$currPos;\n        rule$expects(peg$e1);\n        if (input.charCodeAt(peg$currPos) === 39) {\n          s1 = peg$c0;\n          peg$currPos++;\n        } else {\n          s1 = peg$FAILED;\n        }\n        if (s1 !== peg$FAILED) {\n          peg$savedPos = s0;\n          s1 = peg$f2();\n        }\n        s0 = s1;\n      }\n    }\n\n    return s0;\n  }\n\n  function peg$parseFAMILY() {\n    var s0, s1, s2;\n\n    var rule$expects = function (expected) {\n      if (peg$silentFails === 0) peg$expect(expected);\n    }\n\n    s0 = peg$currPos;\n    rule$expects(peg$e2);\n    if (input.substr(peg$currPos, 3) === peg$c1) {\n      s1 = peg$c1;\n      peg$currPos += 3;\n    } else {\n      s1 = peg$FAILED;\n    }\n    if (s1 === peg$FAILED) {\n      rule$expects(peg$e3);\n      if (input.substr(peg$currPos, 3) === peg$c2) {\n        s1 = peg$c2;\n        peg$currPos += 3;\n      } else {\n        s1 = peg$FAILED;\n      }\n      if (s1 === peg$FAILED) {\n        rule$expects(peg$e4);\n        if (input.substr(peg$currPos, 3) === peg$c3) {\n          s1 = peg$c3;\n          peg$currPos += 3;\n        } else {\n          s1 = peg$FAILED;\n        }\n        if (s1 === peg$FAILED) {\n          rule$expects(peg$e5);\n          if (input.substr(peg$currPos, 3) === peg$c4) {\n            s1 = peg$c4;\n            peg$currPos += 3;\n          } else {\n            s1 = peg$FAILED;\n          }\n        }\n      }\n    }\n    if (s1 !== peg$FAILED) {\n      peg$savedPos = s0;\n      s1 = peg$f3(s1);\n    }\n    s0 = s1;\n    if (s0 === peg$FAILED) {\n      s0 = peg$currPos;\n      s1 = [];\n      rule$expects(peg$e6);\n      if (peg$r1.test(input.charAt(peg$currPos))) {\n        s2 = input.charAt(peg$currPos);\n        peg$currPos++;\n      } else {\n        s2 = peg$FAILED;\n      }\n      if (s2 !== peg$FAILED) {\n        while (s2 !== peg$FAILED) {\n          s1.push(s2);\n          rule$expects(peg$e6);\n          if (peg$r1.test(input.charAt(peg$currPos))) {\n            s2 = input.charAt(peg$currPos);\n            peg$currPos++;\n          } else {\n            s2 = peg$FAILED;\n          }\n        }\n      } else {\n        s1 = peg$FAILED;\n      }\n      if (s1 !== peg$FAILED) {\n        peg$savedPos = s0;\n        s1 = peg$f4(s1);\n      }\n      s0 = s1;\n    }\n\n    return s0;\n  }\n\n  function peg$parseBLOCK_MOVE() {\n    var s0, s1, s2, s3, s4;\n\n    var rule$expects = function (expected) {\n      if (peg$silentFails === 0) peg$expect(expected);\n    }\n\n    s0 = peg$currPos;\n    s1 = peg$parseFAMILY();\n    if (s1 !== peg$FAILED) {\n      peg$savedPos = s0;\n      s1 = peg$f5(s1);\n    }\n    s0 = s1;\n    if (s0 === peg$FAILED) {\n      s0 = peg$currPos;\n      s1 = peg$parseNUMBER();\n      if (s1 !== peg$FAILED) {\n        s2 = peg$parseFAMILY();\n        if (s2 !== peg$FAILED) {\n          peg$savedPos = s0;\n          s0 = peg$f6(s1, s2);\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n      if (s0 === peg$FAILED) {\n        s0 = peg$currPos;\n        s1 = peg$parseNUMBER();\n        if (s1 !== peg$FAILED) {\n          rule$expects(peg$e7);\n          if (input.charCodeAt(peg$currPos) === 45) {\n            s2 = peg$c5;\n            peg$currPos++;\n          } else {\n            s2 = peg$FAILED;\n          }\n          if (s2 !== peg$FAILED) {\n            s3 = peg$parseNUMBER();\n            if (s3 !== peg$FAILED) {\n              s4 = peg$parseFAMILY();\n              if (s4 !== peg$FAILED) {\n                peg$savedPos = s0;\n                s0 = peg$f7(s1, s3, s4);\n              } else {\n                peg$currPos = s0;\n                s0 = peg$FAILED;\n              }\n            } else {\n              peg$currPos = s0;\n              s0 = peg$FAILED;\n            }\n          } else {\n            peg$currPos = s0;\n            s0 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      }\n    }\n\n    return s0;\n  }\n\n  function peg$parseREPEATABLE_UNIT() {\n    var s0, s1, s2, s3, s4, s5;\n\n    var rule$expects = function (expected) {\n      if (peg$silentFails === 0) peg$expect(expected);\n    }\n\n    s0 = peg$parseBLOCK_MOVE();\n    if (s0 === peg$FAILED) {\n      s0 = peg$currPos;\n      rule$expects(peg$e8);\n      if (input.charCodeAt(peg$currPos) === 91) {\n        s1 = peg$c6;\n        peg$currPos++;\n      } else {\n        s1 = peg$FAILED;\n      }\n      if (s1 !== peg$FAILED) {\n        s2 = peg$parseSEQUENCE();\n        if (s2 !== peg$FAILED) {\n          rule$expects(peg$e9);\n          if (peg$r2.test(input.charAt(peg$currPos))) {\n            s3 = input.charAt(peg$currPos);\n            peg$currPos++;\n          } else {\n            s3 = peg$FAILED;\n          }\n          if (s3 !== peg$FAILED) {\n            s4 = peg$parseSEQUENCE();\n            if (s4 !== peg$FAILED) {\n              rule$expects(peg$e10);\n              if (input.charCodeAt(peg$currPos) === 93) {\n                s5 = peg$c7;\n                peg$currPos++;\n              } else {\n                s5 = peg$FAILED;\n              }\n              if (s5 !== peg$FAILED) {\n                peg$savedPos = s0;\n                s0 = peg$f8(s2, s3, s4);\n              } else {\n                peg$currPos = s0;\n                s0 = peg$FAILED;\n              }\n            } else {\n              peg$currPos = s0;\n              s0 = peg$FAILED;\n            }\n          } else {\n            peg$currPos = s0;\n            s0 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n      if (s0 === peg$FAILED) {\n        s0 = peg$currPos;\n        rule$expects(peg$e11);\n        if (input.charCodeAt(peg$currPos) === 40) {\n          s1 = peg$c8;\n          peg$currPos++;\n        } else {\n          s1 = peg$FAILED;\n        }\n        if (s1 !== peg$FAILED) {\n          s2 = peg$parseSEQUENCE();\n          if (s2 !== peg$FAILED) {\n            rule$expects(peg$e12);\n            if (input.charCodeAt(peg$currPos) === 41) {\n              s3 = peg$c9;\n              peg$currPos++;\n            } else {\n              s3 = peg$FAILED;\n            }\n            if (s3 !== peg$FAILED) {\n              peg$savedPos = s0;\n              s0 = peg$f9(s2);\n            } else {\n              peg$currPos = s0;\n              s0 = peg$FAILED;\n            }\n          } else {\n            peg$currPos = s0;\n            s0 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      }\n    }\n\n    return s0;\n  }\n\n  function peg$parseREPEATED_UNIT() {\n    var s0, s1, s2;\n\n    var rule$expects = function (expected) {\n      if (peg$silentFails === 0) peg$expect(expected);\n    }\n\n    s0 = peg$currPos;\n    s1 = peg$parseREPEATABLE_UNIT();\n    if (s1 !== peg$FAILED) {\n      s2 = peg$parseAMOUNT();\n      if (s2 !== peg$FAILED) {\n        peg$savedPos = s0;\n        s0 = peg$f10(s1, s2);\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    if (s0 === peg$FAILED) {\n      s0 = peg$currPos;\n      s1 = peg$parseREPEATABLE_UNIT();\n      if (s1 !== peg$FAILED) {\n        peg$savedPos = s0;\n        s1 = peg$f11(s1);\n      }\n      s0 = s1;\n    }\n\n    return s0;\n  }\n\n  function peg$parseCOMMENT() {\n    var s0, s1, s2, s3;\n\n    var rule$expects = function (expected) {\n      if (peg$silentFails === 0) peg$expect(expected);\n    }\n\n    s0 = peg$currPos;\n    rule$expects(peg$e13);\n    if (input.substr(peg$currPos, 2) === peg$c10) {\n      s1 = peg$c10;\n      peg$currPos += 2;\n    } else {\n      s1 = peg$FAILED;\n    }\n    if (s1 !== peg$FAILED) {\n      s2 = [];\n      rule$expects(peg$e14);\n      if (peg$r3.test(input.charAt(peg$currPos))) {\n        s3 = input.charAt(peg$currPos);\n        peg$currPos++;\n      } else {\n        s3 = peg$FAILED;\n      }\n      while (s3 !== peg$FAILED) {\n        s2.push(s3);\n        rule$expects(peg$e14);\n        if (peg$r3.test(input.charAt(peg$currPos))) {\n          s3 = input.charAt(peg$currPos);\n          peg$currPos++;\n        } else {\n          s3 = peg$FAILED;\n        }\n      }\n      peg$savedPos = s0;\n      s0 = peg$f12(s2);\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n\n    return s0;\n  }\n\n  function peg$parseANNOTATION() {\n    var s0, s1;\n\n    var rule$expects = function (expected) {\n      if (peg$silentFails === 0) peg$expect(expected);\n    }\n\n    s0 = peg$currPos;\n    rule$expects(peg$e15);\n    if (peg$r4.test(input.charAt(peg$currPos))) {\n      s1 = input.charAt(peg$currPos);\n      peg$currPos++;\n    } else {\n      s1 = peg$FAILED;\n    }\n    if (s1 !== peg$FAILED) {\n      peg$savedPos = s0;\n      s1 = peg$f13();\n    }\n    s0 = s1;\n    if (s0 === peg$FAILED) {\n      s0 = peg$currPos;\n      rule$expects(peg$e16);\n      if (input.charCodeAt(peg$currPos) === 46) {\n        s1 = peg$c11;\n        peg$currPos++;\n      } else {\n        s1 = peg$FAILED;\n      }\n      if (s1 !== peg$FAILED) {\n        peg$savedPos = s0;\n        s1 = peg$f14();\n      }\n      s0 = s1;\n      if (s0 === peg$FAILED) {\n        s0 = peg$parseCOMMENT();\n      }\n    }\n\n    return s0;\n  }\n\n  function peg$parseSEGMENT_PART() {\n    var s0;\n\n    var rule$expects = function (expected) {\n      if (peg$silentFails === 0) peg$expect(expected);\n    }\n\n    s0 = peg$parseREPEATED_UNIT();\n    if (s0 === peg$FAILED) {\n      s0 = peg$parseANNOTATION();\n    }\n\n    return s0;\n  }\n\n  function peg$parseSEGMENT() {\n    var s0, s1, s2;\n\n    var rule$expects = function (expected) {\n      if (peg$silentFails === 0) peg$expect(expected);\n    }\n\n    s0 = peg$currPos;\n    s1 = peg$parseSEGMENT_PART();\n    if (s1 !== peg$FAILED) {\n      s2 = peg$parseSEGMENT();\n      if (s2 !== peg$FAILED) {\n        peg$savedPos = s0;\n        s0 = peg$f15(s1, s2);\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    if (s0 === peg$FAILED) {\n      s0 = peg$currPos;\n      s1 = peg$parseSEGMENT_PART();\n      if (s1 !== peg$FAILED) {\n        peg$savedPos = s0;\n        s1 = peg$f16(s1);\n      }\n      s0 = s1;\n    }\n\n    return s0;\n  }\n\n  function peg$parseUNIT_LIST() {\n    var s0, s1, s2, s3;\n\n    var rule$expects = function (expected) {\n      if (peg$silentFails === 0) peg$expect(expected);\n    }\n\n    s0 = peg$currPos;\n    s1 = peg$parseSEGMENT();\n    if (s1 !== peg$FAILED) {\n      s2 = [];\n      rule$expects(peg$e17);\n      if (peg$r5.test(input.charAt(peg$currPos))) {\n        s3 = input.charAt(peg$currPos);\n        peg$currPos++;\n      } else {\n        s3 = peg$FAILED;\n      }\n      if (s3 !== peg$FAILED) {\n        while (s3 !== peg$FAILED) {\n          s2.push(s3);\n          rule$expects(peg$e17);\n          if (peg$r5.test(input.charAt(peg$currPos))) {\n            s3 = input.charAt(peg$currPos);\n            peg$currPos++;\n          } else {\n            s3 = peg$FAILED;\n          }\n        }\n      } else {\n        s2 = peg$FAILED;\n      }\n      if (s2 !== peg$FAILED) {\n        s3 = peg$parseUNIT_LIST();\n        if (s3 !== peg$FAILED) {\n          peg$savedPos = s0;\n          s0 = peg$f17(s1, s3);\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    if (s0 === peg$FAILED) {\n      s0 = peg$parseSEGMENT();\n    }\n\n    return s0;\n  }\n\n  function peg$parseSEQUENCE() {\n    var s0, s1, s2, s3, s4;\n\n    var rule$expects = function (expected) {\n      if (peg$silentFails === 0) peg$expect(expected);\n    }\n\n    s0 = peg$currPos;\n    s1 = [];\n    rule$expects(peg$e17);\n    if (peg$r5.test(input.charAt(peg$currPos))) {\n      s2 = input.charAt(peg$currPos);\n      peg$currPos++;\n    } else {\n      s2 = peg$FAILED;\n    }\n    while (s2 !== peg$FAILED) {\n      s1.push(s2);\n      rule$expects(peg$e17);\n      if (peg$r5.test(input.charAt(peg$currPos))) {\n        s2 = input.charAt(peg$currPos);\n        peg$currPos++;\n      } else {\n        s2 = peg$FAILED;\n      }\n    }\n    s2 = peg$parseUNIT_LIST();\n    if (s2 !== peg$FAILED) {\n      s3 = [];\n      rule$expects(peg$e17);\n      if (peg$r5.test(input.charAt(peg$currPos))) {\n        s4 = input.charAt(peg$currPos);\n        peg$currPos++;\n      } else {\n        s4 = peg$FAILED;\n      }\n      while (s4 !== peg$FAILED) {\n        s3.push(s4);\n        rule$expects(peg$e17);\n        if (peg$r5.test(input.charAt(peg$currPos))) {\n          s4 = input.charAt(peg$currPos);\n          peg$currPos++;\n        } else {\n          s4 = peg$FAILED;\n        }\n      }\n      peg$savedPos = s0;\n      s0 = peg$f18(s2);\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    if (s0 === peg$FAILED) {\n      s0 = peg$currPos;\n      s1 = [];\n      rule$expects(peg$e17);\n      if (peg$r5.test(input.charAt(peg$currPos))) {\n        s2 = input.charAt(peg$currPos);\n        peg$currPos++;\n      } else {\n        s2 = peg$FAILED;\n      }\n      while (s2 !== peg$FAILED) {\n        s1.push(s2);\n        rule$expects(peg$e17);\n        if (peg$r5.test(input.charAt(peg$currPos))) {\n          s2 = input.charAt(peg$currPos);\n          peg$currPos++;\n        } else {\n          s2 = peg$FAILED;\n        }\n      }\n      peg$savedPos = s0;\n      s1 = peg$f19();\n      s0 = s1;\n    }\n\n    return s0;\n  }\n\n  peg$begin();\n  peg$result = peg$startRuleFunction();\n\n  if (peg$result !== peg$FAILED && peg$currPos === input.length) {\n    return peg$result;\n  } else {\n    if (peg$result !== peg$FAILED && peg$currPos < input.length) {\n      peg$expect(peg$endExpectation());\n    }\n\n    throw peg$buildError();\n  }\n}\n\nmodule.exports = {\n  SyntaxError: peg$SyntaxError,\n  parse: peg$parse\n};\n", "// Generated by PEG.js v0.11.0-master.f69239d, https://pegjs.org/\n\n\"use strict\";\n\nfunction peg$subclass(child, parent) {\n  function C() { this.constructor = child; }\n  C.prototype = parent.prototype;\n  child.prototype = new C();\n}\n\nfunction peg$SyntaxError(message, expected, found, location) {\n  this.message = message;\n  this.expected = expected;\n  this.found = found;\n  this.location = location;\n  this.name = \"SyntaxError\";\n\n  // istanbul ignore next\n  if (typeof Error.captureStackTrace === \"function\") {\n    Error.captureStackTrace(this, peg$SyntaxError);\n  }\n}\n\npeg$subclass(peg$SyntaxError, Error);\n\npeg$SyntaxError.buildMessage = function(expected, found) {\n  var DESCRIBE_EXPECTATION_FNS = {\n    literal: function(expectation) {\n      return \"\\\"\" + literalEscape(expectation.text) + \"\\\"\";\n    },\n\n    class: function(expectation) {\n      var escapedParts = expectation.parts.map(function(part) {\n        return Array.isArray(part)\n          ? classEscape(part[0]) + \"-\" + classEscape(part[1])\n          : classEscape(part);\n      });\n\n      return \"[\" + (expectation.inverted ? \"^\" : \"\") + escapedParts + \"]\";\n    },\n\n    any: function() {\n      return \"any character\";\n    },\n\n    end: function() {\n      return \"end of input\";\n    },\n\n    other: function(expectation) {\n      return expectation.description;\n    },\n\n    not: function(expectation) {\n      return \"not \" + describeExpectation(expectation.expected);\n    }\n  };\n\n  function hex(ch) {\n    return ch.charCodeAt(0).toString(16).toUpperCase();\n  }\n\n  function literalEscape(s) {\n    return s\n      .replace(/\\\\/g, \"\\\\\\\\\")\n      .replace(/\"/g,  \"\\\\\\\"\")\n      .replace(/\\0/g, \"\\\\0\")\n      .replace(/\\t/g, \"\\\\t\")\n      .replace(/\\n/g, \"\\\\n\")\n      .replace(/\\r/g, \"\\\\r\")\n      .replace(/[\\x00-\\x0F]/g,          function(ch) { return \"\\\\x0\" + hex(ch); })\n      .replace(/[\\x10-\\x1F\\x7F-\\x9F]/g, function(ch) { return \"\\\\x\"  + hex(ch); });\n  }\n\n  function classEscape(s) {\n    return s\n      .replace(/\\\\/g, \"\\\\\\\\\")\n      .replace(/\\]/g, \"\\\\]\")\n      .replace(/\\^/g, \"\\\\^\")\n      .replace(/-/g,  \"\\\\-\")\n      .replace(/\\0/g, \"\\\\0\")\n      .replace(/\\t/g, \"\\\\t\")\n      .replace(/\\n/g, \"\\\\n\")\n      .replace(/\\r/g, \"\\\\r\")\n      .replace(/[\\x00-\\x0F]/g,          function(ch) { return \"\\\\x0\" + hex(ch); })\n      .replace(/[\\x10-\\x1F\\x7F-\\x9F]/g, function(ch) { return \"\\\\x\"  + hex(ch); });\n  }\n\n  function describeExpectation(expectation) {\n    return DESCRIBE_EXPECTATION_FNS[expectation.type](expectation);\n  }\n\n  function describeExpected(expected) {\n    var descriptions = expected.map(describeExpectation);\n    var i, j;\n\n    descriptions.sort();\n\n    if (descriptions.length > 0) {\n      for (i = 1, j = 1; i < descriptions.length; i++) {\n        if (descriptions[i - 1] !== descriptions[i]) {\n          descriptions[j] = descriptions[i];\n          j++;\n        }\n      }\n      descriptions.length = j;\n    }\n\n    switch (descriptions.length) {\n      case 1:\n        return descriptions[0];\n\n      case 2:\n        return descriptions[0] + \" or \" + descriptions[1];\n\n      default:\n        return descriptions.slice(0, -1).join(\", \")\n          + \", or \"\n          + descriptions[descriptions.length - 1];\n    }\n  }\n\n  function describeFound(found) {\n    return found ? \"\\\"\" + literalEscape(found) + \"\\\"\" : \"end of input\";\n  }\n\n  return \"Expected \" + describeExpected(expected) + \" but \" + describeFound(found) + \" found.\";\n};\n\nfunction peg$parse(input, options) {\n  options = options !== undefined ? options : {};\n\n  var peg$FAILED = {};\n\n  var peg$startRuleFunctions = { start: peg$parsestart };\n  var peg$startRuleFunction = peg$parsestart;\n\n  var peg$c0 = \" \";\n  var peg$c1 = \"Name\";\n  var peg$c2 = \"Set\";\n  var peg$c3 = \"\\n\";\n  var peg$c4 = \"Solved\";\n  var peg$c5 = \"End\";\n  var peg$c6 = \"Move\";\n\n  var peg$r0 = /^[A-Za-z0-9<>]/;\n  var peg$r1 = /^[A-Za-z]/;\n  var peg$r2 = /^[A-Za-z0-9]/;\n  var peg$r3 = /^[0-9]/;\n\n  var peg$e0 = peg$classExpectation([[\"A\", \"Z\"], [\"a\", \"z\"], [\"0\", \"9\"], \"<\", \">\"], false, false);\n  var peg$e1 = peg$classExpectation([[\"A\", \"Z\"], [\"a\", \"z\"]], false, false);\n  var peg$e2 = peg$classExpectation([[\"A\", \"Z\"], [\"a\", \"z\"], [\"0\", \"9\"]], false, false);\n  var peg$e3 = peg$classExpectation([[\"0\", \"9\"]], false, false);\n  var peg$e4 = peg$literalExpectation(\" \", false);\n  var peg$e5 = peg$literalExpectation(\"Name\", false);\n  var peg$e6 = peg$literalExpectation(\"Set\", false);\n  var peg$e7 = peg$literalExpectation(\"\\n\", false);\n  var peg$e8 = peg$literalExpectation(\"Solved\", false);\n  var peg$e9 = peg$literalExpectation(\"End\", false);\n  var peg$e10 = peg$literalExpectation(\"Move\", false);\n\n  var peg$f0 = function(def) { return fixMoves(def); };\n  var peg$f1 = function(characters) { return characters.join(\"\"); };\n  var peg$f2 = function(first, rest) { return [first].concat(rest).join(\"\"); };\n  var peg$f3 = function(characters) { return parseInt(characters.join(\"\"), 10); };\n  var peg$f4 = function(identifier) { return identifier; };\n  var peg$f5 = function(set_identifier, num_pieces, num_orientations) {\n          return [set_identifier, {numPieces: num_pieces, orientations: num_orientations}];\n         };\n  var peg$f6 = function(orbit, orbits) { orbits[orbit[0]] = orbit[1]; return orbits; };\n  var peg$f7 = function(orbit) { const orbits = {}; orbits[orbit[0]] = orbit[1]; return orbits;  };\n  var peg$f8 = function(num, nums) { return [num].concat(nums); };\n  var peg$f9 = function(num) { return [num]; };\n  var peg$f10 = function(nums) { return fixPermutation(nums) };\n  var peg$f11 = function(set_identifier, permutation, nums) {\n                  return [set_identifier, {permutation: permutation, orientation: nums}];\n                };\n  var peg$f12 = function(set_identifier, permutation) {\n                  return [set_identifier, {permutation: permutation, orientation: new Array(permutation.length).fill(0)}];\n                };\n  var peg$f13 = function(definition, definitions) { definitions[definition[0]] = definition[1]; return definitions; };\n  var peg$f14 = function(definition) { const definitions = {}; definitions[definition[0]] = definition[1]; return definitions; };\n  var peg$f15 = function(definitions) { return definitions; };\n  var peg$f16 = function(identifier, definitions) { return [identifier, definitions]; };\n  var peg$f17 = function(move, moves) { moves[move[0]] = move[1]; return moves; };\n  var peg$f18 = function(move) { const moves = {}; moves[move[0]] = move[1]; return moves; };\n  var peg$f19 = function(name, orbits, start_pieces, moves) {\n                      return {name: name, orbits: orbits, moves: moves, startPieces: start_pieces};\n                    };\n\n  var peg$currPos = 0;\n  var peg$savedPos = 0;\n  var peg$posDetailsCache = [{ line: 1, column: 1 }];\n  var peg$expected = [];\n  var peg$silentFails = 0;\n\n  var peg$result;\n\n  if (\"startRule\" in options) {\n    if (!(options.startRule in peg$startRuleFunctions)) {\n      throw new Error(\"Can't start parsing from rule \\\"\" + options.startRule + \"\\\".\");\n    }\n\n    peg$startRuleFunction = peg$startRuleFunctions[options.startRule];\n  }\n\n  function text() {\n    return input.substring(peg$savedPos, peg$currPos);\n  }\n\n  function offset() {\n    return peg$savedPos;\n  }\n\n  function range() {\n    return [peg$savedPos, peg$currPos];\n  }\n\n  function location() {\n    return peg$computeLocation(peg$savedPos, peg$currPos);\n  }\n\n  function expected(description, location) {\n    location = location !== undefined\n      ? location\n      : peg$computeLocation(peg$savedPos, peg$currPos);\n\n    throw peg$buildStructuredError(\n      [peg$otherExpectation(description)],\n      input.substring(peg$savedPos, peg$currPos),\n      location\n    );\n  }\n\n  function error(message, location) {\n    location = location !== undefined\n      ? location\n      : peg$computeLocation(peg$savedPos, peg$currPos);\n\n    throw peg$buildSimpleError(message, location);\n  }\n\n  function peg$literalExpectation(text, ignoreCase) {\n    return { type: \"literal\", text: text, ignoreCase: ignoreCase };\n  }\n\n  function peg$classExpectation(parts, inverted, ignoreCase) {\n    return { type: \"class\", parts: parts, inverted: inverted, ignoreCase: ignoreCase };\n  }\n\n  function peg$anyExpectation() {\n    return { type: \"any\" };\n  }\n\n  function peg$endExpectation() {\n    return { type: \"end\" };\n  }\n\n  function peg$otherExpectation(description) {\n    return { type: \"other\", description: description };\n  }\n\n  function peg$computePosDetails(pos) {\n    var details = peg$posDetailsCache[pos];\n    var p;\n\n    if (details) {\n      return details;\n    } else {\n      p = pos - 1;\n      while (!peg$posDetailsCache[p]) {\n        p--;\n      }\n\n      details = peg$posDetailsCache[p];\n      details = {\n        line: details.line,\n        column: details.column\n      };\n\n      while (p < pos) {\n        if (input.charCodeAt(p) === 10) {\n          details.line++;\n          details.column = 1;\n        } else {\n          details.column++;\n        }\n\n        p++;\n      }\n\n      peg$posDetailsCache[pos] = details;\n\n      return details;\n    }\n  }\n\n  var peg$VALIDFILENAME = typeof options.filename === \"string\" && options.filename.length > 0;\n  function peg$computeLocation(startPos, endPos) {\n    var loc = {};\n\n    if ( peg$VALIDFILENAME ) loc.filename = options.filename;\n\n    var startPosDetails = peg$computePosDetails(startPos);\n    loc.start = {\n      offset: startPos,\n      line: startPosDetails.line,\n      column: startPosDetails.column\n    };\n\n    var endPosDetails = peg$computePosDetails(endPos);\n    loc.end = {\n      offset: endPos,\n      line: endPosDetails.line,\n      column: endPosDetails.column\n    };\n\n    return loc;\n  }\n\n  function peg$begin() {\n    peg$expected.push({ pos: peg$currPos, variants: [] });\n  }\n\n  function peg$expect(expected) {\n    var top = peg$expected[peg$expected.length - 1];\n\n    if (peg$currPos < top.pos) { return; }\n\n    if (peg$currPos > top.pos) {\n      top.pos = peg$currPos;\n      top.variants = [];\n    }\n\n    top.variants.push(expected);\n  }\n\n  function peg$end(invert) {\n    var expected = peg$expected.pop();\n    var top = peg$expected[peg$expected.length - 1];\n    var variants = expected.variants;\n\n    if (top.pos !== expected.pos) { return; }\n\n    if (invert) {\n      variants = variants.map(function(e) {\n        return e.type === \"not\" ? e.expected : { type: \"not\", expected: e };\n      });\n    }\n\n    Array.prototype.push.apply(top.variants, variants);\n  }\n\n  function peg$buildSimpleError(message, location) {\n    return new peg$SyntaxError(message, null, null, location);\n  }\n\n  function peg$buildStructuredError(expected, found, location) {\n    return new peg$SyntaxError(\n      peg$SyntaxError.buildMessage(expected, found),\n      expected,\n      found,\n      location\n    );\n  }\n\n  function peg$buildError() {\n    var expected = peg$expected[0];\n    var failPos = expected.pos;\n\n    return peg$buildStructuredError(\n      expected.variants,\n      failPos < input.length ? input.charAt(failPos) : null,\n      failPos < input.length\n        ? peg$computeLocation(failPos, failPos + 1)\n        : peg$computeLocation(failPos, failPos)\n    );\n  }\n\n  function peg$parsestart() {\n    var s0, s1;\n\n    var rule$expects = function (expected) {\n      if (peg$silentFails === 0) peg$expect(expected);\n    }\n\n    s0 = peg$currPos;\n    s1 = peg$parseDEFINITION_FILE();\n    if (s1 !== peg$FAILED) {\n      peg$savedPos = s0;\n      s1 = peg$f0(s1);\n    }\n    s0 = s1;\n\n    return s0;\n  }\n\n  function peg$parseIDENTIFIER() {\n    var s0, s1, s2;\n\n    var rule$expects = function (expected) {\n      if (peg$silentFails === 0) peg$expect(expected);\n    }\n\n    s0 = peg$currPos;\n    s1 = [];\n    rule$expects(peg$e0);\n    if (peg$r0.test(input.charAt(peg$currPos))) {\n      s2 = input.charAt(peg$currPos);\n      peg$currPos++;\n    } else {\n      s2 = peg$FAILED;\n    }\n    if (s2 !== peg$FAILED) {\n      while (s2 !== peg$FAILED) {\n        s1.push(s2);\n        rule$expects(peg$e0);\n        if (peg$r0.test(input.charAt(peg$currPos))) {\n          s2 = input.charAt(peg$currPos);\n          peg$currPos++;\n        } else {\n          s2 = peg$FAILED;\n        }\n      }\n    } else {\n      s1 = peg$FAILED;\n    }\n    if (s1 !== peg$FAILED) {\n      peg$savedPos = s0;\n      s1 = peg$f1(s1);\n    }\n    s0 = s1;\n\n    return s0;\n  }\n\n  function peg$parseSET_IDENTIFIER() {\n    var s0, s1, s2, s3;\n\n    var rule$expects = function (expected) {\n      if (peg$silentFails === 0) peg$expect(expected);\n    }\n\n    s0 = peg$currPos;\n    rule$expects(peg$e1);\n    if (peg$r1.test(input.charAt(peg$currPos))) {\n      s1 = input.charAt(peg$currPos);\n      peg$currPos++;\n    } else {\n      s1 = peg$FAILED;\n    }\n    if (s1 !== peg$FAILED) {\n      s2 = [];\n      rule$expects(peg$e2);\n      if (peg$r2.test(input.charAt(peg$currPos))) {\n        s3 = input.charAt(peg$currPos);\n        peg$currPos++;\n      } else {\n        s3 = peg$FAILED;\n      }\n      while (s3 !== peg$FAILED) {\n        s2.push(s3);\n        rule$expects(peg$e2);\n        if (peg$r2.test(input.charAt(peg$currPos))) {\n          s3 = input.charAt(peg$currPos);\n          peg$currPos++;\n        } else {\n          s3 = peg$FAILED;\n        }\n      }\n      peg$savedPos = s0;\n      s0 = peg$f2(s1, s2);\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n\n    return s0;\n  }\n\n  function peg$parseNUMBER() {\n    var s0, s1, s2;\n\n    var rule$expects = function (expected) {\n      if (peg$silentFails === 0) peg$expect(expected);\n    }\n\n    s0 = peg$currPos;\n    s1 = [];\n    rule$expects(peg$e3);\n    if (peg$r3.test(input.charAt(peg$currPos))) {\n      s2 = input.charAt(peg$currPos);\n      peg$currPos++;\n    } else {\n      s2 = peg$FAILED;\n    }\n    if (s2 !== peg$FAILED) {\n      while (s2 !== peg$FAILED) {\n        s1.push(s2);\n        rule$expects(peg$e3);\n        if (peg$r3.test(input.charAt(peg$currPos))) {\n          s2 = input.charAt(peg$currPos);\n          peg$currPos++;\n        } else {\n          s2 = peg$FAILED;\n        }\n      }\n    } else {\n      s1 = peg$FAILED;\n    }\n    if (s1 !== peg$FAILED) {\n      peg$savedPos = s0;\n      s1 = peg$f3(s1);\n    }\n    s0 = s1;\n\n    return s0;\n  }\n\n  function peg$parseSPACE() {\n    var s0;\n\n    var rule$expects = function (expected) {\n      if (peg$silentFails === 0) peg$expect(expected);\n    }\n\n    rule$expects(peg$e4);\n    if (input.charCodeAt(peg$currPos) === 32) {\n      s0 = peg$c0;\n      peg$currPos++;\n    } else {\n      s0 = peg$FAILED;\n    }\n\n    return s0;\n  }\n\n  function peg$parseNAME() {\n    var s0, s1, s2, s3;\n\n    var rule$expects = function (expected) {\n      if (peg$silentFails === 0) peg$expect(expected);\n    }\n\n    s0 = peg$currPos;\n    rule$expects(peg$e5);\n    if (input.substr(peg$currPos, 4) === peg$c1) {\n      s1 = peg$c1;\n      peg$currPos += 4;\n    } else {\n      s1 = peg$FAILED;\n    }\n    if (s1 !== peg$FAILED) {\n      s2 = peg$parseSPACE();\n      if (s2 !== peg$FAILED) {\n        s3 = peg$parseIDENTIFIER();\n        if (s3 !== peg$FAILED) {\n          peg$savedPos = s0;\n          s0 = peg$f4(s3);\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n\n    return s0;\n  }\n\n  function peg$parseORBIT() {\n    var s0, s1, s2, s3, s4, s5, s6, s7;\n\n    var rule$expects = function (expected) {\n      if (peg$silentFails === 0) peg$expect(expected);\n    }\n\n    s0 = peg$currPos;\n    rule$expects(peg$e6);\n    if (input.substr(peg$currPos, 3) === peg$c2) {\n      s1 = peg$c2;\n      peg$currPos += 3;\n    } else {\n      s1 = peg$FAILED;\n    }\n    if (s1 !== peg$FAILED) {\n      s2 = peg$parseSPACE();\n      if (s2 !== peg$FAILED) {\n        s3 = peg$parseSET_IDENTIFIER();\n        if (s3 !== peg$FAILED) {\n          s4 = peg$parseSPACE();\n          if (s4 !== peg$FAILED) {\n            s5 = peg$parseNUMBER();\n            if (s5 !== peg$FAILED) {\n              s6 = peg$parseSPACE();\n              if (s6 !== peg$FAILED) {\n                s7 = peg$parseNUMBER();\n                if (s7 !== peg$FAILED) {\n                  peg$savedPos = s0;\n                  s0 = peg$f5(s3, s5, s7);\n                } else {\n                  peg$currPos = s0;\n                  s0 = peg$FAILED;\n                }\n              } else {\n                peg$currPos = s0;\n                s0 = peg$FAILED;\n              }\n            } else {\n              peg$currPos = s0;\n              s0 = peg$FAILED;\n            }\n          } else {\n            peg$currPos = s0;\n            s0 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n\n    return s0;\n  }\n\n  function peg$parseORBITS() {\n    var s0, s1, s2, s3;\n\n    var rule$expects = function (expected) {\n      if (peg$silentFails === 0) peg$expect(expected);\n    }\n\n    s0 = peg$currPos;\n    s1 = peg$parseORBIT();\n    if (s1 !== peg$FAILED) {\n      s2 = peg$parseNEWLINE();\n      if (s2 !== peg$FAILED) {\n        s3 = peg$parseORBITS();\n        if (s3 !== peg$FAILED) {\n          peg$savedPos = s0;\n          s0 = peg$f6(s1, s3);\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    if (s0 === peg$FAILED) {\n      s0 = peg$currPos;\n      s1 = peg$parseORBIT();\n      if (s1 !== peg$FAILED) {\n        peg$savedPos = s0;\n        s1 = peg$f7(s1);\n      }\n      s0 = s1;\n    }\n\n    return s0;\n  }\n\n  function peg$parseNEWLINE() {\n    var s0;\n\n    var rule$expects = function (expected) {\n      if (peg$silentFails === 0) peg$expect(expected);\n    }\n\n    rule$expects(peg$e7);\n    if (input.charCodeAt(peg$currPos) === 10) {\n      s0 = peg$c3;\n      peg$currPos++;\n    } else {\n      s0 = peg$FAILED;\n    }\n\n    return s0;\n  }\n\n  function peg$parseNEWLINES() {\n    var s0, s1;\n\n    var rule$expects = function (expected) {\n      if (peg$silentFails === 0) peg$expect(expected);\n    }\n\n    s0 = [];\n    rule$expects(peg$e7);\n    if (input.charCodeAt(peg$currPos) === 10) {\n      s1 = peg$c3;\n      peg$currPos++;\n    } else {\n      s1 = peg$FAILED;\n    }\n    if (s1 !== peg$FAILED) {\n      while (s1 !== peg$FAILED) {\n        s0.push(s1);\n        rule$expects(peg$e7);\n        if (input.charCodeAt(peg$currPos) === 10) {\n          s1 = peg$c3;\n          peg$currPos++;\n        } else {\n          s1 = peg$FAILED;\n        }\n      }\n    } else {\n      s0 = peg$FAILED;\n    }\n\n    return s0;\n  }\n\n  function peg$parseOPTIONAL_NEWLINES() {\n    var s0, s1;\n\n    var rule$expects = function (expected) {\n      if (peg$silentFails === 0) peg$expect(expected);\n    }\n\n    s0 = [];\n    rule$expects(peg$e7);\n    if (input.charCodeAt(peg$currPos) === 10) {\n      s1 = peg$c3;\n      peg$currPos++;\n    } else {\n      s1 = peg$FAILED;\n    }\n    while (s1 !== peg$FAILED) {\n      s0.push(s1);\n      rule$expects(peg$e7);\n      if (input.charCodeAt(peg$currPos) === 10) {\n        s1 = peg$c3;\n        peg$currPos++;\n      } else {\n        s1 = peg$FAILED;\n      }\n    }\n\n    return s0;\n  }\n\n  function peg$parseNUMBERS() {\n    var s0, s1, s2, s3;\n\n    var rule$expects = function (expected) {\n      if (peg$silentFails === 0) peg$expect(expected);\n    }\n\n    s0 = peg$currPos;\n    s1 = peg$parseNUMBER();\n    if (s1 !== peg$FAILED) {\n      s2 = peg$parseSPACE();\n      if (s2 !== peg$FAILED) {\n        s3 = peg$parseNUMBERS();\n        if (s3 !== peg$FAILED) {\n          peg$savedPos = s0;\n          s0 = peg$f8(s1, s3);\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    if (s0 === peg$FAILED) {\n      s0 = peg$currPos;\n      s1 = peg$parseNUMBER();\n      if (s1 !== peg$FAILED) {\n        peg$savedPos = s0;\n        s1 = peg$f9(s1);\n      }\n      s0 = s1;\n    }\n\n    return s0;\n  }\n\n  function peg$parsePERMUTATION() {\n    var s0, s1;\n\n    var rule$expects = function (expected) {\n      if (peg$silentFails === 0) peg$expect(expected);\n    }\n\n    s0 = peg$currPos;\n    s1 = peg$parseNUMBERS();\n    if (s1 !== peg$FAILED) {\n      peg$savedPos = s0;\n      s1 = peg$f10(s1);\n    }\n    s0 = s1;\n\n    return s0;\n  }\n\n  function peg$parseDEFINITION() {\n    var s0, s1, s2, s3, s4, s5;\n\n    var rule$expects = function (expected) {\n      if (peg$silentFails === 0) peg$expect(expected);\n    }\n\n    s0 = peg$currPos;\n    s1 = peg$parseSET_IDENTIFIER();\n    if (s1 !== peg$FAILED) {\n      s2 = peg$parseNEWLINE();\n      if (s2 !== peg$FAILED) {\n        s3 = peg$parsePERMUTATION();\n        if (s3 !== peg$FAILED) {\n          s4 = peg$parseNEWLINE();\n          if (s4 !== peg$FAILED) {\n            s5 = peg$parseNUMBERS();\n            if (s5 !== peg$FAILED) {\n              peg$savedPos = s0;\n              s0 = peg$f11(s1, s3, s5);\n            } else {\n              peg$currPos = s0;\n              s0 = peg$FAILED;\n            }\n          } else {\n            peg$currPos = s0;\n            s0 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    if (s0 === peg$FAILED) {\n      s0 = peg$currPos;\n      s1 = peg$parseSET_IDENTIFIER();\n      if (s1 !== peg$FAILED) {\n        s2 = peg$parseNEWLINE();\n        if (s2 !== peg$FAILED) {\n          s3 = peg$parsePERMUTATION();\n          if (s3 !== peg$FAILED) {\n            peg$savedPos = s0;\n            s0 = peg$f12(s1, s3);\n          } else {\n            peg$currPos = s0;\n            s0 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    }\n\n    return s0;\n  }\n\n  function peg$parseDEFINITIONS() {\n    var s0, s1, s2, s3;\n\n    var rule$expects = function (expected) {\n      if (peg$silentFails === 0) peg$expect(expected);\n    }\n\n    s0 = peg$currPos;\n    s1 = peg$parseDEFINITION();\n    if (s1 !== peg$FAILED) {\n      s2 = peg$parseNEWLINE();\n      if (s2 !== peg$FAILED) {\n        s3 = peg$parseDEFINITIONS();\n        if (s3 !== peg$FAILED) {\n          peg$savedPos = s0;\n          s0 = peg$f13(s1, s3);\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    if (s0 === peg$FAILED) {\n      s0 = peg$currPos;\n      s1 = peg$parseDEFINITION();\n      if (s1 !== peg$FAILED) {\n        peg$savedPos = s0;\n        s1 = peg$f14(s1);\n      }\n      s0 = s1;\n    }\n\n    return s0;\n  }\n\n  function peg$parseSTART_PIECES() {\n    var s0, s1, s2, s3, s4, s5;\n\n    var rule$expects = function (expected) {\n      if (peg$silentFails === 0) peg$expect(expected);\n    }\n\n    s0 = peg$currPos;\n    rule$expects(peg$e8);\n    if (input.substr(peg$currPos, 6) === peg$c4) {\n      s1 = peg$c4;\n      peg$currPos += 6;\n    } else {\n      s1 = peg$FAILED;\n    }\n    if (s1 !== peg$FAILED) {\n      s2 = peg$parseNEWLINE();\n      if (s2 !== peg$FAILED) {\n        s3 = peg$parseDEFINITIONS();\n        if (s3 !== peg$FAILED) {\n          s4 = peg$parseNEWLINE();\n          if (s4 !== peg$FAILED) {\n            rule$expects(peg$e9);\n            if (input.substr(peg$currPos, 3) === peg$c5) {\n              s5 = peg$c5;\n              peg$currPos += 3;\n            } else {\n              s5 = peg$FAILED;\n            }\n            if (s5 !== peg$FAILED) {\n              peg$savedPos = s0;\n              s0 = peg$f15(s3);\n            } else {\n              peg$currPos = s0;\n              s0 = peg$FAILED;\n            }\n          } else {\n            peg$currPos = s0;\n            s0 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n\n    return s0;\n  }\n\n  function peg$parseMOVE() {\n    var s0, s1, s2, s3, s4, s5, s6, s7;\n\n    var rule$expects = function (expected) {\n      if (peg$silentFails === 0) peg$expect(expected);\n    }\n\n    s0 = peg$currPos;\n    rule$expects(peg$e10);\n    if (input.substr(peg$currPos, 4) === peg$c6) {\n      s1 = peg$c6;\n      peg$currPos += 4;\n    } else {\n      s1 = peg$FAILED;\n    }\n    if (s1 !== peg$FAILED) {\n      s2 = peg$parseSPACE();\n      if (s2 !== peg$FAILED) {\n        s3 = peg$parseIDENTIFIER();\n        if (s3 !== peg$FAILED) {\n          s4 = peg$parseNEWLINE();\n          if (s4 !== peg$FAILED) {\n            s5 = peg$parseDEFINITIONS();\n            if (s5 !== peg$FAILED) {\n              s6 = peg$parseNEWLINE();\n              if (s6 !== peg$FAILED) {\n                rule$expects(peg$e9);\n                if (input.substr(peg$currPos, 3) === peg$c5) {\n                  s7 = peg$c5;\n                  peg$currPos += 3;\n                } else {\n                  s7 = peg$FAILED;\n                }\n                if (s7 !== peg$FAILED) {\n                  peg$savedPos = s0;\n                  s0 = peg$f16(s3, s5);\n                } else {\n                  peg$currPos = s0;\n                  s0 = peg$FAILED;\n                }\n              } else {\n                peg$currPos = s0;\n                s0 = peg$FAILED;\n              }\n            } else {\n              peg$currPos = s0;\n              s0 = peg$FAILED;\n            }\n          } else {\n            peg$currPos = s0;\n            s0 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n\n    return s0;\n  }\n\n  function peg$parseMOVES() {\n    var s0, s1, s2, s3;\n\n    var rule$expects = function (expected) {\n      if (peg$silentFails === 0) peg$expect(expected);\n    }\n\n    s0 = peg$currPos;\n    s1 = peg$parseMOVE();\n    if (s1 !== peg$FAILED) {\n      s2 = peg$parseNEWLINES();\n      if (s2 !== peg$FAILED) {\n        s3 = peg$parseMOVES();\n        if (s3 !== peg$FAILED) {\n          peg$savedPos = s0;\n          s0 = peg$f17(s1, s3);\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    if (s0 === peg$FAILED) {\n      s0 = peg$currPos;\n      s1 = peg$parseMOVE();\n      if (s1 !== peg$FAILED) {\n        peg$savedPos = s0;\n        s1 = peg$f18(s1);\n      }\n      s0 = s1;\n    }\n\n    return s0;\n  }\n\n  function peg$parseDEFINITION_FILE() {\n    var s0, s1, s2, s3, s4, s5, s6, s7, s8;\n\n    var rule$expects = function (expected) {\n      if (peg$silentFails === 0) peg$expect(expected);\n    }\n\n    s0 = peg$currPos;\n    s1 = peg$parseNAME();\n    if (s1 !== peg$FAILED) {\n      s2 = peg$parseNEWLINES();\n      if (s2 !== peg$FAILED) {\n        s3 = peg$parseORBITS();\n        if (s3 !== peg$FAILED) {\n          s4 = peg$parseNEWLINES();\n          if (s4 !== peg$FAILED) {\n            s5 = peg$parseSTART_PIECES();\n            if (s5 !== peg$FAILED) {\n              s6 = peg$parseNEWLINES();\n              if (s6 !== peg$FAILED) {\n                s7 = peg$parseMOVES();\n                if (s7 !== peg$FAILED) {\n                  s8 = peg$parseOPTIONAL_NEWLINES();\n                  peg$savedPos = s0;\n                  s0 = peg$f19(s1, s3, s5, s7);\n                } else {\n                  peg$currPos = s0;\n                  s0 = peg$FAILED;\n                }\n              } else {\n                peg$currPos = s0;\n                s0 = peg$FAILED;\n              }\n            } else {\n              peg$currPos = s0;\n              s0 = peg$FAILED;\n            }\n          } else {\n            peg$currPos = s0;\n            s0 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n\n    return s0;\n  }\n\n\n    function fixPermutation(permutation) {\n      return permutation.map(x => x - 1);\n    }\n\n    function fixMoves(def) {\n      for (const moveName in def.moves) {\n        const move = def.moves[moveName] ;\n        for (const orbitName in def.orbits) {\n          const moveOrbit = move[orbitName] ;\n          const oldOrientation = moveOrbit.orientation ;\n          const perm = moveOrbit.permutation ;\n          const newOrientation = new Array(oldOrientation.length) ;\n          for (let i = 0; i < perm.length; i++) {\n            newOrientation[i] = oldOrientation[perm[i]] ;\n          }\n          moveOrbit.orientation = newOrientation ;\n        }\n      }\n      return def;\n    }\n\n\n  peg$begin();\n  peg$result = peg$startRuleFunction();\n\n  if (peg$result !== peg$FAILED && peg$currPos === input.length) {\n    return peg$result;\n  } else {\n    if (peg$result !== peg$FAILED && peg$currPos < input.length) {\n      peg$expect(peg$endExpectation());\n    }\n\n    throw peg$buildError();\n  }\n}\n\nmodule.exports = {\n  SyntaxError: peg$SyntaxError,\n  parse: peg$parse\n};\n", "// TODO: `export * as ...`?\nimport * as alg from \"./alg\";\nimport * as bluetooth from \"./bluetooth\";\nimport * as kpuzzle from \"./kpuzzle\";\nimport * as protocol from \"./protocol\";\nimport * as puzzleGeometry from \"./puzzle-geometry\";\nimport * as stream from \"./stream\";\nimport * as twisty from \"./twisty\";\n\nexport { alg };\nexport { bluetooth };\nexport { protocol };\nexport { kpuzzle };\nexport { stream };\nexport { twisty };\n\n// TODO: Export `puzzle-geometry` as `puzzle-geometry`, if at all possible.\n// https://github.com/cubing/cubing.js/issues/1\nexport { puzzleGeometry };\n", "export {\n  AlgPart,\n  Unit,\n  WithAmount,\n  Move,\n  Container,\n  Annotation,\n  Sequence,\n  Group,\n  MoveFamily,\n  BlockMove,\n  BareBlockMove,\n  LayerBlockMove,\n  RangeBlockMove,\n  Commutator,\n  Conjugate,\n  Pause,\n  NewLine,\n  Comment,\n} from \"./algorithm\";\n\nexport {\n  modifiedBlockMove,\n  experimentalAppendBlockMove,\n  experimentalConcatAlgs,\n} from \"./operation\";\n\nexport {\n  TraversalDownUp,\n  TraversalUp,\n  invert,\n  expand,\n  structureEquals,\n  coalesceBaseMoves,\n  algToString,\n  algPartToStringForTesting,\n  blockMoveToString,\n} from \"./traversal\";\n\nexport { Example } from \"./example\";\n\nexport { AlgJSON, fromJSON } from \"./json\";\n\nexport { parse } from \"./parser\";\n\nexport { keyToMove } from \"./keyboard\";\n\nexport {\n  validateSiGNMoves,\n  validateFlatAlg,\n  validateSiGNAlg,\n  ValidationError,\n} from \"./validation\";\n\nexport {\n  serializeURLParam,\n  deserializeURLParam,\n  algCubingNetLink,\n  getAlgURLParam,\n} from \"./url\";\n\nexport { setAlgPartTypeMismatchReportingLevel } from \"./debug\";\n", "type ReportingLevel = \"none\" | \"warn\" | \"error\";\nlet currentReportingLevel = \"warn\";\n\nconst MAX_NUMBER_OF_TIMES_TO_WARN = 10;\nlet numWarned = 0;\n\n// TODO: Avoid creating the string message if it won't be used (e.g. by taking a function?).\nexport function reportTypeMismatch(msg: string): void {\n  switch (currentReportingLevel) {\n    case \"error\":\n      throw new Error(msg);\n    case \"warn\":\n      numWarned++;\n      if (numWarned < MAX_NUMBER_OF_TIMES_TO_WARN) {\n        if (numWarned + 1 === MAX_NUMBER_OF_TIMES_TO_WARN) {\n          console.warn(msg);\n        }\n      }\n      return;\n  }\n}\n\nexport function setAlgPartTypeMismatchReportingLevel(\n  level: ReportingLevel,\n): void {\n  currentReportingLevel = level;\n}\n", "import { reportTypeMismatch } from \"../debug\";\n\nexport type AlgPartType = string;\n\nexport abstract class AlgPart {\n  public abstract type: AlgPartType;\n}\n\n// type Constructor<T> = Function & { prototype: T }\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\nexport function matchesAlgType(a: { type: any }, t: AlgPartType): boolean {\n  return a.type === t;\n}\n\nexport function assertMatchesType<T extends AlgPart>(\n  // eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\n  a: any,\n  t: AlgPartType,\n): T {\n  if (!matchesAlgType(a, t)) {\n    reportTypeMismatch(`Expected \"type\": \"${t}\", saw \"type\": \"${a.type}\".`);\n  }\n  return a;\n}\n\n// Assumes that every `AlgPart` is a `Unit` or a `Sequence`.\nexport function isUnit(a: AlgPart): boolean {\n  if (!(\"type\" in a)) {\n    return false;\n  }\n  return !matchesAlgType(a, \"sequence\");\n}\n\nexport function assertIsUnit(a: AlgPart): Unit {\n  if (!(\"type\" in a)) {\n    reportTypeMismatch(`Expected \"unit\", saw a value that was not an AlgPart.`);\n  }\n  if (matchesAlgType(a, \"sequence\")) {\n    reportTypeMismatch(`Expected unit, saw \"sequence\".`);\n  }\n  return a;\n}\n\nexport abstract class Unit extends AlgPart {}\n\nexport abstract class Move extends Unit {}\nexport abstract class Annotation extends Unit {}\nexport abstract class Container extends Unit {}\n\n// TODO: Reintroduce an Algorithm class, and allow a mutable sequence too?\nexport class Sequence extends AlgPart {\n  public type: string = \"sequence\";\n  constructor(public nestedUnits: Unit[]) {\n    super();\n    for (const n of nestedUnits) {\n      assertIsUnit(n);\n    }\n    Object.freeze(this.nestedUnits);\n    Object.freeze(this);\n  }\n}\n\nexport interface WithAmount {\n  // TODO: Allow `amount` to be `undefined`, to distinguish between R and R1?\n  amount: number;\n}\nexport class Group extends Container implements WithAmount {\n  public type: string = \"group\";\n  constructor(public nestedSequence: Sequence, public amount: number = 1) {\n    super();\n    Object.freeze(this);\n  }\n}\nexport class Commutator extends Container implements WithAmount {\n  public type: string = \"commutator\";\n  constructor(\n    public A: Sequence,\n    public B: Sequence,\n    public amount: number = 1,\n  ) {\n    super();\n    Object.freeze(this);\n  }\n}\nexport class Conjugate extends Container implements WithAmount {\n  public type: string = \"conjugate\";\n  constructor(\n    public A: Sequence,\n    public B: Sequence,\n    public amount: number = 1,\n  ) {\n    super();\n    Object.freeze(this);\n  }\n}\nexport class Pause extends Move {\n  public type: string = \"pause\";\n  constructor() {\n    super();\n    Object.freeze(this);\n  }\n}\nexport class NewLine extends Annotation {\n  public type: string = \"newLine\";\n  constructor() {\n    super();\n    Object.freeze(this);\n  }\n}\n\n// TODO: must be followed by a newline, unless at the end of an alg?\nexport class Comment extends Annotation {\n  public type: string = \"comment\";\n  constructor(public comment: string) {\n    super();\n    Object.freeze(this);\n  }\n}\n\n// TODO\n// export class TimeStamp extends AlgPart implements AlgPart\n", "import { Move } from \"./alg-part\";\n\nexport type MoveFamily = string; // TODO: Convert to an enum with string mappings.\n\n// TODO: Rename to `LetterMove`?\nexport class BlockMove extends Move {\n  public type: string = \"blockMove\";\n\n  // If `outerLayer` is set, `innerLayer` must also be set.\n  public outerLayer?: number;\n  public innerLayer?: number;\n  constructor(\n    outerLayer: number | undefined,\n    innerLayer: number | undefined,\n    public family: MoveFamily,\n    public amount: number = 1,\n  ) {\n    super();\n    if (innerLayer) {\n      this.innerLayer = innerLayer;\n      if (outerLayer) {\n        this.outerLayer = outerLayer;\n      }\n    }\n    if (outerLayer && !innerLayer) {\n      throw new Error(\n        \"Attempted to contruct block move with outer layer but no inner layer\",\n      );\n    }\n    Object.freeze(this);\n  }\n}\n\nexport function BareBlockMove(family: MoveFamily, amount?: number): BlockMove {\n  return new BlockMove(undefined, undefined, family, amount);\n}\n\nexport function LayerBlockMove(\n  innerLayer: number,\n  family: MoveFamily,\n  amount?: number,\n): BlockMove {\n  return new BlockMove(undefined, innerLayer, family, amount);\n}\n\nexport function RangeBlockMove(\n  outerLayer: number,\n  innerLayer: number,\n  family: MoveFamily,\n  amount?: number,\n): BlockMove {\n  return new BlockMove(outerLayer, innerLayer, family, amount);\n}\n", "import { BlockMove, Sequence } from \"./algorithm\";\n\nfunction canCoalesce(m1: BlockMove, m2: BlockMove): boolean {\n  return (\n    m1.family === m2.family &&\n    m1.innerLayer === m2.innerLayer &&\n    m1.outerLayer === m2.outerLayer\n  );\n}\n\ninterface BlockMoveModifications {\n  outerLayer?: number;\n  innerLayer?: number;\n  family?: string;\n  amount?: number;\n}\n\nexport function modifiedBlockMove(\n  original: BlockMove,\n  modifications: BlockMoveModifications,\n): BlockMove {\n  // TODO: use the nullish coalescing operator once it becomes available to us.\n  return new BlockMove(\n    modifications.outerLayer ?? original.outerLayer,\n    modifications.innerLayer ?? original.innerLayer,\n    modifications.family ?? original.family,\n    modifications.amount ?? original.amount,\n  );\n}\n\nexport function experimentalAppendBlockMove(\n  s: Sequence,\n  newMove: BlockMove,\n  coalesceLastMove: boolean = false,\n  mod: number = 0,\n): Sequence {\n  const oldNestedUnits = s.nestedUnits;\n  const oldLastMove = oldNestedUnits[\n    oldNestedUnits.length - 1\n  ] as BlockMove | null;\n  if (coalesceLastMove && oldLastMove && canCoalesce(oldLastMove, newMove)) {\n    const newNestedUnits = s.nestedUnits.slice(0, oldNestedUnits.length - 1);\n    let newAmount = oldLastMove.amount + newMove.amount;\n    if (mod > 1) {\n      newAmount = ((newAmount % mod) + mod) % mod;\n      if (newAmount * 2 > mod) {\n        newAmount -= mod;\n      }\n    }\n    if (newAmount !== 0) {\n      newNestedUnits.push(\n        modifiedBlockMove(oldLastMove, { amount: newAmount }),\n      );\n    }\n    return new Sequence(newNestedUnits);\n  } else {\n    return new Sequence([...oldNestedUnits, newMove]);\n  }\n}\n\n// This purposely takes sequences as individual arguments, instead of a lsit of sequences, because:\n//\n// 1. This matches Javascript's built-in `Array.concat()` functionality.\n// 2. It encourages avoiding lists of sequences (which might lead to coding mistakes).\n//\n// TODO: Now useful is it to coalesce at alg boundaries (rather than coalescing the whole result)?\n// Should that be a separate function, or should we change this to accept coalescing option arg like `experimentalAppendBlockMove()`?\nexport function experimentalConcatAlgs(...args: Sequence[]): Sequence {\n  return new Sequence(\n    Array.prototype.concat.apply(\n      [],\n      [...args].map((s) => s.nestedUnits),\n    ),\n  );\n}\n", "import {\n  assertIsUnit,\n  assertMatchesType,\n  isUnit,\n  matchesAlgType,\n} from \"./algorithm/alg-part\";\n\nimport {\n  AlgPart,\n  BlockMove,\n  Comment,\n  Commutator,\n  Conjugate,\n  Group,\n  NewLine,\n  Pause,\n  Sequence,\n  Unit,\n  WithAmount,\n} from \"./algorithm\";\n\nfunction dispatch<DataDown, DataUp>(\n  t: TraversalDownUp<DataDown, DataUp>,\n  algPart: AlgPart,\n  dataDown: DataDown,\n): DataUp {\n  switch (algPart.type) {\n    case \"sequence\":\n      assertMatchesType(algPart, \"sequence\");\n      return t.traverseSequence(algPart as Sequence, dataDown);\n    case \"group\":\n      assertMatchesType(algPart, \"group\");\n      return t.traverseGroup(algPart as Group, dataDown);\n    case \"blockMove\":\n      assertMatchesType(algPart, \"blockMove\");\n      return t.traverseBlockMove(algPart as BlockMove, dataDown);\n    case \"commutator\":\n      assertMatchesType(algPart, \"commutator\");\n      return t.traverseCommutator(algPart as Commutator, dataDown);\n    case \"conjugate\":\n      assertMatchesType(algPart, \"conjugate\");\n      return t.traverseConjugate(algPart as Conjugate, dataDown);\n    case \"pause\":\n      assertMatchesType(algPart, \"pause\");\n      return t.traversePause(algPart as Pause, dataDown);\n    case \"newLine\":\n      assertMatchesType(algPart, \"newLine\");\n      return t.traverseNewLine(algPart as NewLine, dataDown);\n    case \"comment\":\n      assertMatchesType(algPart, \"comment\");\n      return t.traverseComment(algPart as Comment, dataDown);\n    default:\n      throw new Error(`Unknown AlgPart type: ${algPart.type}`);\n  }\n}\n\nexport abstract class TraversalDownUp<DataDown, DataUp> {\n  // Immediate subclasses should overwrite this.\n  public traverse(algPart: AlgPart, dataDown: DataDown): DataUp {\n    return dispatch(this, algPart, dataDown);\n  }\n\n  public traverseIntoUnit(algPart: AlgPart, dataDown: DataDown): Unit {\n    return assertIsUnit(this.traverse(algPart, dataDown) as any);\n  }\n\n  public abstract traverseSequence(\n    sequence: Sequence,\n    dataDown: DataDown,\n  ): DataUp;\n\n  public abstract traverseGroup(group: Group, dataDown: DataDown): DataUp;\n  public abstract traverseBlockMove(\n    blockMove: BlockMove,\n    dataDown: DataDown,\n  ): DataUp;\n\n  public abstract traverseCommutator(\n    commutator: Commutator,\n    dataDown: DataDown,\n  ): DataUp;\n\n  public abstract traverseConjugate(\n    conjugate: Conjugate,\n    dataDown: DataDown,\n  ): DataUp;\n\n  public abstract traversePause(pause: Pause, dataDown: DataDown): DataUp;\n  public abstract traverseNewLine(newLine: NewLine, dataDown: DataDown): DataUp;\n  public abstract traverseComment(comment: Comment, dataDown: DataDown): DataUp;\n}\n\nexport abstract class TraversalUp<DataUp> extends TraversalDownUp<\n  undefined,\n  DataUp\n> {\n  public traverse(algPart: AlgPart): DataUp {\n    return dispatch<undefined, DataUp>(this, algPart, undefined);\n  }\n\n  public traverseIntoUnit(algPart: AlgPart): Unit {\n    return assertIsUnit(this.traverse(algPart) as any);\n  }\n\n  public abstract traverseSequence(sequence: Sequence): DataUp;\n  public abstract traverseGroup(group: Group): DataUp;\n  public abstract traverseBlockMove(blockMove: BlockMove): DataUp;\n  public abstract traverseCommutator(commutator: Commutator): DataUp;\n  public abstract traverseConjugate(conjugate: Conjugate): DataUp;\n  public abstract traversePause(pause: Pause): DataUp;\n  public abstract traverseNewLine(newLine: NewLine): DataUp;\n  public abstract traverseComment(comment: Comment): DataUp;\n}\n\n// TODO: Test that inverses are bijections.\nexport class Invert extends TraversalUp<AlgPart> {\n  public traverseSequence(sequence: Sequence): Sequence {\n    // TODO: Handle newLines and comments correctly\n    return new Sequence(\n      sequence.nestedUnits.map((a) => this.traverseIntoUnit(a)).reverse(),\n    );\n  }\n\n  public traverseGroup(group: Group): AlgPart {\n    return new Group(this.traverseSequence(group.nestedSequence), group.amount);\n  }\n\n  public traverseBlockMove(blockMove: BlockMove): AlgPart {\n    return new BlockMove(\n      blockMove.outerLayer,\n      blockMove.innerLayer,\n      blockMove.family,\n      -blockMove.amount,\n    );\n  }\n\n  public traverseCommutator(commutator: Commutator): AlgPart {\n    return new Commutator(commutator.B, commutator.A, commutator.amount);\n  }\n\n  public traverseConjugate(conjugate: Conjugate): AlgPart {\n    return new Conjugate(\n      conjugate.A,\n      this.traverseSequence(conjugate.B),\n      conjugate.amount,\n    );\n  }\n\n  public traversePause(pause: Pause): AlgPart {\n    return pause;\n  }\n\n  public traverseNewLine(newLine: NewLine): AlgPart {\n    return newLine;\n  }\n\n  public traverseComment(comment: Comment): AlgPart {\n    return comment;\n  }\n}\n\nexport class Expand extends TraversalUp<AlgPart> {\n  public traverseSequence(sequence: Sequence): Sequence {\n    return new Sequence(\n      this.flattenSequenceOneLevel(\n        sequence.nestedUnits.map((a) => this.traverse(a)),\n      ),\n    );\n  }\n\n  public traverseGroup(group: Group): AlgPart {\n    // TODO: Pass raw AlgPart[] to sequence.\n    return this.repeat(\n      this.flattenSequenceOneLevel([this.traverse(group.nestedSequence)]),\n      group,\n    );\n  }\n\n  public traverseBlockMove(blockMove: BlockMove): AlgPart {\n    return blockMove;\n  }\n\n  public traverseCommutator(commutator: Commutator): AlgPart {\n    const expandedA = this.traverseSequence(commutator.A);\n    const expandedB = this.traverseSequence(commutator.B);\n    let once: AlgPart[] = [];\n    once = once.concat(\n      expandedA,\n      expandedB,\n      invert(expandedA),\n      invert(expandedB),\n    );\n    return this.repeat(this.flattenSequenceOneLevel(once), commutator);\n  }\n\n  public traverseConjugate(conjugate: Conjugate): AlgPart {\n    const expandedA = this.traverseSequence(conjugate.A);\n    const expandedB = this.traverseSequence(conjugate.B);\n    let once: AlgPart[] = [];\n    once = once.concat(expandedA, expandedB, invert(expandedA));\n    return this.repeat(this.flattenSequenceOneLevel(once), conjugate);\n  }\n\n  public traversePause(pause: Pause): AlgPart {\n    return pause;\n  }\n\n  public traverseNewLine(newLine: NewLine): AlgPart {\n    return newLine;\n  }\n\n  public traverseComment(comment: Comment): AlgPart {\n    return comment;\n  }\n\n  private flattenSequenceOneLevel(algList: AlgPart[]): Unit[] {\n    let flattened: Unit[] = [];\n    for (const part of algList) {\n      if (matchesAlgType(part, \"sequence\")) {\n        flattened = flattened.concat((part as Sequence).nestedUnits);\n      } else if (isUnit(part)) {\n        flattened.push(part);\n      } else {\n        throw new Error(\n          \"expand() encountered an internal error. Did you pass in a valid Algorithm?\",\n        );\n      }\n    }\n    return flattened;\n  }\n\n  private repeat(algList: Unit[], accordingTo: WithAmount): Sequence {\n    const amount = Math.abs(accordingTo.amount);\n    const amountDir = accordingTo.amount > 0 ? 1 : -1; // Mutable\n\n    // TODO: Cleaner inversion\n    let once: Unit[];\n    if (amountDir === -1) {\n      // TODO: Avoid casting to sequence.\n      once = (invert(new Sequence(algList)) as Sequence).nestedUnits;\n    } else {\n      once = algList;\n    }\n\n    let repeated: Unit[] = [];\n    for (let i = 0; i < amount; i++) {\n      repeated = repeated.concat(once);\n    }\n\n    return new Sequence(repeated);\n  }\n}\n\nexport class StructureEquals extends TraversalDownUp<AlgPart, boolean> {\n  public traverseSequence(sequence: Sequence, dataDown: AlgPart): boolean {\n    if (isUnit(dataDown)) {\n      return false;\n    }\n    const dataDownSeq = dataDown as Sequence;\n    if (sequence.nestedUnits.length !== dataDownSeq.nestedUnits.length) {\n      return false;\n    }\n    for (let i = 0; i < sequence.nestedUnits.length; i++) {\n      if (!this.traverse(sequence.nestedUnits[i], dataDownSeq.nestedUnits[i])) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  public traverseGroup(group: Group, dataDown: AlgPart): boolean {\n    return (\n      matchesAlgType(dataDown, \"group\") &&\n      this.traverse(group.nestedSequence, (dataDown as Group).nestedSequence)\n    );\n  }\n\n  public traverseBlockMove(blockMove: BlockMove, dataDown: AlgPart): boolean {\n    // TODO: Handle layers.\n    return (\n      matchesAlgType(dataDown, \"blockMove\") &&\n      blockMove.outerLayer === (dataDown as BlockMove).outerLayer &&\n      blockMove.innerLayer === (dataDown as BlockMove).innerLayer &&\n      blockMove.family === (dataDown as BlockMove).family &&\n      blockMove.amount === (dataDown as BlockMove).amount\n    );\n  }\n\n  public traverseCommutator(\n    commutator: Commutator,\n    dataDown: AlgPart,\n  ): boolean {\n    return (\n      matchesAlgType(dataDown, \"commutator\") &&\n      this.traverse(commutator.A, (dataDown as Commutator).A) &&\n      this.traverse(commutator.B, (dataDown as Commutator).B)\n    );\n  }\n\n  public traverseConjugate(conjugate: Conjugate, dataDown: AlgPart): boolean {\n    return (\n      matchesAlgType(dataDown, \"conjugate\") &&\n      this.traverse(conjugate.A, (dataDown as Conjugate).A) &&\n      this.traverse(conjugate.B, (dataDown as Conjugate).B)\n    );\n  }\n\n  public traversePause(_pause: Pause, dataDown: AlgPart): boolean {\n    return matchesAlgType(dataDown, \"pause\");\n  }\n\n  public traverseNewLine(_newLine: NewLine, dataDown: AlgPart): boolean {\n    return matchesAlgType(dataDown, \"newLine\");\n  }\n\n  public traverseComment(comment: Comment, dataDown: AlgPart): boolean {\n    return (\n      matchesAlgType(dataDown, \"comment\") &&\n      comment.comment === (dataDown as Comment).comment\n    );\n  }\n}\n\n// TODO: Test that inverses are bijections.\nexport class CoalesceBaseMoves extends TraversalUp<AlgPart> {\n  // TODO: Handle\n  public traverseSequence(sequence: Sequence): Sequence {\n    const coalesced: Unit[] = [];\n    for (const part of sequence.nestedUnits) {\n      if (!matchesAlgType(part, \"blockMove\")) {\n        coalesced.push(this.traverseIntoUnit(part));\n      } else if (coalesced.length > 0) {\n        const last = coalesced[coalesced.length - 1];\n        if (\n          matchesAlgType(last, \"blockMove\") &&\n          this.sameBlock(last as BlockMove, part as BlockMove)\n        ) {\n          // TODO: This is cube-specific. Perhaps pass the modules as DataDown?\n          const amount =\n            (last as BlockMove).amount + (part as BlockMove).amount;\n          coalesced.pop();\n          if (amount !== 0) {\n            // We could modify the last element instead of creating a new one,\n            // but this is safe against shifting coding practices.\n            // TODO: Figure out if the shoot-in-the-foot risk\n            // modification is worth the speed.\n            coalesced.push(\n              new BlockMove(\n                (part as BlockMove).outerLayer,\n                (part as BlockMove).innerLayer,\n                (part as BlockMove).family,\n                amount,\n              ),\n            );\n          }\n        } else {\n          coalesced.push(part);\n        }\n      } else {\n        coalesced.push(part);\n      }\n    }\n    return new Sequence(coalesced);\n  }\n\n  public traverseGroup(group: Group): AlgPart {\n    return group;\n  }\n\n  public traverseBlockMove(blockMove: BlockMove): AlgPart {\n    return blockMove;\n  }\n\n  public traverseCommutator(commutator: Commutator): AlgPart {\n    return commutator;\n  }\n\n  public traverseConjugate(conjugate: Conjugate): AlgPart {\n    return conjugate;\n  }\n\n  public traversePause(pause: Pause): AlgPart {\n    return pause;\n  }\n\n  public traverseNewLine(newLine: NewLine): AlgPart {\n    return newLine;\n  }\n\n  public traverseComment(comment: Comment): AlgPart {\n    return comment;\n  }\n\n  private sameBlock(moveA: BlockMove, moveB: BlockMove): boolean {\n    // TODO: Handle layers\n    return (\n      moveA.outerLayer === moveB.outerLayer &&\n      moveA.innerLayer === moveB.innerLayer &&\n      moveA.family === moveB.family\n    );\n  }\n}\n\n// export class Concat extends TraversalDownUp<Algorithm, Sequence> {\n//   private concatIntoSequence(A: Unit[], B: Algorithm): Sequence {\n//     var nestedAlgs: Unit[] = A.slice();\n//     if (matchesAlgType(B, \"sequence\")) {\n//       nestedAlgs = nestedAlgs.concat((B as unknown as Sequence).nestedUnits)\n//     } else {\n//       nestedAlgs.push(B as unknown as Unit);\n//     }\n//     return new Sequence(nestedAlgs)\n//   }\n//   public traverseSequence(     sequence:     Sequence,     dataDown: Algorithm): Sequence {return this.concatIntoSequence(sequence.nestedUnits, dataDown); }\n//   public traverseGroup(        group:        Group,        dataDown: Algorithm): Sequence {return this.concatIntoSequence([group]          , dataDown); }\n//   public traverseBlockMove(    BlockMove:    BlockMove,    dataDown: Algorithm): Sequence {return this.concatIntoSequence([BlockMove]      , dataDown); }\n//   public traverseCommutator(   commutator:   Commutator,   dataDown: Algorithm): Sequence {return this.concatIntoSequence([commutator]     , dataDown); }\n//   public traverseConjugate(    conjugate:    Conjugate,    dataDown: Algorithm): Sequence {return this.concatIntoSequence([conjugate]      , dataDown); }\n//   public traversePause(        pause:        Pause,        dataDown: Algorithm): Sequence {return this.concatIntoSequence([pause]          , dataDown); }\n//   public traverseNewLine(      newLine:      NewLine,      dataDown: Algorithm): Sequence {return this.concatIntoSequence([newLine]        , dataDown); }\n//   public traverseComment( comment: Comment, dataDown: Algorithm): Sequence {return this.concatIntoSequence([comment]   , dataDown); }\n// }\n\nfunction repetitionSuffix(amount: number): string {\n  const absAmount = Math.abs(amount);\n  let s = \"\";\n  if (absAmount !== 1) {\n    s += String(absAmount);\n  }\n  if (absAmount !== amount) {\n    s += \"'\";\n  }\n  return s;\n}\nexport function blockMoveToString(blockMove: BlockMove): string {\n  let out = blockMove.family + repetitionSuffix(blockMove.amount);\n  if (typeof blockMove.innerLayer !== \"undefined\") {\n    out = String(blockMove.innerLayer) + out;\n    if (typeof blockMove.outerLayer !== \"undefined\") {\n      out = String(blockMove.outerLayer) + \"-\" + out;\n    }\n  }\n  return out;\n}\n\nexport class ToString extends TraversalUp<string> {\n  public traverseSequence(sequence: Sequence): string {\n    let output = \"\";\n    if (sequence.nestedUnits.length > 0) {\n      output += this.traverse(sequence.nestedUnits[0]);\n      for (let i = 1; i < sequence.nestedUnits.length; i++) {\n        output += this.spaceBetween(\n          sequence.nestedUnits[i - 1],\n          sequence.nestedUnits[i],\n        );\n        output += this.traverse(sequence.nestedUnits[i]);\n      }\n    }\n    return output;\n  }\n\n  public traverseGroup(group: Group): string {\n    return (\n      \"(\" +\n      this.traverse(group.nestedSequence) +\n      \")\" +\n      repetitionSuffix(group.amount)\n    );\n  }\n\n  public traverseBlockMove(blockMove: BlockMove): string {\n    return blockMoveToString(blockMove);\n  }\n\n  public traverseCommutator(commutator: Commutator): string {\n    return (\n      \"[\" +\n      this.traverse(commutator.A) +\n      \", \" +\n      this.traverse(commutator.B) +\n      \"]\" +\n      repetitionSuffix(commutator.amount)\n    );\n  }\n\n  public traverseConjugate(conjugate: Conjugate): string {\n    return (\n      \"[\" +\n      this.traverse(conjugate.A) +\n      \": \" +\n      this.traverse(conjugate.B) +\n      \"]\" +\n      repetitionSuffix(conjugate.amount)\n    );\n  }\n\n  // TODO: Remove spaces between repeated pauses (in traverseSequence)\n  public traversePause(_pause: Pause): string {\n    return \".\";\n  }\n\n  public traverseNewLine(_newLine: NewLine): string {\n    return \"\\n\";\n  }\n\n  // TODO: Enforce being followed by a newline (or the end of the alg)?\n  public traverseComment(comment: Comment): string {\n    return \"//\" + comment.comment;\n  }\n\n  // TODO: Sanitize `*/`\n  private spaceBetween(u1: Unit, u2: Unit): string {\n    if (matchesAlgType(u1, \"pause\") && matchesAlgType(u2, \"pause\")) {\n      return \"\";\n    }\n    if (matchesAlgType(u1, \"newLine\") || matchesAlgType(u2, \"newLine\")) {\n      return \"\";\n    }\n    if (matchesAlgType(u1, \"comment\") && !matchesAlgType(u2, \"newLine\")) {\n      return \"\\n\";\n    }\n    return \" \";\n  }\n}\n\nconst invertInstance = new Invert();\nconst expandInstance = new Expand();\nconst structureEqualsInstance = new StructureEquals();\nconst coalesceBaseMovesInstance = new CoalesceBaseMoves();\nconst algToStringInstance = new ToString();\n\nexport const invert = invertInstance.traverseSequence.bind(invertInstance) as (\n  a: Sequence,\n) => Sequence;\nexport const expand = expandInstance.traverseSequence.bind(expandInstance) as (\n  a: Sequence,\n) => Sequence;\nexport const structureEquals = structureEqualsInstance.traverseSequence.bind(\n  structureEqualsInstance,\n) as (a1: Sequence, a2: Sequence) => boolean;\nexport const coalesceBaseMoves = coalesceBaseMovesInstance.traverseSequence.bind(\n  coalesceBaseMovesInstance,\n) as (a: Sequence) => Sequence;\nexport const algToString = algToStringInstance.traverseSequence.bind(\n  algToStringInstance,\n) as (a: Sequence) => string;\n\nexport const algPartStructureEqualsForTesting = algToStringInstance.traverse.bind(\n  algToStringInstance,\n) as (a1: AlgPart, a2: AlgPart) => boolean;\nexport const algPartToStringForTesting = algToStringInstance.traverse.bind(\n  algToStringInstance,\n) as (a: AlgPart) => string;\n\nexport function experimentalBlockMoveQuantumName(move: BlockMove): string {\n  return algPartToStringForTesting(\n    new BlockMove(move.outerLayer, move.innerLayer, move.family, 1),\n  );\n}\n", "import {\n  BareBlockMove,\n  Comment,\n  Commutator,\n  Conjugate,\n  Group,\n  NewLine,\n  Pause,\n  Sequence,\n} from \"./algorithm\";\n\n// tslint:disable-next-line no-namespace // TODO: nested module\n// eslint-disable-next-line @typescript-eslint/no-namespace\nexport const Example = {\n  Sune: new Sequence([\n    BareBlockMove(\"R\", 1),\n    BareBlockMove(\"U\", 1),\n    BareBlockMove(\"R\", -1),\n    BareBlockMove(\"U\", 1),\n    BareBlockMove(\"R\", 1),\n    BareBlockMove(\"U\", -2),\n    BareBlockMove(\"R\", -1),\n  ]),\n\n  AntiSune: new Sequence([\n    BareBlockMove(\"R\", 1),\n    BareBlockMove(\"U\", 2),\n    BareBlockMove(\"R\", -1),\n    BareBlockMove(\"U\", -1),\n    BareBlockMove(\"R\", 1),\n    BareBlockMove(\"U\", -1),\n    BareBlockMove(\"R\", -1),\n  ]),\n\n  SuneCommutator: new Sequence([\n    new Commutator(\n      new Sequence([\n        BareBlockMove(\"R\", 1),\n        BareBlockMove(\"U\", 1),\n        BareBlockMove(\"R\", -2),\n      ]),\n      new Sequence([\n        new Conjugate(\n          new Sequence([BareBlockMove(\"R\", 1)]),\n          new Sequence([BareBlockMove(\"U\", 1)]),\n          1,\n        ),\n      ]),\n      1,\n    ),\n  ]),\n\n  Niklas: new Sequence([\n    BareBlockMove(\"R\", 1),\n    BareBlockMove(\"U\", -1),\n    BareBlockMove(\"L\", -1),\n    BareBlockMove(\"U\", 1),\n    BareBlockMove(\"R\", -1),\n    BareBlockMove(\"U\", -1),\n    BareBlockMove(\"L\", 1),\n    BareBlockMove(\"U\", 1),\n  ]),\n\n  EPerm: new Sequence([\n    BareBlockMove(\"x\", -1),\n    new Commutator(\n      new Sequence([\n        new Conjugate(\n          new Sequence([BareBlockMove(\"R\", 1)]),\n          new Sequence([BareBlockMove(\"U\", -1)]),\n        ),\n      ]),\n      new Sequence([BareBlockMove(\"D\", 1)]),\n      1,\n    ),\n    new Commutator(\n      new Sequence([\n        new Conjugate(\n          new Sequence([BareBlockMove(\"R\", 1)]),\n          new Sequence([BareBlockMove(\"U\", 1)]),\n        ),\n      ]),\n      new Sequence([BareBlockMove(\"D\", 1)]),\n      1,\n    ),\n    BareBlockMove(\"x\", 1),\n  ]),\n\n  FURURFCompact: new Sequence([\n    new Conjugate(\n      new Sequence([BareBlockMove(\"F\", 1)]),\n      new Sequence([\n        new Commutator(\n          new Sequence([BareBlockMove(\"U\", 1)]),\n          new Sequence([BareBlockMove(\"R\", 1)]),\n          1,\n        ),\n      ]),\n      1,\n    ),\n  ]),\n\n  APermCompact: new Sequence([\n    new Conjugate(\n      new Sequence([BareBlockMove(\"R\", 2)]),\n      new Sequence([\n        new Commutator(\n          new Sequence([BareBlockMove(\"F\", 2)]),\n          new Sequence([\n            BareBlockMove(\"R\", -1),\n            BareBlockMove(\"B\", -1),\n            BareBlockMove(\"R\", 1),\n          ]),\n          1,\n        ),\n      ]),\n      1,\n    ),\n  ]),\n\n  FURURFMoves: new Sequence([\n    BareBlockMove(\"F\", 1),\n    BareBlockMove(\"U\", 1),\n    BareBlockMove(\"R\", 1),\n    BareBlockMove(\"U\", -1),\n    BareBlockMove(\"R\", -1),\n    BareBlockMove(\"F\", -1),\n  ]),\n\n  TPerm: new Sequence([\n    BareBlockMove(\"R\", 1),\n    BareBlockMove(\"U\", 1),\n    BareBlockMove(\"R\", -1),\n    BareBlockMove(\"U\", -1),\n    BareBlockMove(\"R\", -1),\n    BareBlockMove(\"F\", 1),\n    BareBlockMove(\"R\", 2),\n    BareBlockMove(\"U\", -1),\n    BareBlockMove(\"R\", -1),\n    BareBlockMove(\"U\", -1),\n    BareBlockMove(\"R\", 1),\n    BareBlockMove(\"U\", 1),\n    BareBlockMove(\"R\", -1),\n    BareBlockMove(\"F\", -1),\n  ]),\n\n  HeadlightSwaps: new Sequence([\n    new Conjugate(\n      new Sequence([BareBlockMove(\"F\", 1)]),\n      new Sequence([\n        new Commutator(\n          new Sequence([BareBlockMove(\"R\", 1)]),\n          new Sequence([BareBlockMove(\"U\", 1)]),\n          3,\n        ),\n      ]),\n      1,\n    ),\n  ]),\n\n  TriplePause: new Sequence([new Pause(), new Pause(), new Pause()]),\n\n  AllAlgParts: [\n    new Sequence([BareBlockMove(\"R\", 1), BareBlockMove(\"U\", -1)]),\n    new Group(new Sequence([BareBlockMove(\"F\", 1)]), 2),\n    // new Rotation(\"y\", -1),\n    BareBlockMove(\"R\", 2),\n    new Commutator(\n      new Sequence([BareBlockMove(\"R\", 2)]),\n      new Sequence([BareBlockMove(\"U\", 2)]),\n      2,\n    ),\n    new Conjugate(\n      new Sequence([BareBlockMove(\"L\", 2)]),\n      new Sequence([BareBlockMove(\"D\", -1)]),\n      2,\n    ),\n    new Pause(),\n    new NewLine(),\n    new Comment(\"short comment\"),\n  ],\n};\n", "import {\n  BlockMove,\n  Comment,\n  Commutator,\n  Conjugate,\n  Group,\n  NewLine,\n  Pause,\n  Sequence,\n  Unit,\n} from \"./algorithm\";\n\n// TODO: Turn this into a union.\nexport interface AlgJSON {\n  type: string;\n  nestedSequence?: AlgJSON;\n  nestedUnits?: AlgJSON[];\n  innerLayer?: number;\n  outerLayer?: number;\n  family?: string;\n  amount?: number;\n  A?: AlgJSON;\n  B?: AlgJSON;\n  comment?: string;\n}\n\nexport function fromJSON(json: AlgJSON): Sequence {\n  if (json.type !== \"sequence\") {\n    throw new Error(`Expected Sequence while parsing, got: ${json.type}`);\n  }\n  if (!json.nestedUnits) {\n    throw new Error(\"Missing nestedUnits\");\n  }\n  return new Sequence(json.nestedUnits.map((j) => unitFromJSON(j)));\n}\n\nfunction unitFromJSON(json: AlgJSON): Unit {\n  switch (json.type) {\n    case \"sequence\":\n      throw new Error(`Expected AlgPart while parsing, got \\`Sequence\\`.`);\n    case \"group\":\n      if (!json.nestedSequence) {\n        throw new Error(\"Missing nestedSequence\");\n      }\n      if (!json.amount) {\n        throw new Error(\"Missing amount\");\n      }\n      return new Group(fromJSON(json.nestedSequence), json.amount);\n    case \"blockMove\":\n      // TODO: Double-check that there is no outer layer without an inner layer?\n      if (!json.family) {\n        throw new Error(\"Missing family\");\n      }\n      if (!json.amount) {\n        throw new Error(\"Missing amount\");\n      }\n      return new BlockMove(\n        json.outerLayer,\n        json.innerLayer,\n        json.family,\n        json.amount,\n      );\n    case \"commutator\":\n      if (!json.A) {\n        throw new Error(\"Missing A\");\n      }\n      if (!json.B) {\n        throw new Error(\"Missing B\");\n      }\n      if (!json.amount) {\n        throw new Error(\"Missing amount\");\n      }\n      return new Commutator(fromJSON(json.A), fromJSON(json.B), json.amount);\n    case \"conjugate\":\n      if (!json.A) {\n        throw new Error(\"Missing A\");\n      }\n      if (!json.B) {\n        throw new Error(\"Missing B\");\n      }\n      if (!json.amount) {\n        throw new Error(\"Missing amount\");\n      }\n      return new Conjugate(fromJSON(json.A), fromJSON(json.B), json.amount);\n    case \"pause\":\n      return new Pause();\n    case \"newLine\":\n      return new NewLine();\n    case \"comment\":\n      // The empty string is nullish, so we check for it separately.\n      if (!json.comment && json.comment !== \"\") {\n        throw new Error(\"Missing comment\");\n      }\n      return new Comment(json.comment);\n    default:\n      throw new Error(`Unknown alg type: ${json.type}`);\n  }\n}\n", "import {\n  BlockMove,\n  Comment,\n  Commutator,\n  Conjugate,\n  Group,\n  NewLine,\n  Pause,\n  Sequence,\n} from \"./algorithm\";\n\nimport { TraversalUp } from \"./traversal\";\n\nexport class ValidationError extends Error {}\n\nexport abstract class ValidatorTraversal extends TraversalUp<void> {}\n\ninterface FamilyList {\n  [s: string]: boolean;\n}\n\nfunction validateFamily(\n  family: string,\n  allowedFamilyLists: FamilyList[],\n): boolean {\n  for (const list of allowedFamilyLists) {\n    if (list[family] === true) {\n      return true;\n    }\n  }\n  return false;\n}\n\n// TODO: Switch to `Set`?\nconst plainMoveFamilies: FamilyList = {\n  x: true,\n  y: true,\n  z: true,\n  M: true,\n  E: true,\n  S: true,\n  m: true,\n  e: true,\n  s: true,\n};\n\nconst singleSliceMoveFamilies: FamilyList = {\n  U: true,\n  L: true,\n  F: true,\n  R: true,\n  B: true,\n  D: true,\n};\n\nconst wideMoveFamilies: FamilyList = {\n  u: true,\n  l: true,\n  f: true,\n  r: true,\n  b: true,\n  d: true,\n  Uw: true,\n  Lw: true,\n  Fw: true,\n  Rw: true,\n  Bw: true,\n  Dw: true,\n};\n\nabstract class BaseMoveValidator extends ValidatorTraversal {\n  public traverseSequence(sequence: Sequence): void {\n    // TODO: Handle newLines and comments correctly\n    for (const unit of sequence.nestedUnits) {\n      this.traverse(unit);\n    }\n  }\n\n  public traverseGroup(group: Group): void {\n    return this.traverse(group.nestedSequence);\n  }\n\n  public traverseCommutator(commutator: Commutator): void {\n    this.traverse(commutator.A);\n    this.traverse(commutator.B);\n  }\n\n  public traverseConjugate(conjugate: Conjugate): void {\n    this.traverse(conjugate.A);\n    this.traverse(conjugate.B);\n  }\n\n  public traversePause(_pause: Pause): void {\n    return;\n  }\n\n  public traverseNewLine(_newLine: NewLine): void {\n    return;\n  }\n\n  public traverseComment(_comment: Comment): void {\n    return;\n  }\n}\n\n// TODO: Export function instead?\nexport class BlockMoveValidator extends BaseMoveValidator {\n  public traverseBlockMove(blockMove: BlockMove): void {\n    if (typeof blockMove.outerLayer !== \"undefined\") {\n      if (typeof blockMove.innerLayer === \"undefined\") {\n        throw new ValidationError(\n          \"A BlockMove with an outer layer must have an inner layer.\",\n        );\n      }\n      if (!validateFamily(blockMove.family, [wideMoveFamilies])) {\n        throw new ValidationError(\n          `The provided SiGN move family is invalid, or cannot have an outer and inner layer: ${blockMove.family}`,\n        );\n      }\n      if (blockMove.outerLayer <= 0) {\n        throw new ValidationError(\"Cannot have an outer layer of 0 or less.\");\n      }\n      // TODO: Allow 2-2r?\n      if (blockMove.outerLayer >= blockMove.innerLayer) {\n        throw new ValidationError(\n          \"The outer layer must be less than the inner layer.\",\n        );\n      }\n      return;\n    } else if (typeof blockMove.innerLayer !== \"undefined\") {\n      if (\n        !validateFamily(blockMove.family, [\n          wideMoveFamilies,\n          singleSliceMoveFamilies,\n        ])\n      ) {\n        throw new ValidationError(\n          `The provided SiGN move family is invalid, or cannot have an inner slice: ${blockMove.family}`,\n        );\n      }\n      if (blockMove.innerLayer <= 0) {\n        throw new ValidationError(\"Cannot have an inner layer of 0 or less.\");\n      }\n      return;\n    } else {\n      if (\n        !validateFamily(blockMove.family, [\n          wideMoveFamilies,\n          singleSliceMoveFamilies,\n          plainMoveFamilies,\n        ])\n      ) {\n        throw new ValidationError(\n          `Invalid SiGN plain move family: ${blockMove.family}`,\n        );\n      }\n      return;\n    }\n  }\n}\n\n// TODO: Export function instead?\nexport class FlatAlgValidator extends ValidatorTraversal {\n  public traverseSequence(sequence: Sequence): void {\n    // TODO: Handle newLines and comments correctly\n    for (const unit of sequence.nestedUnits) {\n      this.traverse(unit);\n    }\n    return;\n  }\n\n  public traverseGroup(_group: Group): void {\n    throw new ValidationError(\"A flat alg cannot contain a group.\");\n  }\n\n  public traverseBlockMove(_blockMove: BlockMove): void {\n    return;\n  }\n\n  public traverseCommutator(_commutator: Commutator): void {\n    throw new ValidationError(\"A flat alg cannot contain a commutator.\");\n  }\n\n  public traverseConjugate(_conjugate: Conjugate): void {\n    throw new ValidationError(\"A flat alg cannot contain a conjugate.\");\n  }\n\n  public traversePause(_pause: Pause): void {\n    return;\n  }\n\n  public traverseNewLine(_newLine: NewLine): void {\n    return;\n  }\n\n  public traverseComment(_comment: Comment): void {\n    return;\n  }\n}\n\nexport type Validator = (a: Sequence) => void;\n\nconst BlockMoveValidatorInstance = new BlockMoveValidator();\nexport const validateSiGNMoves = BlockMoveValidatorInstance.traverse.bind(\n  BlockMoveValidatorInstance,\n) as Validator;\n\nconst flatAlgValidatorInstance = new FlatAlgValidator();\nexport const validateFlatAlg = flatAlgValidatorInstance.traverse.bind(\n  flatAlgValidatorInstance,\n) as Validator;\n\n// TODO: Option for puzzle size?\nexport function validateSiGNAlg(a: Sequence): void {\n  validateSiGNMoves(a);\n  validateFlatAlg(a);\n}\n", "// Workaround per https://github.com/pegjs/pegjs/pull/481\nexport { parse } from \"./parser-pegjs\";\n", "import { Sequence } from \"../algorithm\";\nimport { fromJSON } from \"../json\";\nimport { validateSiGNAlg, Validator } from \"../validation\";\nimport { parse as pegParse } from \"./parser\";\n\nexport interface ParseOptions {\n  validators?: Validator[];\n}\n\n// TODO: Include token location info.\n// TODO: Take validators in a way that allows optimizing parsing.\nexport function parse(\n  s: string,\n  options: ParseOptions = { validators: [] },\n): Sequence {\n  options.validators = options.validators || [];\n\n  const algo = fromJSON(pegParse(s));\n  for (const validate of options.validators) {\n    validate(algo);\n  }\n  return algo;\n}\n\nexport function parseSiGN(s: string): Sequence {\n  return parse(s, { validators: [validateSiGNAlg] });\n}\n", "import { BareBlockMove, BlockMove } from \"./algorithm\";\n\nconst cubeKeyMapping: { [key: number]: BlockMove } = {\n  73: BareBlockMove(\"R\"),\n  75: BareBlockMove(\"R\", -1),\n  87: BareBlockMove(\"B\"),\n  79: BareBlockMove(\"B\", -1),\n  83: BareBlockMove(\"D\"),\n  76: BareBlockMove(\"D\", -1),\n  68: BareBlockMove(\"L\"),\n  69: BareBlockMove(\"L\", -1),\n  74: BareBlockMove(\"U\"),\n  70: BareBlockMove(\"U\", -1),\n  72: BareBlockMove(\"F\"),\n  71: BareBlockMove(\"F\", -1),\n\n  78: BareBlockMove(\"x\", -1),\n  67: BareBlockMove(\"l\"),\n  82: BareBlockMove(\"l\", -1),\n  85: BareBlockMove(\"r\"),\n  77: BareBlockMove(\"r\", -1),\n\n  88: BareBlockMove(\"d\", 1),\n  188: BareBlockMove(\"d\", -1),\n\n  84: BareBlockMove(\"x\"),\n  89: BareBlockMove(\"x\"),\n  66: BareBlockMove(\"x\", -1),\n  186: BareBlockMove(\"y\"),\n  59: BareBlockMove(\"y\"),\n  65: BareBlockMove(\"y\", -1), // 186 is WebKit, 59 is Mozilla; see http://unixpapa.com/js/key.html\n  80: BareBlockMove(\"z\"),\n  81: BareBlockMove(\"z\", -1),\n\n  90: BareBlockMove(\"M\", -1),\n  190: BareBlockMove(\"M\", -1),\n};\n\n// TODO: options about whether to ignore modifier keys (e.g. alt, ctrl).\n// TODO: Support different mappings.\n// TODO: Return BaseMove instead?\nexport function keyToMove(e: KeyboardEvent): BlockMove | null {\n  if (e.altKey || e.ctrlKey) {\n    return null;\n  }\n\n  return cubeKeyMapping[e.keyCode] || null;\n}\n", "import { Sequence } from \"./algorithm\";\nimport { parse } from \"./parser\";\nimport { algToString } from \"./traversal\";\n\n// This is not the most sophisticated scheme, but it has been used in production\n// at alg.cubing.net for years.\nexport function serializeURLParam(a: Sequence): string {\n  let escaped = algToString(a);\n  escaped = escaped.replace(/_/g, \"&#95;\").replace(/ /g, \"_\");\n  escaped = escaped.replace(/\\+/g, \"&#2b;\");\n  escaped = escaped.replace(/-/g, \"&#45;\").replace(/'/g, \"-\");\n  return escaped;\n}\n\nexport function deserializeURLParam(a: string): Sequence {\n  let unescaped = a;\n  unescaped = unescaped.replace(/-/g, \"'\").replace(/&#45;/g, \"-\");\n  unescaped = unescaped.replace(/\\+/g, \" \").replace(/&#2b;/g, \"+\"); // Recognize + as space. Many URL encodings will do this.\n  unescaped = unescaped.replace(/_/g, \" \").replace(/&#95;/g, \"_\");\n  return parse(unescaped);\n}\n\n// Returns an empty sequence if the parameter is not present.\n// Throws an error if an alg is present but not valid.\nexport function getAlgURLParam(name: string): Sequence {\n  const s = new URLSearchParams(window.location.search).get(name) || \"\";\n  return deserializeURLParam(s);\n}\n\nexport interface AlgCubingNetOptions {\n  alg?: Sequence;\n  setup?: Sequence;\n  title?: string;\n  puzzle?:\n    | \"1x1x1\"\n    | \"2x2x2\"\n    | \"3x3x3\"\n    | \"4x4x4\"\n    | \"5x5x5\"\n    | \"6x6x6\"\n    | \"7x7x7\"\n    | \"8x8x8\"\n    | \"9x9x9\"\n    | \"10x10x10\"\n    | \"11x11x11\"\n    | \"12x12x12\"\n    | \"13x13x13\"\n    | \"14x14x14\"\n    | \"16x16x16\"\n    | \"17x17x17\";\n  stage?:\n    | \"full\"\n    | \"cross\"\n    | \"F2L\"\n    | \"LL\"\n    | \"OLL\"\n    | \"PLL\"\n    | \"CLS\"\n    | \"ELS\"\n    | \"L6E\"\n    | \"CMLL\"\n    | \"WV\"\n    | \"ZBLL\"\n    | \"void\";\n  view?: \"editor\" | \"playback\" | \"fullscreen\";\n  type?: \"moves\" | \"reconstruction\" | \"alg\" | \"reconstruction-end-with-setup\";\n}\n\n// TODO: runtime validation?\nexport function algCubingNetLink(options: AlgCubingNetOptions): string {\n  const url = new URL(\"https://alg.cubing.net\");\n  if (!options.alg) {\n    throw new Error(\"An alg parameter is required.\");\n  }\n  url.searchParams.set(\"alg\", serializeURLParam(options.alg));\n\n  if (options.setup) {\n    url.searchParams.set(\"setup\", serializeURLParam(options.setup));\n  }\n  if (options.title) {\n    url.searchParams.set(\"title\", options.title);\n  }\n  if (options.puzzle) {\n    if (\n      ![\n        \"1x1x1\",\n        \"2x2x2\",\n        \"3x3x3\",\n        \"4x4x4\",\n        \"5x5x5\",\n        \"6x6x6\",\n        \"7x7x7\",\n        \"8x8x8\",\n        \"9x9x9\",\n        \"10x10x10\",\n        \"11x11x11\",\n        \"12x12x12\",\n        \"13x13x13\",\n        \"14x14x14\",\n        \"16x16x16\",\n        \"17x17x17\",\n      ].includes(options.puzzle)\n    ) {\n      throw new Error(`Invalid puzzle parameter: ${options.puzzle}`);\n    }\n    url.searchParams.set(\"puzzle\", options.puzzle);\n  }\n  if (options.stage) {\n    if (\n      ![\n        \"full\",\n        \"cross\",\n        \"F2L\",\n        \"LL\",\n        \"OLL\",\n        \"PLL\",\n        \"CLS\",\n        \"ELS\",\n        \"L6E\",\n        \"CMLL\",\n        \"WV\",\n        \"ZBLL\",\n        \"void\",\n      ].includes(options.stage)\n    ) {\n      throw new Error(`Invalid stage parameter: ${options.stage}`);\n    }\n    url.searchParams.set(\"stage\", options.stage);\n  }\n  if (options.view) {\n    if (![\"editor\", \"playback\", \"fullscreen\"].includes(options.view)) {\n      throw new Error(`Invalid view parameter: ${options.view}`);\n    }\n    url.searchParams.set(\"view\", options.view);\n  }\n  if (options.type) {\n    if (\n      ![\n        \"moves\",\n        \"reconstruction\",\n        \"alg\",\n        \"reconstruction-end-with-setup\",\n      ].includes(options.type)\n    ) {\n      throw new Error(`Invalid type parameter: ${options.type}`);\n    }\n    url.searchParams.set(\"type\", options.type);\n  }\n  return url.toString();\n}\n", "export {\n  BluetoothConfig,\n  BluetoothPuzzle,\n  MoveEvent,\n  OrientationEvent,\n} from \"./bluetooth-puzzle\";\nexport { connect } from \"./connect\";\nexport { enableDebugLogging } from \"./debug\";\nexport { GanCube } from \"./gan\";\nexport { GiiKERCube, giikerMoveToBlockMoveForTesting } from \"./giiker\";\nexport { GoCube } from \"./gocube\";\nexport { debugKeyboardConnect, KeyboardPuzzle } from \"./keyboard\";\n", "import { Quaternion, Vector3 } from \"three\";\nimport { MoveEvent, OrientationEvent } from \"./bluetooth-puzzle\";\n\n// TODO: Combine orientation and moves into a single event to handle quaternion remapping.\nexport interface StreamTransformer {\n  // Modifies the input.\n  transformMove(moveEvent: MoveEvent): void;\n\n  // Modifies the input.\n  transformOrientation(orientationEvent: OrientationEvent): void;\n}\n\nfunction maxAxis(v: Vector3): string {\n  const maxVal = Math.max(Math.abs(v.x), Math.abs(v.y), Math.abs(v.z));\n  switch (maxVal) {\n    case v.x:\n      return \"x\";\n    case -v.x:\n      return \"-x\";\n    case v.y:\n      return \"y\";\n    case -v.y:\n      return \"-y\";\n    case v.z:\n      return \"z\";\n    case -v.z:\n      return \"-z\";\n    default:\n      throw new Error(\"Uh-oh.\");\n  }\n}\n\nconst s2 = Math.sqrt(0.5);\n\nconst m: { [s: string]: Quaternion } = {\n  \"y z\": new Quaternion(0, 0, 0, 1),\n  \"-z y\": new Quaternion(s2, 0, 0, s2),\n  \"x z\": new Quaternion(0, 0, -s2, s2),\n  \"-x z\": new Quaternion(0, 0, s2, s2),\n};\n\nexport class BasicRotationTransformer implements StreamTransformer {\n  // private reorientQuat = new Quaternion();\n\n  public transformMove(_moveEvent: MoveEvent): void {\n    // Nothing to do.\n  }\n\n  public transformOrientation(orientationEvent: OrientationEvent): void {\n    const { x, y, z, w } = orientationEvent.quaternion;\n    const quat = new Quaternion(x, y, z, w);\n\n    const U = new Vector3(0, 1, 0);\n    const F = new Vector3(0, 0, 1);\n    const maxU = maxAxis(U.applyQuaternion(quat));\n    const maxF = maxAxis(F.applyQuaternion(quat));\n\n    const oriQuat = m[`${maxU} ${maxF}`] || m[\"y z\"];\n\n    console.log(quat);\n    console.log(oriQuat);\n    const q2 = quat.premultiply(oriQuat);\n\n    // console.log(maxAxis(U.applyQuaternion(quat)), maxAxis(F.applyQuaternion(quat)));\n    console.log(q2);\n\n    orientationEvent.quaternion = quat;\n\n    console.log(orientationEvent.quaternion);\n  }\n}\n", "import { BlockMove } from \"../alg\";\nimport { Transformation } from \"../kpuzzle\";\nimport { BasicRotationTransformer, StreamTransformer } from \"./transformer\";\n\n/******** BluetoothPuzzle ********/\n\n// TODO: Make compatible with Twisty.\nexport type PuzzleState = Transformation;\n\n// TODO: Use actual `CustomEvent`s?\n// https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent\nexport interface MoveEvent {\n  latestMove: BlockMove;\n  timeStamp: number;\n  debug?: Record<string, unknown>;\n  state?: PuzzleState;\n  quaternion?: any; // TODO: Unused\n}\n\n// TODO: Only use the `quaternion` field in the `MoveEvent`?\nexport interface OrientationEvent {\n  quaternion: {\n    x: number;\n    y: number;\n    z: number;\n    w: number;\n  };\n  timeStamp: number;\n  debug?: Record<string, unknown>;\n}\n\nexport interface BluetoothConfig {\n  filters: BluetoothRequestDeviceFilter[];\n  optionalServices: BluetoothServiceUUID[];\n}\n\n// TODO: Expose device name (and/or globally unique identifier)?\nexport abstract class BluetoothPuzzle {\n  public transformers: StreamTransformer[] = [];\n  protected listeners: Array<(e: MoveEvent) => void> = []; // TODO: type\n  protected orientationListeners: Array<(e: OrientationEvent) => void> = []; // TODO: type\n\n  public abstract name(): string | undefined;\n\n  // TODO: require subclasses to implement this?\n  public async getState(): Promise<PuzzleState> {\n    throw new Error(\"cannot get state\");\n  }\n\n  public addMoveListener(listener: (e: MoveEvent) => void): void {\n    this.listeners.push(listener);\n  }\n\n  public addOrientationListener(listener: (e: OrientationEvent) => void): void {\n    this.orientationListeners.push(listener);\n  }\n\n  public experimentalAddBasicRotationTransformer(): void {\n    this.transformers.push(new BasicRotationTransformer());\n  }\n\n  protected dispatchMove(moveEvent: MoveEvent): void {\n    for (const transformer of this.transformers) {\n      transformer.transformMove(moveEvent);\n    }\n    for (const l of this.listeners) {\n      l(moveEvent);\n    }\n  }\n\n  protected dispatchOrientation(orientationEvent: OrientationEvent): void {\n    for (const transformer of this.transformers) {\n      transformer.transformOrientation(orientationEvent);\n    }\n    const { x, y, z, w } = orientationEvent.quaternion;\n    // TODO: can we avoid mutating the source event?\n    orientationEvent.quaternion = {\n      x,\n      y,\n      z,\n      w,\n    };\n    for (const l of this.orientationListeners) {\n      // TODO: Convert quaternion.\n      l(orientationEvent);\n    }\n  }\n}\n", "let DEBUG_LOGGING_ENABLED = false;\n\nexport function enableDebugLogging(enable: boolean): void {\n  DEBUG_LOGGING_ENABLED = enable;\n}\n\n// TODO: Remove this.\nexport function debugLog(...args: any[]): void {\n  if (!DEBUG_LOGGING_ENABLED) {\n    return;\n  }\n\n  if (console.info) {\n    console.info(...args);\n  } else {\n    console.log(...args);\n  }\n}\n", "/* tslint:disable no-bitwise */\n\nimport { Quaternion } from \"three\";\nimport { BareBlockMove, BlockMove } from \"../alg\";\nimport { KPuzzle, Puzzles } from \"../kpuzzle\";\nimport {\n  BluetoothConfig,\n  BluetoothPuzzle,\n  PuzzleState,\n} from \"./bluetooth-puzzle\";\nimport { debugLog } from \"./debug\";\nimport { importKey, unsafeDecryptBlock } from \"./unsafe-raw-aes\";\n\n// This needs to be short enough to capture 6 moves (OBQTM).\nconst DEFAULT_INTERVAL_MS = 150;\n// Number of latest moves provided by the Gan 356i.\nconst MAX_LATEST_MOVES = 6;\n\nconst ganMoveToBlockMove: { [i: number]: BlockMove } = {\n  0x00: BareBlockMove(\"U\"),\n  0x02: BareBlockMove(\"U\", -1),\n  0x03: BareBlockMove(\"R\"),\n  0x05: BareBlockMove(\"R\", -1),\n  0x06: BareBlockMove(\"F\"),\n  0x08: BareBlockMove(\"F\", -1),\n  0x09: BareBlockMove(\"D\"),\n  0x0b: BareBlockMove(\"D\", -1),\n  0x0c: BareBlockMove(\"L\"),\n  0x0e: BareBlockMove(\"L\", -1),\n  0x0f: BareBlockMove(\"B\"),\n  0x11: BareBlockMove(\"B\", -1),\n};\n\nlet homeQuatInverse: Quaternion | null = null;\n\nfunction probablyDecodedCorrectly(data: Uint8Array): boolean {\n  return (\n    data[13] < 0x12 &&\n    data[14] < 0x12 &&\n    data[15] < 0x12 &&\n    data[16] < 0x12 &&\n    data[17] < 0x12 &&\n    data[18] < 0x12\n  );\n}\n\nconst key10 = new Uint8Array([\n  198,\n  202,\n  21,\n  223,\n  79,\n  110,\n  19,\n  182,\n  119,\n  13,\n  230,\n  89,\n  58,\n  175,\n  186,\n  162,\n]);\nconst key11 = new Uint8Array([\n  67,\n  226,\n  91,\n  214,\n  125,\n  220,\n  120,\n  216,\n  7,\n  96,\n  163,\n  218,\n  130,\n  60,\n  1,\n  241,\n]);\n\n// Clean-room reverse-engineered\nasync function decryptState(\n  data: Uint8Array,\n  aesKey: CryptoKey | null,\n): Promise<Uint8Array> {\n  if (aesKey === null) {\n    return data;\n  }\n\n  const copy = new Uint8Array(data);\n  copy.set(new Uint8Array(await unsafeDecryptBlock(aesKey, copy.slice(3))), 3);\n  copy.set(\n    new Uint8Array(await unsafeDecryptBlock(aesKey, copy.slice(0, 16))),\n    0,\n  );\n\n  if (probablyDecodedCorrectly(copy)) {\n    return copy;\n  }\n\n  throw new Error(\"Invalid Gan cube state\");\n}\n\nclass PhysicalState {\n  public static async read(\n    characteristic: BluetoothRemoteGATTCharacteristic,\n    aesKey: CryptoKey | null,\n  ): Promise<PhysicalState> {\n    const value = await decryptState(\n      new Uint8Array((await characteristic.readValue()).buffer),\n      aesKey,\n    );\n    const timeStamp = Date.now();\n    // console.log(value);\n    return new PhysicalState(new DataView(value.buffer), timeStamp);\n  }\n\n  private arr: Uint8Array;\n  private arrLen = 19;\n  private constructor(private dataView: DataView, public timeStamp: number) {\n    this.arr = new Uint8Array(dataView.buffer);\n    if (this.arr.length !== this.arrLen) {\n      throw new Error(\"Unexpected array length\");\n    }\n  }\n\n  public rotQuat(): Quaternion {\n    let x = this.dataView.getInt16(0, true) / 16384;\n    let y = this.dataView.getInt16(2, true) / 16384;\n    let z = this.dataView.getInt16(4, true) / 16384;\n    [x, y, z] = [-y, z, -x];\n    const wSquared = 1 - (x * x + y * y + z * z);\n    const w = wSquared > 0 ? Math.sqrt(wSquared) : 0;\n    const quat = new Quaternion(x, y, z, w);\n\n    if (!homeQuatInverse) {\n      homeQuatInverse = quat.clone().inverse();\n    }\n\n    return quat.clone().multiply(homeQuatInverse.clone());\n  }\n\n  // Loops from 255 to 0.\n  public moveCounter(): number {\n    return this.arr[12];\n  }\n\n  public numMovesSince(previousMoveCounter: number): number {\n    return (this.moveCounter() - previousMoveCounter) & 0xff;\n  }\n\n  // Due to the design of the Gan356i protocol, it's common to query for the\n  // latest physical state and find 0 moves have been performed since the last\n  // query. Therefore, it's useful to allow 0 as an argument.\n  public latestMoves(n: number): BlockMove[] {\n    if (n < 0 || n > MAX_LATEST_MOVES) {\n      throw new Error(`Must ask for 0 to 6 latest moves. (Asked for ${n})`);\n    }\n    return Array.from(this.arr.slice(19 - n, 19)).map(\n      (i) => ganMoveToBlockMove[i],\n    );\n  }\n\n  public debugInfo(): { arr: Uint8Array } {\n    return {\n      arr: this.arr,\n    };\n  }\n}\n\n// TODO: Short IDs\nconst UUIDs = {\n  ganCubeService: \"0000fff0-0000-1000-8000-00805f9b34fb\",\n  physicalStateCharacteristic: \"0000fff5-0000-1000-8000-00805f9b34fb\",\n  actualAngleAndBatteryCharacteristic: \"0000fff7-0000-1000-8000-00805f9b34fb\",\n  faceletStatus1Characteristic: \"0000fff2-0000-1000-8000-00805f9b34fb\",\n  faceletStatus2Characteristic: \"0000fff3-0000-1000-8000-00805f9b34fb\",\n  infoService: \"0000180a-0000-1000-8000-00805f9b34fb\",\n  systemIDCharacteristic: \"00002a23-0000-1000-8000-00805f9b34fb\",\n  versionCharacteristic: \"00002a28-0000-1000-8000-00805f9b34fb\",\n};\n\nconst commands: { [cmd: string]: BufferSource } = {\n  reset: new Uint8Array([\n    0x00,\n    0x00,\n    0x24,\n    0x00,\n    0x49,\n    0x92,\n    0x24,\n    0x49,\n    0x6d,\n    0x92,\n    0xdb,\n    0xb6,\n    0x49,\n    0x92,\n    0xb6,\n    0x24,\n    0x6d,\n    0xdb,\n  ]),\n};\n\n// // TODO: Move this into a factory?\nexport const ganConfig: BluetoothConfig = {\n  filters: [{ namePrefix: \"GAN\" }],\n  optionalServices: [UUIDs.ganCubeService, UUIDs.infoService],\n};\n\nfunction buf2hex(buffer: ArrayBuffer): string {\n  // buffer is an ArrayBuffer\n  return Array.prototype.map\n    .call(new Uint8Array(buffer), (x: number) =>\n      (\"00\" + x.toString(16)).slice(-2),\n    )\n    .join(\" \");\n}\n\nconst reidEdgeOrder = \"UF UR UB UL DF DR DB DL FR FL BR BL\".split(\" \");\nconst reidCornerOrder = \"UFR URB UBL ULF DRF DFL DLB DBR\".split(\" \");\n\ninterface PieceInfo {\n  piece: number;\n  orientation: number;\n}\n\nfunction rotateLeft(s: string, i: number): string {\n  return s.slice(i) + s.slice(0, i);\n}\n\nconst pieceMap: { [s: string]: PieceInfo } = {};\n// TODO: Condense the for loops.\nreidEdgeOrder.forEach((edge, idx) => {\n  for (let i = 0; i < 2; i++) {\n    pieceMap[rotateLeft(edge, i)] = { piece: idx, orientation: i };\n  }\n});\nreidCornerOrder.forEach((corner, idx) => {\n  for (let i = 0; i < 3; i++) {\n    pieceMap[rotateLeft(corner, i)] = { piece: idx, orientation: i };\n  }\n});\n\nconst gan356iCornerMappings = [\n  [0, 21, 15],\n  [5, 13, 47],\n  [7, 45, 39],\n  [2, 37, 23],\n  [29, 10, 16],\n  [31, 18, 32],\n  [26, 34, 40],\n  [24, 42, 8],\n];\n\nconst gan356iEdgeMappings = [\n  [1, 22],\n  [3, 14],\n  [6, 46],\n  [4, 38],\n  [30, 17],\n  [27, 9],\n  [25, 41],\n  [28, 33],\n  [19, 12],\n  [20, 35],\n  [44, 11],\n  [43, 36],\n];\nconst faceOrder = \"URFDLB\";\n\nasync function getKey(\n  server: BluetoothRemoteGATTServer,\n): Promise<CryptoKey | null> {\n  const infoService = await server.getPrimaryService(UUIDs.infoService);\n\n  const versionCharacteristic = await infoService.getCharacteristic(\n    UUIDs.versionCharacteristic,\n  );\n  const versionBuffer = new Uint8Array(\n    (await versionCharacteristic.readValue()).buffer,\n  );\n\n  const versionValue =\n    (((versionBuffer[0] << 8) + versionBuffer[1]) << 8) + versionBuffer[2];\n  if (versionValue < 0x01_00_08) {\n    return null;\n  }\n\n  const keyXor = versionValue < 0x01_01_00 ? key10 : key11;\n\n  const systemIDCharacteristic = await infoService.getCharacteristic(\n    UUIDs.systemIDCharacteristic,\n  );\n  const systemID = new Uint8Array(\n    (await systemIDCharacteristic.readValue()).buffer,\n  ).reverse();\n\n  const key = new Uint8Array(keyXor);\n  for (let i = 0; i < systemID.length; i++) {\n    key[i] = (key[i] + systemID[i]) % 256;\n  }\n\n  return importKey(key);\n}\n\nexport class GanCube extends BluetoothPuzzle {\n  // We have to perform async operations before we call the constructor.\n  public static async connect(\n    server: BluetoothRemoteGATTServer,\n  ): Promise<GanCube> {\n    const ganCubeService = await server.getPrimaryService(UUIDs.ganCubeService);\n    debugLog(\"Service:\", ganCubeService);\n\n    const physicalStateCharacteristic = await ganCubeService.getCharacteristic(\n      UUIDs.physicalStateCharacteristic,\n    );\n    debugLog(\"Characteristic:\", physicalStateCharacteristic);\n\n    const aesKey = await getKey(server);\n\n    const initialMoveCounter = (\n      await PhysicalState.read(physicalStateCharacteristic, aesKey)\n    ).moveCounter();\n    debugLog(\"Initial Move Counter:\", initialMoveCounter);\n    const cube = new GanCube(\n      ganCubeService,\n      server,\n      physicalStateCharacteristic,\n      initialMoveCounter,\n      aesKey,\n    );\n    return cube;\n  }\n\n  public INTERVAL_MS: number = DEFAULT_INTERVAL_MS;\n  private intervalHandle: number | null = null;\n  private kpuzzle: KPuzzle = new KPuzzle(Puzzles[\"3x3x3\"]);\n  private cachedFaceletStatus1Characteristic: Promise<\n    BluetoothRemoteGATTCharacteristic\n  >;\n\n  private cachedFaceletStatus2Characteristic: Promise<\n    BluetoothRemoteGATTCharacteristic\n  >;\n\n  private cachedActualAngleAndBatteryCharacteristic: Promise<\n    BluetoothRemoteGATTCharacteristic\n  >;\n\n  private constructor(\n    private service: BluetoothRemoteGATTService,\n    private server: BluetoothRemoteGATTServer,\n    private physicalStateCharacteristic: BluetoothRemoteGATTCharacteristic,\n    private lastMoveCounter: number,\n    private aesKey: CryptoKey | null,\n  ) {\n    super();\n    this.startTrackingMoves();\n  }\n\n  public name(): string | undefined {\n    return this.server.device.name;\n  }\n\n  public startTrackingMoves(): void {\n    // `window.setInterval` instead of `setInterval`:\n    // https://github.com/Microsoft/TypeScript/issues/842#issuecomment-252445883\n    this.intervalHandle = window.setInterval(\n      this.intervalHandler.bind(this),\n      this.INTERVAL_MS,\n    );\n  }\n\n  public stopTrackingMoves(): void {\n    if (!this.intervalHandle) {\n      throw new Error(\"Not tracking moves!\");\n    }\n    clearInterval(this.intervalHandle);\n    this.intervalHandle = null;\n  }\n\n  // TODO: Can we ever receive async responses out of order?\n  public async intervalHandler(): Promise<void> {\n    const physicalState = await PhysicalState.read(\n      this.physicalStateCharacteristic,\n      this.aesKey,\n    );\n    let numInterveningMoves = physicalState.numMovesSince(this.lastMoveCounter);\n    // console.log(numInterveningMoves);\n    if (numInterveningMoves > MAX_LATEST_MOVES) {\n      debugLog(\n        `Too many moves! Dropping ${\n          numInterveningMoves - MAX_LATEST_MOVES\n        } moves`,\n      );\n      numInterveningMoves = MAX_LATEST_MOVES;\n    }\n    for (const move of physicalState.latestMoves(numInterveningMoves)) {\n      // console.log(move);\n      this.kpuzzle.applyBlockMove(move);\n      this.dispatchMove({\n        latestMove: move,\n        timeStamp: physicalState.timeStamp,\n        debug: physicalState.debugInfo(),\n        state: this.kpuzzle.state,\n        // quaternion: physicalState.rotQuat(),\n      });\n    }\n    this.dispatchOrientation({\n      timeStamp: physicalState.timeStamp,\n      quaternion: physicalState.rotQuat(),\n    });\n    this.lastMoveCounter = physicalState.moveCounter();\n  }\n\n  public async getBattery(): Promise<number> {\n    return new Uint8Array(\n      await this.readActualAngleAndBatteryCharacteristic(),\n    )[7];\n  }\n\n  public async getState(): Promise<PuzzleState> {\n    const arr: Uint8Array = await decryptState(\n      new Uint8Array(await this.readFaceletStatus1Characteristic()),\n      this.aesKey,\n    );\n    const stickers: number[] = [];\n    for (let i = 0; i < 18; i += 3) {\n      let v = (((arr[i ^ 1] << 8) + arr[(i + 1) ^ 1]) << 8) + arr[(i + 2) ^ 1];\n      for (let j = 0; j < 8; j++) {\n        stickers.push(v & 7);\n        v >>= 3;\n      }\n    }\n\n    const state: PuzzleState = {\n      CORNERS: {\n        permutation: [],\n        orientation: [],\n      },\n      EDGES: {\n        permutation: [],\n        orientation: [],\n      },\n      CENTERS: {\n        permutation: [0, 1, 2, 3, 4, 5],\n        orientation: [0, 0, 0, 0, 0, 0],\n      },\n    };\n\n    for (const cornerMapping of gan356iCornerMappings) {\n      const pieceInfo: PieceInfo =\n        pieceMap[cornerMapping.map((i) => faceOrder[stickers[i]]).join(\"\")];\n      state.CORNERS.permutation.push(pieceInfo.piece);\n      state.CORNERS.orientation.push(pieceInfo.orientation);\n    }\n\n    for (const edgeMapping of gan356iEdgeMappings) {\n      const pieceInfo: PieceInfo =\n        pieceMap[edgeMapping.map((i) => faceOrder[stickers[i]]).join(\"\")];\n      state.EDGES.permutation.push(pieceInfo.piece);\n      state.EDGES.orientation.push(pieceInfo.orientation);\n    }\n\n    return state;\n  }\n\n  public async faceletStatus1Characteristic(): Promise<\n    BluetoothRemoteGATTCharacteristic\n  > {\n    this.cachedFaceletStatus1Characteristic =\n      this.cachedFaceletStatus1Characteristic ||\n      this.service.getCharacteristic(UUIDs.faceletStatus1Characteristic);\n    return this.cachedFaceletStatus1Characteristic;\n  }\n\n  public async faceletStatus2Characteristic(): Promise<\n    BluetoothRemoteGATTCharacteristic\n  > {\n    this.cachedFaceletStatus2Characteristic =\n      this.cachedFaceletStatus2Characteristic ||\n      this.service.getCharacteristic(UUIDs.faceletStatus2Characteristic);\n    return this.cachedFaceletStatus2Characteristic;\n  }\n\n  public async actualAngleAndBatteryCharacteristic(): Promise<\n    BluetoothRemoteGATTCharacteristic\n  > {\n    this.cachedActualAngleAndBatteryCharacteristic =\n      this.cachedActualAngleAndBatteryCharacteristic ||\n      this.service.getCharacteristic(UUIDs.actualAngleAndBatteryCharacteristic);\n    return this.cachedActualAngleAndBatteryCharacteristic;\n  }\n\n  public async reset(): Promise<void> {\n    const faceletStatus1Characteristic = await this.faceletStatus1Characteristic();\n    await faceletStatus1Characteristic.writeValue(commands.reset);\n  }\n\n  public async readFaceletStatus1Characteristic(): Promise<ArrayBuffer> {\n    const faceletStatus1Characteristic = await this.faceletStatus1Characteristic();\n    return (await faceletStatus1Characteristic.readValue()).buffer;\n  }\n\n  public async readFaceletStatus2Characteristic(): Promise<string> {\n    const faceletStatus2Characteristic = await this.faceletStatus2Characteristic();\n    return buf2hex((await faceletStatus2Characteristic.readValue()).buffer);\n  }\n\n  public async readActualAngleAndBatteryCharacteristic(): Promise<ArrayBuffer> {\n    const actualAngleAndBatteryCharacteristic = await this.actualAngleAndBatteryCharacteristic();\n    return (await actualAngleAndBatteryCharacteristic.readValue()).buffer;\n  }\n\n  // TODO\n  // private onphysicalStateCharacteristicChanged(event: any): void {\n  //   var val = event.target.value;\n  //   debugLog(val);\n  // }\n}\n", "export {\n  KPuzzleDefinition,\n  OrbitTransformation,\n  Transformation,\n} from \"./definition_types\";\n\nexport { KPuzzle, stateForBlockMove } from \"./kpuzzle\";\n\nexport {\n  Canonicalize,\n  SearchSequence,\n  CanonicalSequenceIterator,\n} from \"./canonicalize\";\n\nexport {\n  Combine,\n  Multiply,\n  IdentityTransformation,\n  Invert,\n  EquivalentTransformations,\n  EquivalentStates,\n  Order,\n} from \"./transformations\";\n\nexport { Puzzles } from \"./puzzle_definitions\";\n\nexport { parseKPuzzle } from \"./parser\";\n\nexport { SVG } from \"./svg\";\n", "import { KPuzzleDefinition, Transformation } from \"./definition_types\";\n\nexport function Combine(\n  def: KPuzzleDefinition,\n  t1: Transformation,\n  t2: Transformation,\n): Transformation {\n  const newTrans: Transformation = {} as Transformation;\n  for (const orbitName in def.orbits) {\n    const oDef = def.orbits[orbitName];\n    const o1 = t1[orbitName];\n    const o2 = t2[orbitName];\n    const newPerm = new Array(oDef.numPieces);\n    const newOri = new Array(oDef.numPieces);\n    for (let idx = 0; idx < oDef.numPieces; idx++) {\n      newOri[idx] =\n        (o1.orientation[o2.permutation[idx]] + o2.orientation[idx]) %\n        oDef.orientations;\n      newPerm[idx] = o1.permutation[o2.permutation[idx]];\n    }\n    newTrans[orbitName] = { permutation: newPerm, orientation: newOri };\n  }\n  return newTrans;\n}\n\nexport function Multiply(\n  def: KPuzzleDefinition,\n  t: Transformation,\n  amount: number,\n): Transformation {\n  if (amount < 0) {\n    return Multiply(def, Invert(def, t), -amount);\n  }\n  if (amount === 0) {\n    return IdentityTransformation(def);\n  }\n  if (amount === 1) {\n    return t;\n  }\n  const halfish = Multiply(def, t, Math.floor(amount / 2));\n  const twiceHalfish = Combine(def, halfish, halfish);\n  if (amount % 2 === 0) {\n    return twiceHalfish;\n  } else {\n    return Combine(def, t, twiceHalfish);\n  }\n}\nexport function IdentityTransformation(\n  definition: KPuzzleDefinition,\n): Transformation {\n  const transformation = {} as Transformation;\n  for (const orbitName in definition.orbits) {\n    const orbitDefinition = definition.orbits[orbitName];\n    const newPermutation = new Array(orbitDefinition.numPieces);\n    const newOrientation = new Array(orbitDefinition.numPieces);\n    for (let i = 0; i < orbitDefinition.numPieces; i++) {\n      newPermutation[i] = i;\n      newOrientation[i] = 0;\n    }\n    const orbitTransformation = {\n      permutation: newPermutation,\n      orientation: newOrientation,\n    };\n    transformation[orbitName] = orbitTransformation;\n  }\n  return transformation;\n}\n\nexport function Invert(\n  def: KPuzzleDefinition,\n  t: Transformation,\n): Transformation {\n  const newTrans: Transformation = {} as Transformation;\n  for (const orbitName in def.orbits) {\n    const oDef = def.orbits[orbitName];\n    const o = t[orbitName];\n    const newPerm = new Array(oDef.numPieces);\n    const newOri = new Array(oDef.numPieces);\n    for (let idx = 0; idx < oDef.numPieces; idx++) {\n      const fromIdx = o.permutation[idx] as number;\n      newPerm[fromIdx] = idx;\n      newOri[fromIdx] =\n        (oDef.orientations - o.orientation[idx] + oDef.orientations) %\n        oDef.orientations;\n    }\n    newTrans[orbitName] = { permutation: newPerm, orientation: newOri };\n  }\n  return newTrans;\n}\n\nfunction gcd(a: number, b: number): number {\n  if (b) {\n    return gcd(b, a % b);\n  }\n  return a;\n}\n/* calculate the order of a particular transformation. */\nexport function Order(def: KPuzzleDefinition, t: Transformation): number {\n  let r: number = 1;\n  for (const orbitName in def.orbits) {\n    const oDef = def.orbits[orbitName];\n    const o = t[orbitName];\n    const d = new Array(oDef.numPieces);\n    for (let idx = 0; idx < oDef.numPieces; idx++) {\n      if (!d[idx]) {\n        let w = idx;\n        let om = 0;\n        let pm = 0;\n        for (;;) {\n          d[w] = true;\n          om = om + o.orientation[w];\n          pm = pm + 1;\n          w = o.permutation[w];\n          if (w === idx) {\n            break;\n          }\n        }\n        if (om !== 0) {\n          pm = (pm * oDef.orientations) / gcd(oDef.orientations, om);\n        }\n        r = (r * pm) / gcd(r, pm);\n      }\n    }\n  }\n  return r;\n}\n\nexport function EquivalentTransformations(\n  def: KPuzzleDefinition,\n  t1: Transformation,\n  t2: Transformation,\n): boolean {\n  for (const orbitName in def.orbits) {\n    const oDef = def.orbits[orbitName];\n    const o1 = t1[orbitName];\n    const o2 = t2[orbitName];\n    for (let idx = 0; idx < oDef.numPieces; idx++) {\n      if (o1.orientation[idx] !== o2.orientation[idx]) {\n        return false;\n      }\n      if (o1.permutation[idx] !== o2.permutation[idx]) {\n        return false;\n      }\n    }\n  }\n  return true;\n}\n\nexport function EquivalentStates(\n  def: KPuzzleDefinition,\n  t1: Transformation,\n  t2: Transformation,\n): boolean {\n  // Turn transformations into states.\n  // This accounts for indistinguishable pieces.\n  return EquivalentTransformations(\n    def,\n    Combine(def, def.startPieces, t1),\n    Combine(def, def.startPieces, t2),\n  );\n}\n", "import { BlockMove, blockMoveToString, expand, Sequence } from \"../alg\";\nimport { KPuzzleDefinition, Transformation } from \"./definition_types\";\nimport { Multiply, IdentityTransformation, Combine } from \"./transformations\";\nimport { MoveNotation } from \"./move_notation\";\n\n// TODO: Move other helpers into the definition.\nexport function stateForBlockMove(\n  def: KPuzzleDefinition,\n  blockMove: BlockMove,\n): Transformation {\n  const move = getNotationLayer(def).lookupMove(blockMove);\n  if (!move) {\n    throw new Error(\"Unknown move: \" + blockMoveToString(blockMove));\n  }\n  return move;\n}\n\nexport function getNotationLayer(def: KPuzzleDefinition): MoveNotation {\n  if (!def.moveNotation) {\n    def.moveNotation = new KPuzzleMoveNotation(def);\n  }\n  return def.moveNotation;\n}\n\nclass KPuzzleMoveNotation implements MoveNotation {\n  private cache: { [key: string]: Transformation } = {};\n  constructor(public def: KPuzzleDefinition) {}\n\n  public lookupMove(move: BlockMove): Transformation | undefined {\n    const key = blockMoveToString(move);\n    let r: Transformation | undefined = this.cache[key];\n    if (r) {\n      return r;\n    }\n    const baseMove = new BlockMove(\n      move.outerLayer,\n      move.innerLayer,\n      move.family,\n      1,\n    );\n    const baseKey = blockMoveToString(baseMove);\n    r = this.def.moves[baseKey];\n    if (r) {\n      r = Multiply(this.def, r, move.amount);\n      this.cache[key] = r;\n    }\n    return r;\n  }\n}\n\nexport class KPuzzle {\n  public state: Transformation;\n  constructor(public definition: KPuzzleDefinition) {\n    this.state = IdentityTransformation(definition);\n  }\n\n  public reset(): void {\n    this.state = IdentityTransformation(this.definition);\n  }\n\n  public serialize(): string {\n    let output = \"\";\n    for (const orbitName in this.definition.orbits) {\n      output += orbitName + \"\\n\";\n      output += this.state[orbitName].permutation.join(\" \") + \"\\n\";\n      output += this.state[orbitName].orientation.join(\" \") + \"\\n\";\n    }\n    output = output.slice(0, output.length - 1); // Trim last newline.\n    return output;\n  }\n\n  public applyBlockMove(blockMove: BlockMove): void {\n    this.state = Combine(\n      this.definition,\n      this.state,\n      stateForBlockMove(this.definition, blockMove),\n    );\n  }\n\n  public applyAlg(a: Sequence): void {\n    // TODO: Iterator instead of full expansion.\n    for (const move of expand(a).nestedUnits as BlockMove[]) {\n      this.applyBlockMove(move);\n    }\n  }\n  // TODO: Implement\n  // parseState(): this {}\n\n  // TODO: Alg parsing\n\n  // TODO: Implement.\n  // invert(): this {}\n}\n", "/**\n *  This module manages canonical sequences.  You can merge sequences\n *  combining moves (fully respecting commuting moves), and you can\n *  generate canonical sequences efficiently.\n */\nimport { KPuzzleDefinition, Transformation } from \"./definition_types\";\nimport {\n  EquivalentTransformations,\n  Combine,\n  IdentityTransformation,\n} from \"./transformations\";\nimport {\n  modifiedBlockMove,\n  blockMoveToString,\n  BlockMove,\n  Sequence,\n} from \"../alg\";\n\nclass InternalMove {\n  constructor(public base: number, public twist: number) {}\n  public getTransformation(canon: Canonicalize): Transformation {\n    return canon.transforms[this.base][this.twist];\n  }\n\n  public asString(canon: Canonicalize): string {\n    const mod = canon.moveorder[this.base];\n    let tw = this.twist % mod;\n    while (tw + tw > mod) {\n      tw -= mod;\n    }\n    while (tw + tw <= -mod) {\n      tw += mod;\n    }\n    const nam = canon.movenames[this.base];\n    if (tw === 1) {\n      return nam;\n    } else if (tw === -1) {\n      return nam + \"'\";\n    } else if (tw > 0) {\n      return nam + tw;\n    } else if (tw < 0) {\n      return nam + -tw + \"'\";\n    } else {\n      throw new Error(\"Stringifying null move?\");\n    }\n  }\n}\n\n// represents puzzle move data and its commuting structure\nexport class Canonicalize {\n  public commutes: boolean[][] = [];\n  public moveorder: number[] = [];\n  public movenames: string[] = [];\n  public transforms: Transformation[][] = [];\n  public moveindex: { [key: string]: number } = {};\n  public baseMoveCount: number;\n  constructor(public def: KPuzzleDefinition) {\n    const basemoves = def.moves;\n    const id = IdentityTransformation(def);\n    for (const mv1 in basemoves) {\n      this.moveindex[mv1] = this.movenames.length;\n      this.movenames.push(mv1);\n      this.transforms.push([id, basemoves[mv1]]);\n    }\n    this.baseMoveCount = this.movenames.length;\n    for (let i = 0; i < this.baseMoveCount; i++) {\n      this.commutes.push([]);\n      const t1 = this.transforms[i][1];\n      for (let j = 0; j < this.baseMoveCount; j++) {\n        const t2 = this.transforms[j][1];\n        const ab = Combine(def, t1, t2);\n        const ba = Combine(def, t2, t1);\n        this.commutes[i][j] = EquivalentTransformations(def, ab, ba);\n      }\n    }\n    for (let i = 0; i < this.baseMoveCount; i++) {\n      const t1 = this.transforms[i][1];\n      let ct = t1;\n      let order = 1;\n      for (let mult = 2; !EquivalentTransformations(def, id, ct); mult++) {\n        order++;\n        ct = Combine(def, ct, t1);\n        this.transforms[i].push(ct);\n      }\n      this.moveorder[i] = order;\n    }\n  }\n\n  public blockMoveToInternalMove(mv: BlockMove): InternalMove {\n    const basemove = modifiedBlockMove(mv, { amount: 1 });\n    const s = blockMoveToString(basemove);\n    if (!(s in this.def.moves)) {\n      throw new Error(\"! move \" + s + \" not in def.\");\n    }\n    const ind = this.moveindex[s];\n    const mod = this.moveorder[ind];\n    let tw = mv.amount % mod;\n    if (tw < 0) {\n      tw = (tw + mod) % mod;\n    }\n    return new InternalMove(ind, tw);\n  }\n\n  // Sequence must be simple sequence of block moves\n  // this one does not attempt to merge.\n  public sequenceToSearchSequence(\n    s: Sequence,\n    tr?: Transformation,\n  ): SearchSequence {\n    const ss = new SearchSequence(this, tr);\n    for (const mv of s.nestedUnits) {\n      ss.appendOneMove(this.blockMoveToInternalMove(mv as BlockMove));\n    }\n    return ss;\n  }\n\n  // Sequence to simple sequence, with merging.\n  public mergeSequenceToSearchSequence(\n    s: Sequence,\n    tr?: Transformation,\n  ): SearchSequence {\n    const ss = new SearchSequence(this, tr);\n    for (const mv of s.nestedUnits) {\n      ss.mergeOneMove(this.blockMoveToInternalMove(mv as BlockMove));\n    }\n    return ss;\n  }\n}\n// represents a single sequence we are working on\n// this can be a search sequence, or it can be a\n// \"cooked\" sequence that we want to use efficiently.\nexport class SearchSequence {\n  public moveseq: InternalMove[] = [];\n  public trans: Transformation;\n  constructor(private canon: Canonicalize, tr?: Transformation) {\n    if (tr) {\n      this.trans = tr;\n    } else {\n      this.trans = IdentityTransformation(canon.def);\n    }\n  }\n\n  /*\n   *  A common use for search sequences is to extend them, but\n   *  sometimes we shouldn't modify the returned one.  This\n   *  method gives you a copy you can do whatever you want with.\n   */\n  public clone(): SearchSequence {\n    const r = new SearchSequence(this.canon, this.trans);\n    r.moveseq = [...this.moveseq];\n    return r;\n  }\n\n  // returns 1 if the move is added, 0 if it is merged, -1 if it cancels a move\n  public mergeOneMove(mv: InternalMove): number {\n    const r = this.onlyMergeOneMove(mv);\n    this.trans = Combine(\n      this.canon.def,\n      this.trans,\n      mv.getTransformation(this.canon),\n    );\n    return r;\n  }\n\n  // does not do merge work; just slaps the new move on\n  public appendOneMove(mv: InternalMove): number {\n    this.moveseq.push(mv);\n    this.trans = Combine(\n      this.canon.def,\n      this.trans,\n      mv.getTransformation(this.canon),\n    );\n    return 1;\n  }\n\n  // pop a move off.\n  public popMove(): number {\n    const mv = this.moveseq.pop();\n    if (!mv) {\n      throw new Error(\"Can't pop an empty sequence\");\n    }\n    this.trans = Combine(\n      this.canon.def,\n      this.trans,\n      this.canon.transforms[mv.base][this.canon.moveorder[mv.base] - mv.twist],\n    );\n    return 1;\n  }\n\n  // do one more twist of the last move\n  public oneMoreTwist(): number {\n    const lastmv = this.moveseq[this.moveseq.length - 1];\n    this.trans = Combine(\n      this.canon.def,\n      this.trans,\n      this.canon.transforms[lastmv.base][1],\n    );\n    this.moveseq[this.moveseq.length - 1] = new InternalMove(\n      lastmv.base,\n      lastmv.twist + 1,\n    );\n    return 0;\n  }\n\n  private onlyMergeOneMove(mv: InternalMove): number {\n    let j = this.moveseq.length - 1;\n    while (j >= 0) {\n      if (mv.base === this.moveseq[j].base) {\n        const mo = this.canon.moveorder[mv.base];\n        let twist = (mv.twist + this.moveseq[j].twist) % mo;\n        if (twist < 0) {\n          twist = (twist + mo) % mo;\n        }\n        if (twist === 0) {\n          // this splice should not be a performance problem because the\n          // typical number of following moves should be small\n          this.moveseq.splice(j, 1);\n          return -1;\n        } else {\n          this.moveseq[j] = new InternalMove(mv.base, twist);\n          return 0;\n        }\n      } else if (this.canon.commutes[mv.base][this.moveseq[j].base]) {\n        j--;\n      } else {\n        break;\n      }\n    }\n    this.moveseq.push(mv);\n    return 1;\n  }\n\n  // returns the length of the merged sequence.\n  public mergeSequence(seq: SearchSequence): number {\n    let r = this.moveseq.length;\n    for (let i = 0; i < seq.moveseq.length; i++) {\n      const mv = seq.moveseq[i];\n      const d = this.onlyMergeOneMove(mv);\n      r += d;\n    }\n    this.trans = Combine(this.canon.def, this.trans, seq.trans);\n    return r;\n  }\n\n  public getSequenceAsString(): string {\n    const r: string[] = [];\n    for (const mv of this.moveseq) {\n      r.push(mv.asString(this.canon));\n    }\n    return r.join(\" \");\n  }\n}\n/*\n *   Iterate through canonical sequences by length.  This version\n *   uses generators.\n */\nexport class CanonicalSequenceIterator {\n  public ss: SearchSequence;\n  public targetLength: number;\n  constructor(public canon: Canonicalize, state?: Transformation) {\n    this.ss = new SearchSequence(canon, state);\n    this.targetLength = 0;\n  }\n\n  public nextState(base: number, canonstate: number[]): null | number[] {\n    const newstate: number[] = [];\n    for (const prevbase of canonstate) {\n      if (prevbase === base) {\n        return null;\n      } else if (!this.canon.commutes[prevbase][base]) {\n        // don't do anything in this case\n      } else if (base < prevbase) {\n        return null;\n      } else {\n        newstate.push(prevbase);\n      }\n    }\n    return newstate;\n  }\n\n  public *genSequence(\n    togo: number,\n    canonstate: number[],\n  ): Generator<SearchSequence, null, void> {\n    if (togo === 0) {\n      yield this.ss;\n    } else {\n      for (let base = 0; base < this.canon.baseMoveCount; base++) {\n        const newstate = this.nextState(base, canonstate);\n        if (newstate) {\n          newstate.push(base);\n          for (let tw = 1; tw < this.canon.moveorder[base]; tw++) {\n            this.ss.appendOneMove(new InternalMove(base, tw));\n            yield* this.genSequence(togo - 1, newstate);\n            this.ss.popMove();\n          }\n        }\n      }\n    }\n    return null;\n  }\n\n  public *generator(): Generator<SearchSequence, SearchSequence, void> {\n    for (let d = 0; ; d++) {\n      yield* this.genSequence(d, []);\n    }\n  }\n\n  public *genSequenceTree(\n    canonstate: number[],\n  ): Generator<SearchSequence, null, number> {\n    const r = yield this.ss;\n    if (r > 0) {\n      return null;\n    }\n    for (let base = 0; base < this.canon.baseMoveCount; base++) {\n      const newstate = this.nextState(base, canonstate);\n      if (newstate) {\n        newstate.push(base);\n        for (let tw = 1; tw < this.canon.moveorder[base]; tw++) {\n          this.ss.appendOneMove(new InternalMove(base, tw));\n          yield* this.genSequenceTree(newstate);\n          this.ss.popMove();\n        }\n      }\n    }\n    return null;\n  }\n}\n", "export default `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.0//EN\"\n       \"http://www.w3.org/TR/2001/REC-SVG-20050904/DTD/svg11.dtd\">\n<svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" viewBox=\"0 0 520 394\" preserveAspectRatio=\"xMidYMid meet\">\n  <title>2x2x2</title>\n  <defs>\n    <g id=\"sticker\">\n        <rect x=\"0\" y=\"0\" width=\"1\" height=\"1\" stroke=\"black\" stroke-width=\"0.04px\" />\n    </g>\n  </defs>\n  <g id=\"puzzle\" transform=\"translate(5, 5) scale(60)\">\n    <use id=\"CORNERS-l0-o0\" xlink:href=\"#sticker\" transform=\"translate(3.2, 1)\" style=\"fill: white\"/>\n    <use id=\"CORNERS-l0-o1\" xlink:href=\"#sticker\" transform=\"translate(4.4, 2.2)\" style=\"fill: red\"/>\n    <use id=\"CORNERS-l0-o2\" xlink:href=\"#sticker\" transform=\"translate(3.2, 2.2)\" style=\"fill: limegreen\"/>\n\n    <use id=\"CORNERS-l1-o0\" xlink:href=\"#sticker\" transform=\"translate(3.2, 0)\" style=\"fill: white\"/>\n    <use id=\"CORNERS-l1-o1\" xlink:href=\"#sticker\" transform=\"translate(6.6, 2.2)\" style=\"fill: #26f\"/>\n    <use id=\"CORNERS-l1-o2\" xlink:href=\"#sticker\" transform=\"translate(5.4, 2.2)\" style=\"fill: red\"/>\n\n    <use id=\"CORNERS-l2-o0\" xlink:href=\"#sticker\" transform=\"translate(2.2, 0)\" style=\"fill: white\"/>\n    <use id=\"CORNERS-l2-o1\" xlink:href=\"#sticker\" transform=\"translate(0, 2.2)\" style=\"fill: orange\"/>\n    <use id=\"CORNERS-l2-o2\" xlink:href=\"#sticker\" transform=\"translate(7.6, 2.2)\" style=\"fill: #26f\"/>\n\n    <use id=\"CORNERS-l3-o0\" xlink:href=\"#sticker\" transform=\"translate(2.2, 1)\" style=\"fill: white\"/>\n    <use id=\"CORNERS-l3-o1\" xlink:href=\"#sticker\" transform=\"translate(2.2, 2.2)\" style=\"fill: limegreen\"/>\n    <use id=\"CORNERS-l3-o2\" xlink:href=\"#sticker\" transform=\"translate(1, 2.2)\" style=\"fill: orange\"/>\n\n    <use id=\"CORNERS-l4-o0\" xlink:href=\"#sticker\" transform=\"translate(3.2, 4.4)\" style=\"fill: yellow\"/>\n    <use id=\"CORNERS-l4-o1\" xlink:href=\"#sticker\" transform=\"translate(3.2, 3.2)\" style=\"fill: limegreen\"/>\n    <use id=\"CORNERS-l4-o2\" xlink:href=\"#sticker\" transform=\"translate(4.4, 3.2)\" style=\"fill: red\"/>\n\n    <use id=\"CORNERS-l5-o0\" xlink:href=\"#sticker\" transform=\"translate(2.2, 4.4)\" style=\"fill: yellow\"/>\n    <use id=\"CORNERS-l5-o1\" xlink:href=\"#sticker\" transform=\"translate(1, 3.2)\" style=\"fill: orange\"/>\n    <use id=\"CORNERS-l5-o2\" xlink:href=\"#sticker\" transform=\"translate(2.2, 3.2)\" style=\"fill: limegreen\"/>\n\n    <use id=\"CORNERS-l6-o0\" xlink:href=\"#sticker\" transform=\"translate(2.2, 5.4)\" style=\"fill: yellow\"/>\n    <use id=\"CORNERS-l6-o1\" xlink:href=\"#sticker\" transform=\"translate(7.6, 3.2)\" style=\"fill: #26f\"/>\n    <use id=\"CORNERS-l6-o2\" xlink:href=\"#sticker\" transform=\"translate(0, 3.2)\"  style=\"fill: orange\"/>\n\n    <use id=\"CORNERS-l7-o0\" xlink:href=\"#sticker\" transform=\"translate(3.2, 5.4)\" style=\"fill: yellow\"/>\n    <use id=\"CORNERS-l7-o1\" xlink:href=\"#sticker\" transform=\"translate(5.4, 3.2)\" style=\"fill: red\"/>\n    <use id=\"CORNERS-l7-o2\" xlink:href=\"#sticker\" transform=\"translate(6.6, 3.2)\" style=\"fill: #26f\"/>\n  </g>\n\n</svg>`;\n", "export default `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.0//EN\"\n       \"http://www.w3.org/TR/2001/REC-SVG-20050904/DTD/svg11.dtd\">\n<svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" viewBox=\"0 0 518 392\" preserveAspectRatio=\"xMidYMid meet\">\n  <title>3x3x3</title>\n  <defs>\n    <g id=\"sticker\">\n        <rect x=\"0\" y=\"0\" width=\"1\" height=\"1\" stroke=\"black\" stroke-width=\"0.04px\" />\n    </g>\n  </defs>\n\n<!--        0 1 2 3 4 5 6 7 8 9 10 11  -->\n<!--        | | | | | | | | | | | |<-  -->\n<!--    0 -       . . .                -->\n<!--    1 -       . . .                -->\n<!--    2 -       . . .                -->\n<!--    3 - . . . . . . . . . . . .    -->\n<!--    4 - . . . . . . . . . . . .    -->\n<!--    5 - . . . . . . . . . . . .    -->\n<!--    6 -       . . .                -->\n<!--    7 -       . . .                -->\n<!--    8 -       . . .                -->\n\n  <g id=\"puzzle\" transform=\"translate(5,5) scale(40)\">\n    <!-- CORNERS -->\n    <use id=\"CORNERS-l0-o0\" xlink:href=\"#sticker\" transform=\"translate(5.3,2.1)\" style=\"fill: white\"/>\n    <use id=\"CORNERS-l0-o1\" xlink:href=\"#sticker\" transform=\"translate(6.5,3.3)\" style=\"fill: red\"/>\n    <use id=\"CORNERS-l0-o2\" xlink:href=\"#sticker\" transform=\"translate(5.3,3.3)\" style=\"fill: limegreen\"/>\n\n    <use id=\"CORNERS-l1-o0\" xlink:href=\"#sticker\" transform=\"translate(5.3,0.1)\" style=\"fill: white\"/>\n    <use id=\"CORNERS-l1-o1\" xlink:href=\"#sticker\" transform=\"translate(9.7,3.3)\" style=\"fill: #26f\"/>\n    <use id=\"CORNERS-l1-o2\" xlink:href=\"#sticker\" transform=\"translate(8.5,3.3)\" style=\"fill: red\"/>\n\n    <use id=\"CORNERS-l2-o0\" xlink:href=\"#sticker\" transform=\"translate(3.3,0.1)\" style=\"fill: white\"/>\n    <use id=\"CORNERS-l2-o1\" xlink:href=\"#sticker\" transform=\"translate(0.1,3.3)\" style=\"fill: orange\"/>\n    <use id=\"CORNERS-l2-o2\" xlink:href=\"#sticker\" transform=\"translate(11.7,3.3)\" style=\"fill: #26f\"/>\n\n    <use id=\"CORNERS-l3-o0\" xlink:href=\"#sticker\" transform=\"translate(3.3,2.1)\" style=\"fill: white\"/>\n    <use id=\"CORNERS-l3-o1\" xlink:href=\"#sticker\" transform=\"translate(3.3,3.3)\" style=\"fill: limegreen\"/>\n    <use id=\"CORNERS-l3-o2\" xlink:href=\"#sticker\" transform=\"translate(2.1,3.3)\" style=\"fill: orange\"/>\n\n    <use id=\"CORNERS-l4-o0\" xlink:href=\"#sticker\" transform=\"translate(5.3,6.5)\" style=\"fill: yellow\"/>\n    <use id=\"CORNERS-l4-o1\" xlink:href=\"#sticker\" transform=\"translate(5.3,5.3)\" style=\"fill: limegreen\"/>\n    <use id=\"CORNERS-l4-o2\" xlink:href=\"#sticker\" transform=\"translate(6.5,5.3)\" style=\"fill: red\"/>\n\n    <use id=\"CORNERS-l5-o0\" xlink:href=\"#sticker\" transform=\"translate(3.3,6.5)\" style=\"fill: yellow\"/>\n    <use id=\"CORNERS-l5-o1\" xlink:href=\"#sticker\" transform=\"translate(2.1,5.3)\" style=\"fill: orange\"/>\n    <use id=\"CORNERS-l5-o2\" xlink:href=\"#sticker\" transform=\"translate(3.3,5.3)\" style=\"fill: limegreen\"/>\n\n    <use id=\"CORNERS-l6-o0\" xlink:href=\"#sticker\" transform=\"translate(3.3,8.5)\" style=\"fill: yellow\"/>\n    <use id=\"CORNERS-l6-o1\" xlink:href=\"#sticker\" transform=\"translate(11.7,5.3)\" style=\"fill: #26f\"/>\n    <use id=\"CORNERS-l6-o2\" xlink:href=\"#sticker\" transform=\"translate(0.1,5.3)\"  style=\"fill: orange\"/>\n\n    <use id=\"CORNERS-l7-o0\" xlink:href=\"#sticker\" transform=\"translate(5.3,8.5)\" style=\"fill: yellow\"/>\n    <use id=\"CORNERS-l7-o1\" xlink:href=\"#sticker\" transform=\"translate(8.5,5.3)\" style=\"fill: red\"/>\n    <use id=\"CORNERS-l7-o2\" xlink:href=\"#sticker\" transform=\"translate(9.7,5.3)\" style=\"fill: #26f\"/>\n\n    <!-- EDGES -->\n    <use id=\"EDGES-l0-o0\"  xlink:href=\"#sticker\" transform=\"translate(4.3,2.1)\" style=\"fill: white\"/>\n    <use id=\"EDGES-l0-o1\"  xlink:href=\"#sticker\" transform=\"translate(4.3,3.3)\" style=\"fill: limegreen\"/>\n\n    <use id=\"EDGES-l1-o0\"  xlink:href=\"#sticker\" transform=\"translate(5.3,1.1)\" style=\"fill: white\"/>\n    <use id=\"EDGES-l1-o1\"  xlink:href=\"#sticker\" transform=\"translate(7.5,3.3)\" style=\"fill: red\"/>\n\n    <use id=\"EDGES-l2-o0\"  xlink:href=\"#sticker\" transform=\"translate(4.3,0.1)\" style=\"fill: white\"/>\n    <use id=\"EDGES-l2-o1\"  xlink:href=\"#sticker\" transform=\"translate(10.7,3.3)\" style=\"fill: #26f\"/>\n\n    <use id=\"EDGES-l3-o0\"  xlink:href=\"#sticker\" transform=\"translate(3.3,1.1)\" style=\"fill: white\"/>\n    <use id=\"EDGES-l3-o1\"  xlink:href=\"#sticker\" transform=\"translate(1.1,3.3)\" style=\"fill: orange\"/>\n\n    <use id=\"EDGES-l4-o0\"  xlink:href=\"#sticker\" transform=\"translate(4.3,6.5)\" style=\"fill: yellow\"/>\n    <use id=\"EDGES-l4-o1\"  xlink:href=\"#sticker\" transform=\"translate(4.3,5.3)\" style=\"fill: limegreen\"/>\n\n    <use id=\"EDGES-l5-o0\" xlink:href=\"#sticker\" transform=\"translate(5.3,7.5)\" style=\"fill: yellow\"/>\n    <use id=\"EDGES-l5-o1\" xlink:href=\"#sticker\" transform=\"translate(7.5,5.3)\" style=\"fill: red\"/>\n\n    <use id=\"EDGES-l6-o0\" xlink:href=\"#sticker\" transform=\"translate(4.3,8.5)\" style=\"fill: yellow\"/>\n    <use id=\"EDGES-l6-o1\" xlink:href=\"#sticker\" transform=\"translate(10.7,5.3)\" style=\"fill: #26f\"/>\n\n    <use id=\"EDGES-l7-o0\"  xlink:href=\"#sticker\" transform=\"translate(3.3,7.5)\" style=\"fill: yellow\"/>\n    <use id=\"EDGES-l7-o1\"  xlink:href=\"#sticker\" transform=\"translate(1.1,5.3)\" style=\"fill: orange\"/>\n\n    <use id=\"EDGES-l8-o0\"  xlink:href=\"#sticker\" transform=\"translate(5.3,4.3)\" style=\"fill: limegreen\"/>\n    <use id=\"EDGES-l8-o1\"  xlink:href=\"#sticker\" transform=\"translate(6.5,4.3)\" style=\"fill: red\"/>\n\n    <use id=\"EDGES-l9-o0\"  xlink:href=\"#sticker\" transform=\"translate(3.3,4.3)\" style=\"fill: limegreen\"/>\n    <use id=\"EDGES-l9-o1\"  xlink:href=\"#sticker\" transform=\"translate(2.1,4.3)\" style=\"fill: orange\"/>\n\n    <use id=\"EDGES-l10-o0\" xlink:href=\"#sticker\" transform=\"translate(9.7,4.3)\" style=\"fill: #26f\"/>\n    <use id=\"EDGES-l10-o1\" xlink:href=\"#sticker\" transform=\"translate(8.5,4.3)\" style=\"fill: red\"/>\n\n    <use id=\"EDGES-l11-o0\" xlink:href=\"#sticker\" transform=\"translate(11.7,4.3)\" style=\"fill: #26f\"/>\n    <use id=\"EDGES-l11-o1\" xlink:href=\"#sticker\" transform=\"translate(0.1,4.3)\" style=\"fill: orange\"/>\n\n    <!-- CENTERS -->\n    <!-- TODO: Allow the same sticker to be reused for multiple orientations -->\n    <use id=\"CENTERS-l0-o0\" xlink:href=\"#sticker\" transform=\"translate(4.3,1.1)\" style=\"fill: white\"/>\n    <use id=\"CENTERS-l0-o1\" xlink:href=\"#sticker\" transform=\"translate(4.3,1.1)\" style=\"fill: white\"/>\n    <use id=\"CENTERS-l0-o2\" xlink:href=\"#sticker\" transform=\"translate(4.3,1.1)\" style=\"fill: white\"/>\n    <use id=\"CENTERS-l0-o3\" xlink:href=\"#sticker\" transform=\"translate(4.3,1.1)\" style=\"fill: white\"/>\n\n    <use id=\"CENTERS-l1-o0\" xlink:href=\"#sticker\" transform=\"translate(1.1,4.3)\" style=\"fill: orange\"/>\n    <use id=\"CENTERS-l1-o1\" xlink:href=\"#sticker\" transform=\"translate(1.1,4.3)\" style=\"fill: orange\"/>\n    <use id=\"CENTERS-l1-o2\" xlink:href=\"#sticker\" transform=\"translate(1.1,4.3)\" style=\"fill: orange\"/>\n    <use id=\"CENTERS-l1-o3\" xlink:href=\"#sticker\" transform=\"translate(1.1,4.3)\" style=\"fill: orange\"/>\n\n    <use id=\"CENTERS-l2-o0\" xlink:href=\"#sticker\" transform=\"translate(4.3,4.3)\" style=\"fill: limegreen\"/>\n    <use id=\"CENTERS-l2-o1\" xlink:href=\"#sticker\" transform=\"translate(4.3,4.3)\" style=\"fill: limegreen\"/>\n    <use id=\"CENTERS-l2-o2\" xlink:href=\"#sticker\" transform=\"translate(4.3,4.3)\" style=\"fill: limegreen\"/>\n    <use id=\"CENTERS-l2-o3\" xlink:href=\"#sticker\" transform=\"translate(4.3,4.3)\" style=\"fill: limegreen\"/>\n\n    <use id=\"CENTERS-l3-o0\" xlink:href=\"#sticker\" transform=\"translate(7.5,4.3)\" style=\"fill: red\"/>\n    <use id=\"CENTERS-l3-o1\" xlink:href=\"#sticker\" transform=\"translate(7.5,4.3)\" style=\"fill: red\"/>\n    <use id=\"CENTERS-l3-o2\" xlink:href=\"#sticker\" transform=\"translate(7.5,4.3)\" style=\"fill: red\"/>\n    <use id=\"CENTERS-l3-o3\" xlink:href=\"#sticker\" transform=\"translate(7.5,4.3)\" style=\"fill: red\"/>\n\n    <use id=\"CENTERS-l4-o0\" xlink:href=\"#sticker\" transform=\"translate(10.7,4.3)\" style=\"fill: #26f\"/>\n    <use id=\"CENTERS-l4-o1\" xlink:href=\"#sticker\" transform=\"translate(10.7,4.3)\" style=\"fill: #26f\"/>\n    <use id=\"CENTERS-l4-o2\" xlink:href=\"#sticker\" transform=\"translate(10.7,4.3)\" style=\"fill: #26f\"/>\n    <use id=\"CENTERS-l4-o3\" xlink:href=\"#sticker\" transform=\"translate(10.7,4.3)\" style=\"fill: #26f\"/>\n\n    <use id=\"CENTERS-l5-o0\" xlink:href=\"#sticker\" transform=\"translate(4.3,7.5)\" style=\"fill: yellow\"/>\n    <use id=\"CENTERS-l5-o1\" xlink:href=\"#sticker\" transform=\"translate(4.3,7.5)\" style=\"fill: yellow\"/>\n    <use id=\"CENTERS-l5-o2\" xlink:href=\"#sticker\" transform=\"translate(4.3,7.5)\" style=\"fill: yellow\"/>\n    <use id=\"CENTERS-l5-o3\" xlink:href=\"#sticker\" transform=\"translate(4.3,7.5)\" style=\"fill: yellow\"/>\n  </g>\n\n</svg>`;\n", "export default `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<svg width=\"256px\" height=\"256px\" viewBox=\"0 0 256 256\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n  <title>3x3x3 LL</title>\n  <defs>\n    <g id=\"sticker\">\n        <rect x=\"-10\" y=\"-10\" width=\"1\" height=\"1\" stroke=\"black\" stroke-width=\"0.04px\" />\n    </g>\n  </defs>\n  <g id=\"3x3x3-LL\" stroke=\"none\" stroke-width=\"4\" style=\"none\" stroke-linejoin=\"round\">\n    <rect id=\"CENTERS-l0-o0\" stroke=\"#000000\" style=\"fill: #FFFFFF\" x=\"96\" y=\"96\" width=\"64\" height=\"64\"></rect>\n    <rect id=\"CENTERS-l0-o1\" stroke=\"#000000\" style=\"fill: #FFFFFF\" x=\"96\" y=\"96\" width=\"64\" height=\"64\"></rect>\n    <rect id=\"CENTERS-l0-o2\" stroke=\"#000000\" style=\"fill: #FFFFFF\" x=\"96\" y=\"96\" width=\"64\" height=\"64\"></rect>\n    <rect id=\"CENTERS-l0-o3\" stroke=\"#000000\" style=\"fill: #FFFFFF\" x=\"96\" y=\"96\" width=\"64\" height=\"64\"></rect>\n\n    <rect    id=\"CORNERS-l0-o0\" stroke=\"#000000\" style=\"fill: #FFFFFF\" x=\"160\" y=\"160\" width=\"64\" height=\"64\"></rect>\n    <polygon id=\"CORNERS-l0-o1\" stroke=\"#000000\" style=\"fill: #FF0000\" points=\"224 160 252 160 252 252 224 224\"></polygon>\n    <polygon id=\"CORNERS-l0-o2\" stroke=\"#000000\" style=\"fill: #00FF00\" transform=\"translate(206, 238) scale(1, -1) rotate(-90) translate(-206, -238) \" points=\"192 192 220 192 220 284 192 256\"></polygon>\n    <rect    id=\"CORNERS-l1-o0\" stroke=\"#000000\" style=\"fill: #FFFFFF\" x=\"160\" y=\"32\" width=\"64\" height=\"64\"></rect>\n    <polygon id=\"CORNERS-l1-o1\" stroke=\"#000000\" style=\"fill: #0000FF\" transform=\"translate(206, 18) rotate(-90) translate(-206, -18) \" points=\"192 -28 220 -28 220 64 192 36\"></polygon>\n    <polygon id=\"CORNERS-l1-o2\" stroke=\"#000000\" style=\"fill: #FF0000\" transform=\"translate(238, 50) scale(1, -1) translate(-238, -50) \" points=\"224 4 252 4 252 96 224 68\"></polygon>\n    <rect    id=\"CORNERS-l2-o0\" stroke=\"#000000\" style=\"fill: #FFFFFF\" x=\"32\" y=\"32\" width=\"64\" height=\"64\"></rect>\n    <polygon id=\"CORNERS-l2-o1\" stroke=\"#000000\" style=\"fill: #FF7F00\" transform=\"translate(18, 50) scale(-1, -1) translate(-18, -50) \" points=\"4 4 32 4 32 96 4 68\"></polygon>\n    <polygon id=\"CORNERS-l2-o2\" stroke=\"#000000\" style=\"fill: #0000FF\" transform=\"translate(50, 18) scale(1, -1) rotate(90) translate(-50, -18) \" points=\"36 -28 64 -28 64 64 36 36\"></polygon>\n    <rect    id=\"CORNERS-l3-o0\" stroke=\"#000000\" style=\"fill: #FFFFFF\" x=\"32\" y=\"160\" width=\"64\" height=\"64\"></rect>\n    <polygon id=\"CORNERS-l3-o1\" stroke=\"#000000\" style=\"fill: #00FF00\" transform=\"translate(50, 238) rotate(90) translate(-50, -238) \" points=\"36 192 64 192 64 284 36 256\"></polygon>\n    <polygon id=\"CORNERS-l3-o2\" stroke=\"#000000\" style=\"fill: #FF7F00\" transform=\"translate(18, 206) scale(-1, 1) translate(-18, -206) \" points=\"4 160 32 160 32 252 4 224\"></polygon>\n\n    <rect id=\"EDGES-l0-o0\" stroke=\"#000000\" style=\"fill: #FFFFFF\" x=\"96\" y=\"160\" width=\"64\" height=\"64\"></rect>\n    <rect id=\"EDGES-l0-o1\" stroke=\"#000000\" style=\"fill: #00FF00\" transform=\"translate(128, 238) scale(1, -1) rotate(90) translate(-128, -238) \" x=\"114\" y=\"206\" width=\"28\" height=\"64\"></rect>\n    <rect id=\"EDGES-l1-o0\" stroke=\"#000000\" style=\"fill: #FFFFFF\" x=\"160\" y=\"96\" width=\"64\" height=\"64\"></rect>\n    <rect id=\"EDGES-l1-o1\" stroke=\"#000000\" style=\"fill: #FF0000\" x=\"224\" y=\"96\" width=\"28\" height=\"64\"></rect>\n    <rect id=\"EDGES-l2-o0\" stroke=\"#000000\" style=\"fill: #FFFFFF\" x=\"96\" y=\"32\" width=\"64\" height=\"64\"></rect>\n    <rect id=\"EDGES-l2-o1\" stroke=\"#000000\" style=\"fill: #0000FF\" transform=\"translate(128, 18) scale(1, -1) rotate(90) translate(-128, -18) \" x=\"114\" y=\"-14\" width=\"28\" height=\"64\"></rect>\n    <rect id=\"EDGES-l3-o0\" stroke=\"#000000\" style=\"fill: #FFFFFF\" x=\"32\" y=\"96\" width=\"64\" height=\"64\"></rect>\n    <rect id=\"EDGES-l3-o1\" stroke=\"#000000\" style=\"fill: #FF7F00\" x=\"4\" y=\"96\" width=\"28\" height=\"64\"></rect>\n\n  </g>\n  <g style=\"opacity: 0\">\n    <!-- CORNERS -->\n    <use id=\"CORNERS-l4-o0\" xlink:href=\"#sticker\" style=\"fill: yellow\"/>\n    <use id=\"CORNERS-l4-o1\" xlink:href=\"#sticker\" style=\"fill: limegreen\"/>\n    <use id=\"CORNERS-l4-o2\" xlink:href=\"#sticker\" style=\"fill: red\"/>\n\n    <use id=\"CORNERS-l5-o0\" xlink:href=\"#sticker\" style=\"fill: yellow\"/>\n    <use id=\"CORNERS-l5-o1\" xlink:href=\"#sticker\" style=\"fill: orange\"/>\n    <use id=\"CORNERS-l5-o2\" xlink:href=\"#sticker\" style=\"fill: limegreen\"/>\n\n    <use id=\"CORNERS-l6-o0\" xlink:href=\"#sticker\" style=\"fill: yellow\"/>\n    <use id=\"CORNERS-l6-o1\" xlink:href=\"#sticker\" style=\"fill: #26f\"/>\n    <use id=\"CORNERS-l6-o2\" xlink:href=\"#sticker\"  style=\"fill: orange\"/>\n\n    <use id=\"CORNERS-l7-o0\" xlink:href=\"#sticker\" style=\"fill: yellow\"/>\n    <use id=\"CORNERS-l7-o1\" xlink:href=\"#sticker\" style=\"fill: red\"/>\n    <use id=\"CORNERS-l7-o2\" xlink:href=\"#sticker\" style=\"fill: #26f\"/>\n\n    <!-- EDGES -->\n    <use id=\"EDGES-l4-o0\"  xlink:href=\"#sticker\" style=\"fill: yellow\"/>\n    <use id=\"EDGES-l4-o1\"  xlink:href=\"#sticker\" style=\"fill: limegreen\"/>\n\n    <use id=\"EDGES-l5-o0\" xlink:href=\"#sticker\" style=\"fill: yellow\"/>\n    <use id=\"EDGES-l5-o1\" xlink:href=\"#sticker\" style=\"fill: red\"/>\n\n    <use id=\"EDGES-l6-o0\" xlink:href=\"#sticker\" style=\"fill: yellow\"/>\n    <use id=\"EDGES-l6-o1\" xlink:href=\"#sticker\" style=\"fill: #26f\"/>\n\n    <use id=\"EDGES-l7-o0\"  xlink:href=\"#sticker\" style=\"fill: yellow\"/>\n    <use id=\"EDGES-l7-o1\"  xlink:href=\"#sticker\" style=\"fill: orange\"/>\n\n    <use id=\"EDGES-l8-o0\"  xlink:href=\"#sticker\" style=\"fill: limegreen\"/>\n    <use id=\"EDGES-l8-o1\"  xlink:href=\"#sticker\" style=\"fill: red\"/>\n\n    <use id=\"EDGES-l9-o0\"  xlink:href=\"#sticker\" style=\"fill: limegreen\"/>\n    <use id=\"EDGES-l9-o1\"  xlink:href=\"#sticker\" style=\"fill: orange\"/>\n\n    <use id=\"EDGES-l10-o0\" xlink:href=\"#sticker\" style=\"fill: #26f\"/>\n    <use id=\"EDGES-l10-o1\" xlink:href=\"#sticker\" style=\"fill: red\"/>\n\n    <use id=\"EDGES-l11-o0\" xlink:href=\"#sticker\" style=\"fill: #26f\"/>\n    <use id=\"EDGES-l11-o1\" xlink:href=\"#sticker\" style=\"fill: orange\"/>\n\n    <!-- CENTERS -->\n    <!-- TODO: Allow the same sticker to be reused for multiple orientations -->\n    <use id=\"CENTERS-l1-o0\" xlink:href=\"#sticker\" style=\"fill: orange\"/>\n    <use id=\"CENTERS-l1-o1\" xlink:href=\"#sticker\" style=\"fill: orange\"/>\n    <use id=\"CENTERS-l1-o2\" xlink:href=\"#sticker\" style=\"fill: orange\"/>\n    <use id=\"CENTERS-l1-o3\" xlink:href=\"#sticker\" style=\"fill: orange\"/>\n\n    <use id=\"CENTERS-l2-o0\" xlink:href=\"#sticker\" style=\"fill: limegreen\"/>\n    <use id=\"CENTERS-l2-o1\" xlink:href=\"#sticker\" style=\"fill: limegreen\"/>\n    <use id=\"CENTERS-l2-o2\" xlink:href=\"#sticker\" style=\"fill: limegreen\"/>\n    <use id=\"CENTERS-l2-o3\" xlink:href=\"#sticker\" style=\"fill: limegreen\"/>\n\n    <use id=\"CENTERS-l3-o0\" xlink:href=\"#sticker\" style=\"fill: red\"/>\n    <use id=\"CENTERS-l3-o1\" xlink:href=\"#sticker\" style=\"fill: red\"/>\n    <use id=\"CENTERS-l3-o2\" xlink:href=\"#sticker\" style=\"fill: red\"/>\n    <use id=\"CENTERS-l3-o3\" xlink:href=\"#sticker\" style=\"fill: red\"/>\n\n    <use id=\"CENTERS-l4-o0\" xlink:href=\"#sticker\" style=\"fill: #26f\"/>\n    <use id=\"CENTERS-l4-o1\" xlink:href=\"#sticker\" style=\"fill: #26f\"/>\n    <use id=\"CENTERS-l4-o2\" xlink:href=\"#sticker\" style=\"fill: #26f\"/>\n    <use id=\"CENTERS-l4-o3\" xlink:href=\"#sticker\" style=\"fill: #26f\"/>\n\n    <use id=\"CENTERS-l5-o0\" xlink:href=\"#sticker\" style=\"fill: yellow\"/>\n    <use id=\"CENTERS-l5-o1\" xlink:href=\"#sticker\" style=\"fill: yellow\"/>\n    <use id=\"CENTERS-l5-o2\" xlink:href=\"#sticker\" style=\"fill: yellow\"/>\n    <use id=\"CENTERS-l5-o3\" xlink:href=\"#sticker\" style=\"fill: yellow\"/>\n  </g>\n</svg>`;\n", "export default `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.0//EN\"\n       \"http://www.w3.org/TR/2001/REC-SVG-20050904/DTD/svg11.dtd\">\n<svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" viewBox=\"0 0 506 440\" preserveAspectRatio=\"xMidYMid meet\">\n  <defs>\n  </defs>\n  <title>pyraminx</title>\n  <defs>\n    <g id=\"stickerA\" transform=\"scale(1, 0.577350269)\">\n      <path\n         d=\"m 0,1.732050808 1,-1.732050808 1,1.732050808 z\"\n         stroke=\"black\" stroke-width=\"0.04px\" stroke-linecap=\"butt\" stroke-linejoin=\"round\"\n      />\n    </g>\n    <g id=\"stickerV\" transform=\"scale(1, 0.577350269)\">\n      <path\n         d=\"m 0,0 1,1.732050808 1,-1.732050808 z\"\n         stroke=\"black\" stroke-width=\"0.04px\" stroke-linecap=\"butt\" stroke-linejoin=\"round\"\n      />\n    </g>\n  </defs>\n\n<!--        0 1 2 3 4 5 6 7 8 9 10   -->\n<!--        | | | | | | | | | | |    -->\n<!--    0 - L L L L L F R R R R R    -->\n<!--    1 -   L L L F F F R R R      -->\n<!--    2 -     L F F F F F R        -->\n<!--    3 -       D D D D D          -->\n<!--    4 -         D D D            -->\n<!--    5 -           D              -->\n\n  <g id=\"puzzle\" transform=\"translate(5, 5) scale(40, 69.28203232)\">\n    <!-- CENTERS -->\n    <use id=\"CENTERS-l0-o0\" xlink:href=\"#stickerV\" transform=\"translate(5.2, 1.066666667)\" style=\"fill: limegreen\"/>\n    <use id=\"CENTERS-l0-o1\" xlink:href=\"#stickerA\" transform=\"translate(3, 0)\" style=\"fill: red\"/>\n    <use id=\"CENTERS-l0-o2\" xlink:href=\"#stickerA\" transform=\"translate(7.4, 0)\" style=\"fill: blue\"/>\n\n    <use id=\"CENTERS-l1-o0\" xlink:href=\"#stickerV\" transform=\"translate(4.2, 2.066666667)\" style=\"fill: limegreen\"/>\n    <use id=\"CENTERS-l1-o1\" xlink:href=\"#stickerA\" transform=\"translate(4.2, 3.2)\" style=\"fill: yellow\"/>\n    <use id=\"CENTERS-l1-o2\" xlink:href=\"#stickerA\" transform=\"translate(2, 1)\" style=\"fill: red\"/>\n\n    <use id=\"CENTERS-l2-o0\" xlink:href=\"#stickerV\" transform=\"translate(6.2, 2.066666667)\" style=\"fill: limegreen\"/>\n    <use id=\"CENTERS-l2-o1\" xlink:href=\"#stickerA\" transform=\"translate(8.4, 1)\" style=\"fill: blue\"/>\n    <use id=\"CENTERS-l2-o2\" xlink:href=\"#stickerA\" transform=\"translate(6.2, 3.2)\" style=\"fill: yellow\"/>\n\n    <use id=\"CENTERS-l3-o0\" xlink:href=\"#stickerA\" transform=\"translate(9.4, 0)\" style=\"fill: blue\"/>\n    <use id=\"CENTERS-l3-o1\" xlink:href=\"#stickerA\" transform=\"translate(1, 0)\" style=\"fill: red\"/>\n    <use id=\"CENTERS-l3-o2\" xlink:href=\"#stickerA\" transform=\"translate(5.2, 4.2)\" style=\"fill: yellow\"/>\n\n    <!-- TIPS -->\n    <use id=\"TIPS-l0-o0\" xlink:href=\"#stickerA\" transform=\"translate(5.2, 0.066666667)\" style=\"fill: limegreen\"/>\n    <use id=\"TIPS-l0-o1\" xlink:href=\"#stickerV\" transform=\"translate(4, 0)\" style=\"fill: red\"/>\n    <use id=\"TIPS-l0-o2\" xlink:href=\"#stickerV\" transform=\"translate(6.4, 0)\" style=\"fill: blue\"/>\n\n    <use id=\"TIPS-l1-o0\" xlink:href=\"#stickerA\" transform=\"translate(3.2, 2.066666667)\" style=\"fill: limegreen\"/>\n    <use id=\"TIPS-l1-o1\" xlink:href=\"#stickerV\" transform=\"translate(3.2, 3.2)\" style=\"fill: yellow\"/>\n    <use id=\"TIPS-l1-o2\" xlink:href=\"#stickerV\" transform=\"translate(2, 2)\" style=\"fill: red\"/>\n\n    <use id=\"TIPS-l2-o0\" xlink:href=\"#stickerV\" transform=\"translate(8.4, 2)\" style=\"fill: blue\"/>\n    <use id=\"TIPS-l2-o1\" xlink:href=\"#stickerV\" transform=\"translate(7.2, 3.2)\" style=\"fill: yellow\"/>\n    <use id=\"TIPS-l2-o2\" xlink:href=\"#stickerA\" transform=\"translate(7.2, 2.066666667)\" style=\"fill: limegreen\"/>\n\n    <use id=\"TIPS-l3-o0\" xlink:href=\"#stickerV\" transform=\"translate(10.4,0)\" style=\"fill: blue\"/>\n    <use id=\"TIPS-l3-o1\" xlink:href=\"#stickerV\" transform=\"translate(0, 0)\" style=\"fill: red\"/>\n    <use id=\"TIPS-l3-o2\" xlink:href=\"#stickerV\" transform=\"translate(5.2, 5.2)\" style=\"fill: yellow\"/>\n\n    <!-- EDGES -->\n    <use id=\"EDGES-l0-o0\" xlink:href=\"#stickerA\" transform=\"translate(4.2, 1.066666667)\" style=\"fill: limegreen\"/>\n    <use id=\"EDGES-l0-o1\" xlink:href=\"#stickerV\" transform=\"translate(3, 1)\" style=\"fill: red\"/>\n\n    <use id=\"EDGES-l1-o0\" xlink:href=\"#stickerA\" transform=\"translate(6.2, 1.066666667)\" style=\"fill: limegreen\"/>\n    <use id=\"EDGES-l1-o1\" xlink:href=\"#stickerV\" transform=\"translate(7.4, 1)\" style=\"fill: blue\"/>\n\n    <use id=\"EDGES-l2-o0\" xlink:href=\"#stickerV\" transform=\"translate(8.4, 0)\" style=\"fill: blue\"/>\n    <use id=\"EDGES-l2-o1\" xlink:href=\"#stickerV\" transform=\"translate(2, 0)\" style=\"fill: red\"/>\n\n    <use id=\"EDGES-l3-o0\" xlink:href=\"#stickerV\" transform=\"translate(5.2, 3.2)\" style=\"fill: yellow\"/>\n    <use id=\"EDGES-l3-o1\" xlink:href=\"#stickerA\" transform=\"translate(5.2, 2.066666667)\" style=\"fill: limegreen\"/>\n\n    <use id=\"EDGES-l4-o0\" xlink:href=\"#stickerV\" transform=\"translate(6.2, 4.2)\" style=\"fill: yellow\"/>\n    <use id=\"EDGES-l4-o1\" xlink:href=\"#stickerV\" transform=\"translate(9.4, 1)\" style=\"fill: blue\"/>\n\n    <use id=\"EDGES-l5-o0\" xlink:href=\"#stickerV\" transform=\"translate(4.2, 4.2)\" style=\"fill: yellow\"/>\n    <use id=\"EDGES-l5-o1\" xlink:href=\"#stickerV\" transform=\"translate(1, 1)\" style=\"fill: red\"/>\n  </g>\n\n</svg>`;\n", "export default `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<svg width=\"360px\" height=\"552px\" viewBox=\"0 0 360 552\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n    <!-- Generator: Sketch 59.1 (86144) - https://sketch.com -->\n    <title>sq1-fancy</title>\n    <desc>Created with Sketch.</desc>\n    <!-- stroke=\"none\" -->\n    <g id=\"sq1-fancy\" stroke=\"#888\" stroke-width=\"0.25\" fill=\"none\" fill-rule=\"evenodd\">\n        <g id=\"EQUATOR\" transform=\"translate(24.000000, 264.000000)\">\n            <rect id=\"EQUATOR-l1-o3\" style=\"fill: red\" x=\"168\" y=\"0\" width=\"24\" height=\"24\"></rect>\n            <rect id=\"EQUATOR-l1-o4\" style=\"fill: red\" x=\"192\" y=\"0\" width=\"24\" height=\"24\"></rect>\n            <rect id=\"EQUATOR-l1-o5\" style=\"fill: limegreen\" x=\"216\" y=\"0\" width=\"24\" height=\"24\"></rect>\n            <rect id=\"EQUATOR-l1-o2\" style=\"fill: limegreen\" x=\"240\" y=\"0\" width=\"24\" height=\"24\"></rect>\n            <rect id=\"EQUATOR-l1-o1\" style=\"fill: limegreen\" x=\"264\" y=\"0\" width=\"24\" height=\"24\"></rect>\n            <rect id=\"EQUATOR-l1-o0\" style=\"fill: orange\" x=\"288\" y=\"0\" width=\"24\" height=\"24\"></rect>\n            <rect id=\"EQUATOR-l0-o3\" style=\"fill: orange\" x=\"0\" y=\"0\" width=\"24\" height=\"24\"></rect>\n            <rect id=\"EQUATOR-l0-o4\" style=\"fill: orange\" x=\"24\" y=\"0\" width=\"24\" height=\"24\"></rect>\n            <rect id=\"EQUATOR-l0-o5\" style=\"fill: limegreen\" x=\"48\" y=\"0\" width=\"24\" height=\"24\"></rect>\n            <rect id=\"EQUATOR-l0-o2\" style=\"fill: limegreen\" x=\"72\" y=\"0\" width=\"24\" height=\"24\"></rect>\n            <rect id=\"EQUATOR-l0-o1\" style=\"fill: limegreen\" x=\"96\" y=\"0\" width=\"24\" height=\"24\"></rect>\n            <rect id=\"EQUATOR-l0-o0\" style=\"fill: red\" x=\"120\" y=\"0\" width=\"24\" height=\"24\"></rect>\n        </g>\n        <g id=\"BOTTOM\" transform=\"translate(41.000000, 257.000000)\" stroke-linejoin=\"round\">\n            <g id=\"WEDGES-23\" transform=\"translate(130.000000, 88.588457) rotate(120.000000) translate(-130.000000, -88.588457) translate(82.000000, 22.588457)\">\n                <polygon id=\"WEDGES-l23-o8\" style=\"fill: #D8D8D8\" points=\"25.723 70.277 40.574 95.999 -2.27373675e-13 96\"></polygon>\n                <polygon id=\"WEDGES-l23-o7\" style=\"fill: red\" points=\"70.2768775 96 60.8615612 131.138439 40.5741225 95.9988775\"></polygon>\n                <polygon id=\"WEDGES-l23-o6\" style=\"fill: red\" points=\"70.2768775 96 40.574 95.999 25.7231225 70.2768775\"></polygon>\n                <polygon id=\"WEDGES-l23-o5\" style=\"fill: red\" points=\"48.0001225 47.9995 68.287 47.9995 78.4307806 65.5692194\"></polygon>\n                <polygon id=\"WEDGES-l23-o4\" style=\"fill: red\" points=\"60.8615 35.1385 68.287 47.9995 48 48\"></polygon>\n                <polygon id=\"WEDGES-l23-o3\" style=\"fill: white\" points=\"83.1384388 48 78.4307806 65.5692194 68.2870612 47.9994388\"></polygon>\n                <polygon id=\"WEDGES-l23-o2\" style=\"fill: white\" points=\"83.1384388 48 68.287 47.9995 60.8615612 35.1384388\"></polygon>\n                <polygon id=\"WEDGES-l23-o1\" style=\"fill: white\" points=\"96 0 83.1384388 48 60.8615612 35.1384388\"></polygon>\n                <polygon id=\"WEDGES-l23-o0\" style=\"fill: red\" points=\"70.2768775 96 25.7231225 70.2768775 48.0001225 47.9995 78.4307806 65.5692194\"></polygon>\n            </g>\n            <g id=\"WEDGES-22\" transform=\"translate(97.157677, 115.157677) rotate(90.000000) translate(-97.157677, -115.157677) translate(49.157677, 49.157677)\">\n                <polygon id=\"WEDGES-l22-o8\" style=\"fill: blue\" points=\"25.723 70.277 40.574 95.999 -2.27373675e-13 96\"></polygon>\n                <polygon id=\"WEDGES-l22-o7\" style=\"fill: #D8D8D8\" points=\"70.2768775 96 60.8615612 131.138439 40.5741225 95.9988775\"></polygon>\n                <polygon id=\"WEDGES-l22-o6\" style=\"fill: blue\" points=\"70.2768775 96 40.574 95.999 25.7231225 70.2768775\"></polygon>\n                <polygon id=\"WEDGES-l22-o5\" style=\"fill: blue\" points=\"48.0001225 47.9995 68.287 47.9995 78.4307806 65.5692194\"></polygon>\n                <polygon id=\"WEDGES-l22-o4\" style=\"fill: white\" points=\"60.8615 35.1385 68.287 47.9995 48 48\"></polygon>\n                <polygon id=\"WEDGES-l22-o3\" style=\"fill: blue\" points=\"83.1384388 48 78.4307806 65.5692194 68.2870612 47.9994388\"></polygon>\n                <polygon id=\"WEDGES-l22-o2\" style=\"fill: white\" points=\"83.1384388 48 68.287 47.9995 60.8615612 35.1384388\"></polygon>\n                <polygon id=\"WEDGES-l22-o1\" style=\"fill: white\" points=\"96 0 83.1384388 48 60.8615612 35.1384388\"></polygon>\n                <polygon id=\"WEDGES-l22-o0\" style=\"fill: blue\" points=\"70.2768775 96 25.7231225 70.2768775 48.0001225 47.9995 78.4307806 65.5692194\"></polygon>\n            </g>\n            <g id=\"WEDGES-21\" transform=\"translate(82.000000, 154.588457) rotate(60.000000) translate(-82.000000, -154.588457) translate(34.000000, 88.588457)\">\n                <polygon id=\"WEDGES-l21-o8\" style=\"fill: #D8D8D8\" points=\"25.723 70.277 40.574 95.999 -2.27373675e-13 96\"></polygon>\n                <polygon id=\"WEDGES-l21-o7\" style=\"fill: #D8D8D8\" points=\"70.2768775 96 60.8615612 131.138439 40.5741225 95.9988775\"></polygon>\n                <polygon id=\"WEDGES-l21-o6\" style=\"fill: #D8D8D8\" points=\"70.2768775 96 40.574 95.999 25.7231225 70.2768775\"></polygon>\n                <polygon id=\"WEDGES-l21-o5\" style=\"fill: blue\" points=\"48.0001225 47.9995 68.287 47.9995 78.4307806 65.5692194\"></polygon>\n                <polygon id=\"WEDGES-l21-o4\" style=\"fill: blue\" points=\"60.8615 35.1385 68.287 47.9995 48 48\"></polygon>\n                <polygon id=\"WEDGES-l21-o3\" style=\"fill: blue\" points=\"83.1384388 48 78.4307806 65.5692194 68.2870612 47.9994388\"></polygon>\n                <polygon id=\"WEDGES-l21-o2\" style=\"fill: blue\" points=\"83.1384388 48 68.287 47.9995 60.8615612 35.1384388\"></polygon>\n                <polygon id=\"WEDGES-l21-o1\" style=\"fill: white\" points=\"96 0 83.1384388 48 60.8615612 35.1384388\"></polygon>\n                <polygon id=\"WEDGES-l21-o0\" style=\"fill: blue\" points=\"70.2768775 96 25.7231225 70.2768775 48.0001225 47.9995 78.4307806 65.5692194\"></polygon>\n            </g>\n            <g id=\"WEDGES-20\" transform=\"translate(88.588457, 196.315353) rotate(30.000000) translate(-88.588457, -196.315353) translate(40.588457, 130.315353)\">\n                <polygon id=\"WEDGES-l20-o8\" style=\"fill: #D8D8D8\" points=\"25.723 70.277 40.574 95.999 -2.27373675e-13 96\"></polygon>\n                <polygon id=\"WEDGES-l20-o7\" style=\"fill: blue\" points=\"70.2768775 96 60.8615612 131.138439 40.5741225 95.9988775\"></polygon>\n                <polygon id=\"WEDGES-l20-o6\" style=\"fill: blue\" points=\"70.2768775 96 40.574 95.999 25.7231225 70.2768775\"></polygon>\n                <polygon id=\"WEDGES-l20-o5\" style=\"fill: blue\" points=\"48.0001225 47.9995 68.287 47.9995 78.4307806 65.5692194\"></polygon>\n                <polygon id=\"WEDGES-l20-o4\" style=\"fill: blue\" points=\"60.8615 35.1385 68.287 47.9995 48 48\"></polygon>\n                <polygon id=\"WEDGES-l20-o3\" style=\"fill: white\" points=\"83.1384388 48 78.4307806 65.5692194 68.2870612 47.9994388\"></polygon>\n                <polygon id=\"WEDGES-l20-o2\" style=\"fill: white\" points=\"83.1384388 48 68.287 47.9995 60.8615612 35.1384388\"></polygon>\n                <polygon id=\"WEDGES-l20-o1\" style=\"fill: white\" points=\"96 0 83.1384388 48 60.8615612 35.1384388\"></polygon>\n                <polygon id=\"WEDGES-l20-o0\" style=\"fill: blue\" points=\"70.2768775 96 25.7231225 70.2768775 48.0001225 47.9995 78.4307806 65.5692194\"></polygon>\n            </g>\n            <g id=\"WEDGES-19\" transform=\"translate(67.157677, 163.157677)\">\n                <polygon id=\"WEDGES-l19-o8\" style=\"fill: orange\" points=\"25.723 70.277 40.574 95.999 -2.27373675e-13 96\"></polygon>\n                <polygon id=\"WEDGES-l19-o7\" style=\"fill: #D8D8D8\" points=\"70.2768775 96 60.8615612 131.138439 40.5741225 95.9988775\"></polygon>\n                <polygon id=\"WEDGES-l19-o6\" style=\"fill: orange\" points=\"70.2768775 96 40.574 95.999 25.7231225 70.2768775\"></polygon>\n                <polygon id=\"WEDGES-l19-o5\" style=\"fill: orange\" points=\"48.0001225 47.9995 68.287 47.9995 78.4307806 65.5692194\"></polygon>\n                <polygon id=\"WEDGES-l19-o4\" style=\"fill: white\" points=\"60.8615 35.1385 68.287 47.9995 48 48\"></polygon>\n                <polygon id=\"WEDGES-l19-o3\" style=\"fill: orange\" points=\"83.1384388 48 78.4307806 65.5692194 68.2870612 47.9994388\"></polygon>\n                <polygon id=\"WEDGES-l19-o2\" style=\"fill: white\" points=\"83.1384388 48 68.287 47.9995 60.8615612 35.1384388\"></polygon>\n                <polygon id=\"WEDGES-l19-o1\" style=\"fill: white\" points=\"96 0 83.1384388 48 60.8615612 35.1384388\"></polygon>\n                <polygon id=\"WEDGES-l19-o0\" style=\"fill: orange\" points=\"70.2768775 96 25.7231225 70.2768775 48.0001225 47.9995 78.4307806 65.5692194\"></polygon>\n            </g>\n            <g id=\"WEDGES-18\" transform=\"translate(154.588457, 244.315353) scale(-1, -1) rotate(150.000000) translate(-154.588457, -244.315353) translate(106.588457, 178.315353)\">\n                <polygon id=\"WEDGES-l18-o8\" style=\"fill: #D8D8D8\" points=\"25.723 70.277 40.574 95.999 -2.27373675e-13 96\"></polygon>\n                <polygon id=\"WEDGES-l18-o7\" style=\"fill: #D8D8D8\" points=\"70.2768775 96 60.8615612 131.138439 40.5741225 95.9988775\"></polygon>\n                <polygon id=\"WEDGES-l18-o6\" style=\"fill: #D8D8D8\" points=\"70.2768775 96 40.574 95.999 25.7231225 70.2768775\"></polygon>\n                <polygon id=\"WEDGES-l18-o5\" style=\"fill: orange\" points=\"48.0001225 47.9995 68.287 47.9995 78.4307806 65.5692194\"></polygon>\n                <polygon id=\"WEDGES-l18-o4\" style=\"fill: orange\" points=\"60.8615 35.1385 68.287 47.9995 48 48\"></polygon>\n                <polygon id=\"WEDGES-l18-o3\" style=\"fill: orange\" points=\"83.1384388 48 78.4307806 65.5692194 68.2870612 47.9994388\"></polygon>\n                <polygon id=\"WEDGES-l18-o2\" style=\"fill: orange\" points=\"83.1384388 48 68.287 47.9995 60.8615612 35.1384388\"></polygon>\n                <polygon id=\"WEDGES-l18-o1\" style=\"fill: white\" points=\"96 0 83.1384388 48 60.8615612 35.1384388\"></polygon>\n                <polygon id=\"WEDGES-l18-o0\" style=\"fill: orange\" points=\"70.2768775 96 25.7231225 70.2768775 48.0001225 47.9995 78.4307806 65.5692194\"></polygon>\n            </g>\n            <g id=\"WEDGES-17\" transform=\"translate(196.315353, 237.726896) scale(-1, -1) rotate(120.000000) translate(-196.315353, -237.726896) translate(148.315353, 171.726896)\">\n                <polygon id=\"WEDGES-l17-o8\" style=\"fill: #D8D8D8\" points=\"25.723 70.277 40.574 95.999 -2.27373675e-13 96\"></polygon>\n                <polygon id=\"WEDGES-l17-o7\" style=\"fill: orange\" points=\"70.2768775 96 60.8615612 131.138439 40.5741225 95.9988775\"></polygon>\n                <polygon id=\"WEDGES-l17-o6\" style=\"fill: orange\" points=\"70.2768775 96 40.574 95.999 25.7231225 70.2768775\"></polygon>\n                <polygon id=\"WEDGES-l17-o5\" style=\"fill: orange\" points=\"48.0001225 47.9995 68.287 47.9995 78.4307806 65.5692194\"></polygon>\n                <polygon id=\"WEDGES-l17-o4\" style=\"fill: orange\" points=\"60.8615 35.1385 68.287 47.9995 48 48\"></polygon>\n                <polygon id=\"WEDGES-l17-o3\" style=\"fill: white\" points=\"83.1384388 48 78.4307806 65.5692194 68.2870612 47.9994388\"></polygon>\n                <polygon id=\"WEDGES-l17-o2\" style=\"fill: white\" points=\"83.1384388 48 68.287 47.9995 60.8615612 35.1384388\"></polygon>\n                <polygon id=\"WEDGES-l17-o1\" style=\"fill: white\" points=\"96 0 83.1384388 48 60.8615612 35.1384388\"></polygon>\n                <polygon id=\"WEDGES-l17-o0\" style=\"fill: orange\" points=\"70.2768775 96 25.7231225 70.2768775 48.0001225 47.9995 78.4307806 65.5692194\"></polygon>\n            </g>\n            <g id=\"WEDGES-16\" transform=\"translate(229.157677, 211.157677) scale(-1, -1) rotate(90.000000) translate(-229.157677, -211.157677) translate(181.157677, 145.157677)\">\n                <polygon id=\"WEDGES-l16-o8\" style=\"fill: limegreen\" points=\"25.723 70.277 40.574 95.999 -2.27373675e-13 96\"></polygon>\n                <polygon id=\"WEDGES-l16-o7\" style=\"fill: #D8D8D8\" points=\"70.2768775 96 60.8615612 131.138439 40.5741225 95.9988775\"></polygon>\n                <polygon id=\"WEDGES-l16-o6\" style=\"fill: limegreen\" points=\"70.2768775 96 40.574 95.999 25.7231225 70.2768775\"></polygon>\n                <polygon id=\"WEDGES-l16-o5\" style=\"fill: limegreen\" points=\"48.0001225 47.9995 68.287 47.9995 78.4307806 65.5692194\"></polygon>\n                <polygon id=\"WEDGES-l16-o4\" style=\"fill: white\" points=\"60.8615 35.1385 68.287 47.9995 48 48\"></polygon>\n                <polygon id=\"WEDGES-l16-o3\" style=\"fill: limegreen\" points=\"83.1384388 48 78.4307806 65.5692194 68.2870612 47.9994388\"></polygon>\n                <polygon id=\"WEDGES-l16-o2\" style=\"fill: white\" points=\"83.1384388 48 68.287 47.9995 60.8615612 35.1384388\"></polygon>\n                <polygon id=\"WEDGES-l16-o1\" style=\"fill: white\" points=\"96 0 83.1384388 48 60.8615612 35.1384388\"></polygon>\n                <polygon id=\"WEDGES-l16-o0\" style=\"fill: limegreen\" points=\"70.2768775 96 25.7231225 70.2768775 48.0001225 47.9995 78.4307806 65.5692194\"></polygon>\n            </g>\n            <g id=\"WEDGES-15\" transform=\"translate(244.315353, 171.726896) scale(-1, -1) rotate(60.000000) translate(-244.315353, -171.726896) translate(196.315353, 105.726896)\">\n                <polygon id=\"WEDGES-l15-o8\" style=\"fill: #D8D8D8\" points=\"25.723 70.277 40.574 95.999 -2.27373675e-13 96\"></polygon>\n                <polygon id=\"WEDGES-l15-o7\" style=\"fill: #D8D8D8\" points=\"70.2768775 96 60.8615612 131.138439 40.5741225 95.9988775\"></polygon>\n                <polygon id=\"WEDGES-l15-o6\" style=\"fill: #D8D8D8\" points=\"70.2768775 96 40.574 95.999 25.7231225 70.2768775\"></polygon>\n                <polygon id=\"WEDGES-l15-o5\" style=\"fill: limegreen\" points=\"48.0001225 47.9995 68.287 47.9995 78.4307806 65.5692194\"></polygon>\n                <polygon id=\"WEDGES-l15-o4\" style=\"fill: limegreen\" points=\"60.8615 35.1385 68.287 47.9995 48 48\"></polygon>\n                <polygon id=\"WEDGES-l15-o3\" style=\"fill: limegreen\" points=\"83.1384388 48 78.4307806 65.5692194 68.2870612 47.9994388\"></polygon>\n                <polygon id=\"WEDGES-l15-o2\" style=\"fill: limegreen\" points=\"83.1384388 48 68.287 47.9995 60.8615612 35.1384388\"></polygon>\n                <polygon id=\"WEDGES-l15-o1\" style=\"fill: white\" points=\"96 0 83.1384388 48 60.8615612 35.1384388\"></polygon>\n                <polygon id=\"WEDGES-l15-o0\" style=\"fill: limegreen\" points=\"70.2768775 96 25.7231225 70.2768775 48.0001225 47.9995 78.4307806 65.5692194\"></polygon>\n            </g>\n            <g id=\"WEDGES-14\" transform=\"translate(237.726896, 130.000000) scale(-1, -1) rotate(30.000000) translate(-237.726896, -130.000000) translate(189.726896, 64.000000)\">\n                <polygon id=\"WEDGES-l14-o8\" style=\"fill: #D8D8D8\" points=\"25.723 70.277 40.574 95.999 -2.27373675e-13 96\"></polygon>\n                <polygon id=\"WEDGES-l14-o7\" style=\"fill: limegreen\" points=\"70.2768775 96 60.8615612 131.138439 40.5741225 95.9988775\"></polygon>\n                <polygon id=\"WEDGES-l14-o6\" style=\"fill: limegreen\" points=\"70.2768775 96 40.574 95.999 25.7231225 70.2768775\"></polygon>\n                <polygon id=\"WEDGES-l14-o5\" style=\"fill: limegreen\" points=\"48.0001225 47.9995 68.287 47.9995 78.4307806 65.5692194\"></polygon>\n                <polygon id=\"WEDGES-l14-o4\" style=\"fill: limegreen\" points=\"60.8615 35.1385 68.287 47.9995 48 48\"></polygon>\n                <polygon id=\"WEDGES-l14-o3\" style=\"fill: white\" points=\"83.1384388 48 78.4307806 65.5692194 68.2870612 47.9994388\"></polygon>\n                <polygon id=\"WEDGES-l14-o2\" style=\"fill: white\" points=\"83.1384388 48 68.287 47.9995 60.8615612 35.1384388\"></polygon>\n                <polygon id=\"WEDGES-l14-o1\" style=\"fill: white\" points=\"96 0 83.1384388 48 60.8615612 35.1384388\"></polygon>\n                <polygon id=\"WEDGES-l14-o0\" style=\"fill: limegreen\" points=\"70.2768775 96 25.7231225 70.2768775 48.0001225 47.9995 78.4307806 65.5692194\"></polygon>\n            </g>\n            <g id=\"WEDGES-13\" transform=\"translate(211.157677, 97.157677) scale(-1, -1) translate(-211.157677, -97.157677) translate(163.157677, 31.157677)\">\n                <polygon id=\"WEDGES-l13-o8\" style=\"fill: red\" points=\"25.723 70.277 40.574 95.999 -2.27373675e-13 96\"></polygon>\n                <polygon id=\"WEDGES-l13-o7\" style=\"fill: #D8D8D8\" points=\"70.2768775 96 60.8615612 131.138439 40.5741225 95.9988775\"></polygon>\n                <polygon id=\"WEDGES-l13-o6\" style=\"fill: red\" points=\"70.2768775 96 40.574 95.999 25.7231225 70.2768775\"></polygon>\n                <polygon id=\"WEDGES-l13-o5\" style=\"fill: red\" points=\"48.0001225 47.9995 68.287 47.9995 78.4307806 65.5692194\"></polygon>\n                <polygon id=\"WEDGES-l13-o4\" style=\"fill: white\" points=\"60.8615 35.1385 68.287 47.9995 48 48\"></polygon>\n                <polygon id=\"WEDGES-l13-o3\" style=\"fill: red\" points=\"83.1384388 48 78.4307806 65.5692194 68.2870612 47.9994388\"></polygon>\n                <polygon id=\"WEDGES-l13-o2\" style=\"fill: white\" points=\"83.1384388 48 68.287 47.9995 60.8615612 35.1384388\"></polygon>\n                <polygon id=\"WEDGES-l13-o1\" style=\"fill: white\" points=\"96 0 83.1384388 48 60.8615612 35.1384388\"></polygon>\n                <polygon id=\"WEDGES-l13-o0\" style=\"fill: red\" points=\"70.2768775 96 25.7231225 70.2768775 48.0001225 47.9995 78.4307806 65.5692194\"></polygon>\n            </g>\n            <g id=\"WEDGES-12\" transform=\"translate(171.726896, 82.000000) rotate(150.000000) translate(-171.726896, -82.000000) translate(123.726896, 16.000000)\">\n                <polygon id=\"WEDGES-l12-o8\" style=\"fill: #D8D8D8\" points=\"25.723 70.277 40.574 95.999 -2.27373675e-13 96\"></polygon>\n                <polygon id=\"WEDGES-l12-o7\" style=\"fill: #D8D8D8\" points=\"70.2768775 96 60.8615612 131.138439 40.5741225 95.9988775\"></polygon>\n                <polygon id=\"WEDGES-l12-o6\" style=\"fill: #D8D8D8\" points=\"70.2768775 96 40.574 95.999 25.7231225 70.2768775\"></polygon>\n                <polygon id=\"WEDGES-l12-o5\" style=\"fill: red\" points=\"48.0001225 47.9995 68.287 47.9995 78.4307806 65.5692194\"></polygon>\n                <polygon id=\"WEDGES-l12-o4\" style=\"fill: red\" points=\"60.8615 35.1385 68.287 47.9995 48 48\"></polygon>\n                <polygon id=\"WEDGES-l12-o3\" style=\"fill: red\" points=\"83.1384388 48 78.4307806 65.5692194 68.2870612 47.9994388\"></polygon>\n                <polygon id=\"WEDGES-l12-o2\" style=\"fill: red\" points=\"83.1384388 48 68.287 47.9995 60.8615612 35.1384388\"></polygon>\n                <polygon id=\"WEDGES-l12-o1\" style=\"fill: white\" points=\"96 0 83.1384388 48 60.8615612 35.1384388\"></polygon>\n                <polygon id=\"WEDGES-l12-o0\" style=\"fill: red\" points=\"70.2768775 96 25.7231225 70.2768775 48.0001225 47.9995 78.4307806 65.5692194\"></polygon>\n            </g>\n        </g>\n        <g id=\"TOP\" transform=\"translate(41.000000, -31.000000)\" stroke-linejoin=\"round\">\n            <g id=\"WEDGES-11\" transform=\"translate(154.588457, 244.315353) scale(-1, -1) rotate(150.000000) translate(-154.588457, -244.315353) translate(106.588457, 178.315353)\">\n                <polygon id=\"WEDGES-l11-o8\" style=\"fill: #D8D8D8\" points=\"25.723 70.277 40.574 95.999 -2.27373675e-13 96\"></polygon>\n                <polygon id=\"WEDGES-l11-o7\" style=\"fill: #D8D8D8\" points=\"70.2768775 96 60.8615612 131.138439 40.5741225 95.9988775\"></polygon>\n                <polygon id=\"WEDGES-l11-o6\" style=\"fill: #D8D8D8\" points=\"70.2768775 96 40.574 95.999 25.7231225 70.2768775\"></polygon>\n                <polygon id=\"WEDGES-l11-o5\" style=\"fill: red\" points=\"48.0001225 47.9995 68.287 47.9995 78.4307806 65.5692194\"></polygon>\n                <polygon id=\"WEDGES-l11-o4\" style=\"fill: red\" points=\"60.8615 35.1385 68.287 47.9995 48 48\"></polygon>\n                <polygon id=\"WEDGES-l11-o3\" style=\"fill: red\" points=\"83.1384388 48 78.4307806 65.5692194 68.2870612 47.9994388\"></polygon>\n                <polygon id=\"WEDGES-l11-o2\" style=\"fill: red\" points=\"83.1384388 48 68.287 47.9995 60.8615612 35.1384388\"></polygon>\n                <polygon id=\"WEDGES-l11-o1\" style=\"fill: yellow\" points=\"96 0 83.1384388 48 60.8615612 35.1384388\"></polygon>\n                <polygon id=\"WEDGES-l11-o0\" style=\"fill: red\" points=\"70.2768775 96 25.7231225 70.2768775 48.0001225 47.9995 78.4307806 65.5692194\"></polygon>\n            </g>\n            <g id=\"WEDGES-10\" transform=\"translate(196.315353, 237.726896) scale(-1, -1) rotate(120.000000) translate(-196.315353, -237.726896) translate(148.315353, 171.726896)\">\n                <polygon id=\"WEDGES-l10-o8\" style=\"fill: #D8D8D8\" points=\"25.723 70.277 40.574 95.999 -2.27373675e-13 96\"></polygon>\n                <polygon id=\"WEDGES-l10-o7\" style=\"fill: red\" points=\"70.2768775 96 60.8615612 131.138439 40.5741225 95.9988775\"></polygon>\n                <polygon id=\"WEDGES-l10-o6\" style=\"fill: red\" points=\"70.2768775 96 40.574 95.999 25.7231225 70.2768775\"></polygon>\n                <polygon id=\"WEDGES-l10-o5\" style=\"fill: red\" points=\"48.0001225 47.9995 68.287 47.9995 78.4307806 65.5692194\"></polygon>\n                <polygon id=\"WEDGES-l10-o4\" style=\"fill: red\" points=\"60.8615 35.1385 68.287 47.9995 48 48\"></polygon>\n                <polygon id=\"WEDGES-l10-o3\" style=\"fill: yellow\" points=\"83.1384388 48 78.4307806 65.5692194 68.2870612 47.9994388\"></polygon>\n                <polygon id=\"WEDGES-l10-o2\" style=\"fill: yellow\" points=\"83.1384388 48 68.287 47.9995 60.8615612 35.1384388\"></polygon>\n                <polygon id=\"WEDGES-l10-o1\" style=\"fill: yellow\" points=\"96 0 83.1384388 48 60.8615612 35.1384388\"></polygon>\n                <polygon id=\"WEDGES-l10-o0\" style=\"fill: red\" points=\"70.2768775 96 25.7231225 70.2768775 48.0001225 47.9995 78.4307806 65.5692194\"></polygon>\n            </g>\n            <g id=\"WEDGES-9\" transform=\"translate(229.157677, 211.157677) scale(-1, -1) rotate(90.000000) translate(-229.157677, -211.157677) translate(181.157677, 145.157677)\">\n                <polygon id=\"WEDGES-l9-o8\" style=\"fill: limegreen\" points=\"25.723 70.277 40.574 95.999 -2.27373675e-13 96\"></polygon>\n                <polygon id=\"WEDGES-l9-o7\" style=\"fill: #D8D8D8\" points=\"70.2768775 96 60.8615612 131.138439 40.5741225 95.9988775\"></polygon>\n                <polygon id=\"WEDGES-l9-o6\" style=\"fill: limegreen\" points=\"70.2768775 96 40.574 95.999 25.7231225 70.2768775\"></polygon>\n                <polygon id=\"WEDGES-l9-o5\" style=\"fill: limegreen\" points=\"48.0001225 47.9995 68.287 47.9995 78.4307806 65.5692194\"></polygon>\n                <polygon id=\"WEDGES-l9-o4\" style=\"fill: yellow\" points=\"60.8615 35.1385 68.287 47.9995 48 48\"></polygon>\n                <polygon id=\"WEDGES-l9-o3\" style=\"fill: limegreen\" points=\"83.1384388 48 78.4307806 65.5692194 68.2870612 47.9994388\"></polygon>\n                <polygon id=\"WEDGES-l9-o2\" style=\"fill: yellow\" points=\"83.1384388 48 68.287 47.9995 60.8615612 35.1384388\"></polygon>\n                <polygon id=\"WEDGES-l9-o1\" style=\"fill: yellow\" points=\"96 0 83.1384388 48 60.8615612 35.1384388\"></polygon>\n                <polygon id=\"WEDGES-l9-o0\" style=\"fill: limegreen\" points=\"70.2768775 96 25.7231225 70.2768775 48.0001225 47.9995 78.4307806 65.5692194\"></polygon>\n            </g>\n            <g id=\"WEDGES-8\" transform=\"translate(244.315353, 171.726896) scale(-1, -1) rotate(60.000000) translate(-244.315353, -171.726896) translate(196.315353, 105.726896)\">\n                <polygon id=\"WEDGES-l8-o8\" style=\"fill: #D8D8D8\" points=\"25.723 70.277 40.574 95.999 -2.27373675e-13 96\"></polygon>\n                <polygon id=\"WEDGES-l8-o7\" style=\"fill: #D8D8D8\" points=\"70.2768775 96 60.8615612 131.138439 40.5741225 95.9988775\"></polygon>\n                <polygon id=\"WEDGES-l8-o6\" style=\"fill: #D8D8D8\" points=\"70.2768775 96 40.574 95.999 25.7231225 70.2768775\"></polygon>\n                <polygon id=\"WEDGES-l8-o5\" style=\"fill: limegreen\" points=\"48.0001225 47.9995 68.287 47.9995 78.4307806 65.5692194\"></polygon>\n                <polygon id=\"WEDGES-l8-o4\" style=\"fill: limegreen\" points=\"60.8615 35.1385 68.287 47.9995 48 48\"></polygon>\n                <polygon id=\"WEDGES-l8-o3\" style=\"fill: limegreen\" points=\"83.1384388 48 78.4307806 65.5692194 68.2870612 47.9994388\"></polygon>\n                <polygon id=\"WEDGES-l8-o2\" style=\"fill: limegreen\" points=\"83.1384388 48 68.287 47.9995 60.8615612 35.1384388\"></polygon>\n                <polygon id=\"WEDGES-l8-o1\" style=\"fill: yellow\" points=\"96 0 83.1384388 48 60.8615612 35.1384388\"></polygon>\n                <polygon id=\"WEDGES-l8-o0\" style=\"fill: limegreen\" points=\"70.2768775 96 25.7231225 70.2768775 48.0001225 47.9995 78.4307806 65.5692194\"></polygon>\n            </g>\n            <g id=\"WEDGES-7\" transform=\"translate(237.726896, 130.000000) scale(-1, -1) rotate(30.000000) translate(-237.726896, -130.000000) translate(189.726896, 64.000000)\">\n                <polygon id=\"WEDGES-l7-o8\" style=\"fill: #D8D8D8\" points=\"25.723 70.277 40.574 95.999 -2.27373675e-13 96\"></polygon>\n                <polygon id=\"WEDGES-l7-o7\" style=\"fill: limegreen\" points=\"70.2768775 96 60.8615612 131.138439 40.5741225 95.9988775\"></polygon>\n                <polygon id=\"WEDGES-l7-o6\" style=\"fill: limegreen\" points=\"70.2768775 96 40.574 95.999 25.7231225 70.2768775\"></polygon>\n                <polygon id=\"WEDGES-l7-o5\" style=\"fill: limegreen\" points=\"48.0001225 47.9995 68.287 47.9995 78.4307806 65.5692194\"></polygon>\n                <polygon id=\"WEDGES-l7-o4\" style=\"fill: limegreen\" points=\"60.8615 35.1385 68.287 47.9995 48 48\"></polygon>\n                <polygon id=\"WEDGES-l7-o3\" style=\"fill: yellow\" points=\"83.1384388 48 78.4307806 65.5692194 68.2870612 47.9994388\"></polygon>\n                <polygon id=\"WEDGES-l7-o2\" style=\"fill: yellow\" points=\"83.1384388 48 68.287 47.9995 60.8615612 35.1384388\"></polygon>\n                <polygon id=\"WEDGES-l7-o1\" style=\"fill: yellow\" points=\"96 0 83.1384388 48 60.8615612 35.1384388\"></polygon>\n                <polygon id=\"WEDGES-l7-o0\" style=\"fill: limegreen\" points=\"70.2768775 96 25.7231225 70.2768775 48.0001225 47.9995 78.4307806 65.5692194\"></polygon>\n            </g>\n            <g id=\"WEDGES-6\" transform=\"translate(211.157677, 97.157677) scale(-1, -1) translate(-211.157677, -97.157677) translate(163.157677, 31.157677)\">\n                <polygon id=\"WEDGES-l6-o8\" style=\"fill: orange\" points=\"25.723 70.277 40.574 95.999 -2.27373675e-13 96\"></polygon>\n                <polygon id=\"WEDGES-l6-o7\" style=\"fill: #D8D8D8\" points=\"70.2768775 96 60.8615612 131.138439 40.5741225 95.9988775\"></polygon>\n                <polygon id=\"WEDGES-l6-o6\" style=\"fill: orange\" points=\"70.2768775 96 40.574 95.999 25.7231225 70.2768775\"></polygon>\n                <polygon id=\"WEDGES-l6-o5\" style=\"fill: orange\" points=\"48.0001225 47.9995 68.287 47.9995 78.4307806 65.5692194\"></polygon>\n                <polygon id=\"WEDGES-l6-o4\" style=\"fill: yellow\" points=\"60.8615 35.1385 68.287 47.9995 48 48\"></polygon>\n                <polygon id=\"WEDGES-l6-o3\" style=\"fill: orange\" points=\"83.1384388 48 78.4307806 65.5692194 68.2870612 47.9994388\"></polygon>\n                <polygon id=\"WEDGES-l6-o2\" style=\"fill: yellow\" points=\"83.1384388 48 68.287 47.9995 60.8615612 35.1384388\"></polygon>\n                <polygon id=\"WEDGES-l6-o1\" style=\"fill: yellow\" points=\"96 0 83.1384388 48 60.8615612 35.1384388\"></polygon>\n                <polygon id=\"WEDGES-l6-o0\" style=\"fill: orange\" points=\"70.2768775 96 25.7231225 70.2768775 48.0001225 47.9995 78.4307806 65.5692194\"></polygon>\n            </g>\n            <g id=\"WEDGES-5\" transform=\"translate(171.726896, 82.000000) rotate(150.000000) translate(-171.726896, -82.000000) translate(123.726896, 16.000000)\">\n                <polygon id=\"WEDGES-l5-o8\" style=\"fill: #D8D8D8\" points=\"25.723 70.277 40.574 95.999 -2.27373675e-13 96\"></polygon>\n                <polygon id=\"WEDGES-l5-o7\" style=\"fill: #D8D8D8\" points=\"70.2768775 96 60.8615612 131.138439 40.5741225 95.9988775\"></polygon>\n                <polygon id=\"WEDGES-l5-o6\" style=\"fill: #D8D8D8\" points=\"70.2768775 96 40.574 95.999 25.7231225 70.2768775\"></polygon>\n                <polygon id=\"WEDGES-l5-o5\" style=\"fill: orange\" points=\"48.0001225 47.9995 68.287 47.9995 78.4307806 65.5692194\"></polygon>\n                <polygon id=\"WEDGES-l5-o4\" style=\"fill: orange\" points=\"60.8615 35.1385 68.287 47.9995 48 48\"></polygon>\n                <polygon id=\"WEDGES-l5-o3\" style=\"fill: orange\" points=\"83.1384388 48 78.4307806 65.5692194 68.2870612 47.9994388\"></polygon>\n                <polygon id=\"WEDGES-l5-o2\" style=\"fill: orange\" points=\"83.1384388 48 68.287 47.9995 60.8615612 35.1384388\"></polygon>\n                <polygon id=\"WEDGES-l5-o1\" style=\"fill: yellow\" points=\"96 0 83.1384388 48 60.8615612 35.1384388\"></polygon>\n                <polygon id=\"WEDGES-l5-o0\" style=\"fill: orange\" points=\"70.2768775 96 25.7231225 70.2768775 48.0001225 47.9995 78.4307806 65.5692194\"></polygon>\n            </g>\n            <g id=\"WEDGES-4\" transform=\"translate(130.000000, 88.588457) rotate(120.000000) translate(-130.000000, -88.588457) translate(82.000000, 22.588457)\">\n                <polygon id=\"WEDGES-l4-o8\" style=\"fill: #D8D8D8\" points=\"25.723 70.277 40.574 95.999 -2.27373675e-13 96\"></polygon>\n                <polygon id=\"WEDGES-l4-o7\" style=\"fill: orange\" points=\"70.2768775 96 60.8615612 131.138439 40.5741225 95.9988775\"></polygon>\n                <polygon id=\"WEDGES-l4-o6\" style=\"fill: orange\" points=\"70.2768775 96 40.574 95.999 25.7231225 70.2768775\"></polygon>\n                <polygon id=\"WEDGES-l4-o5\" style=\"fill: orange\" points=\"48.0001225 47.9995 68.287 47.9995 78.4307806 65.5692194\"></polygon>\n                <polygon id=\"WEDGES-l4-o4\" style=\"fill: orange\" points=\"60.8615 35.1385 68.287 47.9995 48 48\"></polygon>\n                <polygon id=\"WEDGES-l4-o3\" style=\"fill: yellow\" points=\"83.1384388 48 78.4307806 65.5692194 68.2870612 47.9994388\"></polygon>\n                <polygon id=\"WEDGES-l4-o2\" style=\"fill: yellow\" points=\"83.1384388 48 68.287 47.9995 60.8615612 35.1384388\"></polygon>\n                <polygon id=\"WEDGES-l4-o1\" style=\"fill: yellow\" points=\"96 0 83.1384388 48 60.8615612 35.1384388\"></polygon>\n                <polygon id=\"WEDGES-l4-o0\" style=\"fill: orange\" points=\"70.2768775 96 25.7231225 70.2768775 48.0001225 47.9995 78.4307806 65.5692194\"></polygon>\n            </g>\n            <g id=\"WEDGES-3\" transform=\"translate(97.157677, 115.157677) rotate(90.000000) translate(-97.157677, -115.157677) translate(49.157677, 49.157677)\">\n                <polygon id=\"WEDGES-l3-o8\" style=\"fill: blue\" points=\"25.723 70.277 40.574 95.999 -2.27373675e-13 96\"></polygon>\n                <polygon id=\"WEDGES-l3-o7\" style=\"fill: #D8D8D8\" points=\"70.2768775 96 60.8615612 131.138439 40.5741225 95.9988775\"></polygon>\n                <polygon id=\"WEDGES-l3-o6\" style=\"fill: blue\" points=\"70.2768775 96 40.574 95.999 25.7231225 70.2768775\"></polygon>\n                <polygon id=\"WEDGES-l3-o5\" style=\"fill: blue\" points=\"48.0001225 47.9995 68.287 47.9995 78.4307806 65.5692194\"></polygon>\n                <polygon id=\"WEDGES-l3-o4\" style=\"fill: yellow\" points=\"60.8615 35.1385 68.287 47.9995 48 48\"></polygon>\n                <polygon id=\"WEDGES-l3-o3\" style=\"fill: blue\" points=\"83.1384388 48 78.4307806 65.5692194 68.2870612 47.9994388\"></polygon>\n                <polygon id=\"WEDGES-l3-o2\" style=\"fill: yellow\" points=\"83.1384388 48 68.287 47.9995 60.8615612 35.1384388\"></polygon>\n                <polygon id=\"WEDGES-l3-o1\" style=\"fill: yellow\" points=\"96 0 83.1384388 48 60.8615612 35.1384388\"></polygon>\n                <polygon id=\"WEDGES-l3-o0\" style=\"fill: blue\" points=\"70.2768775 96 25.7231225 70.2768775 48.0001225 47.9995 78.4307806 65.5692194\"></polygon>\n            </g>\n            <g id=\"WEDGES-2\" transform=\"translate(82.000000, 154.588457) rotate(60.000000) translate(-82.000000, -154.588457) translate(34.000000, 88.588457)\">\n                <polygon id=\"WEDGES-l2-o8\" style=\"fill: #D8D8D8\" points=\"25.723 70.277 40.574 95.999 -2.27373675e-13 96\"></polygon>\n                <polygon id=\"WEDGES-l2-o7\" style=\"fill: #D8D8D8\" points=\"70.2768775 96 60.8615612 131.138439 40.5741225 95.9988775\"></polygon>\n                <polygon id=\"WEDGES-l2-o6\" style=\"fill: #D8D8D8\" points=\"70.2768775 96 40.574 95.999 25.7231225 70.2768775\"></polygon>\n                <polygon id=\"WEDGES-l2-o5\" style=\"fill: blue\" points=\"48.0001225 47.9995 68.287 47.9995 78.4307806 65.5692194\"></polygon>\n                <polygon id=\"WEDGES-l2-o4\" style=\"fill: blue\" points=\"60.8615 35.1385 68.287 47.9995 48 48\"></polygon>\n                <polygon id=\"WEDGES-l2-o3\" style=\"fill: blue\" points=\"83.1384388 48 78.4307806 65.5692194 68.2870612 47.9994388\"></polygon>\n                <polygon id=\"WEDGES-l2-o2\" style=\"fill: blue\" points=\"83.1384388 48 68.287 47.9995 60.8615612 35.1384388\"></polygon>\n                <polygon id=\"WEDGES-l2-o1\" style=\"fill: yellow\" points=\"96 0 83.1384388 48 60.8615612 35.1384388\"></polygon>\n                <polygon id=\"WEDGES-l2-o0\" style=\"fill: blue\" points=\"70.2768775 96 25.7231225 70.2768775 48.0001225 47.9995 78.4307806 65.5692194\"></polygon>\n            </g>\n            <g id=\"WEDGES-1\" transform=\"translate(88.588457, 196.315353) rotate(30.000000) translate(-88.588457, -196.315353) translate(40.588457, 130.315353)\">\n                <polygon id=\"WEDGES-l1-o8\" style=\"fill: #D8D8D8\" points=\"25.723 70.277 40.574 95.999 -2.27373675e-13 96\"></polygon>\n                <polygon id=\"WEDGES-l1-o7\" style=\"fill: blue\" points=\"70.2768775 96 60.8615612 131.138439 40.5741225 95.9988775\"></polygon>\n                <polygon id=\"WEDGES-l1-o6\" style=\"fill: blue\" points=\"70.2768775 96 40.574 95.999 25.7231225 70.2768775\"></polygon>\n                <polygon id=\"WEDGES-l1-o5\" style=\"fill: blue\" points=\"48.0001225 47.9995 68.287 47.9995 78.4307806 65.5692194\"></polygon>\n                <polygon id=\"WEDGES-l1-o4\" style=\"fill: blue\" points=\"60.8615 35.1385 68.287 47.9995 48 48\"></polygon>\n                <polygon id=\"WEDGES-l1-o3\" style=\"fill: yellow\" points=\"83.1384388 48 78.4307806 65.5692194 68.2870612 47.9994388\"></polygon>\n                <polygon id=\"WEDGES-l1-o2\" style=\"fill: yellow\" points=\"83.1384388 48 68.287 47.9995 60.8615612 35.1384388\"></polygon>\n                <polygon id=\"WEDGES-l1-o1\" style=\"fill: yellow\" points=\"96 0 83.1384388 48 60.8615612 35.1384388\"></polygon>\n                <polygon id=\"WEDGES-l1-o0\" style=\"fill: blue\" points=\"70.2768775 96 25.7231225 70.2768775 48.0001225 47.9995 78.4307806 65.5692194\"></polygon>\n            </g>\n            <g id=\"WEDGES-0\" transform=\"translate(67.157677, 163.157677)\">\n                <polygon id=\"WEDGES-l0-o8\" style=\"fill: red\" points=\"25.723 70.277 40.574 95.999 -2.27373675e-13 96\"></polygon>\n                <polygon id=\"WEDGES-l0-o7\" style=\"fill: #D8D8D8\" points=\"70.2768775 96 60.8615612 131.138439 40.5741225 95.9988775\"></polygon>\n                <polygon id=\"WEDGES-l0-o6\" style=\"fill: red\" points=\"70.2768775 96 40.574 95.999 25.7231225 70.2768775\"></polygon>\n                <polygon id=\"WEDGES-l0-o5\" style=\"fill: red\" points=\"48.0001225 47.9995 68.287 47.9995 78.4307806 65.5692194\"></polygon>\n                <polygon id=\"WEDGES-l0-o4\" style=\"fill: yellow\" points=\"60.8615 35.1385 68.287 47.9995 48 48\"></polygon>\n                <polygon id=\"WEDGES-l0-o3\" style=\"fill: red\" points=\"83.1384388 48 78.4307806 65.5692194 68.2870612 47.9994388\"></polygon>\n                <polygon id=\"WEDGES-l0-o2\" style=\"fill: yellow\" points=\"83.1384388 48 68.287 47.9995 60.8615612 35.1384388\"></polygon>\n                <polygon id=\"WEDGES-l0-o1\" style=\"fill: yellow\" points=\"96 0 83.1384388 48 60.8615612 35.1384388\"></polygon>\n                <polygon id=\"WEDGES-l0-o0\" style=\"fill: red\" points=\"70.2768775 96 25.7231225 70.2768775 48.0001225 47.9995 78.4307806 65.5692194\"></polygon>\n            </g>\n        </g>\n        <g id=\"DIAGONALS\" transform=\"translate(168.861561, 1.019238)\" stroke=\"#000000\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\">\n            <line x1=\"0\" y1=\"287.842323\" x2=\"70.2768775\" y2=\"550.119201\" id=\"BOTTOM\"></line>\n            <line x1=\"0.15767665\" y1=\"262.276878\" x2=\"70.4345542\" y2=\"2.27488928e-16\" id=\"TOP\"></line>\n        </g>\n    </g>\n</svg>`;\n", "export default `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" viewBox=\"0 0 480 240\" preserveAspectRatio=\"xMidYMid meet\">\n  <title>clock</title>\n  <defs>\n    <g id=\"hand\" transform=\"translate(-20, -20)\">\n      <path d=\"M19.9995197,2.22079449 L23.8791657,19.0203611 C23.9580836,19.3338406 24,19.6620253 24,20 C24,22.209139 22.209139,24 20,24 C17.790861,24 16,22.209139 16,20 C16,19.6620253 16.0419164,19.3338406 16.1208343,19.0203611 L19.9995197,2.22079449 Z\"></path>\n    </g>\n    <g id=\"cardinal_hours\" style=\"fill: #FFFFFF\">\n      <circle cx=\"0\" cy=\"24\" r=\"2\"></circle>\n      <circle cx=\"-24\" cy=\"0\" r=\"2\"></circle>\n      <circle cx=\"24\" cy=\"0\" r=\"2\"></circle>\n      <circle cx=\"0\" cy=\"-24\" r=\"2\"></circle>\n    </g>\n    <g id=\"face_hours\">\n      <g>\n        <use xlink:href=\"#cardinal_hours\"/>\n      </g>\n      <g transform=\"rotate(30)\">\n        <use xlink:href=\"#cardinal_hours\"/>\n      </g>\n      <g  transform=\"rotate(60)\">\n        <use xlink:href=\"#cardinal_hours\"/>\n      </g>\n    </g>\n    <g id=\"pegs\" stroke=\"#000000\" style=\"fill: #FFD000\">\n      <circle id=\"PEG4\" cx=\"90\" cy=\"90\" r=\"10\"></circle>\n      <circle id=\"PEG3\" cx=\"30\" cy=\"90\" r=\"10\"></circle>\n      <circle id=\"PEG2\" cx=\"90\" cy=\"30\" r=\"10\"></circle>\n      <circle id=\"PEG1\" cx=\"30\" cy=\"30\" r=\"10\"></circle>\n    </g>\n    <g id=\"frame\" transform=\"translate(-24, -24)\">\n      <path stroke=\"#000000\" d=\"M120,20 C137.495665,20 153.941932,24.4930026 168.247913,32.3881183 C171.855881,30.8514056 175.828512,30 180,30 C196.568542,30 210,43.4314575 210,60 C210,64.1714878 209.148594,68.1441192 207.610077,71.7536009 C215.506997,86.0580678 220,102.504335 220,120 C220,137.495665 215.506997,153.941932 207.611882,168.247913 C209.148594,171.855881 210,175.828512 210,180 C210,196.568542 196.568542,210 180,210 C175.828512,210 171.855881,209.148594 168.246399,207.610077 C153.941932,215.506997 137.495665,220 120,220 C102.504335,220 86.0580678,215.506997 71.7520869,207.611882 C68.1441192,209.148594 64.1714878,210 60,210 C43.4314575,210 30,196.568542 30,180 C30,175.828512 30.8514056,171.855881 32.3899234,168.246399 C24.4930026,153.941932 20,137.495665 20,120 C20,102.504335 24.4930026,86.0580678 32.3881183,71.7520869 C30.8514056,68.1441192 30,64.1714878 30,60 C30,43.4314575 43.4314575,30 60,30 C64.1714878,30 68.1441192,30.8514056 71.7536009,32.3899234 C86.0580678,24.4930026 102.504335,20 120,20 Z\"></path>\n    </g>\n  </defs>\n  <g>\n    <g transform=\"translate(24, 24)\">\n      <use xlink:href=\"#frame\" id=\"FRAME-l0-o0\" style=\"fill: #0C5093\"/>\n      <use xlink:href=\"#pegs\" transform=\"translate(36, 36)\"/>\n      <g transform=\"translate(36, 36)\">\n        <circle id=\"FACES-l0-o0\" stroke=\"#000000\" style=\"fill: #90B8DF\" r=\"20\"></circle>\n        <use xlink:href=\"#face_hours\"/>\n        <g>\n          <use id=\"DIALS-l0-o0\"  xlink:href=\"#hand\" transform=\"rotate(0)\" style=\"fill: #FFD000\"/>\n          <use id=\"DIALS-l0-o1\"  xlink:href=\"#hand\" transform=\"rotate(30)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l0-o2\"  xlink:href=\"#hand\" transform=\"rotate(60)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l0-o3\"  xlink:href=\"#hand\" transform=\"rotate(90)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l0-o4\"  xlink:href=\"#hand\" transform=\"rotate(120)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l0-o5\"  xlink:href=\"#hand\" transform=\"rotate(150)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l0-o6\"  xlink:href=\"#hand\" transform=\"rotate(180)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l0-o7\"  xlink:href=\"#hand\" transform=\"rotate(210)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l0-o8\"  xlink:href=\"#hand\" transform=\"rotate(240)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l0-o9\"  xlink:href=\"#hand\" transform=\"rotate(270)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l0-o10\" xlink:href=\"#hand\" transform=\"rotate(300)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l0-o11\" xlink:href=\"#hand\" transform=\"rotate(330)\" style=\"fill: #0000\"/>\n        </g>\n      </g>\n      <g transform=\"translate(96, 36)\">\n        <circle id=\"FACES-l1-o0\" stroke=\"#000000\" style=\"fill: #90B8DF\" r=\"20\"></circle>\n        <use xlink:href=\"#face_hours\"/>\n        <g>\n          <use id=\"DIALS-l1-o0\"  xlink:href=\"#hand\" transform=\"rotate(0)\" style=\"fill: #FFD000\"/>\n          <use id=\"DIALS-l1-o1\"  xlink:href=\"#hand\" transform=\"rotate(30)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l1-o2\"  xlink:href=\"#hand\" transform=\"rotate(60)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l1-o3\"  xlink:href=\"#hand\" transform=\"rotate(90)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l1-o4\"  xlink:href=\"#hand\" transform=\"rotate(120)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l1-o5\"  xlink:href=\"#hand\" transform=\"rotate(150)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l1-o6\"  xlink:href=\"#hand\" transform=\"rotate(180)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l1-o7\"  xlink:href=\"#hand\" transform=\"rotate(210)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l1-o8\"  xlink:href=\"#hand\" transform=\"rotate(240)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l1-o9\"  xlink:href=\"#hand\" transform=\"rotate(270)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l1-o10\" xlink:href=\"#hand\" transform=\"rotate(300)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l1-o11\" xlink:href=\"#hand\" transform=\"rotate(330)\" style=\"fill: #0000\"/>\n        </g>\n      </g>\n      <g transform=\"translate(156, 36)\">\n        <circle id=\"FACES-l2-o0\" stroke=\"#000000\" style=\"fill: #90B8DF\" r=\"20\"></circle>\n        <use xlink:href=\"#face_hours\"/>\n        <g>\n          <use id=\"DIALS-l2-o0\"  xlink:href=\"#hand\" transform=\"rotate(0)\" style=\"fill: #FFD000\"/>\n          <use id=\"DIALS-l2-o1\"  xlink:href=\"#hand\" transform=\"rotate(30)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l2-o2\"  xlink:href=\"#hand\" transform=\"rotate(60)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l2-o3\"  xlink:href=\"#hand\" transform=\"rotate(90)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l2-o4\"  xlink:href=\"#hand\" transform=\"rotate(120)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l2-o5\"  xlink:href=\"#hand\" transform=\"rotate(150)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l2-o6\"  xlink:href=\"#hand\" transform=\"rotate(180)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l2-o7\"  xlink:href=\"#hand\" transform=\"rotate(210)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l2-o8\"  xlink:href=\"#hand\" transform=\"rotate(240)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l2-o9\"  xlink:href=\"#hand\" transform=\"rotate(270)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l2-o10\" xlink:href=\"#hand\" transform=\"rotate(300)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l2-o11\" xlink:href=\"#hand\" transform=\"rotate(330)\" style=\"fill: #0000\"/>\n        </g>\n      </g>\n      <g transform=\"translate(36, 96)\">\n        <circle id=\"FACES-l3-o0\" stroke=\"#000000\" style=\"fill: #90B8DF\" r=\"20\"></circle>\n        <use xlink:href=\"#face_hours\"/>\n        <g>\n          <use id=\"DIALS-l3-o0\"  xlink:href=\"#hand\" transform=\"rotate(0)\" style=\"fill: #FFD000\"/>\n          <use id=\"DIALS-l3-o1\"  xlink:href=\"#hand\" transform=\"rotate(30)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l3-o2\"  xlink:href=\"#hand\" transform=\"rotate(60)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l3-o3\"  xlink:href=\"#hand\" transform=\"rotate(90)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l3-o4\"  xlink:href=\"#hand\" transform=\"rotate(120)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l3-o5\"  xlink:href=\"#hand\" transform=\"rotate(150)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l3-o6\"  xlink:href=\"#hand\" transform=\"rotate(180)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l3-o7\"  xlink:href=\"#hand\" transform=\"rotate(210)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l3-o8\"  xlink:href=\"#hand\" transform=\"rotate(240)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l3-o9\"  xlink:href=\"#hand\" transform=\"rotate(270)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l3-o10\" xlink:href=\"#hand\" transform=\"rotate(300)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l3-o11\" xlink:href=\"#hand\" transform=\"rotate(330)\" style=\"fill: #0000\"/>\n        </g>\n      </g>\n      <g transform=\"translate(96, 96)\">\n        <circle id=\"FACES-l4-o0\" stroke=\"#000000\" style=\"fill: #90B8DF\" r=\"20\"></circle>\n        <use xlink:href=\"#face_hours\"/>\n        <g>\n          <use id=\"DIALS-l4-o0\"  xlink:href=\"#hand\" transform=\"rotate(0)\" style=\"fill: #FFD000\"/>\n          <use id=\"DIALS-l4-o1\"  xlink:href=\"#hand\" transform=\"rotate(30)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l4-o2\"  xlink:href=\"#hand\" transform=\"rotate(60)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l4-o3\"  xlink:href=\"#hand\" transform=\"rotate(90)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l4-o4\"  xlink:href=\"#hand\" transform=\"rotate(120)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l4-o5\"  xlink:href=\"#hand\" transform=\"rotate(150)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l4-o6\"  xlink:href=\"#hand\" transform=\"rotate(180)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l4-o7\"  xlink:href=\"#hand\" transform=\"rotate(210)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l4-o8\"  xlink:href=\"#hand\" transform=\"rotate(240)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l4-o9\"  xlink:href=\"#hand\" transform=\"rotate(270)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l4-o10\" xlink:href=\"#hand\" transform=\"rotate(300)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l4-o11\" xlink:href=\"#hand\" transform=\"rotate(330)\" style=\"fill: #0000\"/>\n        </g>\n      </g>\n      <g transform=\"translate(156, 96)\">\n        <circle id=\"FACES-l5-o0\" stroke=\"#000000\" style=\"fill: #90B8DF\" r=\"20\"></circle>\n        <use xlink:href=\"#face_hours\"/>\n        <g>\n          <use id=\"DIALS-l5-o0\"  xlink:href=\"#hand\" transform=\"rotate(0)\" style=\"fill: #FFD000\"/>\n          <use id=\"DIALS-l5-o1\"  xlink:href=\"#hand\" transform=\"rotate(30)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l5-o2\"  xlink:href=\"#hand\" transform=\"rotate(60)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l5-o3\"  xlink:href=\"#hand\" transform=\"rotate(90)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l5-o4\"  xlink:href=\"#hand\" transform=\"rotate(120)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l5-o5\"  xlink:href=\"#hand\" transform=\"rotate(150)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l5-o6\"  xlink:href=\"#hand\" transform=\"rotate(180)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l5-o7\"  xlink:href=\"#hand\" transform=\"rotate(210)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l5-o8\"  xlink:href=\"#hand\" transform=\"rotate(240)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l5-o9\"  xlink:href=\"#hand\" transform=\"rotate(270)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l5-o10\" xlink:href=\"#hand\" transform=\"rotate(300)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l5-o11\" xlink:href=\"#hand\" transform=\"rotate(330)\" style=\"fill: #0000\"/>\n        </g>\n      </g>\n      <g transform=\"translate(36, 156)\">\n        <circle id=\"FACES-l6-o0\" stroke=\"#000000\" style=\"fill: #90B8DF\" r=\"20\"></circle>\n        <use xlink:href=\"#face_hours\"/>\n        <g>\n          <use id=\"DIALS-l6-o0\"  xlink:href=\"#hand\" transform=\"rotate(0)\" style=\"fill: #FFD000\"/>\n          <use id=\"DIALS-l6-o1\"  xlink:href=\"#hand\" transform=\"rotate(30)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l6-o2\"  xlink:href=\"#hand\" transform=\"rotate(60)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l6-o3\"  xlink:href=\"#hand\" transform=\"rotate(90)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l6-o4\"  xlink:href=\"#hand\" transform=\"rotate(120)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l6-o5\"  xlink:href=\"#hand\" transform=\"rotate(150)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l6-o6\"  xlink:href=\"#hand\" transform=\"rotate(180)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l6-o7\"  xlink:href=\"#hand\" transform=\"rotate(210)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l6-o8\"  xlink:href=\"#hand\" transform=\"rotate(240)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l6-o9\"  xlink:href=\"#hand\" transform=\"rotate(270)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l6-o10\" xlink:href=\"#hand\" transform=\"rotate(300)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l6-o11\" xlink:href=\"#hand\" transform=\"rotate(330)\" style=\"fill: #0000\"/>\n        </g>\n      </g>\n      <g transform=\"translate(96, 156)\">\n        <circle id=\"FACES-l7-o0\" stroke=\"#000000\" style=\"fill: #90B8DF\" r=\"20\"></circle>\n        <use xlink:href=\"#face_hours\"/>\n        <g>\n          <use id=\"DIALS-l7-o0\"  xlink:href=\"#hand\" transform=\"rotate(0)\" style=\"fill: #FFD000\"/>\n          <use id=\"DIALS-l7-o1\"  xlink:href=\"#hand\" transform=\"rotate(30)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l7-o2\"  xlink:href=\"#hand\" transform=\"rotate(60)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l7-o3\"  xlink:href=\"#hand\" transform=\"rotate(90)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l7-o4\"  xlink:href=\"#hand\" transform=\"rotate(120)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l7-o5\"  xlink:href=\"#hand\" transform=\"rotate(150)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l7-o6\"  xlink:href=\"#hand\" transform=\"rotate(180)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l7-o7\"  xlink:href=\"#hand\" transform=\"rotate(210)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l7-o8\"  xlink:href=\"#hand\" transform=\"rotate(240)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l7-o9\"  xlink:href=\"#hand\" transform=\"rotate(270)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l7-o10\" xlink:href=\"#hand\" transform=\"rotate(300)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l7-o11\" xlink:href=\"#hand\" transform=\"rotate(330)\" style=\"fill: #0000\"/>\n        </g>\n      </g>\n      <g transform=\"translate(156, 156)\">\n        <circle id=\"FACES-l8-o0\" stroke=\"#000000\" style=\"fill: #90B8DF\" r=\"20\"></circle>\n        <use xlink:href=\"#face_hours\"/>\n        <g>\n          <use id=\"DIALS-l8-o0\"  xlink:href=\"#hand\" transform=\"rotate(0)\" style=\"fill: #FFD000\"/>\n          <use id=\"DIALS-l8-o1\"  xlink:href=\"#hand\" transform=\"rotate(30)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l8-o2\"  xlink:href=\"#hand\" transform=\"rotate(60)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l8-o3\"  xlink:href=\"#hand\" transform=\"rotate(90)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l8-o4\"  xlink:href=\"#hand\" transform=\"rotate(120)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l8-o5\"  xlink:href=\"#hand\" transform=\"rotate(150)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l8-o6\"  xlink:href=\"#hand\" transform=\"rotate(180)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l8-o7\"  xlink:href=\"#hand\" transform=\"rotate(210)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l8-o8\"  xlink:href=\"#hand\" transform=\"rotate(240)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l8-o9\"  xlink:href=\"#hand\" transform=\"rotate(270)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l8-o10\" xlink:href=\"#hand\" transform=\"rotate(300)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l8-o11\" xlink:href=\"#hand\" transform=\"rotate(330)\" style=\"fill: #0000\"/>\n        </g>\n      </g>\n    </g>\n    <g transform=\"translate(264, 24)\">\n      <use xlink:href=\"#frame\" id=\"FRAME-l0-o1\" style=\"fill: #90B8DF\"/>\n      <use xlink:href=\"#pegs\" transform=\"translate(36, 36)\"/>\n      <g transform=\"translate(36, 36)\">\n        <circle id=\"FACES-l9-o0\" stroke=\"#000000\" style=\"fill: #0C5093\" r=\"20\"></circle>\n        <use xlink:href=\"#face_hours\"/>\n        <g>\n          <use id=\"DIALS-l9-o0\"  xlink:href=\"#hand\" transform=\"rotate(0)\" style=\"fill: #FFD000\"/>\n          <use id=\"DIALS-l9-o1\"  xlink:href=\"#hand\" transform=\"rotate(30)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l9-o2\"  xlink:href=\"#hand\" transform=\"rotate(60)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l9-o3\"  xlink:href=\"#hand\" transform=\"rotate(90)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l9-o4\"  xlink:href=\"#hand\" transform=\"rotate(120)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l9-o5\"  xlink:href=\"#hand\" transform=\"rotate(150)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l9-o6\"  xlink:href=\"#hand\" transform=\"rotate(180)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l9-o7\"  xlink:href=\"#hand\" transform=\"rotate(210)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l9-o8\"  xlink:href=\"#hand\" transform=\"rotate(240)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l9-o9\"  xlink:href=\"#hand\" transform=\"rotate(270)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l9-o10\" xlink:href=\"#hand\" transform=\"rotate(300)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l9-o11\" xlink:href=\"#hand\" transform=\"rotate(330)\" style=\"fill: #0000\"/>\n        </g>\n      </g>\n      <g transform=\"translate(96, 36)\">\n        <circle id=\"FACES-l10-o0\" stroke=\"#000000\" style=\"fill: #0C5093\" r=\"20\"></circle>\n        <use xlink:href=\"#face_hours\"/>\n        <g>\n          <use id=\"DIALS-l10-o0\"  xlink:href=\"#hand\" transform=\"rotate(0)\" style=\"fill: #FFD000\"/>\n          <use id=\"DIALS-l10-o1\"  xlink:href=\"#hand\" transform=\"rotate(30)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l10-o2\"  xlink:href=\"#hand\" transform=\"rotate(60)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l10-o3\"  xlink:href=\"#hand\" transform=\"rotate(90)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l10-o4\"  xlink:href=\"#hand\" transform=\"rotate(120)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l10-o5\"  xlink:href=\"#hand\" transform=\"rotate(150)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l10-o6\"  xlink:href=\"#hand\" transform=\"rotate(180)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l10-o7\"  xlink:href=\"#hand\" transform=\"rotate(210)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l10-o8\"  xlink:href=\"#hand\" transform=\"rotate(240)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l10-o9\"  xlink:href=\"#hand\" transform=\"rotate(270)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l10-o10\" xlink:href=\"#hand\" transform=\"rotate(300)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l10-o11\" xlink:href=\"#hand\" transform=\"rotate(330)\" style=\"fill: #0000\"/>\n        </g>\n      </g>\n      <g transform=\"translate(156, 36)\">\n        <circle id=\"FACES-l11-o0\" stroke=\"#000000\" style=\"fill: #0C5093\" r=\"20\"></circle>\n        <use xlink:href=\"#face_hours\"/>\n        <g>\n          <use id=\"DIALS-l11-o0\"  xlink:href=\"#hand\" transform=\"rotate(0)\" style=\"fill: #FFD000\"/>\n          <use id=\"DIALS-l11-o1\"  xlink:href=\"#hand\" transform=\"rotate(30)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l11-o2\"  xlink:href=\"#hand\" transform=\"rotate(60)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l11-o3\"  xlink:href=\"#hand\" transform=\"rotate(90)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l11-o4\"  xlink:href=\"#hand\" transform=\"rotate(120)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l11-o5\"  xlink:href=\"#hand\" transform=\"rotate(150)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l11-o6\"  xlink:href=\"#hand\" transform=\"rotate(180)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l11-o7\"  xlink:href=\"#hand\" transform=\"rotate(210)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l11-o8\"  xlink:href=\"#hand\" transform=\"rotate(240)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l11-o9\"  xlink:href=\"#hand\" transform=\"rotate(270)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l11-o10\" xlink:href=\"#hand\" transform=\"rotate(300)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l11-o11\" xlink:href=\"#hand\" transform=\"rotate(330)\" style=\"fill: #0000\"/>\n        </g>\n      </g>\n      <g transform=\"translate(36, 96)\">\n        <circle id=\"FACES-l12-o0\" stroke=\"#000000\" style=\"fill: #0C5093\" r=\"20\"></circle>\n        <use xlink:href=\"#face_hours\"/>\n        <g>\n          <use id=\"DIALS-l12-o0\"  xlink:href=\"#hand\" transform=\"rotate(0)\" style=\"fill: #FFD000\"/>\n          <use id=\"DIALS-l12-o1\"  xlink:href=\"#hand\" transform=\"rotate(30)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l12-o2\"  xlink:href=\"#hand\" transform=\"rotate(60)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l12-o3\"  xlink:href=\"#hand\" transform=\"rotate(90)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l12-o4\"  xlink:href=\"#hand\" transform=\"rotate(120)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l12-o5\"  xlink:href=\"#hand\" transform=\"rotate(150)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l12-o6\"  xlink:href=\"#hand\" transform=\"rotate(180)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l12-o7\"  xlink:href=\"#hand\" transform=\"rotate(210)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l12-o8\"  xlink:href=\"#hand\" transform=\"rotate(240)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l12-o9\"  xlink:href=\"#hand\" transform=\"rotate(270)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l12-o10\" xlink:href=\"#hand\" transform=\"rotate(300)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l12-o11\" xlink:href=\"#hand\" transform=\"rotate(330)\" style=\"fill: #0000\"/>\n        </g>\n      </g>\n      <g transform=\"translate(96, 96)\">\n        <circle id=\"FACES-l13-o0\" stroke=\"#000000\" style=\"fill: #0C5093\" r=\"20\"></circle>\n        <use xlink:href=\"#face_hours\"/>\n        <g>\n          <use id=\"DIALS-l13-o0\"  xlink:href=\"#hand\" transform=\"rotate(0)\" style=\"fill: #FFD000\"/>\n          <use id=\"DIALS-l13-o1\"  xlink:href=\"#hand\" transform=\"rotate(30)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l13-o2\"  xlink:href=\"#hand\" transform=\"rotate(60)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l13-o3\"  xlink:href=\"#hand\" transform=\"rotate(90)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l13-o4\"  xlink:href=\"#hand\" transform=\"rotate(120)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l13-o5\"  xlink:href=\"#hand\" transform=\"rotate(150)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l13-o6\"  xlink:href=\"#hand\" transform=\"rotate(180)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l13-o7\"  xlink:href=\"#hand\" transform=\"rotate(210)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l13-o8\"  xlink:href=\"#hand\" transform=\"rotate(240)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l13-o9\"  xlink:href=\"#hand\" transform=\"rotate(270)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l13-o10\" xlink:href=\"#hand\" transform=\"rotate(300)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l13-o11\" xlink:href=\"#hand\" transform=\"rotate(330)\" style=\"fill: #0000\"/>\n        </g>\n      </g>\n      <g transform=\"translate(156, 96)\">\n        <circle id=\"FACES-l14-o0\" stroke=\"#000000\" style=\"fill: #0C5093\" r=\"20\"></circle>\n        <use xlink:href=\"#face_hours\"/>\n        <g>\n          <use id=\"DIALS-l14-o0\"  xlink:href=\"#hand\" transform=\"rotate(0)\" style=\"fill: #FFD000\"/>\n          <use id=\"DIALS-l14-o1\"  xlink:href=\"#hand\" transform=\"rotate(30)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l14-o2\"  xlink:href=\"#hand\" transform=\"rotate(60)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l14-o3\"  xlink:href=\"#hand\" transform=\"rotate(90)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l14-o4\"  xlink:href=\"#hand\" transform=\"rotate(120)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l14-o5\"  xlink:href=\"#hand\" transform=\"rotate(150)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l14-o6\"  xlink:href=\"#hand\" transform=\"rotate(180)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l14-o7\"  xlink:href=\"#hand\" transform=\"rotate(210)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l14-o8\"  xlink:href=\"#hand\" transform=\"rotate(240)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l14-o9\"  xlink:href=\"#hand\" transform=\"rotate(270)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l14-o10\" xlink:href=\"#hand\" transform=\"rotate(300)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l14-o11\" xlink:href=\"#hand\" transform=\"rotate(330)\" style=\"fill: #0000\"/>\n        </g>\n      </g>\n      <g transform=\"translate(36, 156)\">\n        <circle id=\"FACES-l15-o0\" stroke=\"#000000\" style=\"fill: #0C5093\" r=\"20\"></circle>\n        <use xlink:href=\"#face_hours\"/>\n        <g>\n          <use id=\"DIALS-l15-o0\"  xlink:href=\"#hand\" transform=\"rotate(0)\" style=\"fill: #FFD000\"/>\n          <use id=\"DIALS-l15-o1\"  xlink:href=\"#hand\" transform=\"rotate(30)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l15-o2\"  xlink:href=\"#hand\" transform=\"rotate(60)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l15-o3\"  xlink:href=\"#hand\" transform=\"rotate(90)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l15-o4\"  xlink:href=\"#hand\" transform=\"rotate(120)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l15-o5\"  xlink:href=\"#hand\" transform=\"rotate(150)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l15-o6\"  xlink:href=\"#hand\" transform=\"rotate(180)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l15-o7\"  xlink:href=\"#hand\" transform=\"rotate(210)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l15-o8\"  xlink:href=\"#hand\" transform=\"rotate(240)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l15-o9\"  xlink:href=\"#hand\" transform=\"rotate(270)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l15-o10\" xlink:href=\"#hand\" transform=\"rotate(300)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l15-o11\" xlink:href=\"#hand\" transform=\"rotate(330)\" style=\"fill: #0000\"/>\n        </g>\n      </g>\n      <g transform=\"translate(96, 156)\">\n        <circle id=\"FACES-l16-o0\" stroke=\"#000000\" style=\"fill: #0C5093\" r=\"20\"></circle>\n        <use xlink:href=\"#face_hours\"/>\n        <g>\n          <use id=\"DIALS-l16-o0\"  xlink:href=\"#hand\" transform=\"rotate(0)\" style=\"fill: #FFD000\"/>\n          <use id=\"DIALS-l16-o1\"  xlink:href=\"#hand\" transform=\"rotate(30)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l16-o2\"  xlink:href=\"#hand\" transform=\"rotate(60)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l16-o3\"  xlink:href=\"#hand\" transform=\"rotate(90)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l16-o4\"  xlink:href=\"#hand\" transform=\"rotate(120)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l16-o5\"  xlink:href=\"#hand\" transform=\"rotate(150)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l16-o6\"  xlink:href=\"#hand\" transform=\"rotate(180)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l16-o7\"  xlink:href=\"#hand\" transform=\"rotate(210)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l16-o8\"  xlink:href=\"#hand\" transform=\"rotate(240)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l16-o9\"  xlink:href=\"#hand\" transform=\"rotate(270)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l16-o10\" xlink:href=\"#hand\" transform=\"rotate(300)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l16-o11\" xlink:href=\"#hand\" transform=\"rotate(330)\" style=\"fill: #0000\"/>\n        </g>\n      </g>\n      <g transform=\"translate(156, 156)\">\n        <circle id=\"FACES-l17-o0\" stroke=\"#000000\" style=\"fill: #0C5093\" r=\"20\"></circle>\n        <use xlink:href=\"#face_hours\"/>\n        <g>\n          <use id=\"DIALS-l17-o0\"  xlink:href=\"#hand\" transform=\"rotate(0)\" style=\"fill: #FFD000\"/>\n          <use id=\"DIALS-l17-o1\"  xlink:href=\"#hand\" transform=\"rotate(30)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l17-o2\"  xlink:href=\"#hand\" transform=\"rotate(60)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l17-o3\"  xlink:href=\"#hand\" transform=\"rotate(90)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l17-o4\"  xlink:href=\"#hand\" transform=\"rotate(120)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l17-o5\"  xlink:href=\"#hand\" transform=\"rotate(150)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l17-o6\"  xlink:href=\"#hand\" transform=\"rotate(180)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l17-o7\"  xlink:href=\"#hand\" transform=\"rotate(210)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l17-o8\"  xlink:href=\"#hand\" transform=\"rotate(240)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l17-o9\"  xlink:href=\"#hand\" transform=\"rotate(270)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l17-o10\" xlink:href=\"#hand\" transform=\"rotate(300)\" style=\"fill: #0000\"/>\n          <use id=\"DIALS-l17-o11\" xlink:href=\"#hand\" transform=\"rotate(330)\" style=\"fill: #0000\"/>\n        </g>\n      </g>\n    </g>\n  </g>\n</svg>`;\n", "import { KPuzzleDefinition } from \"../definition_types\";\n\ndeclare module \"*.svg\";\n\n// TODO: Figure out how to import SVGs directly, in a way that works with all our build systems.\n\nimport cube222JSON from \"./2x2x2.kpuzzle.json\";\nexport const Cube222: KPuzzleDefinition = cube222JSON;\nimport cube222SVG from \"./svg-inlined/2x2x2.kpuzzle.svg\";\nCube222.svg = cube222SVG;\n// Cube222.svg = svgJSON[\"2x2x2.kpuzzle.svg\"];\n\nimport cube333JSON from \"./3x3x3.kpuzzle.json\";\nexport const Cube333: KPuzzleDefinition = cube333JSON;\nimport cube333SVG from \"./svg-inlined/3x3x3.kpuzzle.svg\";\nCube333.svg = cube333SVG;\n\n// TODO: is stringify/parse the best way to clone?\nexport const Cube333LL: KPuzzleDefinition = JSON.parse(\n  JSON.stringify(cube333JSON),\n);\nimport cube333LLSVG from \"./svg-inlined/3x3x3-ll.kpuzzle.svg\";\nCube333LL.svg = cube333LLSVG;\n\nimport PyraminxJSON from \"./pyraminx.kpuzzle.json\";\nexport const Pyraminx: KPuzzleDefinition = PyraminxJSON;\nimport pyraminxSVG from \"./svg-inlined/pyraminx.kpuzzle.svg\";\nPyraminx.svg = pyraminxSVG;\n\nimport square1JSON from \"./sq1-hyperorbit.kpuzzle.json\";\nexport const Square1: KPuzzleDefinition = square1JSON;\nimport square1SVG from \"./svg-inlined/sq1-hyperorbit.kpuzzle.svg\";\nSquare1.svg = square1SVG;\n\nimport clockJSON from \"./clock.kpuzzle.json\";\nexport const Clock: KPuzzleDefinition = clockJSON;\nimport clockSVG from \"./svg-inlined/clock.kpuzzle.svg\";\nClock.svg = clockSVG;\n", "import { KPuzzleDefinition } from \"./definition_types\";\nimport {\n  Clock,\n  Cube222,\n  Cube333,\n  Pyraminx,\n  Square1,\n  Cube333LL,\n} from \"./definitions\";\n\nexport const Puzzles: { [key: string]: KPuzzleDefinition } = {\n  \"2x2x2\": Cube222,\n  \"3x3x3\": Cube333,\n  \"3x3x3LL\": Cube333LL,\n  \"pyraminx\": Pyraminx,\n  \"sq1\": Square1,\n  \"clock\": Clock,\n};\n", "// Workaround per https://github.com/pegjs/pegjs/pull/481\nexport { parse } from \"./parser-pegjs\";\n", "import { KPuzzleDefinition } from \"../definition_types\";\nimport { parse as importedParse } from \"./parser-shim\";\n\nconst parseKPuzzle: (s: string) => KPuzzleDefinition = importedParse;\n\nexport { parseKPuzzle };\n", "import { KPuzzleDefinition, Transformation } from \"./definition_types\";\nimport { KPuzzle } from \"./kpuzzle\";\n\nconst xmlns = \"http://www.w3.org/2000/svg\";\n\n// Unique ID mechanism to keep SVG gradient element IDs unique. TODO: Is there\n// something more performant, and that can't be broken by other elements of the\n// page? (And also doesn't break if this library is run in parallel.)\nlet svgCounter = 0;\nfunction nextSVGID(): string {\n  svgCounter += 1;\n  return \"svg\" + svgCounter.toString();\n}\n\nexport class SVG {\n  public element: HTMLElement;\n  public gradientDefs: SVGDefsElement;\n  private originalColors: { [type: string]: string } = {};\n  private gradients: { [type: string]: SVGGradientElement } = {};\n  private svgID: string;\n  constructor(public kPuzzleDefinition: KPuzzleDefinition) {\n    if (!kPuzzleDefinition.svg) {\n      throw new Error(\n        `No SVG definition for puzzle type: ${kPuzzleDefinition.name}`,\n      );\n    }\n\n    this.svgID = nextSVGID();\n\n    this.element = document.createElement(\"div\");\n    this.element.classList.add(\"svg-wrapper\");\n    // TODO: Sanitization.\n    this.element.innerHTML = kPuzzleDefinition.svg;\n\n    const svgElem = this.element.querySelector(\"svg\");\n    if (!svgElem) {\n      throw new Error(\"Could not get SVG element\");\n    }\n    if (xmlns !== svgElem.namespaceURI) {\n      throw new Error(\"Unexpected XML namespace\");\n    }\n    svgElem.style.maxWidth = \"100%\";\n    svgElem.style.maxHeight = \"100%\";\n    this.gradientDefs = document.createElementNS(\n      xmlns,\n      \"defs\",\n    ) as SVGDefsElement;\n    svgElem.insertBefore(this.gradientDefs, svgElem.firstChild);\n\n    for (const orbitName in kPuzzleDefinition.orbits) {\n      const orbitDefinition = kPuzzleDefinition.orbits[orbitName];\n\n      for (let idx = 0; idx < orbitDefinition.numPieces; idx++) {\n        for (\n          let orientation = 0;\n          orientation < orbitDefinition.orientations;\n          orientation++\n        ) {\n          const id = this.elementID(orbitName, idx, orientation);\n          const elem = this.elementByID(id);\n          const originalColor = elem.style.fill as string;\n          this.originalColors[id] = originalColor;\n          this.gradients[id] = this.newGradient(id, originalColor);\n          this.gradientDefs.appendChild(this.gradients[id]);\n          elem.setAttribute(\"style\", `fill: url(#grad-${this.svgID}-${id})`);\n        }\n      }\n    }\n  }\n\n  public drawKPuzzle(\n    kpuzzle: KPuzzle,\n    nextState?: Transformation,\n    fraction?: number,\n  ): void {\n    this.draw(kpuzzle.definition, kpuzzle.state, nextState, fraction);\n  }\n\n  // TODO: save definition in the constructor?\n  public draw(\n    definition: KPuzzleDefinition,\n    state: Transformation,\n    nextState?: Transformation,\n    fraction?: number,\n  ): void {\n    for (const orbitName in definition.orbits) {\n      const orbitDefinition = definition.orbits[orbitName];\n\n      const curOrbitState = state[orbitName];\n      const nextOrbitState = nextState\n        ? (nextState as Transformation)[orbitName]\n        : null;\n      for (let idx = 0; idx < orbitDefinition.numPieces; idx++) {\n        for (\n          let orientation = 0;\n          orientation < orbitDefinition.orientations;\n          orientation++\n        ) {\n          const id = this.elementID(orbitName, idx, orientation);\n          const fromCur = this.elementID(\n            orbitName,\n            curOrbitState.permutation[idx],\n            (orbitDefinition.orientations -\n              curOrbitState.orientation[idx] +\n              orientation) %\n              orbitDefinition.orientations,\n          );\n          let singleColor = false;\n          if (nextOrbitState) {\n            const fromNext = this.elementID(\n              orbitName,\n              nextOrbitState.permutation[idx],\n              (orbitDefinition.orientations -\n                nextOrbitState.orientation[idx] +\n                orientation) %\n                orbitDefinition.orientations,\n            );\n            if (fromCur === fromNext) {\n              singleColor = true; // TODO: Avoid redundant work during move.\n            }\n            fraction = fraction || 0; // TODO Use the type system to tie this to nextState?\n            const easedBackwardsPercent =\n              100 * (1 - fraction * fraction * (2 - fraction * fraction)); // TODO: Move easing up the stack.\n            this.gradients[id].children[0].setAttribute(\n              \"stop-color\",\n              this.originalColors[fromCur],\n            );\n            this.gradients[id].children[1].setAttribute(\n              \"stop-color\",\n              this.originalColors[fromCur],\n            );\n            this.gradients[id].children[1].setAttribute(\n              \"offset\",\n              `${Math.max(easedBackwardsPercent - 5, 0)}%`,\n            );\n            this.gradients[id].children[2].setAttribute(\n              \"offset\",\n              `${Math.max(easedBackwardsPercent - 5, 0)}%`,\n            );\n            this.gradients[id].children[3].setAttribute(\n              \"offset\",\n              `${easedBackwardsPercent}%`,\n            );\n            this.gradients[id].children[4].setAttribute(\n              \"offset\",\n              `${easedBackwardsPercent}%`,\n            );\n            this.gradients[id].children[4].setAttribute(\n              \"stop-color\",\n              this.originalColors[fromNext],\n            );\n            this.gradients[id].children[5].setAttribute(\n              \"stop-color\",\n              this.originalColors[fromNext],\n            );\n          } else {\n            singleColor = true; // TODO: Avoid redundant work during move.\n          }\n          if (singleColor) {\n            this.gradients[id].children[0].setAttribute(\n              \"stop-color\",\n              this.originalColors[fromCur],\n            );\n            this.gradients[id].children[1].setAttribute(\n              \"stop-color\",\n              this.originalColors[fromCur],\n            );\n            this.gradients[id].children[1].setAttribute(\"offset\", `100%`);\n            this.gradients[id].children[2].setAttribute(\"offset\", `100%`);\n            this.gradients[id].children[3].setAttribute(\"offset\", `100%`);\n            this.gradients[id].children[4].setAttribute(\"offset\", `100%`);\n          }\n          // this.gradients[id]\n          // this.elementByID(id).style.fill = this.originalColors[from];\n        }\n      }\n    }\n  }\n\n  private newGradient(id: string, originalColor: string): SVGGradientElement {\n    const grad = document.createElementNS(\n      xmlns,\n      \"radialGradient\",\n    ) as SVGGradientElement;\n    grad.setAttribute(\"id\", `grad-${this.svgID}-${id}`);\n    grad.setAttribute(\"r\", `70.7107%`); // TODO: Adapt to puzzle.\n    const stopDefs = [\n      { offset: 0, color: originalColor },\n      { offset: 0, color: originalColor },\n      { offset: 0, color: \"black\" },\n      { offset: 0, color: \"black\" },\n      { offset: 0, color: originalColor },\n      { offset: 100, color: originalColor },\n    ];\n    for (const stopDef of stopDefs) {\n      const stop = document.createElementNS(xmlns, \"stop\") as SVGStopElement;\n      stop.setAttribute(\"offset\", `${stopDef.offset}%`);\n      stop.setAttribute(\"stop-color\", stopDef.color);\n      stop.setAttribute(\"stop-opacity\", \"1\");\n      grad.appendChild(stop);\n    }\n    return grad;\n  }\n\n  private elementID(\n    orbitName: string,\n    idx: number,\n    orientation: number,\n  ): string {\n    return orbitName + \"-l\" + idx + \"-o\" + orientation;\n  }\n\n  private elementByID(id: string): HTMLElement {\n    // TODO: Use classes and scope selector to SVG element.\n    return this.element.querySelector(\"#\" + id) as HTMLElement;\n  }\n}\n", "const blockSize = 16;\nconst zeros = new Uint8Array(blockSize);\nconst paddingBlockPlaintext = new Uint8Array(\n  new Array(blockSize).fill(blockSize),\n);\nconst AES_CBC = \"AES-CBC\";\n\nexport async function importKey(keyBytes: ArrayBuffer): Promise<CryptoKey> {\n  return await crypto.subtle.importKey(\"raw\", keyBytes, AES_CBC, true, [\n    \"encrypt\",\n    \"decrypt\",\n  ]);\n}\n\nasync function unsafeEncryptBlockWithIV(\n  key: CryptoKey,\n  plaintextBlock: ArrayBuffer,\n  iv: ArrayBuffer,\n): Promise<ArrayBuffer> {\n  return (\n    await window.crypto.subtle.encrypt(\n      {\n        name: AES_CBC,\n        iv,\n      },\n      key,\n      plaintextBlock,\n    )\n  ).slice(0, blockSize);\n}\n\nexport async function unsafeEncryptBlock(\n  key: CryptoKey,\n  plaintextBlock: ArrayBuffer,\n): Promise<ArrayBuffer> {\n  return (await unsafeEncryptBlockWithIV(key, plaintextBlock, zeros)).slice(\n    0,\n    blockSize,\n  );\n}\n\nexport async function unsafeDecryptBlock(\n  key: CryptoKey,\n  ciphertextBlock: ArrayBuffer,\n): Promise<ArrayBuffer> {\n  const paddingBlock = await unsafeEncryptBlockWithIV(\n    key,\n    paddingBlockPlaintext,\n    ciphertextBlock,\n  );\n\n  const cbcCiphertext = new Uint8Array(2 * blockSize);\n  cbcCiphertext.set(new Uint8Array(ciphertextBlock), 0);\n  cbcCiphertext.set(new Uint8Array(paddingBlock), blockSize);\n\n  return (\n    await window.crypto.subtle.decrypt(\n      {\n        name: AES_CBC,\n        iv: zeros,\n      },\n      key,\n      cbcCiphertext,\n    )\n  ).slice(0, blockSize);\n}\n", "const blockSize = 16;\nconst zeros = new Uint8Array(blockSize);\nconst paddingBlockPlaintext = new Uint8Array(\n  new Array(blockSize).fill(blockSize),\n);\nconst AES_CBC = \"AES-CBC\";\n\nexport async function importKey(keyBytes: ArrayBuffer): Promise<CryptoKey> {\n  return await crypto.subtle.importKey(\"raw\", keyBytes, AES_CBC, true, [\n    \"encrypt\",\n    \"decrypt\",\n  ]);\n}\n\nasync function unsafeEncryptBlockWithIV(\n  key: CryptoKey,\n  plaintextBlock: ArrayBuffer,\n  iv: ArrayBuffer,\n): Promise<ArrayBuffer> {\n  return (\n    await window.crypto.subtle.encrypt(\n      {\n        name: AES_CBC,\n        iv,\n      },\n      key,\n      plaintextBlock,\n    )\n  ).slice(0, blockSize);\n}\n\nexport async function unsafeEncryptBlock(\n  key: CryptoKey,\n  plaintextBlock: ArrayBuffer,\n): Promise<ArrayBuffer> {\n  return (await unsafeEncryptBlockWithIV(key, plaintextBlock, zeros)).slice(\n    0,\n    blockSize,\n  );\n}\n\nexport async function unsafeDecryptBlock(\n  key: CryptoKey,\n  ciphertextBlock: ArrayBuffer,\n): Promise<ArrayBuffer> {\n  const paddingBlock = await unsafeEncryptBlockWithIV(\n    key,\n    paddingBlockPlaintext,\n    ciphertextBlock,\n  );\n\n  const cbcCiphertext = new Uint8Array(2 * blockSize);\n  cbcCiphertext.set(new Uint8Array(ciphertextBlock), 0);\n  cbcCiphertext.set(new Uint8Array(paddingBlock), blockSize);\n\n  return (\n    await window.crypto.subtle.decrypt(\n      {\n        name: AES_CBC,\n        iv: zeros,\n      },\n      key,\n      cbcCiphertext,\n    )\n  ).slice(0, blockSize);\n}\n", "/* tslint:disable no-bitwise */\n\nimport { Quaternion } from \"three\";\nimport { BareBlockMove, BlockMove } from \"../alg\";\nimport { KPuzzle, Puzzles } from \"../kpuzzle\";\nimport {\n  BluetoothConfig,\n  BluetoothPuzzle,\n  PuzzleState,\n} from \"./bluetooth-puzzle\";\nimport { debugLog } from \"./debug\";\nimport { importKey, unsafeDecryptBlock } from \"./unsafe-raw-aes\";\n\n// This needs to be short enough to capture 6 moves (OBQTM).\nconst DEFAULT_INTERVAL_MS = 150;\n// Number of latest moves provided by the Gan 356i.\nconst MAX_LATEST_MOVES = 6;\n\nconst ganMoveToBlockMove: { [i: number]: BlockMove } = {\n  0x00: BareBlockMove(\"U\"),\n  0x02: BareBlockMove(\"U\", -1),\n  0x03: BareBlockMove(\"R\"),\n  0x05: BareBlockMove(\"R\", -1),\n  0x06: BareBlockMove(\"F\"),\n  0x08: BareBlockMove(\"F\", -1),\n  0x09: BareBlockMove(\"D\"),\n  0x0b: BareBlockMove(\"D\", -1),\n  0x0c: BareBlockMove(\"L\"),\n  0x0e: BareBlockMove(\"L\", -1),\n  0x0f: BareBlockMove(\"B\"),\n  0x11: BareBlockMove(\"B\", -1),\n};\n\nlet homeQuatInverse: Quaternion | null = null;\n\nfunction probablyDecodedCorrectly(data: Uint8Array): boolean {\n  return (\n    data[13] < 0x12 &&\n    data[14] < 0x12 &&\n    data[15] < 0x12 &&\n    data[16] < 0x12 &&\n    data[17] < 0x12 &&\n    data[18] < 0x12\n  );\n}\n\nconst key10 = new Uint8Array([\n  198,\n  202,\n  21,\n  223,\n  79,\n  110,\n  19,\n  182,\n  119,\n  13,\n  230,\n  89,\n  58,\n  175,\n  186,\n  162,\n]);\nconst key11 = new Uint8Array([\n  67,\n  226,\n  91,\n  214,\n  125,\n  220,\n  120,\n  216,\n  7,\n  96,\n  163,\n  218,\n  130,\n  60,\n  1,\n  241,\n]);\n\n// Clean-room reverse-engineered\nasync function decryptState(\n  data: Uint8Array,\n  aesKey: CryptoKey | null,\n): Promise<Uint8Array> {\n  if (aesKey === null) {\n    return data;\n  }\n\n  const copy = new Uint8Array(data);\n  copy.set(new Uint8Array(await unsafeDecryptBlock(aesKey, copy.slice(3))), 3);\n  copy.set(\n    new Uint8Array(await unsafeDecryptBlock(aesKey, copy.slice(0, 16))),\n    0,\n  );\n\n  if (probablyDecodedCorrectly(copy)) {\n    return copy;\n  }\n\n  throw new Error(\"Invalid Gan cube state\");\n}\n\nclass PhysicalState {\n  public static async read(\n    characteristic: BluetoothRemoteGATTCharacteristic,\n    aesKey: CryptoKey | null,\n  ): Promise<PhysicalState> {\n    const value = await decryptState(\n      new Uint8Array((await characteristic.readValue()).buffer),\n      aesKey,\n    );\n    const timeStamp = Date.now();\n    // console.log(value);\n    return new PhysicalState(new DataView(value.buffer), timeStamp);\n  }\n\n  private arr: Uint8Array;\n  private arrLen = 19;\n  private constructor(private dataView: DataView, public timeStamp: number) {\n    this.arr = new Uint8Array(dataView.buffer);\n    if (this.arr.length !== this.arrLen) {\n      throw new Error(\"Unexpected array length\");\n    }\n  }\n\n  public rotQuat(): Quaternion {\n    let x = this.dataView.getInt16(0, true) / 16384;\n    let y = this.dataView.getInt16(2, true) / 16384;\n    let z = this.dataView.getInt16(4, true) / 16384;\n    [x, y, z] = [-y, z, -x];\n    const wSquared = 1 - (x * x + y * y + z * z);\n    const w = wSquared > 0 ? Math.sqrt(wSquared) : 0;\n    const quat = new Quaternion(x, y, z, w);\n\n    if (!homeQuatInverse) {\n      homeQuatInverse = quat.clone().inverse();\n    }\n\n    return quat.clone().multiply(homeQuatInverse.clone());\n  }\n\n  // Loops from 255 to 0.\n  public moveCounter(): number {\n    return this.arr[12];\n  }\n\n  public numMovesSince(previousMoveCounter: number): number {\n    return (this.moveCounter() - previousMoveCounter) & 0xff;\n  }\n\n  // Due to the design of the Gan356i protocol, it's common to query for the\n  // latest physical state and find 0 moves have been performed since the last\n  // query. Therefore, it's useful to allow 0 as an argument.\n  public latestMoves(n: number): BlockMove[] {\n    if (n < 0 || n > MAX_LATEST_MOVES) {\n      throw new Error(`Must ask for 0 to 6 latest moves. (Asked for ${n})`);\n    }\n    return Array.from(this.arr.slice(19 - n, 19)).map(\n      (i) => ganMoveToBlockMove[i],\n    );\n  }\n\n  public debugInfo(): { arr: Uint8Array } {\n    return {\n      arr: this.arr,\n    };\n  }\n}\n\n// TODO: Short IDs\nconst UUIDs = {\n  ganCubeService: \"0000fff0-0000-1000-8000-00805f9b34fb\",\n  physicalStateCharacteristic: \"0000fff5-0000-1000-8000-00805f9b34fb\",\n  actualAngleAndBatteryCharacteristic: \"0000fff7-0000-1000-8000-00805f9b34fb\",\n  faceletStatus1Characteristic: \"0000fff2-0000-1000-8000-00805f9b34fb\",\n  faceletStatus2Characteristic: \"0000fff3-0000-1000-8000-00805f9b34fb\",\n  infoService: \"0000180a-0000-1000-8000-00805f9b34fb\",\n  systemIDCharacteristic: \"00002a23-0000-1000-8000-00805f9b34fb\",\n  versionCharacteristic: \"00002a28-0000-1000-8000-00805f9b34fb\",\n};\n\nconst commands: { [cmd: string]: BufferSource } = {\n  reset: new Uint8Array([\n    0x00,\n    0x00,\n    0x24,\n    0x00,\n    0x49,\n    0x92,\n    0x24,\n    0x49,\n    0x6d,\n    0x92,\n    0xdb,\n    0xb6,\n    0x49,\n    0x92,\n    0xb6,\n    0x24,\n    0x6d,\n    0xdb,\n  ]),\n};\n\n// // TODO: Move this into a factory?\nexport const ganConfig: BluetoothConfig = {\n  filters: [{ namePrefix: \"GAN\" }],\n  optionalServices: [UUIDs.ganCubeService, UUIDs.infoService],\n};\n\nfunction buf2hex(buffer: ArrayBuffer): string {\n  // buffer is an ArrayBuffer\n  return Array.prototype.map\n    .call(new Uint8Array(buffer), (x: number) =>\n      (\"00\" + x.toString(16)).slice(-2),\n    )\n    .join(\" \");\n}\n\nconst reidEdgeOrder = \"UF UR UB UL DF DR DB DL FR FL BR BL\".split(\" \");\nconst reidCornerOrder = \"UFR URB UBL ULF DRF DFL DLB DBR\".split(\" \");\n\ninterface PieceInfo {\n  piece: number;\n  orientation: number;\n}\n\nfunction rotateLeft(s: string, i: number): string {\n  return s.slice(i) + s.slice(0, i);\n}\n\nconst pieceMap: { [s: string]: PieceInfo } = {};\n// TODO: Condense the for loops.\nreidEdgeOrder.forEach((edge, idx) => {\n  for (let i = 0; i < 2; i++) {\n    pieceMap[rotateLeft(edge, i)] = { piece: idx, orientation: i };\n  }\n});\nreidCornerOrder.forEach((corner, idx) => {\n  for (let i = 0; i < 3; i++) {\n    pieceMap[rotateLeft(corner, i)] = { piece: idx, orientation: i };\n  }\n});\n\nconst gan356iCornerMappings = [\n  [0, 21, 15],\n  [5, 13, 47],\n  [7, 45, 39],\n  [2, 37, 23],\n  [29, 10, 16],\n  [31, 18, 32],\n  [26, 34, 40],\n  [24, 42, 8],\n];\n\nconst gan356iEdgeMappings = [\n  [1, 22],\n  [3, 14],\n  [6, 46],\n  [4, 38],\n  [30, 17],\n  [27, 9],\n  [25, 41],\n  [28, 33],\n  [19, 12],\n  [20, 35],\n  [44, 11],\n  [43, 36],\n];\nconst faceOrder = \"URFDLB\";\n\nasync function getKey(\n  server: BluetoothRemoteGATTServer,\n): Promise<CryptoKey | null> {\n  const infoService = await server.getPrimaryService(UUIDs.infoService);\n\n  const versionCharacteristic = await infoService.getCharacteristic(\n    UUIDs.versionCharacteristic,\n  );\n  const versionBuffer = new Uint8Array(\n    (await versionCharacteristic.readValue()).buffer,\n  );\n\n  const versionValue =\n    (((versionBuffer[0] << 8) + versionBuffer[1]) << 8) + versionBuffer[2];\n  if (versionValue < 0x01_00_08) {\n    return null;\n  }\n\n  const keyXor = versionValue < 0x01_01_00 ? key10 : key11;\n\n  const systemIDCharacteristic = await infoService.getCharacteristic(\n    UUIDs.systemIDCharacteristic,\n  );\n  const systemID = new Uint8Array(\n    (await systemIDCharacteristic.readValue()).buffer,\n  ).reverse();\n\n  const key = new Uint8Array(keyXor);\n  for (let i = 0; i < systemID.length; i++) {\n    key[i] = (key[i] + systemID[i]) % 256;\n  }\n\n  return importKey(key);\n}\n\nexport class GanCube extends BluetoothPuzzle {\n  // We have to perform async operations before we call the constructor.\n  public static async connect(\n    server: BluetoothRemoteGATTServer,\n  ): Promise<GanCube> {\n    const ganCubeService = await server.getPrimaryService(UUIDs.ganCubeService);\n    debugLog(\"Service:\", ganCubeService);\n\n    const physicalStateCharacteristic = await ganCubeService.getCharacteristic(\n      UUIDs.physicalStateCharacteristic,\n    );\n    debugLog(\"Characteristic:\", physicalStateCharacteristic);\n\n    const aesKey = await getKey(server);\n\n    const initialMoveCounter = (\n      await PhysicalState.read(physicalStateCharacteristic, aesKey)\n    ).moveCounter();\n    debugLog(\"Initial Move Counter:\", initialMoveCounter);\n    const cube = new GanCube(\n      ganCubeService,\n      server,\n      physicalStateCharacteristic,\n      initialMoveCounter,\n      aesKey,\n    );\n    return cube;\n  }\n\n  public INTERVAL_MS: number = DEFAULT_INTERVAL_MS;\n  private intervalHandle: number | null = null;\n  private kpuzzle: KPuzzle = new KPuzzle(Puzzles[\"3x3x3\"]);\n  private cachedFaceletStatus1Characteristic: Promise<\n    BluetoothRemoteGATTCharacteristic\n  >;\n\n  private cachedFaceletStatus2Characteristic: Promise<\n    BluetoothRemoteGATTCharacteristic\n  >;\n\n  private cachedActualAngleAndBatteryCharacteristic: Promise<\n    BluetoothRemoteGATTCharacteristic\n  >;\n\n  private constructor(\n    private service: BluetoothRemoteGATTService,\n    private server: BluetoothRemoteGATTServer,\n    private physicalStateCharacteristic: BluetoothRemoteGATTCharacteristic,\n    private lastMoveCounter: number,\n    private aesKey: CryptoKey | null,\n  ) {\n    super();\n    this.startTrackingMoves();\n  }\n\n  public name(): string | undefined {\n    return this.server.device.name;\n  }\n\n  public startTrackingMoves(): void {\n    // `window.setInterval` instead of `setInterval`:\n    // https://github.com/Microsoft/TypeScript/issues/842#issuecomment-252445883\n    this.intervalHandle = window.setInterval(\n      this.intervalHandler.bind(this),\n      this.INTERVAL_MS,\n    );\n  }\n\n  public stopTrackingMoves(): void {\n    if (!this.intervalHandle) {\n      throw new Error(\"Not tracking moves!\");\n    }\n    clearInterval(this.intervalHandle);\n    this.intervalHandle = null;\n  }\n\n  // TODO: Can we ever receive async responses out of order?\n  public async intervalHandler(): Promise<void> {\n    const physicalState = await PhysicalState.read(\n      this.physicalStateCharacteristic,\n      this.aesKey,\n    );\n    let numInterveningMoves = physicalState.numMovesSince(this.lastMoveCounter);\n    // console.log(numInterveningMoves);\n    if (numInterveningMoves > MAX_LATEST_MOVES) {\n      debugLog(\n        `Too many moves! Dropping ${\n          numInterveningMoves - MAX_LATEST_MOVES\n        } moves`,\n      );\n      numInterveningMoves = MAX_LATEST_MOVES;\n    }\n    for (const move of physicalState.latestMoves(numInterveningMoves)) {\n      // console.log(move);\n      this.kpuzzle.applyBlockMove(move);\n      this.dispatchMove({\n        latestMove: move,\n        timeStamp: physicalState.timeStamp,\n        debug: physicalState.debugInfo(),\n        state: this.kpuzzle.state,\n        // quaternion: physicalState.rotQuat(),\n      });\n    }\n    this.dispatchOrientation({\n      timeStamp: physicalState.timeStamp,\n      quaternion: physicalState.rotQuat(),\n    });\n    this.lastMoveCounter = physicalState.moveCounter();\n  }\n\n  public async getBattery(): Promise<number> {\n    return new Uint8Array(\n      await this.readActualAngleAndBatteryCharacteristic(),\n    )[7];\n  }\n\n  public async getState(): Promise<PuzzleState> {\n    const arr: Uint8Array = await decryptState(\n      new Uint8Array(await this.readFaceletStatus1Characteristic()),\n      this.aesKey,\n    );\n    const stickers: number[] = [];\n    for (let i = 0; i < 18; i += 3) {\n      let v = (((arr[i ^ 1] << 8) + arr[(i + 1) ^ 1]) << 8) + arr[(i + 2) ^ 1];\n      for (let j = 0; j < 8; j++) {\n        stickers.push(v & 7);\n        v >>= 3;\n      }\n    }\n\n    const state: PuzzleState = {\n      CORNERS: {\n        permutation: [],\n        orientation: [],\n      },\n      EDGES: {\n        permutation: [],\n        orientation: [],\n      },\n      CENTERS: {\n        permutation: [0, 1, 2, 3, 4, 5],\n        orientation: [0, 0, 0, 0, 0, 0],\n      },\n    };\n\n    for (const cornerMapping of gan356iCornerMappings) {\n      const pieceInfo: PieceInfo =\n        pieceMap[cornerMapping.map((i) => faceOrder[stickers[i]]).join(\"\")];\n      state.CORNERS.permutation.push(pieceInfo.piece);\n      state.CORNERS.orientation.push(pieceInfo.orientation);\n    }\n\n    for (const edgeMapping of gan356iEdgeMappings) {\n      const pieceInfo: PieceInfo =\n        pieceMap[edgeMapping.map((i) => faceOrder[stickers[i]]).join(\"\")];\n      state.EDGES.permutation.push(pieceInfo.piece);\n      state.EDGES.orientation.push(pieceInfo.orientation);\n    }\n\n    return state;\n  }\n\n  public async faceletStatus1Characteristic(): Promise<\n    BluetoothRemoteGATTCharacteristic\n  > {\n    this.cachedFaceletStatus1Characteristic =\n      this.cachedFaceletStatus1Characteristic ||\n      this.service.getCharacteristic(UUIDs.faceletStatus1Characteristic);\n    return this.cachedFaceletStatus1Characteristic;\n  }\n\n  public async faceletStatus2Characteristic(): Promise<\n    BluetoothRemoteGATTCharacteristic\n  > {\n    this.cachedFaceletStatus2Characteristic =\n      this.cachedFaceletStatus2Characteristic ||\n      this.service.getCharacteristic(UUIDs.faceletStatus2Characteristic);\n    return this.cachedFaceletStatus2Characteristic;\n  }\n\n  public async actualAngleAndBatteryCharacteristic(): Promise<\n    BluetoothRemoteGATTCharacteristic\n  > {\n    this.cachedActualAngleAndBatteryCharacteristic =\n      this.cachedActualAngleAndBatteryCharacteristic ||\n      this.service.getCharacteristic(UUIDs.actualAngleAndBatteryCharacteristic);\n    return this.cachedActualAngleAndBatteryCharacteristic;\n  }\n\n  public async reset(): Promise<void> {\n    const faceletStatus1Characteristic = await this.faceletStatus1Characteristic();\n    await faceletStatus1Characteristic.writeValue(commands.reset);\n  }\n\n  public async readFaceletStatus1Characteristic(): Promise<ArrayBuffer> {\n    const faceletStatus1Characteristic = await this.faceletStatus1Characteristic();\n    return (await faceletStatus1Characteristic.readValue()).buffer;\n  }\n\n  public async readFaceletStatus2Characteristic(): Promise<string> {\n    const faceletStatus2Characteristic = await this.faceletStatus2Characteristic();\n    return buf2hex((await faceletStatus2Characteristic.readValue()).buffer);\n  }\n\n  public async readActualAngleAndBatteryCharacteristic(): Promise<ArrayBuffer> {\n    const actualAngleAndBatteryCharacteristic = await this.actualAngleAndBatteryCharacteristic();\n    return (await actualAngleAndBatteryCharacteristic.readValue()).buffer;\n  }\n\n  // TODO\n  // private onphysicalStateCharacteristicChanged(event: any): void {\n  //   var val = event.target.value;\n  //   debugLog(val);\n  // }\n}\n", "/* tslint:disable no-bitwise */\n\nimport { BareBlockMove, BlockMove } from \"../alg\";\nimport { Transformation } from \"../kpuzzle\";\nimport {\n  BluetoothConfig,\n  BluetoothPuzzle,\n  PuzzleState,\n} from \"./bluetooth-puzzle\";\nimport { debugLog } from \"./debug\";\n\nconst MESSAGE_LENGTH = 20;\n\nconst UUIDs = {\n  cubeService: \"0000aadb-0000-1000-8000-00805f9b34fb\",\n  cubeCharacteristic: \"0000aadc-0000-1000-8000-00805f9b34fb\",\n};\n\n// TODO: Move this into a factory?\nexport const giiKERConfig: BluetoothConfig = {\n  filters: [\n    // Known prefixes: GiC, GiS (3x3x3), Gi2 (2x2x2)\n    // Suspected prefixes GiY, Gi3\n    { namePrefix: \"Gi\" },\n    { services: [\"0000aadb-0000-1000-8000-00805f9b34fb\"] },\n    { services: [\"0000aaaa-0000-1000-8000-00805f9b34fb\"] },\n    { services: [\"0000fe95-0000-1000-8000-00805f9b34fb\"] },\n  ],\n  optionalServices: [\n    // \"00001530-1212-efde-1523-785feabcd123\",\n    // \"0000aaaa-0000-1000-8000-00805f9b34fb\",\n    UUIDs.cubeService,\n    // \"0000180f-0000-1000-8000-00805f9b34fb\",\n    // \"0000180a-0000-1000-8000-00805f9b34fb\"\n  ],\n};\n\n// TODO: Expose for testing.\nfunction giikerMoveToBlockMove(face: number, amount: number): BlockMove {\n  switch (amount) {\n    case 3:\n      amount = -1;\n      break;\n    case 9:\n      debugLog(\"Encountered 9\", face, amount);\n      amount = -2;\n      break;\n  }\n\n  const family = [\"?\", \"B\", \"D\", \"L\", \"U\", \"R\", \"F\"][face];\n  return BareBlockMove(family, amount);\n}\n\nexport { giikerMoveToBlockMove as giikerMoveToBlockMoveForTesting };\n\nfunction giikerStateStr(giikerState: number[]): string {\n  let str = \"\";\n  str += giikerState.slice(0, 8).join(\".\");\n  str += \"\\n\";\n  str += giikerState.slice(8, 16).join(\".\");\n  str += \"\\n\";\n  str += giikerState.slice(16, 28).join(\".\");\n  str += \"\\n\";\n  str += giikerState.slice(28, 32).join(\".\");\n  str += \"\\n\";\n  str += giikerState.slice(32, 40).join(\".\");\n  return str;\n}\n\n// TODO\n// const Reid333Orbits = {\n//   \"EDGES\":   {\"numPieces\": 12, \"orientations\": 2},\n//   \"CORNERS\": {\"numPieces\": 8,  \"orientations\": 3},\n//   \"CENTERS\": {\"numPieces\": 6,  \"orientations\": 4}\n// };\n\nconst Reid333SolvedCenters = {\n  permutation: [0, 1, 2, 3, 4, 5],\n  orientation: [0, 0, 0, 0, 0, 0],\n};\n\nconst epGiiKERtoReid333: number[] = [4, 8, 0, 9, 5, 1, 3, 7, 6, 10, 2, 11];\nconst epReid333toGiiKER: number[] = [2, 5, 10, 6, 0, 4, 8, 7, 1, 3, 9, 11];\n\nconst preEO: number[] = [1, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0];\nconst postEO: number[] = [1, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0];\n\nconst cpGiiKERtoReid333: number[] = [4, 0, 3, 5, 7, 1, 2, 6];\nconst cpReid333toGiiKER: number[] = [1, 5, 6, 2, 0, 3, 7, 4];\n\nconst preCO: number[] = [1, 2, 1, 2, 2, 1, 2, 1];\nconst postCO: number[] = [2, 1, 2, 1, 1, 2, 1, 2];\n\nconst coFlip: number[] = [-1, 1, -1, 1, 1, -1, 1, -1];\n\nfunction getNibble(val: Uint8Array, i: number): number {\n  if (i % 2 === 1) {\n    return val[(i / 2) | 0] % 16;\n  }\n  return 0 | (val[(i / 2) | 0] / 16);\n}\n\nfunction probablyEncrypted(data: Uint8Array): boolean {\n  return data[18] === 0xa7;\n}\n\nconst lookup = [\n  176,\n  81,\n  104,\n  224,\n  86,\n  137,\n  237,\n  119,\n  38,\n  26,\n  193,\n  161,\n  210,\n  126,\n  150,\n  81,\n  93,\n  13,\n  236,\n  249,\n  89,\n  235,\n  88,\n  24,\n  113,\n  81,\n  214,\n  131,\n  130,\n  199,\n  2,\n  169,\n  39,\n  165,\n  171,\n  41,\n];\n\nfunction decryptState(data: Uint8Array): Uint8Array {\n  const offset1 = getNibble(data, 38);\n  const offset2 = getNibble(data, 39);\n  const output = new Uint8Array(MESSAGE_LENGTH);\n  for (let i = 0; i < MESSAGE_LENGTH; i++) {\n    output[i] = data[i] + lookup[offset1 + i] + lookup[offset2 + i];\n  }\n  return output;\n}\n\n// TODO: Support caching which decoding strategy worked last time.\nasync function decodeState(data: Uint8Array): Promise<Uint8Array> {\n  if (!probablyEncrypted(data)) {\n    return data;\n  }\n  return await decryptState(data);\n  // TODO: Check that the decrypted state is a valid staet.\n}\n\nexport class GiiKERCube extends BluetoothPuzzle {\n  public static async connect(\n    server: BluetoothRemoteGATTServer,\n  ): Promise<GiiKERCube> {\n    const cubeService = await server.getPrimaryService(UUIDs.cubeService);\n    debugLog(\"Service:\", cubeService);\n\n    const cubeCharacteristic = await cubeService.getCharacteristic(\n      UUIDs.cubeCharacteristic,\n    );\n    debugLog(\"Characteristic:\", cubeCharacteristic);\n\n    // TODO: Can we safely save the async promise instead of waiting for the response?\n\n    const originalValue = await decodeState(\n      new Uint8Array((await cubeCharacteristic.readValue()).buffer),\n    );\n    debugLog(\"Original value:\", originalValue);\n    const cube = new GiiKERCube(server, cubeCharacteristic, originalValue);\n\n    await cubeCharacteristic.startNotifications();\n    cubeCharacteristic.addEventListener(\n      \"characteristicvaluechanged\",\n      cube.onCubeCharacteristicChanged.bind(cube),\n    );\n\n    return cube;\n  }\n\n  private constructor(\n    private server: BluetoothRemoteGATTServer,\n    private cubeCharacteristic: BluetoothRemoteGATTCharacteristic,\n    private originalValue?: Uint8Array | null,\n  ) {\n    super();\n  }\n\n  public name(): string | undefined {\n    return this.server.device.name;\n  }\n\n  public async getState(): Promise<PuzzleState> {\n    return this.toReid333(\n      new Uint8Array((await this.cubeCharacteristic.readValue()).buffer),\n    );\n  }\n\n  private getBit(val: Uint8Array, i: number): number {\n    const n = (i / 8) | 0;\n    const shift = 7 - (i % 8);\n    return (val[n] >> shift) & 1;\n  }\n\n  private toReid333(val: Uint8Array): Transformation {\n    const state = {\n      EDGES: {\n        permutation: new Array(12),\n        orientation: new Array(12),\n      },\n      CORNERS: {\n        permutation: new Array(8),\n        orientation: new Array(8),\n      },\n      CENTERS: Reid333SolvedCenters,\n    };\n\n    for (let i = 0; i < 12; i++) {\n      const gi = epReid333toGiiKER[i];\n      state.EDGES.permutation[i] =\n        epGiiKERtoReid333[getNibble(val, gi + 16) - 1];\n      state.EDGES.orientation[i] =\n        this.getBit(val, gi + 112) ^\n        preEO[state.EDGES.permutation[i]] ^\n        postEO[i];\n    }\n    for (let i = 0; i < 8; i++) {\n      const gi = cpReid333toGiiKER[i];\n      state.CORNERS.permutation[i] = cpGiiKERtoReid333[getNibble(val, gi) - 1];\n      state.CORNERS.orientation[i] =\n        (getNibble(val, gi + 8) * coFlip[gi] +\n          preCO[state.CORNERS.permutation[i]] +\n          postCO[i]) %\n        3;\n    }\n    return state;\n  }\n\n  private async onCubeCharacteristicChanged(event: any): Promise<void> {\n    const val = await decodeState(new Uint8Array(event.target.value.buffer));\n    debugLog(val);\n    debugLog(val);\n\n    if (this.isRepeatedInitialValue(val)) {\n      debugLog(\"Skipping repeated initial value.\");\n      return;\n    }\n\n    const giikerState = [];\n    for (let i = 0; i < MESSAGE_LENGTH; i++) {\n      giikerState.push(Math.floor(val[i] / 16));\n      giikerState.push(val[i] % 16);\n    }\n    debugLog(giikerState);\n    const str = giikerStateStr(giikerState);\n    debugLog(str);\n\n    this.dispatchMove({\n      latestMove: giikerMoveToBlockMove(giikerState[32], giikerState[33]),\n      timeStamp: event.timeStamp,\n      debug: {\n        stateStr: str,\n      },\n      state: this.toReid333(val),\n    });\n  }\n\n  private isRepeatedInitialValue(val: Uint8Array): boolean {\n    if (typeof this.originalValue === \"undefined\") {\n      // TODO: Test this branch.\n      throw new Error(\"GiiKERCube has uninitialized original value.\");\n    }\n\n    if (this.originalValue === null) {\n      return false;\n    }\n\n    const originalValue = this.originalValue;\n    // Reset the value here, so we can return early below.\n    this.originalValue = null;\n\n    debugLog(\"Comparing against original value.\");\n    for (let i = 0; i < MESSAGE_LENGTH - 2; i++) {\n      if (originalValue[i] !== val[i]) {\n        debugLog(\"Different at index \", i);\n        return false;\n      }\n    }\n    return true;\n  }\n}\n", "/* tslint:disable no-bitwise */\n\nimport { BareBlockMove, BlockMove } from \"../alg\";\nimport { Transformation } from \"../kpuzzle\";\nimport {\n  BluetoothConfig,\n  BluetoothPuzzle,\n  PuzzleState,\n} from \"./bluetooth-puzzle\";\nimport { debugLog } from \"./debug\";\n\nconst MESSAGE_LENGTH = 20;\n\nconst UUIDs = {\n  cubeService: \"0000aadb-0000-1000-8000-00805f9b34fb\",\n  cubeCharacteristic: \"0000aadc-0000-1000-8000-00805f9b34fb\",\n};\n\n// TODO: Move this into a factory?\nexport const giiKERConfig: BluetoothConfig = {\n  filters: [\n    // Known prefixes: GiC, GiS (3x3x3), Gi2 (2x2x2)\n    // Suspected prefixes GiY, Gi3\n    { namePrefix: \"Gi\" },\n    { services: [\"0000aadb-0000-1000-8000-00805f9b34fb\"] },\n    { services: [\"0000aaaa-0000-1000-8000-00805f9b34fb\"] },\n    { services: [\"0000fe95-0000-1000-8000-00805f9b34fb\"] },\n  ],\n  optionalServices: [\n    // \"00001530-1212-efde-1523-785feabcd123\",\n    // \"0000aaaa-0000-1000-8000-00805f9b34fb\",\n    UUIDs.cubeService,\n    // \"0000180f-0000-1000-8000-00805f9b34fb\",\n    // \"0000180a-0000-1000-8000-00805f9b34fb\"\n  ],\n};\n\n// TODO: Expose for testing.\nfunction giikerMoveToBlockMove(face: number, amount: number): BlockMove {\n  switch (amount) {\n    case 3:\n      amount = -1;\n      break;\n    case 9:\n      debugLog(\"Encountered 9\", face, amount);\n      amount = -2;\n      break;\n  }\n\n  const family = [\"?\", \"B\", \"D\", \"L\", \"U\", \"R\", \"F\"][face];\n  return BareBlockMove(family, amount);\n}\n\nexport { giikerMoveToBlockMove as giikerMoveToBlockMoveForTesting };\n\nfunction giikerStateStr(giikerState: number[]): string {\n  let str = \"\";\n  str += giikerState.slice(0, 8).join(\".\");\n  str += \"\\n\";\n  str += giikerState.slice(8, 16).join(\".\");\n  str += \"\\n\";\n  str += giikerState.slice(16, 28).join(\".\");\n  str += \"\\n\";\n  str += giikerState.slice(28, 32).join(\".\");\n  str += \"\\n\";\n  str += giikerState.slice(32, 40).join(\".\");\n  return str;\n}\n\n// TODO\n// const Reid333Orbits = {\n//   \"EDGES\":   {\"numPieces\": 12, \"orientations\": 2},\n//   \"CORNERS\": {\"numPieces\": 8,  \"orientations\": 3},\n//   \"CENTERS\": {\"numPieces\": 6,  \"orientations\": 4}\n// };\n\nconst Reid333SolvedCenters = {\n  permutation: [0, 1, 2, 3, 4, 5],\n  orientation: [0, 0, 0, 0, 0, 0],\n};\n\nconst epGiiKERtoReid333: number[] = [4, 8, 0, 9, 5, 1, 3, 7, 6, 10, 2, 11];\nconst epReid333toGiiKER: number[] = [2, 5, 10, 6, 0, 4, 8, 7, 1, 3, 9, 11];\n\nconst preEO: number[] = [1, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0];\nconst postEO: number[] = [1, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0];\n\nconst cpGiiKERtoReid333: number[] = [4, 0, 3, 5, 7, 1, 2, 6];\nconst cpReid333toGiiKER: number[] = [1, 5, 6, 2, 0, 3, 7, 4];\n\nconst preCO: number[] = [1, 2, 1, 2, 2, 1, 2, 1];\nconst postCO: number[] = [2, 1, 2, 1, 1, 2, 1, 2];\n\nconst coFlip: number[] = [-1, 1, -1, 1, 1, -1, 1, -1];\n\nfunction getNibble(val: Uint8Array, i: number): number {\n  if (i % 2 === 1) {\n    return val[(i / 2) | 0] % 16;\n  }\n  return 0 | (val[(i / 2) | 0] / 16);\n}\n\nfunction probablyEncrypted(data: Uint8Array): boolean {\n  return data[18] === 0xa7;\n}\n\nconst lookup = [\n  176,\n  81,\n  104,\n  224,\n  86,\n  137,\n  237,\n  119,\n  38,\n  26,\n  193,\n  161,\n  210,\n  126,\n  150,\n  81,\n  93,\n  13,\n  236,\n  249,\n  89,\n  235,\n  88,\n  24,\n  113,\n  81,\n  214,\n  131,\n  130,\n  199,\n  2,\n  169,\n  39,\n  165,\n  171,\n  41,\n];\n\nfunction decryptState(data: Uint8Array): Uint8Array {\n  const offset1 = getNibble(data, 38);\n  const offset2 = getNibble(data, 39);\n  const output = new Uint8Array(MESSAGE_LENGTH);\n  for (let i = 0; i < MESSAGE_LENGTH; i++) {\n    output[i] = data[i] + lookup[offset1 + i] + lookup[offset2 + i];\n  }\n  return output;\n}\n\n// TODO: Support caching which decoding strategy worked last time.\nasync function decodeState(data: Uint8Array): Promise<Uint8Array> {\n  if (!probablyEncrypted(data)) {\n    return data;\n  }\n  return await decryptState(data);\n  // TODO: Check that the decrypted state is a valid staet.\n}\n\nexport class GiiKERCube extends BluetoothPuzzle {\n  public static async connect(\n    server: BluetoothRemoteGATTServer,\n  ): Promise<GiiKERCube> {\n    const cubeService = await server.getPrimaryService(UUIDs.cubeService);\n    debugLog(\"Service:\", cubeService);\n\n    const cubeCharacteristic = await cubeService.getCharacteristic(\n      UUIDs.cubeCharacteristic,\n    );\n    debugLog(\"Characteristic:\", cubeCharacteristic);\n\n    // TODO: Can we safely save the async promise instead of waiting for the response?\n\n    const originalValue = await decodeState(\n      new Uint8Array((await cubeCharacteristic.readValue()).buffer),\n    );\n    debugLog(\"Original value:\", originalValue);\n    const cube = new GiiKERCube(server, cubeCharacteristic, originalValue);\n\n    await cubeCharacteristic.startNotifications();\n    cubeCharacteristic.addEventListener(\n      \"characteristicvaluechanged\",\n      cube.onCubeCharacteristicChanged.bind(cube),\n    );\n\n    return cube;\n  }\n\n  private constructor(\n    private server: BluetoothRemoteGATTServer,\n    private cubeCharacteristic: BluetoothRemoteGATTCharacteristic,\n    private originalValue?: Uint8Array | null,\n  ) {\n    super();\n  }\n\n  public name(): string | undefined {\n    return this.server.device.name;\n  }\n\n  public async getState(): Promise<PuzzleState> {\n    return this.toReid333(\n      new Uint8Array((await this.cubeCharacteristic.readValue()).buffer),\n    );\n  }\n\n  private getBit(val: Uint8Array, i: number): number {\n    const n = (i / 8) | 0;\n    const shift = 7 - (i % 8);\n    return (val[n] >> shift) & 1;\n  }\n\n  private toReid333(val: Uint8Array): Transformation {\n    const state = {\n      EDGES: {\n        permutation: new Array(12),\n        orientation: new Array(12),\n      },\n      CORNERS: {\n        permutation: new Array(8),\n        orientation: new Array(8),\n      },\n      CENTERS: Reid333SolvedCenters,\n    };\n\n    for (let i = 0; i < 12; i++) {\n      const gi = epReid333toGiiKER[i];\n      state.EDGES.permutation[i] =\n        epGiiKERtoReid333[getNibble(val, gi + 16) - 1];\n      state.EDGES.orientation[i] =\n        this.getBit(val, gi + 112) ^\n        preEO[state.EDGES.permutation[i]] ^\n        postEO[i];\n    }\n    for (let i = 0; i < 8; i++) {\n      const gi = cpReid333toGiiKER[i];\n      state.CORNERS.permutation[i] = cpGiiKERtoReid333[getNibble(val, gi) - 1];\n      state.CORNERS.orientation[i] =\n        (getNibble(val, gi + 8) * coFlip[gi] +\n          preCO[state.CORNERS.permutation[i]] +\n          postCO[i]) %\n        3;\n    }\n    return state;\n  }\n\n  private async onCubeCharacteristicChanged(event: any): Promise<void> {\n    const val = await decodeState(new Uint8Array(event.target.value.buffer));\n    debugLog(val);\n    debugLog(val);\n\n    if (this.isRepeatedInitialValue(val)) {\n      debugLog(\"Skipping repeated initial value.\");\n      return;\n    }\n\n    const giikerState = [];\n    for (let i = 0; i < MESSAGE_LENGTH; i++) {\n      giikerState.push(Math.floor(val[i] / 16));\n      giikerState.push(val[i] % 16);\n    }\n    debugLog(giikerState);\n    const str = giikerStateStr(giikerState);\n    debugLog(str);\n\n    this.dispatchMove({\n      latestMove: giikerMoveToBlockMove(giikerState[32], giikerState[33]),\n      timeStamp: event.timeStamp,\n      debug: {\n        stateStr: str,\n      },\n      state: this.toReid333(val),\n    });\n  }\n\n  private isRepeatedInitialValue(val: Uint8Array): boolean {\n    if (typeof this.originalValue === \"undefined\") {\n      // TODO: Test this branch.\n      throw new Error(\"GiiKERCube has uninitialized original value.\");\n    }\n\n    if (this.originalValue === null) {\n      return false;\n    }\n\n    const originalValue = this.originalValue;\n    // Reset the value here, so we can return early below.\n    this.originalValue = null;\n\n    debugLog(\"Comparing against original value.\");\n    for (let i = 0; i < MESSAGE_LENGTH - 2; i++) {\n      if (originalValue[i] !== val[i]) {\n        debugLog(\"Different at index \", i);\n        return false;\n      }\n    }\n    return true;\n  }\n}\n", "import { Quaternion } from \"three\";\nimport { BareBlockMove, BlockMove, Sequence } from \"../alg\";\nimport { BluetoothConfig, BluetoothPuzzle } from \"./bluetooth-puzzle\";\nimport { debugLog } from \"./debug\";\n\nconst UUIDs = {\n  goCubeService: \"6e400001-b5a3-f393-e0a9-e50e24dcca9e\",\n  goCubeStateCharacteristic: \"6e400003-b5a3-f393-e0a9-e50e24dcca9e\",\n};\n\n// TODO: Move this into a factory?\nexport const goCubeConfig: BluetoothConfig = {\n  filters: [{ namePrefix: \"GoCube\" }, { namePrefix: \"Rubik\" }],\n  optionalServices: [UUIDs.goCubeService],\n};\n\n// https://stackoverflow.com/a/40031979\nfunction buf2hex(buffer: ArrayBuffer): string {\n  // buffer is an ArrayBuffer\n  return Array.prototype.map\n    .call(new Uint8Array(buffer), (x: number) =>\n      (\"00\" + x.toString(16)).slice(-2),\n    )\n    .join(\"\");\n}\n\nfunction bufferToString(buffer: ArrayBuffer): string {\n  const byteView = new Uint8Array(buffer);\n  let str = \"\";\n  for (const charCode of byteView) {\n    str += String.fromCharCode(charCode);\n  }\n  return str;\n}\n\nconst moveMap: BlockMove[] = [\n  BareBlockMove(\"B\", 1),\n  BareBlockMove(\"B\", -1),\n  BareBlockMove(\"F\", 1),\n  BareBlockMove(\"F\", -1),\n  BareBlockMove(\"U\", 1),\n  BareBlockMove(\"U\", -1),\n  BareBlockMove(\"D\", 1),\n  BareBlockMove(\"D\", -1),\n  BareBlockMove(\"R\", 1),\n  BareBlockMove(\"R\", -1),\n  BareBlockMove(\"L\", 1),\n  BareBlockMove(\"L\", -1),\n];\n\nexport class GoCube extends BluetoothPuzzle {\n  // We have to perform async operations before we call the constructor.\n  public static async connect(\n    server: BluetoothRemoteGATTServer,\n  ): Promise<GoCube> {\n    const service = await server.getPrimaryService(UUIDs.goCubeService);\n    debugLog({ service });\n    const goCubeStateCharacteristic = await service.getCharacteristic(\n      UUIDs.goCubeStateCharacteristic,\n    );\n    debugLog({ goCubeStateCharacteristic });\n\n    const cube = new GoCube(server, goCubeStateCharacteristic);\n\n    await goCubeStateCharacteristic.startNotifications();\n    goCubeStateCharacteristic.addEventListener(\n      \"characteristicvaluechanged\",\n      cube.onCubeCharacteristicChanged.bind(cube),\n    );\n\n    return cube;\n  }\n\n  // public async getState(): Promise<PuzzleState> {\n  //   return new Promise((resolve, reject) => {\n  //     this.resolve = (value: any) => {\n  //       resolve(buf2hex(value.buffer) as any);\n  //     };\n  //     this.goCubeStateCharacteristic.startNotifications();\n  //   });\n  // }\n\n  private recorded: any[][] = [];\n\n  private homeQuatInverse: Quaternion | null = null;\n  private lastRawQuat: Quaternion = new Quaternion(0, 0, 0, 1);\n  private currentQuat: Quaternion = new Quaternion(0, 0, 0, 1);\n  private lastTarget: Quaternion = new Quaternion(0, 0, 0, 1);\n  private alg: Sequence = new Sequence([]);\n\n  private constructor(\n    private server: BluetoothRemoteGATTServer,\n    public goCubeStateCharacteristic: BluetoothRemoteGATTCharacteristic,\n  ) {\n    super();\n  }\n\n  public reset(): void {\n    this.resetAlg();\n    this.resetOrientation();\n  }\n\n  public resetAlg(algo?: Sequence): void {\n    this.alg = algo || new Sequence([]);\n  }\n\n  public resetOrientation(): void {\n    this.homeQuatInverse = this.lastRawQuat.clone().inverse();\n    this.currentQuat = new Quaternion(0, 0, 0, 1);\n    this.lastTarget = new Quaternion(0, 0, 0, 1);\n  }\n\n  public name(): string | undefined {\n    return this.server.device.name;\n  }\n\n  private onCubeCharacteristicChanged(event: any): void {\n    const buffer: DataView = event.target.value;\n    this.recorded.push([event.timeStamp, buf2hex(buffer.buffer)]);\n    if (buffer.byteLength === 8) {\n      const move = moveMap[buffer.getUint8(3)];\n      this.alg = new Sequence(this.alg.nestedUnits.concat([move]));\n      this.dispatchMove({\n        latestMove: moveMap[buffer.getUint8(3)],\n        timeStamp: event.timeStamp,\n        debug: {\n          stateStr: buf2hex(buffer.buffer),\n        },\n      });\n    } else {\n      const coords = bufferToString(\n        buffer.buffer.slice(3, buffer.byteLength - 3),\n      )\n        .split(\"#\")\n        .map((s) => parseInt(s, 10) / 16384);\n      const quat = new Quaternion(coords[0], coords[1], coords[2], coords[3]);\n\n      this.lastRawQuat = quat.clone();\n\n      if (!this.homeQuatInverse) {\n        this.homeQuatInverse = quat.clone().inverse();\n      }\n\n      const targetQuat = quat.clone().multiply(this.homeQuatInverse.clone());\n      targetQuat.y = -targetQuat.y; // GoCube axis fix.\n\n      this.lastTarget.slerp(targetQuat, 0.5);\n      this.currentQuat.rotateTowards(this.lastTarget, rotateTowardsRate);\n\n      this.dispatchOrientation({\n        quaternion: this.currentQuat,\n        timeStamp: event.timeStamp,\n      });\n    }\n  }\n}\n\nconst rotateTowardsRate = 0.5;\n", "import { Quaternion } from \"three\";\nimport { BareBlockMove, BlockMove, Sequence } from \"../alg\";\nimport { BluetoothConfig, BluetoothPuzzle } from \"./bluetooth-puzzle\";\nimport { debugLog } from \"./debug\";\n\nconst UUIDs = {\n  goCubeService: \"6e400001-b5a3-f393-e0a9-e50e24dcca9e\",\n  goCubeStateCharacteristic: \"6e400003-b5a3-f393-e0a9-e50e24dcca9e\",\n};\n\n// TODO: Move this into a factory?\nexport const goCubeConfig: BluetoothConfig = {\n  filters: [{ namePrefix: \"GoCube\" }, { namePrefix: \"Rubik\" }],\n  optionalServices: [UUIDs.goCubeService],\n};\n\n// https://stackoverflow.com/a/40031979\nfunction buf2hex(buffer: ArrayBuffer): string {\n  // buffer is an ArrayBuffer\n  return Array.prototype.map\n    .call(new Uint8Array(buffer), (x: number) =>\n      (\"00\" + x.toString(16)).slice(-2),\n    )\n    .join(\"\");\n}\n\nfunction bufferToString(buffer: ArrayBuffer): string {\n  const byteView = new Uint8Array(buffer);\n  let str = \"\";\n  for (const charCode of byteView) {\n    str += String.fromCharCode(charCode);\n  }\n  return str;\n}\n\nconst moveMap: BlockMove[] = [\n  BareBlockMove(\"B\", 1),\n  BareBlockMove(\"B\", -1),\n  BareBlockMove(\"F\", 1),\n  BareBlockMove(\"F\", -1),\n  BareBlockMove(\"U\", 1),\n  BareBlockMove(\"U\", -1),\n  BareBlockMove(\"D\", 1),\n  BareBlockMove(\"D\", -1),\n  BareBlockMove(\"R\", 1),\n  BareBlockMove(\"R\", -1),\n  BareBlockMove(\"L\", 1),\n  BareBlockMove(\"L\", -1),\n];\n\nexport class GoCube extends BluetoothPuzzle {\n  // We have to perform async operations before we call the constructor.\n  public static async connect(\n    server: BluetoothRemoteGATTServer,\n  ): Promise<GoCube> {\n    const service = await server.getPrimaryService(UUIDs.goCubeService);\n    debugLog({ service });\n    const goCubeStateCharacteristic = await service.getCharacteristic(\n      UUIDs.goCubeStateCharacteristic,\n    );\n    debugLog({ goCubeStateCharacteristic });\n\n    const cube = new GoCube(server, goCubeStateCharacteristic);\n\n    await goCubeStateCharacteristic.startNotifications();\n    goCubeStateCharacteristic.addEventListener(\n      \"characteristicvaluechanged\",\n      cube.onCubeCharacteristicChanged.bind(cube),\n    );\n\n    return cube;\n  }\n\n  // public async getState(): Promise<PuzzleState> {\n  //   return new Promise((resolve, reject) => {\n  //     this.resolve = (value: any) => {\n  //       resolve(buf2hex(value.buffer) as any);\n  //     };\n  //     this.goCubeStateCharacteristic.startNotifications();\n  //   });\n  // }\n\n  private recorded: any[][] = [];\n\n  private homeQuatInverse: Quaternion | null = null;\n  private lastRawQuat: Quaternion = new Quaternion(0, 0, 0, 1);\n  private currentQuat: Quaternion = new Quaternion(0, 0, 0, 1);\n  private lastTarget: Quaternion = new Quaternion(0, 0, 0, 1);\n  private alg: Sequence = new Sequence([]);\n\n  private constructor(\n    private server: BluetoothRemoteGATTServer,\n    public goCubeStateCharacteristic: BluetoothRemoteGATTCharacteristic,\n  ) {\n    super();\n  }\n\n  public reset(): void {\n    this.resetAlg();\n    this.resetOrientation();\n  }\n\n  public resetAlg(algo?: Sequence): void {\n    this.alg = algo || new Sequence([]);\n  }\n\n  public resetOrientation(): void {\n    this.homeQuatInverse = this.lastRawQuat.clone().inverse();\n    this.currentQuat = new Quaternion(0, 0, 0, 1);\n    this.lastTarget = new Quaternion(0, 0, 0, 1);\n  }\n\n  public name(): string | undefined {\n    return this.server.device.name;\n  }\n\n  private onCubeCharacteristicChanged(event: any): void {\n    const buffer: DataView = event.target.value;\n    this.recorded.push([event.timeStamp, buf2hex(buffer.buffer)]);\n    if (buffer.byteLength === 8) {\n      const move = moveMap[buffer.getUint8(3)];\n      this.alg = new Sequence(this.alg.nestedUnits.concat([move]));\n      this.dispatchMove({\n        latestMove: moveMap[buffer.getUint8(3)],\n        timeStamp: event.timeStamp,\n        debug: {\n          stateStr: buf2hex(buffer.buffer),\n        },\n      });\n    } else {\n      const coords = bufferToString(\n        buffer.buffer.slice(3, buffer.byteLength - 3),\n      )\n        .split(\"#\")\n        .map((s) => parseInt(s, 10) / 16384);\n      const quat = new Quaternion(coords[0], coords[1], coords[2], coords[3]);\n\n      this.lastRawQuat = quat.clone();\n\n      if (!this.homeQuatInverse) {\n        this.homeQuatInverse = quat.clone().inverse();\n      }\n\n      const targetQuat = quat.clone().multiply(this.homeQuatInverse.clone());\n      targetQuat.y = -targetQuat.y; // GoCube axis fix.\n\n      this.lastTarget.slerp(targetQuat, 0.5);\n      this.currentQuat.rotateTowards(this.lastTarget, rotateTowardsRate);\n\n      this.dispatchOrientation({\n        quaternion: this.currentQuat,\n        timeStamp: event.timeStamp,\n      });\n    }\n  }\n}\n\nconst rotateTowardsRate = 0.5;\n", "import { BluetoothPuzzle } from \"./bluetooth-puzzle\";\nimport { debugLog } from \"./debug\";\nimport { ganConfig, GanCube } from \"./gan\";\nimport { giiKERConfig, GiiKERCube } from \"./giiker\";\nimport { GoCube, goCubeConfig } from \"./gocube\";\n\n/******** requestOptions ********/\n\nexport interface BluetoothConfig {\n  filters: BluetoothRequestDeviceFilter[];\n  optionalServices: BluetoothServiceUUID[];\n}\n\nfunction requestOptions(\n  acceptAllDevices: boolean = false,\n): RequestDeviceOptions {\n  const options = acceptAllDevices\n    ? {\n        acceptAllDevices: true,\n        optionalServices: [] as BluetoothServiceUUID[],\n      }\n    : {\n        filters: [] as BluetoothRequestDeviceFilter[],\n        optionalServices: [] as BluetoothServiceUUID[],\n      };\n  for (const config of [ganConfig, giiKERConfig, goCubeConfig]) {\n    if (!acceptAllDevices) {\n      // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n      options.filters = options.filters!.concat(config.filters);\n    }\n    options.optionalServices = options.optionalServices.concat(\n      config.optionalServices,\n    );\n  }\n  debugLog({ requestOptions: options });\n  return options;\n}\n\n/******** connect() ********/\n\ninterface BluetoothConnectOptions {\n  acceptAllDevices?: boolean;\n}\n\n// We globally track the number of connection failures,\n// in order to offer the user recourse (accept all devices) if they're having issues.\n// This allows us to future-proof situations where a device might not show up in\n// the chooser, but works if we connect.\nlet consecutiveFailures = 0;\nconst MAX_FAILURES_BEFORE_ACCEPT_ALL_FALLBACK = 2;\n\n// TODO: Debug options to allow connecting to any device?\nexport async function connect(\n  options: BluetoothConnectOptions = {},\n): Promise<BluetoothPuzzle> {\n  debugLog(\"Attempting to pair.\");\n  let device;\n  try {\n    let acceptAllDevices = options.acceptAllDevices;\n    if (\n      !acceptAllDevices &&\n      consecutiveFailures >= MAX_FAILURES_BEFORE_ACCEPT_ALL_FALLBACK\n    ) {\n      console.info(\n        `The last ${MAX_FAILURES_BEFORE_ACCEPT_ALL_FALLBACK} Bluetooth puzzle connection attempts failed. This time, the Bluetooth prompt will show all possible devices.`,\n      );\n      acceptAllDevices = true;\n    }\n    device = await navigator.bluetooth.requestDevice(\n      requestOptions(acceptAllDevices),\n    );\n    consecutiveFailures = 0;\n  } catch (e) {\n    consecutiveFailures++;\n    throw new Error(e);\n  }\n  debugLog(\"Device:\", device);\n\n  if (typeof device.gatt === \"undefined\") {\n    return Promise.reject(\"Device did not have a GATT server.\");\n  }\n\n  const server = await device.gatt.connect();\n  debugLog(\"Server:\", server);\n\n  const name = server.device?.name || \"\";\n\n  // TODO by reading supported matched filters or provided services.\n  if (name && name.startsWith(\"GAN\")) {\n    return await GanCube.connect(server);\n  } else if ((name && name.startsWith(\"GoCube\")) || name.startsWith(\"Rubik\")) {\n    return await GoCube.connect(server);\n  } else {\n    return await GiiKERCube.connect(server);\n  }\n}\n", "import { keyToMove } from \"../alg\";\nimport { KPuzzle, Puzzles } from \"../kpuzzle\";\nimport { BluetoothPuzzle, PuzzleState } from \"./bluetooth-puzzle\";\n\nconst def = Puzzles[\"3x3x3\"];\n\nexport class KeyboardPuzzle extends BluetoothPuzzle {\n  public puzzle: KPuzzle = new KPuzzle(def);\n  // TODO: Decide on the right arguments.\n  constructor(target: Element) {\n    super();\n    // TODO: Filter out repeated keydown?\n    target.addEventListener(\"keydown\", this.onKeyDown.bind(this));\n  }\n\n  public name(): string | undefined {\n    return \"Keyboard Input\";\n  }\n\n  public async getState(): Promise<PuzzleState> {\n    return this.puzzle.state;\n  }\n\n  private onKeyDown(e: KeyboardEvent): void {\n    if (e.altKey || e.ctrlKey || e.metaKey || e.shiftKey) {\n      return;\n    }\n\n    const move = keyToMove(e);\n    if (move) {\n      this.puzzle.applyBlockMove(move);\n      this.dispatchMove({\n        latestMove: move,\n        timeStamp: e.timeStamp,\n        state: this.puzzle.state,\n      });\n      e.preventDefault();\n    }\n  }\n}\n\n// TODO: Type\nexport async function debugKeyboardConnect(\n  target: any = window,\n): Promise<KeyboardPuzzle> {\n  return new KeyboardPuzzle(target);\n}\n", "export {\n  reid3x3x3ToTwizzleBinary,\n  twizzleBinaryToReid3x3x3,\n} from \"./binary/binary3x3x3\";\nexport { bufferToSpacedHex, spacedHexToBuffer } from \"./binary/hex\";\n", "export function identityPermutation(numElems: number): number[] {\n  const arr = new Array(numElems);\n  for (let i = 0; i < numElems; i++) {\n    arr[i] = i;\n  }\n  return arr;\n}\n\n// Inclusive start, exclusive end (similar to `Array.prototype.slice`)\nexport function orientationsToMask(\n  radix: number,\n  orientations: number[],\n): number {\n  let val = 0;\n  for (const orientation of orientations) {\n    val *= radix;\n    val += orientation;\n  }\n  return val;\n}\n\n// Inclusive start, exclusive end (similar to `Array.prototype.slice`)\nexport function maskToOrientations(\n  radix: number,\n  numElems: number,\n  mask: number,\n): number[] {\n  const arr = [];\n  while (mask > 0) {\n    arr.push(mask % radix);\n    mask = Math.floor(mask / radix);\n  }\n  return new Array(numElems - arr.length).fill(0).concat(arr.reverse());\n}\n\n// From https://www.jaapsch.net/puzzles/compindx.htm#perm\nexport function permutationToLex(permutation: number[]): number {\n  const n = permutation.length;\n  let lexicographicIdx = 0;\n  for (let i = 0; i < n - 1; i++) {\n    lexicographicIdx = lexicographicIdx * (n - i);\n    for (let j = i + 1; j < n; j++) {\n      if (permutation[i] > permutation[j]) {\n        lexicographicIdx += 1;\n      }\n    }\n  }\n  return lexicographicIdx;\n}\n\n// From https://www.jaapsch.net/puzzles/compindx.htm#perm\nexport function lexToPermutation(\n  numPieces: number,\n  lexicographicIdx: number,\n): number[] {\n  const permutation: number[] = new Array(numPieces);\n  permutation[numPieces - 1] = 0;\n  for (let i = numPieces - 2; i >= 0; i--) {\n    permutation[i] = lexicographicIdx % (numPieces - i);\n    lexicographicIdx = Math.floor(lexicographicIdx / (numPieces - i));\n    for (let j = i + 1; j < numPieces; j++) {\n      if (permutation[j] >= permutation[i]) {\n        permutation[j] = permutation[j] + 1;\n      }\n    }\n  }\n  return permutation;\n}\n", "import { parse, Sequence } from \"../../alg\";\nimport {\n  Combine,\n  Invert,\n  KPuzzle,\n  Puzzles,\n  Transformation,\n} from \"../../kpuzzle\";\nimport {\n  identityPermutation,\n  lexToPermutation,\n  maskToOrientations,\n  orientationsToMask,\n  permutationToLex,\n} from \"./orbit-indexing\";\n\ntype Binary3x3x3State = ArrayBuffer;\n\n// Bit lengths of the encoded components, in order.\nconst BIT_LENGTHS = [29, 12, 16, 13, 3, 2, 1, 12];\n\n// These fields are sorted by the order in which they appear in the binary format.\nexport interface Binary3x3x3Components {\n  epLex: number; // 29 bits, edge permutation\n  eoMask: number; // 12 bits, edge orientation\n  cpLex: number; // 16 bits, corner permutation\n  coMask: number; // 13 bits, corner orientation\n  poIdxU: number; // 3 bits, puzzle orientation (U face)\n  poIdxL: number; // 2 bits, puzzle orientation (L face)\n  moSupport: number; // 1 bit, center orientation support\n  moMask: number; // 12 bits, center orientation\n}\n\n// There are various clever ways to do this, but this is simple and efficient.\nfunction arraySum(arr: number[]): number {\n  let total = 0;\n  for (const entry of arr) {\n    total += entry;\n  }\n  return total;\n}\n\n// Due to limitations in JS bit operations, this is unsafe if any of the bit lengths span across the contents of more than 4 bytes.\n// - Safe: [8, 32]\n// - Unsafe: [4, 32, 4]\n// - Unsafe: [40, 4]\nfunction splitBinary(bitLengths: number[], buffy: ArrayBuffer): number[] {\n  const u8buffy = new Uint8Array(buffy);\n  let at = 0;\n  let bits = 0;\n  let accum = 0;\n  const values: number[] = [];\n  for (const bitLength of bitLengths) {\n    while (bits < bitLength) {\n      accum = (accum << 8) | u8buffy[at++];\n      bits += 8;\n    }\n    values.push((accum >> (bits - bitLength)) & ((1 << bitLength) - 1));\n    bits -= bitLength;\n  }\n  return values;\n}\n\n// See above for safety notes.\nfunction concatBinary(bitLengths: number[], values: number[]): ArrayBuffer {\n  const buffy = new Uint8Array(Math.ceil(arraySum(bitLengths) / 8));\n  let at = 0;\n  let bits = 0;\n  let accum = 0;\n  for (let i = 0; i < bitLengths.length; i++) {\n    accum = (accum << bitLengths[i]) | values[i];\n    bits += bitLengths[i];\n    while (bits >= 8) {\n      buffy[at++] = accum >> (bits - 8);\n      bits -= 8;\n    }\n  }\n  if (bits > 0) {\n    buffy[at++] = accum << (8 - bits);\n  }\n  return buffy;\n}\n\nfunction puzzleOrientationIdx(state: Transformation): [number, number] {\n  const idxU = state[\"CENTERS\"].permutation[0];\n  const idxD = state[\"CENTERS\"].permutation[5];\n  const unadjustedIdxL = state[\"CENTERS\"].permutation[1];\n  let idxL = unadjustedIdxL;\n  if (idxU < unadjustedIdxL) {\n    idxL--;\n  }\n  if (idxD < unadjustedIdxL) {\n    idxL--;\n  }\n  return [idxU, idxL];\n}\n\nconst puzzleOrientationCache: Transformation[][] = new Array(6)\n  .fill(0)\n  .map(() => {\n    return new Array(6);\n  });\n\n// We use a new block to avoid keeping a reference to temporary vars.\n{\n  const orientationKpuzzle = new KPuzzle(Puzzles[\"3x3x3\"]);\n  const uAlgs: Sequence[] = [\"\", \"z\", \"x\", \"z'\", \"x'\", \"x2\"].map((s) =>\n    parse(s),\n  );\n  const yAlg = parse(\"y\");\n  for (const uAlg of uAlgs) {\n    orientationKpuzzle.reset();\n    orientationKpuzzle.applyAlg(uAlg);\n    for (let i = 0; i < 4; i++) {\n      orientationKpuzzle.applyAlg(yAlg);\n      const [idxU, idxL] = puzzleOrientationIdx(orientationKpuzzle.state);\n      puzzleOrientationCache[idxU][idxL] = Invert(\n        Puzzles[\"3x3x3\"],\n        orientationKpuzzle.state,\n      );\n    }\n  }\n}\n\nfunction normalizePuzzleOrientation(s: Transformation): Transformation {\n  const [idxU, idxL] = puzzleOrientationIdx(s);\n  const orientationTransformation = puzzleOrientationCache[idxU][idxL];\n  return Combine(Puzzles[\"3x3x3\"], s, orientationTransformation);\n}\n\n// TODO: combine with `orientPuzzle`?\nfunction reorientPuzzle(\n  s: Transformation,\n  idxU: number,\n  idxL: number,\n): Transformation {\n  const orientationTransformation = Invert(\n    Puzzles[\"3x3x3\"],\n    puzzleOrientationCache[idxU][idxL],\n  );\n  return Combine(Puzzles[\"3x3x3\"], s, orientationTransformation);\n}\n// 0x111 (for idxU) means \"not supported\"\nfunction supportsPuzzleOrientation(components: Binary3x3x3Components): boolean {\n  return components.poIdxU !== 7;\n}\n\nexport function reid3x3x3ToBinaryComponents(\n  state: Transformation,\n): Binary3x3x3Components {\n  const normedState = normalizePuzzleOrientation(state);\n\n  const epLex = permutationToLex(normedState[\"EDGES\"].permutation);\n  const eoMask = orientationsToMask(2, normedState[\"EDGES\"].orientation);\n  const cpLex = permutationToLex(normedState[\"CORNERS\"].permutation);\n  const coMask = orientationsToMask(3, normedState[\"CORNERS\"].orientation);\n  const [poIdxU, poIdxL] = puzzleOrientationIdx(state);\n  const moSupport = 1; // Required for now.\n  const moMask = orientationsToMask(4, normedState[\"CENTERS\"].orientation);\n\n  return {\n    epLex,\n    eoMask,\n    cpLex,\n    coMask,\n    poIdxU,\n    poIdxL,\n    moSupport,\n    moMask,\n  };\n}\n\nexport function binaryComponentsToTwizzleBinary(\n  components: Binary3x3x3Components,\n): Binary3x3x3State {\n  const {\n    epLex,\n    eoMask,\n    cpLex,\n    coMask,\n    poIdxU,\n    poIdxL,\n    moSupport,\n    moMask,\n  } = components;\n\n  return concatBinary(BIT_LENGTHS, [\n    epLex,\n    eoMask,\n    cpLex,\n    coMask,\n    poIdxU,\n    poIdxL,\n    moSupport,\n    moMask,\n  ]);\n}\n\nexport function reid3x3x3ToTwizzleBinary(\n  state: Transformation,\n): Binary3x3x3State {\n  const components: Binary3x3x3Components = reid3x3x3ToBinaryComponents(state);\n  return binaryComponentsToTwizzleBinary(components);\n}\n\nexport function twizzleBinaryToBinaryComponents(\n  buffer: ArrayBuffer,\n): Binary3x3x3Components {\n  const [\n    epLex,\n    eoMask,\n    cpLex,\n    coMask,\n    poIdxU,\n    poIdxL,\n    moSupport,\n    moMask,\n  ] = splitBinary(BIT_LENGTHS, buffer);\n\n  return {\n    epLex,\n    eoMask,\n    cpLex,\n    coMask,\n    poIdxU,\n    poIdxL,\n    moSupport,\n    moMask,\n  };\n}\n\nexport function binaryComponentsToReid3x3x3(\n  components: Binary3x3x3Components,\n): Transformation {\n  if (components.moSupport !== 1) {\n    throw new Error(\"Must support center orientation.\");\n  }\n\n  const normedState = {\n    EDGES: {\n      permutation: lexToPermutation(12, components.epLex),\n      orientation: maskToOrientations(2, 12, components.eoMask),\n    },\n    CORNERS: {\n      permutation: lexToPermutation(8, components.cpLex),\n      orientation: maskToOrientations(3, 8, components.coMask),\n    },\n    CENTERS: {\n      permutation: identityPermutation(6),\n      orientation: maskToOrientations(4, 6, components.moMask),\n    },\n  };\n\n  if (!supportsPuzzleOrientation(components)) {\n    return normedState;\n  }\n\n  return reorientPuzzle(normedState, components.poIdxU, components.poIdxL);\n}\n\n// Returns a list of error string.\n// An empty list means validation success.\nfunction validateComponents(components: Binary3x3x3Components): string[] {\n  const errors = [];\n  if (components.epLex < 0 || components.epLex >= 479001600) {\n    errors.push(`epLex (${components.epLex}) out of range`);\n  }\n  if (components.cpLex < 0 || components.cpLex >= 40320) {\n    errors.push(`cpLex (${components.cpLex}) out of range`);\n  }\n  if (components.coMask < 0 || components.coMask >= 6561) {\n    errors.push(`coMask (${components.coMask}) out of range`);\n  }\n  if (components.poIdxU < 0 || components.poIdxU >= 6) {\n    // 0x111 (for idxU) means \"not supported\"\n    if (supportsPuzzleOrientation(components)) {\n      errors.push(`poIdxU (${components.poIdxU}) out of range`);\n    }\n  }\n  // The following cannot be (f decoded from binary properl) out of rangey.\n  if (components.eoMask < 0 || components.eoMask >= 4096) {\n    errors.push(`eoMask (${components.eoMask}) out of range`);\n  }\n  if (components.moMask < 0 || components.moMask >= 4096) {\n    errors.push(`moMask (${components.moMask}) out of range`);\n  }\n  if (components.poIdxL < 0 || components.poIdxL >= 4) {\n    errors.push(`poIdxL (${components.poIdxL}) out of range`);\n  }\n  if (components.moSupport < 0 || components.moSupport >= 2) {\n    errors.push(`moSupport (${components.moSupport}) out of range`);\n  }\n  return errors;\n}\n\nexport function twizzleBinaryToReid3x3x3(buffy: ArrayBuffer): Transformation {\n  const components = twizzleBinaryToBinaryComponents(buffy);\n  const errors = validateComponents(components);\n  if (errors.length !== 0) {\n    throw new Error(`Invalid binary state components: ${errors.join(\", \")}`);\n  }\n  return binaryComponentsToReid3x3x3(components);\n}\n", "export function bufferToSpacedHex(buffer: ArrayBuffer): string {\n  // buffer is an ArrayBuffer\n  return Array.prototype.map\n    .call(new Uint8Array(buffer), (x: number) =>\n      (\"00\" + x.toString(16)).slice(-2),\n    )\n    .join(\" \");\n}\n\nexport function spacedHexToBuffer(hex: string): Uint8Array {\n  return new Uint8Array(hex.split(\" \").map((c) => parseInt(c, 16)));\n}\n", "export { Perm } from \"./Perm\";\nexport {\n  Orbit,\n  OrbitDef,\n  OrbitsDef,\n  Transformation,\n  VisibleState,\n} from \"./PermOriSet\";\nexport {\n  getpuzzle,\n  getPuzzleGeometryByDesc,\n  getPuzzleGeometryByName,\n  getpuzzles,\n  parsedesc,\n  PuzzleGeometry,\n  StickerDat,\n  StickerDatAxis,\n  StickerDatFace,\n  StickerDatSticker,\n  useNewFaceNames,\n} from \"./PuzzleGeometry\";\nexport { Quat } from \"./Quat\";\nexport { schreierSims } from \"./SchreierSims\";\n", "const zeroCache: number[][] = [];\nconst iotaCache: number[][] = [];\n\nexport function zeros(n: number): number[] {\n  if (!zeroCache[n]) {\n    const c = Array(n);\n    for (let i = 0; i < n; i++) {\n      c[i] = 0;\n    }\n    zeroCache[n] = c;\n  }\n  return zeroCache[n];\n}\n\nexport function iota(n: number): number[] {\n  if (!iotaCache[n]) {\n    const c = Array(n);\n    for (let i = 0; i < n; i++) {\n      c[i] = i;\n    }\n    iotaCache[n] = c;\n  }\n  return iotaCache[n];\n}\n\nexport function identity(n: number): Perm {\n  return new Perm(iota(n));\n}\n\nexport function random(n: number): Perm {\n  // random\n  const c = Array(n);\n  for (let i = 0; i < n; i++) {\n    c[i] = i;\n  }\n  for (let i = 0; i < n; i++) {\n    const j = i + Math.floor((n - i) * Math.random());\n    const t = c[i];\n    c[i] = c[j];\n    c[j] = t;\n  }\n  return new Perm(c);\n}\n\nexport function factorial(a: number): number {\n  let r = 1;\n  while (a > 1) {\n    r *= a;\n    a--;\n  }\n  return r;\n}\n\nfunction gcd(a: number, b: number): number {\n  if (a > b) {\n    const t = a;\n    a = b;\n    b = t;\n  }\n  while (a > 0) {\n    const m = b % a;\n    b = a;\n    a = m;\n  }\n  return b;\n}\n\nexport function lcm(a: number, b: number): number {\n  return (a / gcd(a, b)) * b;\n}\n\nexport class Perm {\n  public n: number; // length\n  public p: number[]; // The permutation itself\n  constructor(a: number[]) {\n    this.n = a.length;\n    this.p = a;\n  }\n\n  public toString(): string {\n    // stringify\n    return \"Perm[\" + this.p.join(\" \") + \"]\";\n  }\n\n  public mul(p2: Perm): Perm {\n    // multiply\n    const c: number[] = Array(this.n);\n    for (let i = 0; i < this.n; i++) {\n      c[i] = p2.p[this.p[i]];\n    }\n    return new Perm(c);\n  }\n\n  public rmul(p2: Perm): Perm {\n    // multiply the other way\n    const c = Array(this.n);\n    for (let i = 0; i < this.n; i++) {\n      c[i] = this.p[p2.p[i]];\n    }\n    return new Perm(c);\n  }\n\n  public inv(): Perm {\n    const c = Array(this.n);\n    for (let i = 0; i < this.n; i++) {\n      c[this.p[i]] = i;\n    }\n    return new Perm(c);\n  }\n\n  public compareTo(p2: Perm): number {\n    // comparison\n    for (let i = 0; i < this.n; i++) {\n      if (this.p[i] !== p2.p[i]) {\n        return this.p[i] - p2.p[i];\n      }\n    }\n    return 0;\n  }\n\n  public toGap(): string {\n    const cyc = new Array<string>();\n    const seen = new Array<boolean>(this.n);\n    for (let i = 0; i < this.p.length; i++) {\n      if (seen[i] || this.p[i] === i) {\n        continue;\n      }\n      const incyc = new Array<number>();\n      for (let j = i; !seen[j]; j = this.p[j]) {\n        incyc.push(1 + j);\n        seen[j] = true;\n      }\n      cyc.push(\"(\" + incyc.join(\",\") + \")\");\n    }\n    return cyc.join(\"\");\n  }\n\n  public order(): number {\n    let r = 1;\n    const seen = new Array<boolean>(this.n);\n    for (let i = 0; i < this.p.length; i++) {\n      if (seen[i] || this.p[i] === i) {\n        continue;\n      }\n      let cs = 0;\n      for (let j = i; !seen[j]; j = this.p[j]) {\n        cs++;\n        seen[j] = true;\n      }\n      r = lcm(r, cs);\n    }\n    return r;\n  }\n}\n", "const zeroCache: number[][] = [];\nconst iotaCache: number[][] = [];\n\nexport function zeros(n: number): number[] {\n  if (!zeroCache[n]) {\n    const c = Array(n);\n    for (let i = 0; i < n; i++) {\n      c[i] = 0;\n    }\n    zeroCache[n] = c;\n  }\n  return zeroCache[n];\n}\n\nexport function iota(n: number): number[] {\n  if (!iotaCache[n]) {\n    const c = Array(n);\n    for (let i = 0; i < n; i++) {\n      c[i] = i;\n    }\n    iotaCache[n] = c;\n  }\n  return iotaCache[n];\n}\n\nexport function identity(n: number): Perm {\n  return new Perm(iota(n));\n}\n\nexport function random(n: number): Perm {\n  // random\n  const c = Array(n);\n  for (let i = 0; i < n; i++) {\n    c[i] = i;\n  }\n  for (let i = 0; i < n; i++) {\n    const j = i + Math.floor((n - i) * Math.random());\n    const t = c[i];\n    c[i] = c[j];\n    c[j] = t;\n  }\n  return new Perm(c);\n}\n\nexport function factorial(a: number): number {\n  let r = 1;\n  while (a > 1) {\n    r *= a;\n    a--;\n  }\n  return r;\n}\n\nfunction gcd(a: number, b: number): number {\n  if (a > b) {\n    const t = a;\n    a = b;\n    b = t;\n  }\n  while (a > 0) {\n    const m = b % a;\n    b = a;\n    a = m;\n  }\n  return b;\n}\n\nexport function lcm(a: number, b: number): number {\n  return (a / gcd(a, b)) * b;\n}\n\nexport class Perm {\n  public n: number; // length\n  public p: number[]; // The permutation itself\n  constructor(a: number[]) {\n    this.n = a.length;\n    this.p = a;\n  }\n\n  public toString(): string {\n    // stringify\n    return \"Perm[\" + this.p.join(\" \") + \"]\";\n  }\n\n  public mul(p2: Perm): Perm {\n    // multiply\n    const c: number[] = Array(this.n);\n    for (let i = 0; i < this.n; i++) {\n      c[i] = p2.p[this.p[i]];\n    }\n    return new Perm(c);\n  }\n\n  public rmul(p2: Perm): Perm {\n    // multiply the other way\n    const c = Array(this.n);\n    for (let i = 0; i < this.n; i++) {\n      c[i] = this.p[p2.p[i]];\n    }\n    return new Perm(c);\n  }\n\n  public inv(): Perm {\n    const c = Array(this.n);\n    for (let i = 0; i < this.n; i++) {\n      c[this.p[i]] = i;\n    }\n    return new Perm(c);\n  }\n\n  public compareTo(p2: Perm): number {\n    // comparison\n    for (let i = 0; i < this.n; i++) {\n      if (this.p[i] !== p2.p[i]) {\n        return this.p[i] - p2.p[i];\n      }\n    }\n    return 0;\n  }\n\n  public toGap(): string {\n    const cyc = new Array<string>();\n    const seen = new Array<boolean>(this.n);\n    for (let i = 0; i < this.p.length; i++) {\n      if (seen[i] || this.p[i] === i) {\n        continue;\n      }\n      const incyc = new Array<number>();\n      for (let j = i; !seen[j]; j = this.p[j]) {\n        incyc.push(1 + j);\n        seen[j] = true;\n      }\n      cyc.push(\"(\" + incyc.join(\",\") + \")\");\n    }\n    return cyc.join(\"\");\n  }\n\n  public order(): number {\n    let r = 1;\n    const seen = new Array<boolean>(this.n);\n    for (let i = 0; i < this.p.length; i++) {\n      if (seen[i] || this.p[i] === i) {\n        continue;\n      }\n      let cs = 0;\n      for (let j = i; !seen[j]; j = this.p[j]) {\n        cs++;\n        seen[j] = true;\n      }\n      r = lcm(r, cs);\n    }\n    return r;\n  }\n}\n", "import { KPuzzleDefinition } from \"./interfaces\"; // TODO\n/* tslint:disable no-bitwise */\n/* tslint:disable prefer-for-of */ import {\n  factorial,\n  iota,\n  lcm,\n  Perm,\n  zeros,\n} from \"./Perm\";\nexport class OrbitDef {\n  constructor(public size: number, public mod: number) {}\n  public reassemblySize(): number {\n    return factorial(this.size) * Math.pow(this.mod, this.size);\n  }\n}\n\nexport class OrbitsDef {\n  constructor(\n    public orbitnames: string[],\n    public orbitdefs: OrbitDef[],\n    public solved: VisibleState,\n    public movenames: string[],\n    public moveops: Transformation[],\n  ) {}\n\n  public transformToKPuzzle(t: Transformation): any {\n    const mp: { [orbitName: string]: any } = {};\n    for (let j = 0; j < this.orbitnames.length; j++) {\n      mp[this.orbitnames[j]] = t.orbits[j].toKpuzzle();\n    }\n    return mp;\n  }\n\n  public toKsolve(name: string, forTwisty: boolean): string[] {\n    const result = [];\n    result.push(\"Name \" + name);\n    result.push(\"\");\n    for (let i = 0; i < this.orbitnames.length; i++) {\n      result.push(\n        \"Set \" +\n          this.orbitnames[i] +\n          \" \" +\n          this.orbitdefs[i].size +\n          \" \" +\n          this.orbitdefs[i].mod,\n      );\n    }\n    result.push(\"\");\n    result.push(\"Solved\");\n    for (let i = 0; i < this.orbitnames.length; i++) {\n      result.push(this.orbitnames[i]);\n      const o = this.solved.orbits[i].toKsolveVS();\n      result.push(o[0]);\n      result.push(o[1]);\n    }\n    result.push(\"End\");\n    result.push(\"\");\n    for (let i = 0; i < this.movenames.length; i++) {\n      result.push(\"Move \" + this.movenames[i]);\n      for (let j = 0; j < this.orbitnames.length; j++) {\n        if (!forTwisty && this.moveops[i].orbits[j].isIdentity()) {\n          continue;\n        }\n        result.push(this.orbitnames[j]);\n        const o = this.moveops[i].orbits[j].toKsolve();\n        result.push(o[0]);\n        result.push(o[1]);\n      }\n      result.push(\"End\");\n      result.push(\"\");\n    }\n    // extra blank line on end lets us use join(\"\\n\") to terminate all\n    return result;\n  }\n\n  // TODO: return type.\n  public toKpuzzle(): KPuzzleDefinition {\n    const orbits: { [orbitName: string]: any } = {};\n    const start: { [orbitName: string]: any } = {};\n    for (let i = 0; i < this.orbitnames.length; i++) {\n      orbits[this.orbitnames[i]] = {\n        numPieces: this.orbitdefs[i].size,\n        orientations: this.orbitdefs[i].mod,\n      };\n      start[this.orbitnames[i]] = this.solved.orbits[i].toKpuzzle();\n    }\n    const moves: { [moveName: string]: any } = {};\n    for (let i = 0; i < this.movenames.length; i++) {\n      moves[this.movenames[i]] = this.transformToKPuzzle(this.moveops[i]);\n    }\n    return { name: \"PG3D\", orbits, startPieces: start, moves };\n  }\n\n  public optimize(): OrbitsDef {\n    const neworbitnames: string[] = [];\n    const neworbitdefs: OrbitDef[] = [];\n    const newsolved: Orbit[] = [];\n    const newmoveops: Orbit[][] = [];\n    for (let j = 0; j < this.moveops.length; j++) {\n      newmoveops.push([]);\n    }\n    for (let i = 0; i < this.orbitdefs.length; i++) {\n      const om = this.orbitdefs[i].mod;\n      const n = this.orbitdefs[i].size;\n      const du = new DisjointUnion(n);\n      const changed = new Array<boolean>(this.orbitdefs[i].size);\n      for (let k = 0; k < n; k++) {\n        changed[k] = false;\n      }\n      for (let j = 0; j < this.moveops.length; j++) {\n        for (let k = 0; k < n; k++) {\n          if (\n            this.moveops[j].orbits[i].perm[k] !== k ||\n            this.moveops[j].orbits[i].ori[k] !== 0\n          ) {\n            changed[k] = true;\n            du.union(k, this.moveops[j].orbits[i].perm[k]);\n          }\n        }\n      }\n      let keepori = true;\n      // right now we kill ori only if solved is unique and\n      // if we can kill it completely.  This is not all the optimization\n      // we can perform.\n      if (om > 1) {\n        keepori = false;\n        const duo = new DisjointUnion(this.orbitdefs[i].size * om);\n        for (let j = 0; j < this.moveops.length; j++) {\n          for (let k = 0; k < n; k++) {\n            if (\n              this.moveops[j].orbits[i].perm[k] !== k ||\n              this.moveops[j].orbits[i].ori[k] !== 0\n            ) {\n              for (let o = 0; o < om; o++) {\n                duo.union(\n                  k * om + o,\n                  this.moveops[j].orbits[i].perm[k] * om +\n                    ((o + this.moveops[j].orbits[i].ori[k]) % om),\n                );\n              }\n            }\n          }\n        }\n        for (let j = 0; !keepori && j < n; j++) {\n          for (let o = 1; o < om; o++) {\n            if (duo.find(j * om) === duo.find(j * om + o)) {\n              keepori = true;\n            }\n          }\n        }\n        for (let j = 0; !keepori && j < n; j++) {\n          for (let k = 0; k < j; k++) {\n            if (\n              this.solved.orbits[i].perm[j] === this.solved.orbits[i].perm[k]\n            ) {\n              keepori = true;\n            }\n          }\n        }\n      }\n      // is there just one result set, or more than one?\n      let nontriv = -1;\n      let multiple = false;\n      for (let j = 0; j < this.orbitdefs[i].size; j++) {\n        if (changed[j]) {\n          const h = du.find(j);\n          if (nontriv < 0) {\n            nontriv = h;\n          } else if (nontriv !== h) {\n            multiple = true;\n          }\n        }\n      }\n      for (let j = 0; j < this.orbitdefs[i].size; j++) {\n        if (!changed[j]) {\n          continue;\n        }\n        const h = du.find(j);\n        if (h !== j) {\n          continue;\n        }\n        const no: number[] = [];\n        const on: number[] = [];\n        let nv = 0;\n        for (let k = 0; k < this.orbitdefs[i].size; k++) {\n          if (du.find(k) === j) {\n            no[nv] = k;\n            on[k] = nv;\n            nv++;\n          }\n        }\n        if (multiple) {\n          neworbitnames.push(this.orbitnames[i] + \"_p\" + j);\n        } else {\n          neworbitnames.push(this.orbitnames[i]);\n        }\n        if (keepori) {\n          neworbitdefs.push(new OrbitDef(nv, this.orbitdefs[i].mod));\n          newsolved.push(this.solved.orbits[i].remapVS(no, nv));\n          for (let k = 0; k < this.moveops.length; k++) {\n            newmoveops[k].push(this.moveops[k].orbits[i].remap(no, on, nv));\n          }\n        } else {\n          neworbitdefs.push(new OrbitDef(nv, 1));\n          newsolved.push(this.solved.orbits[i].remapVS(no, nv).killOri());\n          for (let k = 0; k < this.moveops.length; k++) {\n            newmoveops[k].push(\n              this.moveops[k].orbits[i].remap(no, on, nv).killOri(),\n            );\n          }\n        }\n      }\n    }\n    return new OrbitsDef(\n      neworbitnames,\n      neworbitdefs,\n      new VisibleState(newsolved),\n      this.movenames,\n      newmoveops.map((_) => new Transformation(_)),\n    );\n  }\n\n  // generate a new \"solved\" position based on scrambling\n  // we use an algorithm that should be faster for large puzzles than\n  // just picking random moves.\n  public scramble(n: number): void {\n    const pool: Transformation[] = [];\n    for (let i = 0; i < this.moveops.length; i++) {\n      pool[i] = this.moveops[i];\n    }\n    for (let i = 0; i < pool.length; i++) {\n      const j = Math.floor(Math.random() * pool.length);\n      const t = pool[i];\n      pool[i] = pool[j];\n      pool[j] = t;\n    }\n    if (n < pool.length) {\n      n = pool.length;\n    }\n    for (let i = 0; i < n; i++) {\n      const ri = Math.floor(Math.random() * pool.length);\n      const rj = Math.floor(Math.random() * pool.length);\n      const rm = Math.floor(Math.random() * this.moveops.length);\n      pool[ri] = pool[ri].mul(pool[rj]).mul(this.moveops[rm]);\n      if (Math.random() < 0.1) {\n        // break up parity\n        pool[ri] = pool[ri].mul(this.moveops[rm]);\n      }\n    }\n    let s = pool[0];\n    for (let i = 1; i < pool.length; i++) {\n      s = s.mul(pool[i]);\n    }\n    this.solved = this.solved.mul(s);\n  }\n\n  public reassemblySize(): number {\n    let n = 1;\n    for (let i = 0; i < this.orbitdefs.length; i++) {\n      n *= this.orbitdefs[i].reassemblySize();\n    }\n    return n;\n  }\n}\nexport class Orbit {\n  public static e(n: number, mod: number): Orbit {\n    return new Orbit(iota(n), zeros(n), mod);\n  }\n\n  constructor(\n    public perm: number[],\n    public ori: number[],\n    public orimod: number,\n  ) {}\n\n  public mul(b: Orbit): Orbit {\n    const n = this.perm.length;\n    const newPerm = new Array<number>(n);\n    if (this.orimod === 1) {\n      for (let i = 0; i < n; i++) {\n        newPerm[i] = this.perm[b.perm[i]];\n      }\n      return new Orbit(newPerm, this.ori, this.orimod);\n    } else {\n      const newOri = new Array<number>(n);\n      for (let i = 0; i < n; i++) {\n        newPerm[i] = this.perm[b.perm[i]];\n        newOri[i] = (this.ori[b.perm[i]] + b.ori[i]) % this.orimod;\n      }\n      return new Orbit(newPerm, newOri, this.orimod);\n    }\n  }\n\n  public inv(): Orbit {\n    const n = this.perm.length;\n    const newPerm = new Array<number>(n);\n    const newOri = new Array<number>(n);\n    for (let i = 0; i < n; i++) {\n      newPerm[this.perm[i]] = i;\n      newOri[this.perm[i]] = (this.orimod - this.ori[i]) % this.orimod;\n    }\n    return new Orbit(newPerm, newOri, this.orimod);\n  }\n\n  public equal(b: Orbit): boolean {\n    const n = this.perm.length;\n    for (let i = 0; i < n; i++) {\n      if (this.perm[i] !== b.perm[i] || this.ori[i] !== b.ori[i]) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  // in-place mutator\n  public killOri(): this {\n    const n = this.perm.length;\n    for (let i = 0; i < n; i++) {\n      this.ori[i] = 0;\n    }\n    this.orimod = 1;\n    return this;\n  }\n\n  public toPerm(): Perm {\n    const o = this.orimod;\n    if (o === 1) {\n      return new Perm(this.perm);\n    }\n    const n = this.perm.length;\n    const newPerm = new Array<number>(n * o);\n    for (let i = 0; i < n; i++) {\n      for (let j = 0; j < o; j++) {\n        newPerm[i * o + j] = o * this.perm[i] + ((this.ori[i] + j) % o);\n      }\n    }\n    return new Perm(newPerm);\n  }\n\n  // returns tuple of sets of identical pieces in this orbit\n  public identicalPieces(): number[][] {\n    const done: boolean[] = [];\n    const n = this.perm.length;\n    const r: number[][] = [];\n    for (let i = 0; i < n; i++) {\n      const v = this.perm[i];\n      if (done[v] === undefined) {\n        const s: number[] = [i];\n        done[v] = true;\n        for (let j = i + 1; j < n; j++) {\n          if (this.perm[j] === v) {\n            s.push(j);\n          }\n        }\n        r.push(s);\n      }\n    }\n    return r;\n  }\n\n  public order(): number {\n    // can be made more efficient\n    return this.toPerm().order();\n  }\n\n  public isIdentity(): boolean {\n    const n = this.perm.length;\n    if (this.perm === iota(n) && this.ori === zeros(n)) {\n      return true;\n    }\n    for (let i = 0; i < n; i++) {\n      if (this.perm[i] !== i || this.ori[i] !== 0) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  public remap(no: number[], on: number[], nv: number): Orbit {\n    const newPerm = new Array<number>(nv);\n    const newOri = new Array<number>(nv);\n    for (let i = 0; i < nv; i++) {\n      newPerm[i] = on[this.perm[no[i]]];\n      newOri[i] = this.ori[no[i]];\n    }\n    return new Orbit(newPerm, newOri, this.orimod);\n  }\n\n  public remapVS(no: number[], nv: number): Orbit {\n    const newPerm = new Array<number>(nv);\n    const newOri = new Array<number>(nv);\n    let nextNew = 0;\n    const reassign = [];\n    for (let i = 0; i < nv; i++) {\n      const ov = this.perm[no[i]];\n      if (reassign[ov] === undefined) {\n        reassign[ov] = nextNew++;\n      }\n      newPerm[i] = reassign[ov];\n      newOri[i] = this.ori[no[i]];\n    }\n    return new Orbit(newPerm, newOri, this.orimod);\n  }\n\n  public toKsolveVS(): string[] {\n    return [this.perm.map((_: number) => _ + 1).join(\" \"), this.ori.join(\" \")];\n  }\n\n  public toKsolve(): string[] {\n    const newori = new Array<number>(this.ori.length);\n    for (let i = 0; i < newori.length; i++) {\n      newori[this.perm[i]] = this.ori[i];\n    }\n    return [this.perm.map((_: number) => _ + 1).join(\" \"), newori.join(\" \")];\n  }\n\n  // TODO: return type\n  public toKpuzzle(): Record<string, unknown> {\n    return { permutation: this.perm, orientation: this.ori };\n  }\n}\nexport class TransformationBase {\n  constructor(public orbits: Orbit[]) {}\n  public internalMul(b: TransformationBase): Orbit[] {\n    const newOrbits: Orbit[] = [];\n    for (let i = 0; i < this.orbits.length; i++) {\n      newOrbits.push(this.orbits[i].mul(b.orbits[i]));\n    }\n    return newOrbits;\n  }\n\n  public internalInv(): Orbit[] {\n    const newOrbits: Orbit[] = [];\n    for (let i = 0; i < this.orbits.length; i++) {\n      newOrbits.push(this.orbits[i].inv());\n    }\n    return newOrbits;\n  }\n\n  public equal(b: TransformationBase): boolean {\n    for (let i = 0; i < this.orbits.length; i++) {\n      if (!this.orbits[i].equal(b.orbits[i])) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  public killOri(): this {\n    for (let i = 0; i < this.orbits.length; i++) {\n      this.orbits[i].killOri();\n    }\n    return this;\n  }\n\n  public toPerm(): Perm {\n    const perms = new Array<Perm>();\n    let n = 0;\n    for (let i = 0; i < this.orbits.length; i++) {\n      const p = this.orbits[i].toPerm();\n      perms.push(p);\n      n += p.n;\n    }\n    const newPerm = new Array<number>(n);\n    n = 0;\n    for (let i = 0; i < this.orbits.length; i++) {\n      const p = perms[i];\n      for (let j = 0; j < p.n; j++) {\n        newPerm[n + j] = n + p.p[j];\n      }\n      n += p.n;\n    }\n    return new Perm(newPerm);\n  }\n\n  public identicalPieces(): number[][] {\n    const r: number[][] = [];\n    let n = 0;\n    for (let i = 0; i < this.orbits.length; i++) {\n      const o = this.orbits[i].orimod;\n      const s = this.orbits[i].identicalPieces();\n      for (let j = 0; j < s.length; j++) {\n        r.push(s[j].map((_) => _ * o + n));\n      }\n      n += o * this.orbits[i].perm.length;\n    }\n    return r;\n  }\n\n  public order(): number {\n    let r = 1;\n    for (let i = 0; i < this.orbits.length; i++) {\n      r = lcm(r, this.orbits[i].order());\n    }\n    return r;\n  }\n}\nexport class Transformation extends TransformationBase {\n  constructor(orbits: Orbit[]) {\n    super(orbits);\n  }\n\n  public mul(b: Transformation): Transformation {\n    return new Transformation(this.internalMul(b));\n  }\n\n  public mulScalar(n: number): Transformation {\n    if (n === 0) {\n      return this.e();\n    }\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    let t: Transformation = this;\n    if (n < 0) {\n      t = t.inv();\n      n = -n;\n    }\n    while ((n & 1) === 0) {\n      t = t.mul(t);\n      n >>= 1;\n    }\n    if (n === 1) {\n      return t;\n    }\n    let s = t;\n    let r = this.e();\n    while (n > 0) {\n      if (n & 1) {\n        r = r.mul(s);\n      }\n      if (n > 1) {\n        s = s.mul(s);\n      }\n      n >>= 1;\n    }\n    return r;\n  }\n\n  public inv(): Transformation {\n    return new Transformation(this.internalInv());\n  }\n\n  public e(): Transformation {\n    return new Transformation(\n      this.orbits.map((_: Orbit) => Orbit.e(_.perm.length, _.orimod)),\n    );\n  }\n}\nexport class VisibleState extends TransformationBase {\n  constructor(orbits: Orbit[]) {\n    super(orbits);\n  }\n\n  public mul(b: Transformation): VisibleState {\n    return new VisibleState(this.internalMul(b));\n  }\n}\n//  Disjoint set union implementation.\nclass DisjointUnion {\n  public heads: number[];\n  constructor(public n: number) {\n    this.heads = new Array<number>(n);\n    for (let i = 0; i < n; i++) {\n      this.heads[i] = i;\n    }\n  }\n\n  public find(v: number): number {\n    let h = this.heads[v];\n    if (this.heads[h] === h) {\n      return h;\n    }\n    h = this.find(this.heads[h]);\n    this.heads[v] = h;\n    return h;\n  }\n\n  public union(a: number, b: number): void {\n    const ah = this.find(a);\n    const bh = this.find(b);\n    if (ah < bh) {\n      this.heads[bh] = ah;\n    } else if (ah > bh) {\n      this.heads[ah] = bh;\n    }\n  }\n}\nexport function showcanon(g: OrbitsDef, disp: (s: string) => void): void {\n  // show information for canonical move derivation\n  const n = g.moveops.length;\n  if (n > 30) {\n    throw new Error(\"Canon info too big for bitmask\");\n  }\n  const orders = [];\n  const commutes = [];\n  for (let i = 0; i < n; i++) {\n    const permA = g.moveops[i];\n    orders.push(permA.order());\n    let bits = 0;\n    for (let j = 0; j < n; j++) {\n      if (j === i) {\n        continue;\n      }\n      const permB = g.moveops[j];\n      if (permA.mul(permB).equal(permB.mul(permA))) {\n        bits |= 1 << j;\n      }\n    }\n    commutes.push(bits);\n  }\n  let curlev: any = {};\n  curlev[0] = 1;\n  for (let d = 0; d < 100; d++) {\n    let sum = 0;\n    const nextlev: any = {};\n    let uniq = 0;\n    for (const sti in curlev) {\n      const st = +sti; // string to number\n      const cnt = curlev[st];\n      sum += cnt;\n      uniq++;\n      for (let mv = 0; mv < orders.length; mv++) {\n        if (\n          ((st >> mv) & 1) === 0 &&\n          (st & commutes[mv] & ((1 << mv) - 1)) === 0\n        ) {\n          const nst = (st & commutes[mv]) | (1 << mv);\n          if (nextlev[nst] === undefined) {\n            nextlev[nst] = 0;\n          }\n          nextlev[nst] += (orders[mv] - 1) * cnt;\n        }\n      }\n    }\n    disp(\"\" + d + \": canonseq \" + sum + \" states \" + uniq);\n    curlev = nextlev;\n  }\n}\n// This is a less effective canonicalization (that happens to work fine\n// for the 3x3x3).  We include this only for comparison.\nexport function showcanon0(g: OrbitsDef, disp: (s: string) => void): void {\n  // show information for canonical move derivation\n  const n = g.moveops.length;\n  if (n > 30) {\n    throw new Error(\"Canon info too big for bitmask\");\n  }\n  const orders = [];\n  const commutes = [];\n  for (let i = 0; i < n; i++) {\n    const permA = g.moveops[i];\n    orders.push(permA.order());\n    let bits = 0;\n    for (let j = 0; j < n; j++) {\n      if (j === i) {\n        continue;\n      }\n      const permB = g.moveops[j];\n      if (permA.mul(permB).equal(permB.mul(permA))) {\n        bits |= 1 << j;\n      }\n    }\n    commutes.push(bits);\n  }\n  let curlev: any = {};\n  disp(\"\" + 0 + \": canonseq \" + 1);\n  for (let x = 0; x < orders.length; x++) {\n    curlev[x] = orders[x] - 1;\n  }\n  for (let d = 1; d < 100; d++) {\n    let sum = 0;\n    const nextlev: any = {};\n    let uniq = 0;\n    for (const sti in curlev) {\n      const st = +sti; // string to number\n      const cnt = curlev[st];\n      sum += cnt;\n      uniq++;\n      for (let mv = 0; mv < orders.length; mv++) {\n        if (mv === st || (commutes[mv] & (1 << st) && mv < st)) {\n          continue;\n        }\n        if (nextlev[mv] === undefined) {\n          nextlev[mv] = 0;\n        }\n        nextlev[mv] += (orders[mv] - 1) * cnt;\n      }\n    }\n    disp(\"\" + d + \": canonseq \" + sum + \" states \" + uniq);\n    curlev = nextlev;\n  }\n}\n", "/* tslint:disable no-bitwise */\n/* tslint:disable prefer-for-of */ // TODO\n\n// We need a quaternion class.  We use this to represent rotations,\n// planes, and points.\n\nconst eps = 1e-9; // TODO: Deduplicate with `PuzzleGeometry`?\n\nexport function expandfaces(rots: Quat[], faces: Quat[][]): Quat[][] {\n  // given a set of faces, expand by rotation set\n  const nfaces = [];\n  for (let i = 0; i < rots.length; i++) {\n    for (let k = 0; k < faces.length; k++) {\n      const face = faces[k];\n      const nface = [];\n      for (let j = 0; j < face.length; j++) {\n        nface.push(face[j].rotateplane(rots[i]));\n      }\n      nfaces.push(nface);\n    }\n  }\n  return nfaces;\n}\n\nexport function centermassface(face: Quat[]): Quat {\n  // calculate a center of a face by averaging points\n  let s = new Quat(0, 0, 0, 0);\n  for (let i = 0; i < face.length; i++) {\n    s = s.sum(face[i]);\n  }\n  return s.smul(1.0 / face.length);\n}\n\nexport function random(): Quat {\n  // generate a random quat\n  const q = new Quat(\n    Math.random() * 2 - 1,\n    Math.random() * 2 - 1,\n    Math.random() * 2 - 1,\n    Math.random() * 2 - 1,\n  );\n  return q.smul(1 / q.len());\n}\n\nexport function solvethreeplanes(\n  p1: number,\n  p2: number,\n  p3: number,\n  planes: Quat[],\n): any {\n  // find intersection of three planes but only if interior\n  // Takes three indices into a plane array, and returns the point at the\n  // intersection of all three, but only if it is internal to all planes.\n  const p = planes[p1].intersect3(planes[p2], planes[p3]);\n  if (!p) {\n    return p;\n  }\n  for (let i = 0; i < planes.length; i++) {\n    if (i !== p1 && i !== p2 && i !== p3) {\n      const dt = planes[i].b * p.b + planes[i].c * p.c + planes[i].d * p.d;\n      if (\n        (planes[i].a > 0 && dt > planes[i].a) ||\n        (planes[i].a < 0 && dt < planes[i].a)\n      ) {\n        return false;\n      }\n    }\n  }\n  return p;\n}\n\nexport class Quat {\n  constructor(\n    public a: number,\n    public b: number,\n    public c: number,\n    public d: number,\n  ) {}\n\n  public mul(q: Quat): Quat {\n    // Quaternion multiplication\n    return new Quat(\n      this.a * q.a - this.b * q.b - this.c * q.c - this.d * q.d,\n      this.a * q.b + this.b * q.a + this.c * q.d - this.d * q.c,\n      this.a * q.c - this.b * q.d + this.c * q.a + this.d * q.b,\n      this.a * q.d + this.b * q.c - this.c * q.b + this.d * q.a,\n    );\n  }\n\n  public toString(): string {\n    return \"Q[\" + this.a + \",\" + this.b + \",\" + this.c + \",\" + this.d + \"]\";\n  }\n\n  public dist(q: Quat): number {\n    // Euclidean distance\n    return Math.hypot(this.a - q.a, this.b - q.b, this.c - q.c, this.d - q.d);\n  }\n\n  public len(): number {\n    // Euclidean length\n    return Math.hypot(this.a, this.b, this.c, this.d);\n  }\n\n  public cross(q: Quat): Quat {\n    // cross product\n    return new Quat(\n      0,\n      this.c * q.d - this.d * q.c,\n      this.d * q.b - this.b * q.d,\n      this.b * q.c - this.c * q.b,\n    );\n  }\n\n  public dot(q: Quat): number {\n    // dot product of two quaternions\n    return this.b * q.b + this.c * q.c + this.d * q.d;\n  }\n\n  public normalize(): Quat {\n    // make the magnitude be 1\n    const d = Math.sqrt(this.dot(this));\n    return new Quat(this.a / d, this.b / d, this.c / d, this.d / d);\n  }\n\n  public makenormal(): Quat {\n    // make a normal vector from a plane or quat or point\n    return new Quat(0, this.b, this.c, this.d).normalize();\n  }\n\n  public normalizeplane(): Quat {\n    // normalize a plane\n    const d = Math.hypot(this.b, this.c, this.d);\n    return new Quat(this.a / d, this.b / d, this.c / d, this.d / d);\n  }\n\n  public smul(m: number): Quat {\n    // scalar multiplication\n    return new Quat(this.a * m, this.b * m, this.c * m, this.d * m);\n  }\n\n  public sum(q: Quat): Quat {\n    // quaternion sum\n    return new Quat(this.a + q.a, this.b + q.b, this.c + q.c, this.d + q.d);\n  }\n\n  public sub(q: Quat): Quat {\n    // difference\n    return new Quat(this.a - q.a, this.b - q.b, this.c - q.c, this.d - q.d);\n  }\n\n  public angle(): number {\n    // quaternion angle\n    return 2 * Math.acos(this.a);\n  }\n\n  public invrot(): Quat {\n    // quaternion inverse rotation\n    return new Quat(this.a, -this.b, -this.c, -this.d);\n  }\n\n  public det3x3(\n    a00: number,\n    a01: number,\n    a02: number,\n    a10: number,\n    a11: number,\n    a12: number,\n    a20: number,\n    a21: number,\n    a22: number,\n  ): number {\n    // 3x3 determinant\n    return (\n      a00 * (a11 * a22 - a12 * a21) +\n      a01 * (a12 * a20 - a10 * a22) +\n      a02 * (a10 * a21 - a11 * a20)\n    );\n  }\n\n  public rotateplane(q: Quat): Quat {\n    // rotate a plane using a quaternion\n    const t = q.mul(new Quat(0, this.b, this.c, this.d)).mul(q.invrot());\n    t.a = this.a;\n    return t;\n  }\n\n  // return any vector orthogonal to the given one.  Find the smallest\n  // component (in absolute value) and return the cross product of that\n  // axis with the given vector.\n  public orthogonal(): Quat {\n    const ab = Math.abs(this.b);\n    const ac = Math.abs(this.c);\n    const ad = Math.abs(this.d);\n    if (ab < ac && ab < ad) {\n      return this.cross(new Quat(0, 1, 0, 0)).normalize();\n    } else if (ac < ab && ac < ad) {\n      return this.cross(new Quat(0, 0, 1, 0)).normalize();\n    } else {\n      return this.cross(new Quat(0, 0, 0, 1)).normalize();\n    }\n  }\n\n  // return the Quaternion that will rotate the this vector\n  // to the b vector through rotatepoint.\n  public pointrotation(b: Quat): Quat {\n    const a = this.normalize();\n    b = b.normalize();\n    if (a.sub(b).len() < eps) {\n      return new Quat(1, 0, 0, 0);\n    }\n    let h = a.sum(b);\n    if (h.len() < eps) {\n      h = h.orthogonal();\n    } else {\n      h = h.normalize();\n    }\n    const r = a.cross(h);\n    r.a = a.dot(h);\n    return r;\n  }\n\n  // given two vectors, return the portion of the first that\n  // is not in the direction of the second.\n  public unproject(b: Quat): Quat {\n    return this.sum(b.smul(-this.dot(b) / (this.len() * b.len())));\n  }\n\n  public rotatepoint(q: Quat): Quat {\n    // rotate a point\n    return q.mul(this).mul(q.invrot());\n  }\n\n  public rotateface(face: Quat[]): Quat[] {\n    // rotate a face by this Q.\n    return face.map((_: Quat) => _.rotatepoint(this));\n  }\n\n  public rotatecubie(cubie: Quat[][]): Quat[][] {\n    // rotate a cubie by this Q.\n    return cubie.map((_: Quat[]) => this.rotateface(_));\n  }\n\n  public intersect3(p2: Quat, p3: Quat): Quat | false {\n    // intersect three planes if there is one\n    const det = this.det3x3(\n      this.b,\n      this.c,\n      this.d,\n      p2.b,\n      p2.c,\n      p2.d,\n      p3.b,\n      p3.c,\n      p3.d,\n    );\n    if (Math.abs(det) < eps) {\n      return false; // TODO: Change to `null` or `undefined`?\n    }\n    return new Quat(\n      0,\n      this.det3x3(this.a, this.c, this.d, p2.a, p2.c, p2.d, p3.a, p3.c, p3.d) /\n        det,\n      this.det3x3(this.b, this.a, this.d, p2.b, p2.a, p2.d, p3.b, p3.a, p3.d) /\n        det,\n      this.det3x3(this.b, this.c, this.a, p2.b, p2.c, p2.a, p3.b, p3.c, p3.a) /\n        det,\n    );\n  }\n\n  public side(x: number): number {\n    // is this point close to the origin, or on one or the other side?\n    if (x > eps) {\n      return 1;\n    }\n    if (x < -eps) {\n      return -1;\n    }\n    return 0;\n  }\n\n  public cutfaces(faces: Quat[][]): Quat[][] {\n    // Cut a set of faces by a plane and return new set\n    const d = this.a;\n    const nfaces = [];\n    for (let j = 0; j < faces.length; j++) {\n      const face = faces[j];\n      const inout = face.map((_: Quat) => this.side(_.dot(this) - d));\n      let seen = 0;\n      for (let i = 0; i < inout.length; i++) {\n        seen |= 1 << (inout[i] + 1);\n      }\n      if ((seen & 5) === 5) {\n        // saw both sides\n        for (let s = -1; s <= 1; s += 2) {\n          const nface = [];\n          for (let k = 0; k < face.length; k++) {\n            if (inout[k] === s || inout[k] === 0) {\n              nface.push(face[k]);\n            }\n            const kk = (k + 1) % face.length;\n            if (inout[k] + inout[kk] === 0 && inout[k] !== 0) {\n              const vk = face[k].dot(this) - d;\n              const vkk = face[kk].dot(this) - d;\n              const r = vk / (vk - vkk);\n              const pt = face[k].smul(1 - r).sum(face[kk].smul(r));\n              nface.push(pt);\n            }\n          }\n          nfaces.push(nface);\n        }\n      } else {\n        // no split\n        nfaces.push(face);\n      }\n    }\n    return nfaces;\n  }\n\n  public faceside(face: Quat[]): number {\n    // which side of a plane is a face on?\n    const d = this.a;\n    for (let i = 0; i < face.length; i++) {\n      const s = this.side(face[i].dot(this) - d);\n      if (s !== 0) {\n        return s;\n      }\n    }\n    throw new Error(\"Could not determine side of plane in faceside\");\n  }\n\n  public sameplane(p: Quat): boolean {\n    // are two planes the same?\n    const a = this.normalize();\n    const b = p.normalize();\n    return a.dist(b) < eps || a.dist(b.smul(-1)) < eps;\n  }\n\n  public makecut(r: number): Quat {\n    // make a cut from a normal vector\n    return new Quat(r, this.b, this.c, this.d);\n  }\n}\n", "/* tslint:disable no-bitwise */\n/* tslint:disable prefer-for-of */ // TODO\n\n// We need a quaternion class.  We use this to represent rotations,\n// planes, and points.\n\nconst eps = 1e-9; // TODO: Deduplicate with `PuzzleGeometry`?\n\nexport function expandfaces(rots: Quat[], faces: Quat[][]): Quat[][] {\n  // given a set of faces, expand by rotation set\n  const nfaces = [];\n  for (let i = 0; i < rots.length; i++) {\n    for (let k = 0; k < faces.length; k++) {\n      const face = faces[k];\n      const nface = [];\n      for (let j = 0; j < face.length; j++) {\n        nface.push(face[j].rotateplane(rots[i]));\n      }\n      nfaces.push(nface);\n    }\n  }\n  return nfaces;\n}\n\nexport function centermassface(face: Quat[]): Quat {\n  // calculate a center of a face by averaging points\n  let s = new Quat(0, 0, 0, 0);\n  for (let i = 0; i < face.length; i++) {\n    s = s.sum(face[i]);\n  }\n  return s.smul(1.0 / face.length);\n}\n\nexport function random(): Quat {\n  // generate a random quat\n  const q = new Quat(\n    Math.random() * 2 - 1,\n    Math.random() * 2 - 1,\n    Math.random() * 2 - 1,\n    Math.random() * 2 - 1,\n  );\n  return q.smul(1 / q.len());\n}\n\nexport function solvethreeplanes(\n  p1: number,\n  p2: number,\n  p3: number,\n  planes: Quat[],\n): any {\n  // find intersection of three planes but only if interior\n  // Takes three indices into a plane array, and returns the point at the\n  // intersection of all three, but only if it is internal to all planes.\n  const p = planes[p1].intersect3(planes[p2], planes[p3]);\n  if (!p) {\n    return p;\n  }\n  for (let i = 0; i < planes.length; i++) {\n    if (i !== p1 && i !== p2 && i !== p3) {\n      const dt = planes[i].b * p.b + planes[i].c * p.c + planes[i].d * p.d;\n      if (\n        (planes[i].a > 0 && dt > planes[i].a) ||\n        (planes[i].a < 0 && dt < planes[i].a)\n      ) {\n        return false;\n      }\n    }\n  }\n  return p;\n}\n\nexport class Quat {\n  constructor(\n    public a: number,\n    public b: number,\n    public c: number,\n    public d: number,\n  ) {}\n\n  public mul(q: Quat): Quat {\n    // Quaternion multiplication\n    return new Quat(\n      this.a * q.a - this.b * q.b - this.c * q.c - this.d * q.d,\n      this.a * q.b + this.b * q.a + this.c * q.d - this.d * q.c,\n      this.a * q.c - this.b * q.d + this.c * q.a + this.d * q.b,\n      this.a * q.d + this.b * q.c - this.c * q.b + this.d * q.a,\n    );\n  }\n\n  public toString(): string {\n    return \"Q[\" + this.a + \",\" + this.b + \",\" + this.c + \",\" + this.d + \"]\";\n  }\n\n  public dist(q: Quat): number {\n    // Euclidean distance\n    return Math.hypot(this.a - q.a, this.b - q.b, this.c - q.c, this.d - q.d);\n  }\n\n  public len(): number {\n    // Euclidean length\n    return Math.hypot(this.a, this.b, this.c, this.d);\n  }\n\n  public cross(q: Quat): Quat {\n    // cross product\n    return new Quat(\n      0,\n      this.c * q.d - this.d * q.c,\n      this.d * q.b - this.b * q.d,\n      this.b * q.c - this.c * q.b,\n    );\n  }\n\n  public dot(q: Quat): number {\n    // dot product of two quaternions\n    return this.b * q.b + this.c * q.c + this.d * q.d;\n  }\n\n  public normalize(): Quat {\n    // make the magnitude be 1\n    const d = Math.sqrt(this.dot(this));\n    return new Quat(this.a / d, this.b / d, this.c / d, this.d / d);\n  }\n\n  public makenormal(): Quat {\n    // make a normal vector from a plane or quat or point\n    return new Quat(0, this.b, this.c, this.d).normalize();\n  }\n\n  public normalizeplane(): Quat {\n    // normalize a plane\n    const d = Math.hypot(this.b, this.c, this.d);\n    return new Quat(this.a / d, this.b / d, this.c / d, this.d / d);\n  }\n\n  public smul(m: number): Quat {\n    // scalar multiplication\n    return new Quat(this.a * m, this.b * m, this.c * m, this.d * m);\n  }\n\n  public sum(q: Quat): Quat {\n    // quaternion sum\n    return new Quat(this.a + q.a, this.b + q.b, this.c + q.c, this.d + q.d);\n  }\n\n  public sub(q: Quat): Quat {\n    // difference\n    return new Quat(this.a - q.a, this.b - q.b, this.c - q.c, this.d - q.d);\n  }\n\n  public angle(): number {\n    // quaternion angle\n    return 2 * Math.acos(this.a);\n  }\n\n  public invrot(): Quat {\n    // quaternion inverse rotation\n    return new Quat(this.a, -this.b, -this.c, -this.d);\n  }\n\n  public det3x3(\n    a00: number,\n    a01: number,\n    a02: number,\n    a10: number,\n    a11: number,\n    a12: number,\n    a20: number,\n    a21: number,\n    a22: number,\n  ): number {\n    // 3x3 determinant\n    return (\n      a00 * (a11 * a22 - a12 * a21) +\n      a01 * (a12 * a20 - a10 * a22) +\n      a02 * (a10 * a21 - a11 * a20)\n    );\n  }\n\n  public rotateplane(q: Quat): Quat {\n    // rotate a plane using a quaternion\n    const t = q.mul(new Quat(0, this.b, this.c, this.d)).mul(q.invrot());\n    t.a = this.a;\n    return t;\n  }\n\n  // return any vector orthogonal to the given one.  Find the smallest\n  // component (in absolute value) and return the cross product of that\n  // axis with the given vector.\n  public orthogonal(): Quat {\n    const ab = Math.abs(this.b);\n    const ac = Math.abs(this.c);\n    const ad = Math.abs(this.d);\n    if (ab < ac && ab < ad) {\n      return this.cross(new Quat(0, 1, 0, 0)).normalize();\n    } else if (ac < ab && ac < ad) {\n      return this.cross(new Quat(0, 0, 1, 0)).normalize();\n    } else {\n      return this.cross(new Quat(0, 0, 0, 1)).normalize();\n    }\n  }\n\n  // return the Quaternion that will rotate the this vector\n  // to the b vector through rotatepoint.\n  public pointrotation(b: Quat): Quat {\n    const a = this.normalize();\n    b = b.normalize();\n    if (a.sub(b).len() < eps) {\n      return new Quat(1, 0, 0, 0);\n    }\n    let h = a.sum(b);\n    if (h.len() < eps) {\n      h = h.orthogonal();\n    } else {\n      h = h.normalize();\n    }\n    const r = a.cross(h);\n    r.a = a.dot(h);\n    return r;\n  }\n\n  // given two vectors, return the portion of the first that\n  // is not in the direction of the second.\n  public unproject(b: Quat): Quat {\n    return this.sum(b.smul(-this.dot(b) / (this.len() * b.len())));\n  }\n\n  public rotatepoint(q: Quat): Quat {\n    // rotate a point\n    return q.mul(this).mul(q.invrot());\n  }\n\n  public rotateface(face: Quat[]): Quat[] {\n    // rotate a face by this Q.\n    return face.map((_: Quat) => _.rotatepoint(this));\n  }\n\n  public rotatecubie(cubie: Quat[][]): Quat[][] {\n    // rotate a cubie by this Q.\n    return cubie.map((_: Quat[]) => this.rotateface(_));\n  }\n\n  public intersect3(p2: Quat, p3: Quat): Quat | false {\n    // intersect three planes if there is one\n    const det = this.det3x3(\n      this.b,\n      this.c,\n      this.d,\n      p2.b,\n      p2.c,\n      p2.d,\n      p3.b,\n      p3.c,\n      p3.d,\n    );\n    if (Math.abs(det) < eps) {\n      return false; // TODO: Change to `null` or `undefined`?\n    }\n    return new Quat(\n      0,\n      this.det3x3(this.a, this.c, this.d, p2.a, p2.c, p2.d, p3.a, p3.c, p3.d) /\n        det,\n      this.det3x3(this.b, this.a, this.d, p2.b, p2.a, p2.d, p3.b, p3.a, p3.d) /\n        det,\n      this.det3x3(this.b, this.c, this.a, p2.b, p2.c, p2.a, p3.b, p3.c, p3.a) /\n        det,\n    );\n  }\n\n  public side(x: number): number {\n    // is this point close to the origin, or on one or the other side?\n    if (x > eps) {\n      return 1;\n    }\n    if (x < -eps) {\n      return -1;\n    }\n    return 0;\n  }\n\n  public cutfaces(faces: Quat[][]): Quat[][] {\n    // Cut a set of faces by a plane and return new set\n    const d = this.a;\n    const nfaces = [];\n    for (let j = 0; j < faces.length; j++) {\n      const face = faces[j];\n      const inout = face.map((_: Quat) => this.side(_.dot(this) - d));\n      let seen = 0;\n      for (let i = 0; i < inout.length; i++) {\n        seen |= 1 << (inout[i] + 1);\n      }\n      if ((seen & 5) === 5) {\n        // saw both sides\n        for (let s = -1; s <= 1; s += 2) {\n          const nface = [];\n          for (let k = 0; k < face.length; k++) {\n            if (inout[k] === s || inout[k] === 0) {\n              nface.push(face[k]);\n            }\n            const kk = (k + 1) % face.length;\n            if (inout[k] + inout[kk] === 0 && inout[k] !== 0) {\n              const vk = face[k].dot(this) - d;\n              const vkk = face[kk].dot(this) - d;\n              const r = vk / (vk - vkk);\n              const pt = face[k].smul(1 - r).sum(face[kk].smul(r));\n              nface.push(pt);\n            }\n          }\n          nfaces.push(nface);\n        }\n      } else {\n        // no split\n        nfaces.push(face);\n      }\n    }\n    return nfaces;\n  }\n\n  public faceside(face: Quat[]): number {\n    // which side of a plane is a face on?\n    const d = this.a;\n    for (let i = 0; i < face.length; i++) {\n      const s = this.side(face[i].dot(this) - d);\n      if (s !== 0) {\n        return s;\n      }\n    }\n    throw new Error(\"Could not determine side of plane in faceside\");\n  }\n\n  public sameplane(p: Quat): boolean {\n    // are two planes the same?\n    const a = this.normalize();\n    const b = p.normalize();\n    return a.dist(b) < eps || a.dist(b.smul(-1)) < eps;\n  }\n\n  public makecut(r: number): Quat {\n    // make a cut from a normal vector\n    return new Quat(r, this.b, this.c, this.d);\n  }\n}\n", "/* tslint:disable prefer-for-of */ // TODO\n\nimport { Quat, solvethreeplanes } from \"./Quat\";\n\n// Next we define a class that yields quaternion generators for each of\n// the five platonic solids.  The quaternion generators chosen are\n// chosen specifically so that the first quaternion doubles as a plane\n// description that yields the given Platonic solid (so for instance, the\n// cubical group and octahedral group are identical in math, but we\n// give distinct representations choosing the first quaternion so that\n// we get the desired figure.)  Our convention is one vertex of the\n// shape points precisely down.\n\n// This class is static.\n\nconst eps = 1e-9; // TODO: Deduplicate with `PuzzleGeometry`?\n\nexport function cube(): Quat[] {\n  const s5 = Math.sqrt(0.5);\n  return [new Quat(s5, s5, 0, 0), new Quat(s5, 0, s5, 0)];\n}\n\nexport function tetrahedron(): Quat[] {\n  return [new Quat(0.5, 0.5, 0.5, 0.5), new Quat(0.5, 0.5, 0.5, -0.5)];\n}\n\nexport function dodecahedron(): Quat[] {\n  const d36 = (2 * Math.PI) / 10;\n  let dx = 0.5 + 0.3 * Math.sqrt(5);\n  let dy = 0.5 + 0.1 * Math.sqrt(5);\n  const dd = Math.sqrt(dx * dx + dy * dy);\n  dx /= dd;\n  dy /= dd;\n  return [\n    new Quat(Math.cos(d36), dx * Math.sin(d36), dy * Math.sin(d36), 0),\n    new Quat(0.5, 0.5, 0.5, 0.5),\n  ];\n}\n\nexport function icosahedron(): Quat[] {\n  let dx = 1 / 6 + Math.sqrt(5) / 6;\n  let dy = 2 / 3 + Math.sqrt(5) / 3;\n  const dd = Math.sqrt(dx * dx + dy * dy);\n  dx /= dd;\n  dy /= dd;\n  const ang = (2 * Math.PI) / 6;\n  return [\n    new Quat(Math.cos(ang), dx * Math.sin(ang), dy * Math.sin(ang), 0),\n    new Quat(Math.cos(ang), -dx * Math.sin(ang), dy * Math.sin(ang), 0),\n  ];\n}\n\nexport function octahedron(): Quat[] {\n  const s5 = Math.sqrt(0.5);\n  return [new Quat(0.5, 0.5, 0.5, 0.5), new Quat(s5, 0, 0, s5)];\n}\n\nexport function closure(g: Quat[]): Quat[] {\n  // compute the closure of a set of generators\n  // This is quadratic in the result size.  Also, it has no protection\n  // against you providing a bogus set of generators that would generate\n  // an infinite group.\n  const q = [new Quat(1, 0, 0, 0)];\n  for (let i = 0; i < q.length; i++) {\n    for (let j = 0; j < g.length; j++) {\n      const ns = g[j].mul(q[i]);\n      const negns = ns.smul(-1);\n      let wasseen = false;\n      for (let k = 0; k < q.length; k++) {\n        if (ns.dist(q[k]) < eps || negns.dist(q[k]) < eps) {\n          wasseen = true;\n          break;\n        }\n      }\n      if (!wasseen) {\n        q.push(ns);\n      }\n    }\n  }\n  return q;\n}\n\nexport function uniqueplanes(p: Quat, g: Quat[]): Quat[] {\n  // compute unique plane rotations\n  // given a rotation group and a plane, find the rotations that\n  // generate unique planes.  This is quadratic in the return size.\n  const planes = [];\n  const planerot = [];\n  for (let i = 0; i < g.length; i++) {\n    const p2 = p.rotateplane(g[i]);\n    let wasseen = false;\n    for (let j = 0; j < planes.length; j++) {\n      if (p2.dist(planes[j]) < eps) {\n        wasseen = true;\n        break;\n      }\n    }\n    if (!wasseen) {\n      planes.push(p2);\n      planerot.push(g[i]);\n    }\n  }\n  return planerot;\n}\n\nexport function getface(planes: Quat[]): Quat[] {\n  // compute a face given a set of planes\n  // The face returned will be a set of points that lie in the first plane\n  // in the given array, that are on the surface of the polytope defined\n  // by all the planes, and will be returned in clockwise order.\n  // This is O(planes^2 * return size + return_size^2).\n  const face = [];\n  for (let i = 1; i < planes.length; i++) {\n    for (let j = i + 1; j < planes.length; j++) {\n      const p = solvethreeplanes(0, i, j, planes);\n      if (p) {\n        let wasseen = false;\n        for (let k = 0; k < face.length; k++) {\n          if (p.dist(face[k]) < eps) {\n            wasseen = true;\n            break;\n          }\n        }\n        if (!wasseen) {\n          face.push(p);\n        }\n      }\n    }\n  }\n  for (;;) {\n    let changed = false;\n    for (let i = 0; i < face.length; i++) {\n      const j: number = (i + 1) % face.length;\n      if (planes[0].dot(face[i].cross(face[j])) < 0) {\n        const t: Quat = face[i];\n        face[i] = face[j];\n        face[j] = t;\n        changed = true;\n      }\n    }\n    if (!changed) {\n      break;\n    }\n  }\n  return face;\n}\n", "export type PuzzleDescriptionString = string;\n\nexport const Puzzles: { [name: string]: PuzzleDescriptionString } = {\n  \"2x2x2\": \"c f 0\",\n  \"3x3x3\": \"c f 0.333333333333333\",\n  \"4x4x4\": \"c f 0.5 f 0\",\n  \"5x5x5\": \"c f 0.6 f 0.2\",\n  \"6x6x6\": \"c f 0.666666666666667 f 0.333333333333333 f 0\",\n  \"7x7x7\": \"c f 0.714285714285714 f 0.428571428571429 f 0.142857142857143\",\n  \"8x8x8\": \"c f 0.75 f 0.5 f 0.25 f 0\",\n  \"9x9x9\":\n    \"c f 0.777777777777778 f 0.555555555555556 f 0.333333333333333 f 0.111111111111111\",\n  \"10x10x10\": \"c f 0.8 f 0.6 f 0.4 f 0.2 f 0\",\n  \"11x11x11\":\n    \"c f 0.818181818181818 f 0.636363636363636 f 0.454545454545455 f 0.272727272727273 f 0.0909090909090909\",\n  \"12x12x12\":\n    \"c f 0.833333333333333 f 0.666666666666667 f 0.5 f 0.333333333333333 f 0.166666666666667 f 0\",\n  \"13x13x13\":\n    \"c f 0.846153846153846 f 0.692307692307692 f 0.538461538461538 f 0.384615384615385 f 0.230769230769231 f 0.0769230769230769\",\n  \"20x20x20\": \"c f 0 f .1 f .2 f .3 f .4 f .5 f .6 f .7 f .8 f .9\",\n  \"30x30x30\":\n    \"c f 0 f .066667 f .133333 f .2 f .266667 f .333333 f .4 f .466667 f .533333 f .6 f .666667 f .733333 f .8 f .866667 f .933333\",\n  \"skewb\": \"c v 0\",\n  \"master skewb\": \"c v 0.275\",\n  \"professor skewb\": \"c v 0 v 0.38\",\n  \"compy cube\": \"c v 0.915641442663986\",\n  \"helicopter\": \"c e 0.707106781186547\",\n  \"curvy copter\": \"c e 0.83\",\n  \"dino\": \"c v 0.577350269189626\",\n  \"little chop\": \"c e 0\",\n  \"pyramorphix\": \"t e 0\",\n  \"mastermorphix\": \"t e 0.346184634065199\",\n  \"pyraminx\": \"t v 0.333333333333333 v 1.66666666666667\",\n  \"master pyraminx\": \"t v 0 v 1 v 2\",\n  \"professor pyraminx\": \"t v -0.2 v 0.6 v 1.4 v 2.2\",\n  \"Jing pyraminx\": \"t f 0\",\n  \"master pyramorphix\": \"t e 0.866025403784437\",\n  \"megaminx\": \"d f 0.7\",\n  \"gigaminx\": \"d f 0.64 f 0.82\",\n  \"pentultimate\": \"d f 0\",\n  // exact value for starminx is sqrt(5(5-2 sqrt(5))/3)\n  \"starminx\": \"d v 0.937962370425399\",\n  \"starminx 2\": \"d f 0.23606797749979\",\n  \"pyraminx crystal\": \"d f 0.447213595499989\",\n  \"chopasaurus\": \"d v 0\",\n  \"big chop\": \"d e 0\",\n  \"skewb diamond\": \"o f 0\",\n  \"FTO\": \"o f 0.333333333333333\",\n  \"Christopher's jewel\": \"o v 0.577350269189626\",\n  \"octastar\": \"o e 0\",\n  \"Trajber's octahedron\": \"o v 0.433012701892219\",\n  \"radio chop\": \"i f 0\",\n  \"icosamate\": \"i v 0\",\n  \"icosahedron 2\": \"i v 0.18759247376021\",\n  \"icosahedron 3\": \"i v 0.18759247376021 e 0\",\n  \"icosahedron static faces\": \"i v 0.84\",\n  \"icosahedron moving faces\": \"i v 0.73\",\n  \"Eitan's star\": \"i f 0.61803398874989\",\n  \"2x2x2 + dino\": \"c f 0 v 0.577350269189626\",\n  \"2x2x2 + little chop\": \"c f 0 e 0\",\n  \"dino + little chop\": \"c v 0.577350269189626 e 0\",\n  \"2x2x2 + dino + little chop\": \"c f 0 v 0.577350269189626 e 0\",\n  \"megaminx + chopasaurus\": \"d f 0.61803398875 v 0\",\n  \"starminx combo\": \"d f 0.23606797749979 v 0.937962370425399\",\n};\n\nexport type PuzzleName = keyof typeof Puzzles;\n", "//   We don't want to introduce dependencies from alg or kpuzzle or other\n//   tools into puzzle geometry, but we do want to interoperate with them.\n//   This file contains interface declarations for some of the things we\n//   use interoperably.  These definitions are not identical to those in\n//   the corresponding classes but they are interoperable.\n\nexport class BlockMove {\n  public type: string = \"blockMove\";\n  public outerLayer?: number;\n  public innerLayer?: number;\n  constructor(\n    outerLayer: number | undefined,\n    innerLayer: number | undefined,\n    public family: string,\n    public amount: number = 1,\n  ) {\n    if (innerLayer) {\n      this.innerLayer = innerLayer;\n      if (outerLayer) {\n        this.outerLayer = outerLayer;\n      }\n    }\n    if (outerLayer && !innerLayer) {\n      throw new Error(\n        \"Attempted to contruct block move with outer layer but no inner layer\",\n      );\n    }\n  }\n}\n\nexport interface MoveNotation {\n  lookupMove(move: BlockMove): Transformation | undefined;\n}\n\nexport interface OrbitTransformation {\n  permutation: number[];\n  orientation: number[];\n}\n\nexport type Transformation = Record<string, OrbitTransformation>;\n\nexport interface OrbitDefinition {\n  numPieces: number;\n  orientations: number;\n}\n\nexport interface KPuzzleDefinition {\n  name: string;\n  orbits: { [key: string]: OrbitDefinition };\n  startPieces: Transformation;\n  moves: { [key: string]: Transformation };\n  svg?: string;\n  moveNotation?: MoveNotation;\n}\n", "import { FaceNameSwizzler } from \"./FaceNameSwizzler\";\nimport { BlockMove } from \"./interfaces\";\n\nexport interface NotationMapper {\n  notationToInternal(mv: BlockMove): BlockMove;\n  notationToExternal(mv: BlockMove): BlockMove;\n}\n\nexport class NullMapper implements NotationMapper {\n  public notationToInternal(mv: BlockMove): BlockMove {\n    return mv;\n  }\n\n  public notationToExternal(mv: BlockMove): BlockMove {\n    return mv;\n  }\n}\n\nexport class NxNxNCubeMapper implements NotationMapper {\n  constructor(public slices: number) {}\n\n  public notationToInternal(mv: BlockMove): BlockMove {\n    const grip = mv.family;\n    if (!mv.innerLayer && !mv.outerLayer) {\n      if (grip === \"x\") {\n        mv = new BlockMove(undefined, undefined, \"Rv\", mv.amount);\n      } else if (grip === \"y\") {\n        mv = new BlockMove(undefined, undefined, \"Uv\", mv.amount);\n      } else if (grip === \"z\") {\n        mv = new BlockMove(undefined, undefined, \"Fv\", mv.amount);\n      }\n      if ((this.slices & 1) === 1) {\n        if (grip === \"E\") {\n          mv = new BlockMove(undefined, (this.slices + 1) / 2, \"D\", mv.amount);\n        } else if (grip === \"M\") {\n          mv = new BlockMove(undefined, (this.slices + 1) / 2, \"L\", mv.amount);\n        } else if (grip === \"S\") {\n          mv = new BlockMove(undefined, (this.slices + 1) / 2, \"F\", mv.amount);\n        }\n      }\n      if (this.slices > 2) {\n        if (grip === \"e\") {\n          mv = new BlockMove(2, this.slices - 1, \"D\", mv.amount);\n        } else if (grip === \"m\") {\n          mv = new BlockMove(2, this.slices - 1, \"L\", mv.amount);\n        } else if (grip === \"s\") {\n          mv = new BlockMove(2, this.slices - 1, \"F\", mv.amount);\n        }\n      }\n    }\n    return mv;\n  }\n\n  // do we want to map slice moves to E/M/S instead of 2U/etc.?\n  public notationToExternal(mv: BlockMove): BlockMove {\n    const grip = mv.family;\n    if (!mv.innerLayer && !mv.outerLayer) {\n      if (grip === \"Rv\") {\n        return new BlockMove(undefined, undefined, \"x\", mv.amount);\n      } else if (grip === \"Uv\") {\n        return new BlockMove(undefined, undefined, \"y\", mv.amount);\n      } else if (grip === \"Fv\") {\n        return new BlockMove(undefined, undefined, \"z\", mv.amount);\n      } else if (grip === \"Lv\") {\n        return this.negate(\"x\", mv.amount);\n      } else if (grip === \"Dv\") {\n        return this.negate(\"y\", mv.amount);\n      } else if (grip === \"Bv\") {\n        return this.negate(\"z\", mv.amount);\n      }\n    }\n    return mv;\n  }\n\n  private negate(family: string, v: number | undefined): BlockMove {\n    if (v === undefined) {\n      v = -1;\n    } else if (v === -1) {\n      v = undefined;\n    } else {\n      v = -v;\n    }\n    return new BlockMove(undefined, undefined, family, v);\n  }\n}\n\n// face renaming mapper.  Accepts two face name remappers.  We\n// work between the two.\n\nexport class FaceRenamingMapper implements NotationMapper {\n  constructor(\n    public internalNames: FaceNameSwizzler,\n    public externalNames: FaceNameSwizzler,\n  ) {}\n\n  // TODO:  consider putting a cache in front of this\n  public convertString(\n    grip: string,\n    a: FaceNameSwizzler,\n    b: FaceNameSwizzler,\n  ): string {\n    let suffix = \"\";\n    if ((grip.endsWith(\"v\") || grip.endsWith(\"v\")) && grip <= \"_\") {\n      suffix = grip.slice(grip.length - 1);\n      grip = grip.slice(0, grip.length - 1);\n    }\n    const upper = grip.toUpperCase();\n    let isLowerCase = false;\n    if (grip !== upper) {\n      isLowerCase = true;\n      grip = upper;\n    }\n    grip = b.joinByFaceIndices(a.splitByFaceNames(grip));\n    if (isLowerCase) {\n      grip = grip.toLowerCase();\n    }\n    return grip + suffix;\n  }\n\n  public convert(\n    mv: BlockMove,\n    a: FaceNameSwizzler,\n    b: FaceNameSwizzler,\n  ): BlockMove {\n    const grip = mv.family;\n    const ngrip = this.convertString(grip, a, b);\n    if (grip === ngrip) {\n      return mv;\n    } else {\n      return new BlockMove(mv.outerLayer, mv.innerLayer, ngrip, mv.amount);\n    }\n  }\n\n  public notationToInternal(mv: BlockMove): BlockMove {\n    const r = this.convert(mv, this.externalNames, this.internalNames);\n    return r;\n  }\n\n  public notationToExternal(mv: BlockMove): BlockMove {\n    return this.convert(mv, this.internalNames, this.externalNames);\n  }\n}\n\n// Sits on top of a (possibly null) notation mapper, and\n// adds R++/R--/D++/D-- notation mapping.\nexport class MegaminxScramblingNotationMapper implements NotationMapper {\n  constructor(private child: NotationMapper) {}\n\n  public notationToInternal(mv: BlockMove): BlockMove {\n    if (\n      mv.innerLayer === undefined &&\n      mv.outerLayer === undefined &&\n      Math.abs(mv.amount) === 1\n    ) {\n      if (mv.family === \"R++\") {\n        return new BlockMove(2, 3, \"L\", -2 * mv.amount);\n      } else if (mv.family === \"R--\") {\n        return new BlockMove(2, 3, \"L\", 2 * mv.amount);\n      } else if (mv.family === \"D++\") {\n        return new BlockMove(2, 3, \"U\", -2 * mv.amount);\n      } else if (mv.family === \"D--\") {\n        return new BlockMove(2, 3, \"U\", 2 * mv.amount);\n      }\n    }\n    return this.child.notationToInternal(mv);\n  }\n\n  // we never rewrite click moves to these moves.\n  public notationToExternal(mv: BlockMove): BlockMove {\n    return this.child.notationToExternal(mv);\n  }\n}\n", "// Manages a set of face names.  Detects whether they are prefix-free.\n// Implements greedy splitting into face names and comparisons between\n// concatenated face names and grip names.\n\nexport class FaceNameSwizzler {\n  public prefixFree: boolean = true;\n  public gripnames: string[] = [];\n  constructor(public facenames: string[], gripnames_arg?: string[]) {\n    if (gripnames_arg) {\n      this.gripnames = gripnames_arg;\n    }\n    for (let i = 0; this.prefixFree && i < facenames.length; i++) {\n      for (let j = 0; this.prefixFree && j < facenames.length; j++) {\n        if (i !== j && facenames[i].startsWith(facenames[j])) {\n          this.prefixFree = false;\n        }\n      }\n    }\n  }\n\n  public setGripNames(names: string[]): void {\n    this.gripnames = names;\n  }\n\n  // split a string into face names and return a list of\n  // indices.\n  public splitByFaceNames(s: string): number[] {\n    const r = [];\n    let at = 0;\n    while (at < s.length) {\n      if (at > 0 && at < s.length && s[at] === \"_\") {\n        at++;\n      }\n      let currentMatch = -1;\n      for (let i = 0; i < this.facenames.length; i++) {\n        if (\n          s.substr(at).startsWith(this.facenames[i]) &&\n          (currentMatch < 0 ||\n            this.facenames[i].length > this.facenames[currentMatch].length)\n        ) {\n          currentMatch = i;\n        }\n      }\n      if (currentMatch >= 0) {\n        r.push(currentMatch);\n        at += this.facenames[currentMatch].length;\n      } else {\n        throw new Error(\"Could not split \" + s + \" into face names.\");\n      }\n    }\n    return r;\n  }\n\n  // cons a grip from an array of numbers.\n  public joinByFaceIndices(list: number[]): string {\n    let sep = \"\";\n    const r = [];\n    for (let i = 0; i < list.length; i++) {\n      r.push(sep);\n      r.push(this.facenames[list[i]]);\n      if (!this.prefixFree) {\n        sep = \"_\";\n      }\n    }\n    return r.join(\"\");\n  }\n\n  /*\n   *   Try to match something the user gave us with some geometric\n   *   feature.  We used to have strict requirements:\n   *\n   *      a)  The set of face names are prefix free\n   *      b)  When specifying a corner, all coincident planes were\n   *          specified\n   *\n   *   But, to allow megaminx to have more reasonable and\n   *   conventional names, and to permit shorter canonical\n   *   names, we are relaxing these requirements and adding\n   *   new syntax.  Now:\n   *\n   *      a)  Face names need not be syntax free.\n   *      b)  When parsing a geometric name, we use greedy\n   *          matching, so the longest name that matches the\n   *          user string at the current position is the one\n   *          assumed to match.\n   *      c)  Underscores are permitted to separate face names\n   *          (both in user input and in geometric\n   *          descriptions).\n   *      d)  Default names of corner moves where corners have\n   *          more than three corners, need only include three\n   *          of the corners.\n   *\n   *   This code is not performance-sensitive so we can do it a\n   *   slow and simple way.\n   */\n  public spinmatch(userinput: string, longname: string): boolean {\n    // are these the same rotationally?\n    if (userinput === longname) {\n      return true;\n    }\n    try {\n      const e1 = this.splitByFaceNames(userinput);\n      const e2 = this.splitByFaceNames(longname);\n      // All elements of userinput need to be in the longname.\n      // There should be no duplicate elements in the userinput.\n      // if both have length 1 or length 2, the sets must be equal.\n      // if both have length 3 or more, then the first set must be\n      // a subset of the second.  Order doesn't matter.\n      if (e1.length !== e2.length && e1.length < 3) {\n        return false;\n      }\n      for (let i = 0; i < e1.length; i++) {\n        for (let j = 0; j < i; j++) {\n          if (e1[i] === e1[j]) {\n            return false;\n          }\n        }\n        let found = false;\n        for (let j = 0; j < e2.length; j++) {\n          if (e1[i] === e2[j]) {\n            found = true;\n            break;\n          }\n        }\n        if (!found) {\n          return false;\n        }\n      }\n      return true;\n    } catch (e) {\n      return false;\n    }\n  }\n\n  public unswizzle(s: string): string {\n    if ((s.endsWith(\"v\") || s.endsWith(\"w\")) && s[0] <= \"Z\") {\n      s = s.slice(0, s.length - 1);\n    }\n    const upperCaseGrip = s.toUpperCase();\n    for (let i = 0; i < this.gripnames.length; i++) {\n      const g = this.gripnames[i];\n      if (this.spinmatch(upperCaseGrip, g)) {\n        return g;\n      }\n    }\n    return s;\n  }\n}\n", "/* tslint:disable no-bitwise */\n/* tslint:disable prefer-for-of */ // TODO\n/* tslint:disable only-arrow-functions */ // TODO\n/* tslint:disable typedef */ // TODO\n\nimport { iota, zeros, Perm } from \"./Perm\";\nimport {\n  Orbit,\n  OrbitDef,\n  OrbitsDef,\n  showcanon,\n  Transformation,\n  VisibleState,\n} from \"./PermOriSet\";\nimport {\n  closure,\n  cube,\n  dodecahedron,\n  getface,\n  icosahedron,\n  octahedron,\n  tetrahedron,\n  uniqueplanes,\n} from \"./PlatonicGenerator\";\nimport { PuzzleDescriptionString, Puzzles, PuzzleName } from \"./Puzzles\";\nimport { centermassface, expandfaces, Quat } from \"./Quat\";\nimport {\n  BlockMove,\n  KPuzzleDefinition,\n  MoveNotation,\n  Transformation as KTransformation,\n} from \"./interfaces\";\nimport {\n  FaceRenamingMapper,\n  MegaminxScramblingNotationMapper,\n  NotationMapper,\n  NullMapper,\n  NxNxNCubeMapper,\n} from \"./NotationMapper\";\nimport { FaceNameSwizzler } from \"./FaceNameSwizzler\";\n\nconst DEFAULT_COLOR_FRACTION = 0.77;\n\nexport interface StickerDatSticker {\n  coords: number[][];\n  color: string;\n  orbit: string;\n  ord: number;\n  ori: number;\n}\n\nexport interface StickerDatFace {\n  coords: number[][];\n  name: string;\n}\n\nexport type StickerDatAxis = [number[], string, number];\n\nexport interface StickerDat {\n  stickers: StickerDatSticker[];\n  foundations: StickerDatSticker[];\n  faces: StickerDatFace[];\n  axis: StickerDatAxis[];\n  unswizzle(mv: BlockMove): string;\n  notationMapper: NotationMapper;\n}\n\n// TODO: Remove this once we no longer have prefix restrictions.\nlet NEW_FACE_NAMES = true;\nexport function useNewFaceNames(use: boolean): void {\n  NEW_FACE_NAMES = use;\n}\n\n//  Now we have a geometry class that does the 3D goemetry to calculate\n//  individual sticker information from a Platonic solid and a set of\n//  cuts.  The cuts must have the same symmetry as the Platonic solid;\n//  we even restrict them further to be either vertex-normal,\n//  edge-normal, or face-parallel cuts.  Right now our constructor takes\n//  a character solid indicator (one of c(ube), o(ctahedron), i(cosahedron),\n//  t(etradron), or d(odecahedron), followed by an array of cuts.\n//  Each cut is a character normal indicator that is either f(ace),\n//  e(dge), or v(ertex), followed by a floating point value that gives\n//  the depth of the cut where 0 is the center and 1 is the outside\n//  border of the shape in that direction.\n\n//  This is a heavyweight class with lots of members and construction\n//  is slow.  Be gentle.\n\n//  Everything except a very few methods should be considered private.\n\nconst eps: number = 1e-9;\nconst copyright = \"PuzzleGeometry 0.1 Copyright 2018 Tomas Rokicki.\";\nconst permissivieMoveParsing = false;\n\n// This is a description of the nets and the external names we give each\n// face.  The names should be a set of prefix-free upper-case alphabetics\n// so\n// we can easily also name and distinguish vertices and edges, but we\n// may change this in the future.  The nets consist of a list of lists.\n// Each list gives the name of a face, and then the names of the\n// faces connected to that face (in the net) in clockwise order.\n// The length of each list should be one more than the number of\n// edges in the regular polygon for that face.  All polygons must\n// have the same number of edges.\n// The first two faces in the first list must describe a horizontal edge\n// that is at the bottom of a regular polygon.  The first two faces in\n// every subsequent list for a given polytope must describe a edge that\n// is directly connected in the net and has already been described (this\n// sets the location and orientation of the polygon for that face.\n// Any edge that is not directly connected in the net should be given\n// the empty string as the other face.  All faces do not need to have\n// a list starting with that face; just enough to describe the full\n// connectivity of the net.\n//\n// TODO: change this back to a const JSON definition.\nfunction defaultnets(): any {\n  return {\n    // four faces: tetrahedron\n    4: [[\"F\", \"D\", \"L\", \"R\"]],\n    // six faces: cube\n    6: [\n      [\"F\", \"D\", \"L\", \"U\", \"R\"],\n      [\"R\", \"F\", \"\", \"B\", \"\"],\n    ],\n    // eight faces: octahedron\n    8: [\n      [\"F\", \"D\", \"L\", \"R\"],\n      [\"D\", \"F\", \"BR\", \"\"],\n      [\"BR\", \"D\", \"\", \"BB\"],\n      [\"BB\", \"BR\", \"U\", \"BL\"],\n    ],\n    // twelve faces:  dodecahedron; U/F/R/F/BL/BR from megaminx\n    12: [\n      [\"U\", \"F\", \"\", \"\", \"\", \"\"],\n      [\"F\", \"U\", \"R\", \"C\", \"A\", \"L\"],\n      [\"R\", \"F\", \"\", \"\", \"E\", \"\"],\n      [\"E\", \"R\", \"\", \"BF\", \"\", \"\"],\n      [\"BF\", \"E\", \"BR\", \"BL\", \"I\", \"D\"],\n    ],\n    // twenty faces: icosahedron\n    20: [\n      [\"R\", \"C\", \"F\", \"E\"],\n      [\"F\", \"R\", \"L\", \"U\"],\n      [\"L\", \"F\", \"A\", \"\"],\n      [\"E\", \"R\", \"G\", \"I\"],\n      [\"I\", \"E\", \"S\", \"H\"],\n      [\"S\", \"I\", \"J\", \"B\"],\n      [\"B\", \"S\", \"K\", \"D\"],\n      [\"K\", \"B\", \"M\", \"O\"],\n      [\"O\", \"K\", \"P\", \"N\"],\n      [\"P\", \"O\", \"Q\", \"\"],\n    ],\n  };\n}\n\n// TODO: change this back to a const JSON definition.\nfunction defaultcolors(): any {\n  return {\n    // the colors should use the same naming convention as the nets, above.\n    4: { F: \"#00ff00\", D: \"#ffff00\", L: \"#ff0000\", R: \"#0000ff\" },\n    6: {\n      U: \"#ffffff\",\n      F: \"#00ff00\",\n      R: \"#ff0000\",\n      D: \"#ffff00\",\n      B: \"#0000ff\",\n      L: \"#ff8000\",\n    },\n    8: {\n      U: \"#ffffff\",\n      F: \"#ff0000\",\n      R: \"#00bb00\",\n      D: \"#ffff00\",\n      BB: \"#1122ff\",\n      L: \"#9524c5\",\n      BL: \"#ff8800\",\n      BR: \"#aaaaaa\",\n    },\n    12: {\n      U: \"#ffffff\",\n      F: \"#006633\",\n      R: \"#ff0000\",\n      C: \"#ffffd0\",\n      A: \"#3399ff\",\n      L: \"#660099\",\n      E: \"#ff66cc\",\n      BF: \"#99ff00\",\n      BR: \"#0000ff\",\n      BL: \"#ffff00\",\n      I: \"#ff6633\",\n      D: \"#999999\",\n    },\n    20: {\n      R: \"#db69f0\",\n      C: \"#178fde\",\n      F: \"#23238b\",\n      E: \"#9cc726\",\n      L: \"#2c212d\",\n      U: \"#177fa7\",\n      A: \"#e0de7f\",\n      G: \"#2b57c0\",\n      I: \"#41126b\",\n      S: \"#4b8c28\",\n      H: \"#7c098d\",\n      J: \"#7fe7b4\",\n      B: \"#85fb74\",\n      K: \"#3f4bc3\",\n      D: \"#0ff555\",\n      M: \"#f1c2c8\",\n      O: \"#58d340\",\n      P: \"#c514f2\",\n      N: \"#14494e\",\n      Q: \"#8b1be1\",\n    },\n  };\n}\n\n// the default precedence of the faces is given here.  This permits\n// the orientations to be reasonably predictable.  There are tradeoffs;\n// some face precedence orders do better things to the edge orientations\n// than the corner orientations and some are the opposite.\n// TODO: change this back to a const JSON definition.\nfunction defaultfaceorders(): any {\n  return {\n    4: [\"F\", \"D\", \"L\", \"R\"],\n    6: [\"U\", \"D\", \"F\", \"B\", \"L\", \"R\"],\n    8: [\"F\", \"BB\", \"D\", \"U\", \"BR\", \"L\", \"R\", \"BL\"],\n    12: [\"L\", \"E\", \"F\", \"BF\", \"R\", \"I\", \"U\", \"D\", \"BR\", \"A\", \"BL\", \"C\"],\n    20: [\n      \"L\",\n      \"S\",\n      \"E\",\n      \"O\",\n      \"F\",\n      \"B\",\n      \"I\",\n      \"P\",\n      \"R\",\n      \"K\",\n      \"U\",\n      \"D\",\n      \"J\",\n      \"A\",\n      \"Q\",\n      \"H\",\n      \"G\",\n      \"N\",\n      \"M\",\n      \"C\",\n    ],\n  };\n}\n\n/*\n *  Default orientations for the puzzles in 3D space.  Can be overridden\n *  by puzzleOrientation or puzzleOrientations options.\n *\n *  These are defined to have a strong intuitive vertical (y) direction\n *  since 3D orbital controls need this.  In comments, we list the\n *  preferred initial camera orientation for each puzzle for twizzle;\n *  this information is explicitly given in the twizzle app file.\n */\n// TODO: change this back to a const JSON definition.\nfunction defaultOrientations(): any {\n  return {\n    4: [\"FLR\", [0, 1, 0], \"F\", [0, 0, 1]], // FLR towards viewer\n    6: [\"U\", [0, 1, 0], \"F\", [0, 0, 1]], // URF towards viewer\n    8: [\"U\", [0, 1, 0], \"F\", [0, 0, 1]], // FLUR towards viewer\n    12: [\"U\", [0, 1, 0], \"F\", [0, 0, 1]], // F towards viewer\n    20: [\"GUQMJ\", [0, 1, 0], \"F\", [0, 0, 1]], // F towards viewer\n  };\n}\n\nfunction findelement(a: any[], p: Quat): number {\n  // find something in facenames, vertexnames, edgenames\n  for (let i = 0; i < a.length; i++) {\n    if (a[i][0].dist(p) < eps) {\n      return i;\n    }\n  }\n  throw new Error(\"Element not found\");\n}\n\nexport function getpuzzles(): { [s: string]: PuzzleDescriptionString } {\n  // get some simple definitions of basic puzzles\n  return Puzzles;\n}\n\nexport function getpuzzle(puzzleName: PuzzleName): PuzzleDescriptionString {\n  // get some simple definitions of basic puzzles\n  return Puzzles[puzzleName];\n}\n\nexport function parsedesc(s: string): any {\n  // parse a text description\n  const a = s.split(/ /).filter(Boolean);\n  if (a.length % 2 === 0) {\n    return false;\n  }\n  if (\n    a[0] !== \"o\" &&\n    a[0] !== \"c\" &&\n    a[0] !== \"i\" &&\n    a[0] !== \"d\" &&\n    a[0] !== \"t\"\n  ) {\n    return false;\n  }\n  const r = [];\n  for (let i = 1; i < a.length; i += 2) {\n    if (a[i] !== \"f\" && a[i] !== \"v\" && a[i] !== \"e\") {\n      return false;\n    }\n    r.push([a[i], a[i + 1]]);\n  }\n  return [a[0], r];\n}\n\nexport function getPuzzleGeometryByDesc(\n  desc: string,\n  options: string[] = [],\n): PuzzleGeometry {\n  const [shape, cuts] = parsedesc(desc);\n  const pg = new PuzzleGeometry(\n    shape,\n    cuts,\n    [\"allmoves\", \"true\"].concat(options),\n  );\n  pg.allstickers();\n  pg.genperms();\n  return pg;\n}\n\nexport function getPuzzleGeometryByName(\n  puzzleName: PuzzleName,\n  options: string[] = [],\n): PuzzleGeometry {\n  return getPuzzleGeometryByDesc(Puzzles[puzzleName], options);\n}\n\nfunction getmovename(geo: any, bits: number, slices: number): any {\n  // generate a move name based on bits, slice, and geo\n  // if the move name is from the opposite face, say so.\n  // find the face that's turned.\n  let nbits = 0;\n  let inverted = false;\n  for (let i = 0; i <= slices; i++) {\n    if ((bits >> i) & 1) {\n      nbits |= 1 << (slices - i);\n    }\n  }\n  if (nbits < bits) {\n    // flip if most of the move is on the other side\n    geo = [geo[2], geo[3], geo[0], geo[1]];\n    bits = nbits;\n    inverted = true;\n  }\n  let movenameFamily = geo[0];\n  let movenamePrefix = \"\";\n  let hibit = 0;\n  while (bits >> (1 + hibit)) {\n    hibit++;\n  }\n  if (bits === (2 << slices) - 1) {\n    movenameFamily = movenameFamily + \"v\";\n  } else if (bits === 1 << hibit) {\n    if (hibit > 0) {\n      movenamePrefix = String(hibit + 1);\n    }\n  } else if (bits === (2 << hibit) - 1) {\n    movenameFamily = movenameFamily.toLowerCase();\n    if (hibit > 1) {\n      movenamePrefix = String(hibit + 1);\n    }\n  } else {\n    movenamePrefix = \"_\" + bits + \"_\";\n    //       throw \"We only support slice and outer block moves right now. \" + bits ;\n  }\n  return [movenamePrefix + movenameFamily, inverted];\n}\n\n// split a geometrical element into face names.  Do greedy match.\n// Permit underscores between names.\nfunction splitByFaceNames(s: string, facenames: any[]): string[] {\n  const r: string[] = [];\n  let at = 0;\n  while (at < s.length) {\n    if (at > 0 && at < s.length && s[at] === \"_\") {\n      at++;\n    }\n    let currentMatch = \"\";\n    for (let i = 0; i < facenames.length; i++) {\n      if (\n        s.substr(at).startsWith(facenames[i][1]) &&\n        facenames[i][1].length > currentMatch.length\n      ) {\n        currentMatch = facenames[i][1];\n      }\n    }\n    if (currentMatch !== \"\") {\n      r.push(currentMatch);\n      at += currentMatch.length;\n    } else {\n      throw new Error(\"Could not split \" + s + \" into face names.\");\n    }\n  }\n  return r;\n}\n\nfunction toCoords(q: Quat, maxdist: number): number[] {\n  return [q.b / maxdist, -q.c / maxdist, q.d / maxdist];\n}\n\nfunction toFaceCoords(q: Quat[], maxdist: number): number[][] {\n  const r = [];\n  const n = q.length;\n  for (let i = 0; i < n; i++) {\n    r[n - i - 1] = toCoords(q[i], maxdist);\n  }\n  return r;\n}\n\nfunction trimEdges(face: Quat[], tr: number): Quat[] {\n  const r: Quat[] = [];\n  for (let iter = 1; iter < 10; iter++) {\n    for (let i = 0; i < face.length; i++) {\n      const pi = (i + face.length - 1) % face.length;\n      const ni = (i + 1) % face.length;\n      const A = face[pi].sub(face[i]).normalize();\n      const B = face[ni].sub(face[i]).normalize();\n      const d = A.dot(B);\n      const m = tr / Math.sqrt(1 - d * d);\n      r[i] = face[i].sum(A.sum(B).smul(m));\n    }\n    let good = true;\n    for (let i = 0; good && i < r.length; i++) {\n      const pi = (i + face.length - 1) % face.length;\n      const ni = (i + 1) % face.length;\n      if (r[pi].sub(r[i]).cross(r[ni].sub(r[i])).dot(r[i]) >= 0) {\n        good = false;\n      }\n    }\n    if (good) {\n      return r;\n    }\n    tr /= 2;\n  }\n  return face;\n}\n\nexport class PuzzleGeometry {\n  public args: string = \"\";\n  public rotations: Quat[]; // all members of the rotation group\n  public baseplanerot: Quat[]; // unique rotations of the baseplane\n  public baseplanes: Quat[]; // planes, corresponding to faces\n  public facenames: any[]; // face names\n  public faceplanes: any; // face planes\n  public edgenames: any[]; // edge names\n  public vertexnames: any[]; // vertexnames\n  public geonormals: any[]; // all geometric directions, with names and types\n  public moveplanes: Quat[]; // the planes that split moves\n  public moveplanes2: Quat[]; // the planes that split moves, filtered\n  public moveplanesets: any[]; // the move planes, in parallel sets\n  public moveplanenormals: Quat[]; // one move plane\n  public movesetorders: any[]; // the order of rotations for each move set\n  public movesetgeos: any[]; // geometric feature information for move sets\n  public basefaces: Quat[][]; // polytope faces before cuts\n  public faces: Quat[][]; // all the stickers\n  public basefacecount: number; // number of base faces\n  public stickersperface: number; // number of stickers per face\n  public cornerfaces: number; // number of faces that meet at a corner\n  public cubies: any[]; // the cubies\n  public shortedge: number; // shortest edge\n  public vertexdistance: number; // vertex distance\n  public edgedistance: number; // edge distance\n  public orbits: number; // count of cubie orbits\n  public facetocubies: any[]; // map a face to a cubie index and offset\n  public moverotations: Quat[][]; // move rotations\n  public cubiekey: any; // cubie locator\n  public cubiekeys: string[]; // cubie keys\n  public facelisthash: any; // face list by key\n  public cubiesetnames: any[]; // cubie set names\n  public cubieords: number[]; // the size of each orbit\n  public cubiesetnums: number[];\n  public cubieordnums: number[];\n  public orbitoris: number[]; // the orientation size of each orbit\n  public cubievaluemap: number[]; // the map for identical cubies\n  public cubiesetcubies: number[][]; // cubies in each cubie set\n  public cmovesbyslice: number[][][] = []; // cmoves as perms by slice\n  // options\n  public verbose: number = 0; // verbosity (console.log)\n  public allmoves: boolean = false; // generate all slice moves in ksolve\n  public outerblockmoves: boolean; // generate outer block moves\n  public vertexmoves: boolean; // generate vertex moves\n  public addrotations: boolean; // add symmetry information to ksolve output\n  public movelist: any; // move list to generate\n  public parsedmovelist: any; // parsed move list\n  public puzzleOrientation: any; // single puzzle orientation from options\n  public puzzleOrientations: any; // puzzle orientation override list from options\n  public cornersets: boolean = true; // include corner sets\n  public centersets: boolean = true; // include center sets\n  public edgesets: boolean = true; // include edge sets\n  public graycorners: boolean = false; // make corner sets gray\n  public graycenters: boolean = false; // make center sets gray\n  public grayedges: boolean = false; // make edge sets gray\n  public killorientation: boolean = false; // eliminate any orientations\n  public optimize: boolean = false; // optimize PermOri\n  public scramble: number = 0; // scramble?\n  public ksolvemovenames: string[]; // move names from ksolve\n  public fixPiece: string = \"\"; // fix a piece?\n  public orientCenters: boolean = false; // orient centers?\n  public duplicatedFaces: number[] = []; // which faces are duplicated\n  public duplicatedCubies: number[] = []; // which cubies are duplicated\n  public fixedCubie: number = -1; // fixed cubie, if any\n  public svggrips: any[]; // grips from svg generation by svg coordinate\n  public net: any = [];\n  public colors: any = [];\n  public faceorder: any = [];\n  public faceprecedence: number[] = [];\n  public swizzler: FaceNameSwizzler;\n  public notationMapper: NotationMapper = new NullMapper();\n  public addNotationMapper: string = \"\";\n  constructor(shape: string, cuts: string[][], optionlist: any[] | undefined) {\n    function asstructured(v: any): any {\n      if (typeof v === \"string\") {\n        return JSON.parse(v);\n      }\n      return v;\n    }\n    function asboolean(v: any): boolean {\n      if (typeof v === \"string\") {\n        if (v === \"false\") {\n          return false;\n        }\n        return true;\n      } else {\n        return v ? true : false;\n      }\n    }\n    if (optionlist !== undefined) {\n      if (optionlist.length % 2 !== 0) {\n        throw new Error(\"Odd length in option list?\");\n      }\n      for (let i = 0; i < optionlist.length; i += 2) {\n        if (optionlist[i] === \"verbose\") {\n          this.verbose++;\n        } else if (optionlist[i] === \"quiet\") {\n          this.verbose = 0;\n        } else if (optionlist[i] === \"allmoves\") {\n          this.allmoves = asboolean(optionlist[i + 1]);\n        } else if (optionlist[i] === \"outerblockmoves\") {\n          this.outerblockmoves = asboolean(optionlist[i + 1]);\n        } else if (optionlist[i] === \"vertexmoves\") {\n          this.vertexmoves = asboolean(optionlist[i + 1]);\n        } else if (optionlist[i] === \"rotations\") {\n          this.addrotations = asboolean(optionlist[i + 1]);\n        } else if (optionlist[i] === \"cornersets\") {\n          this.cornersets = asboolean(optionlist[i + 1]);\n        } else if (optionlist[i] === \"centersets\") {\n          this.centersets = asboolean(optionlist[i + 1]);\n        } else if (optionlist[i] === \"edgesets\") {\n          this.edgesets = asboolean(optionlist[i + 1]);\n        } else if (optionlist[i] === \"graycorners\") {\n          this.graycorners = asboolean(optionlist[i + 1]);\n        } else if (optionlist[i] === \"graycenters\") {\n          this.graycenters = asboolean(optionlist[i + 1]);\n        } else if (optionlist[i] === \"grayedges\") {\n          this.grayedges = asboolean(optionlist[i + 1]);\n        } else if (optionlist[i] === \"movelist\") {\n          this.movelist = asstructured(optionlist[i + 1]);\n        } else if (optionlist[i] === \"killorientation\") {\n          this.killorientation = asboolean(optionlist[i + 1]);\n        } else if (optionlist[i] === \"optimize\") {\n          this.optimize = asboolean(optionlist[i + 1]);\n        } else if (optionlist[i] === \"scramble\") {\n          this.scramble = optionlist[i + 1];\n        } else if (optionlist[i] === \"fix\") {\n          this.fixPiece = optionlist[i + 1];\n        } else if (optionlist[i] === \"orientcenters\") {\n          this.orientCenters = asboolean(optionlist[i + 1]);\n        } else if (optionlist[i] === \"puzzleorientation\") {\n          this.puzzleOrientation = asstructured(optionlist[i + 1]);\n        } else if (optionlist[i] === \"puzzleorientations\") {\n          this.puzzleOrientations = asstructured(optionlist[i + 1]);\n        } else {\n          throw new Error(\n            \"Bad option while processing option list \" + optionlist[i],\n          );\n        }\n      }\n    }\n    this.args = shape + \" \" + cuts.map((_) => _.join(\" \")).join(\" \");\n    if (optionlist) {\n      this.args += \" \" + optionlist.join(\" \");\n    }\n    if (this.verbose > 0) {\n      console.log(this.header(\"# \"));\n    }\n    this.create(shape, cuts);\n  }\n\n  public create(shape: string, cuts: any[]): void {\n    // create the shape, doing all the essential geometry\n    // create only goes far enough to figure out how many stickers per\n    // face, and what the short edge is.  If the short edge is too short,\n    // we probably don't want to display or manipulate this one.  How\n    // short is too short is hard to say.\n    // var that = this ; // TODO\n    this.moveplanes = [];\n    this.moveplanes2 = [];\n    this.faces = [];\n    this.cubies = [];\n    let g = null;\n    switch (shape) {\n      case \"c\":\n        g = cube();\n        break;\n      case \"o\":\n        g = octahedron();\n        break;\n      case \"i\":\n        g = icosahedron();\n        break;\n      case \"t\":\n        g = tetrahedron();\n        break;\n      case \"d\":\n        g = dodecahedron();\n        break;\n      default:\n        throw new Error(\"Bad shape argument: \" + shape);\n    }\n    this.rotations = closure(g);\n    if (this.verbose) {\n      console.log(\"# Rotations: \" + this.rotations.length);\n    }\n    const baseplane = g[0];\n    this.baseplanerot = uniqueplanes(baseplane, this.rotations);\n    const baseplanes = this.baseplanerot.map((_) => baseplane.rotateplane(_));\n    this.baseplanes = baseplanes;\n    this.basefacecount = baseplanes.length;\n    const net = defaultnets()[baseplanes.length];\n    this.net = net;\n    this.colors = defaultcolors()[baseplanes.length];\n    this.faceorder = defaultfaceorders()[baseplanes.length];\n    if (this.verbose) {\n      console.log(\"# Base planes: \" + baseplanes.length);\n    }\n    const baseface = getface(baseplanes);\n    const zero = new Quat(0, 0, 0, 0);\n    if (this.verbose) {\n      console.log(\"# Face vertices: \" + baseface.length);\n    }\n    const facenormal = baseplanes[0].makenormal();\n    const edgenormal = baseface[0].sum(baseface[1]).makenormal();\n    const vertexnormal = baseface[0].makenormal();\n    const boundary = new Quat(1, facenormal.b, facenormal.c, facenormal.d);\n    if (this.verbose) {\n      console.log(\"# Boundary is \" + boundary);\n    }\n    const planerot = uniqueplanes(boundary, this.rotations);\n    const planes = planerot.map((_) => boundary.rotateplane(_));\n    let faces = [getface(planes)];\n    this.edgedistance = faces[0][0].sum(faces[0][1]).smul(0.5).dist(zero);\n    this.vertexdistance = faces[0][0].dist(zero);\n    const cutplanes = [];\n    const intersects = [];\n    let sawface = false; // what cuts did we see?\n    let sawedge = false;\n    let sawvertex = false;\n    for (let i = 0; i < cuts.length; i++) {\n      let normal = null;\n      let distance = 0;\n      switch (cuts[i][0]) {\n        case \"f\":\n          normal = facenormal;\n          distance = 1;\n          sawface = true;\n          break;\n        case \"v\":\n          normal = vertexnormal;\n          distance = this.vertexdistance;\n          sawvertex = true;\n          break;\n        case \"e\":\n          normal = edgenormal;\n          distance = this.edgedistance;\n          sawedge = true;\n          break;\n        default:\n          throw new Error(\"Bad cut argument: \" + cuts[i][0]);\n      }\n      cutplanes.push(normal.makecut(cuts[i][1]));\n      intersects.push(cuts[i][1] < distance);\n    }\n    if (this.addrotations) {\n      if (!sawface) {\n        cutplanes.push(facenormal.makecut(10));\n      }\n      if (!sawvertex) {\n        cutplanes.push(vertexnormal.makecut(10));\n      }\n      if (!sawedge) {\n        cutplanes.push(edgenormal.makecut(10));\n      }\n    }\n    this.basefaces = [];\n    for (let i = 0; i < this.baseplanerot.length; i++) {\n      const face = this.baseplanerot[i].rotateface(faces[0]);\n      this.basefaces.push(face);\n    }\n    //\n    //   Determine names for edges, vertices, and planes.  Planes are defined\n    //   by the plane normal/distance; edges are defined by the midpoint;\n    //   vertices are defined by actual point.  In each case we define a name.\n    //   Note that edges have two potential names, and corners have n where\n    //   n planes meet at a vertex.  We arbitrarily choose the one that is\n    //   alphabetically first (and we will probably want to change this).\n    //\n    const facenames: any[] = [];\n    const faceplanes = [];\n    const vertexnames: any[] = [];\n    const edgenames: any[] = [];\n    const edgesperface = faces[0].length;\n    function searchaddelement(a: any[], p: Quat, name: any): void {\n      for (let i = 0; i < a.length; i++) {\n        if (a[i][0].dist(p) < eps) {\n          a[i].push(name);\n          return;\n        }\n      }\n      a.push([p, name]);\n    }\n    for (let i = 0; i < this.baseplanerot.length; i++) {\n      const face = this.baseplanerot[i].rotateface(faces[0]);\n      for (let j = 0; j < face.length; j++) {\n        const jj = (j + 1) % face.length;\n        const midpoint = face[j].sum(face[jj]).smul(0.5);\n        searchaddelement(edgenames, midpoint, i);\n      }\n    }\n    const otherfaces = [];\n    for (let i = 0; i < this.baseplanerot.length; i++) {\n      const face = this.baseplanerot[i].rotateface(faces[0]);\n      const facelist = [];\n      for (let j = 0; j < face.length; j++) {\n        const jj = (j + 1) % face.length;\n        const midpoint = face[j].sum(face[jj]).smul(0.5);\n        const el = edgenames[findelement(edgenames, midpoint)];\n        if (i === el[1]) {\n          facelist.push(el[2]);\n        } else if (i === el[2]) {\n          facelist.push(el[1]);\n        } else {\n          throw new Error(\"Could not find edge\");\n        }\n      }\n      otherfaces.push(facelist);\n    }\n    const facenametoindex: any = {};\n    const faceindextoname: any = [];\n    faceindextoname.push(net[0][0]);\n    facenametoindex[net[0][0]] = 0;\n    faceindextoname[otherfaces[0][0]] = net[0][1];\n    facenametoindex[net[0][1]] = otherfaces[0][0];\n    for (let i = 0; i < net.length; i++) {\n      const f0 = net[i][0];\n      const fi = facenametoindex[f0];\n      if (fi === undefined) {\n        throw new Error(\"Bad edge description; first edge not connected\");\n      }\n      let ii = -1;\n      for (let j = 0; j < otherfaces[fi].length; j++) {\n        const fn2 = faceindextoname[otherfaces[fi][j]];\n        if (fn2 !== undefined && fn2 === net[i][1]) {\n          ii = j;\n          break;\n        }\n      }\n      if (ii < 0) {\n        throw new Error(\"First element of a net not known\");\n      }\n      for (let j = 2; j < net[i].length; j++) {\n        if (net[i][j] === \"\") {\n          continue;\n        }\n        const of = otherfaces[fi][(j + ii - 1) % edgesperface];\n        const fn2 = faceindextoname[of];\n        if (fn2 !== undefined && fn2 !== net[i][j]) {\n          throw new Error(\"Face mismatch in net\");\n        }\n        faceindextoname[of] = net[i][j];\n        facenametoindex[net[i][j]] = of;\n      }\n    }\n    for (let i = 0; i < faceindextoname.length; i++) {\n      let found = false;\n      for (let j = 0; j < this.faceorder.length; j++) {\n        if (faceindextoname[i] === this.faceorder[j]) {\n          this.faceprecedence[i] = j;\n          found = true;\n          break;\n        }\n      }\n      if (!found) {\n        throw new Error(\n          \"Could not find face \" +\n            faceindextoname[i] +\n            \" in face order list \" +\n            this.faceorder,\n        );\n      }\n    }\n    for (let i = 0; i < this.baseplanerot.length; i++) {\n      const face = this.baseplanerot[i].rotateface(faces[0]);\n      const faceplane = boundary.rotateplane(this.baseplanerot[i]);\n      const facename = faceindextoname[i];\n      facenames.push([face, facename]);\n      faceplanes.push([faceplane, facename]);\n    }\n    for (let i = 0; i < this.baseplanerot.length; i++) {\n      const face = this.baseplanerot[i].rotateface(faces[0]);\n      const facename = faceindextoname[i];\n      for (let j = 0; j < face.length; j++) {\n        const jj = (j + 1) % face.length;\n        const midpoint = face[j].sum(face[jj]).smul(0.5);\n        const jjj = (j + 2) % face.length;\n        const midpoint2 = face[jj].sum(face[jjj]).smul(0.5);\n        const e1 = findelement(edgenames, midpoint);\n        const e2 = findelement(edgenames, midpoint2);\n        searchaddelement(vertexnames, face[jj], [facename, e2, e1]);\n      }\n    }\n    this.swizzler = new FaceNameSwizzler(facenames.map((_: any) => _[1]));\n    const sep = this.swizzler.prefixFree ? \"\" : \"_\";\n    // fix the edge names; use face precedence order\n    for (let i = 0; i < edgenames.length; i++) {\n      if (edgenames[i].length !== 3) {\n        throw new Error(\"Bad length in edge names \" + edgenames[i]);\n      }\n      let c1 = faceindextoname[edgenames[i][1]];\n      const c2 = faceindextoname[edgenames[i][2]];\n      if (\n        this.faceprecedence[edgenames[i][1]] <\n        this.faceprecedence[edgenames[i][2]]\n      ) {\n        c1 = c1 + sep + c2;\n      } else {\n        c1 = c2 + sep + c1;\n      }\n      edgenames[i] = [edgenames[i][0], c1];\n    }\n    // fix the vertex names; clockwise rotations; low face first.\n    this.cornerfaces = vertexnames[0].length - 1;\n    for (let i = 0; i < vertexnames.length; i++) {\n      if (vertexnames[i].length < 4) {\n        throw new Error(\"Bad length in vertex names\");\n      }\n      let st = 1;\n      for (let j = 2; j < vertexnames[i].length; j++) {\n        if (\n          this.faceprecedence[facenametoindex[vertexnames[i][j][0]]] <\n          this.faceprecedence[facenametoindex[vertexnames[i][st][0]]]\n        ) {\n          st = j;\n        }\n      }\n      let r = \"\";\n      for (let j = 1; j < vertexnames[i].length; j++) {\n        if (j === 1) {\n          r = vertexnames[i][st][0];\n        } else {\n          r = r + sep + vertexnames[i][st][0];\n        }\n        for (let k = 1; k < vertexnames[i].length; k++) {\n          if (vertexnames[i][st][2] === vertexnames[i][k][1]) {\n            st = k;\n            break;\n          }\n        }\n      }\n      vertexnames[i] = [vertexnames[i][0], r];\n    }\n    if (this.verbose > 1) {\n      console.log(\"Face precedence list: \" + this.faceorder.join(\" \"));\n      console.log(\"Face names: \" + facenames.map((_: any) => _[1]).join(\" \"));\n      console.log(\"Edge names: \" + edgenames.map((_: any) => _[1]).join(\" \"));\n      console.log(\n        \"Vertex names: \" + vertexnames.map((_: any) => _[1]).join(\" \"),\n      );\n    }\n    const geonormals = [];\n    for (let i = 0; i < faceplanes.length; i++) {\n      geonormals.push([faceplanes[i][0].makenormal(), faceplanes[i][1], \"f\"]);\n    }\n    for (let i = 0; i < edgenames.length; i++) {\n      geonormals.push([edgenames[i][0].makenormal(), edgenames[i][1], \"e\"]);\n    }\n    for (let i = 0; i < vertexnames.length; i++) {\n      geonormals.push([vertexnames[i][0].makenormal(), vertexnames[i][1], \"v\"]);\n    }\n    this.facenames = facenames;\n    this.faceplanes = faceplanes;\n    this.edgenames = edgenames;\n    this.vertexnames = vertexnames;\n    this.geonormals = geonormals;\n    const geonormalnames = geonormals.map((_: any) => _[1]);\n    this.swizzler.setGripNames(geonormalnames);\n    if (this.verbose) {\n      console.log(\n        \"# Distances: face \" +\n          1 +\n          \" edge \" +\n          this.edgedistance +\n          \" vertex \" +\n          this.vertexdistance,\n      );\n    }\n    // expand cutplanes by rotations.  We only work with one face here.\n    for (let c = 0; c < cutplanes.length; c++) {\n      for (let i = 0; i < this.rotations.length; i++) {\n        const q = cutplanes[c].rotateplane(this.rotations[i]);\n        let wasseen = false;\n        for (let j = 0; j < this.moveplanes.length; j++) {\n          if (q.sameplane(this.moveplanes[j])) {\n            wasseen = true;\n            break;\n          }\n        }\n        if (!wasseen) {\n          this.moveplanes.push(q);\n          faces = q.cutfaces(faces);\n          if (intersects[c]) {\n            this.moveplanes2.push(q);\n          }\n        }\n      }\n    }\n    this.faces = faces;\n    if (this.verbose) {\n      console.log(\"# Faces is now \" + faces.length);\n    }\n    this.stickersperface = faces.length;\n    //  Find and report the shortest edge in any of the faces.  If this\n    //  is small the puzzle is probably not practical or displayable.\n    let shortedge = 1e99;\n    for (let i = 0; i < faces.length; i++) {\n      for (let j = 0; j < faces[i].length; j++) {\n        const k = (j + 1) % faces[i].length;\n        const t = faces[i][j].dist(faces[i][k]);\n        if (t < shortedge) {\n          shortedge = t;\n        }\n      }\n    }\n    this.shortedge = shortedge;\n    if (this.verbose) {\n      console.log(\"# Short edge is \" + shortedge);\n    }\n    // add nxnxn cube notation if it has cube face moves\n    if (shape === \"c\" && sawface) {\n      // In this case the mapper adding is deferred until we\n      // know the number of slices.\n      this.addNotationMapper = \"NxNxNCubeMapper\";\n    }\n    if (shape === \"o\" && sawface && NEW_FACE_NAMES) {\n      this.notationMapper = new FaceRenamingMapper(\n        this.swizzler,\n        new FaceNameSwizzler([\"F\", \"D\", \"L\", \"BL\", \"R\", \"U\", \"BR\", \"B\"]),\n      );\n    }\n    if (shape === \"d\" && sawface && NEW_FACE_NAMES) {\n      this.addNotationMapper = \"Megaminx\";\n      this.notationMapper = new FaceRenamingMapper(\n        this.swizzler,\n        new FaceNameSwizzler([\n          \"U\",\n          \"F\",\n          \"L\",\n          \"BL\",\n          \"BR\",\n          \"R\",\n          \"FR\",\n          \"FL\",\n          \"DL\",\n          \"B\",\n          \"DR\",\n          \"D\",\n        ]),\n      );\n    }\n  }\n\n  public keyface(face: Quat[]): string {\n    // take a face and figure out the sides of each move plane\n    let s = \"\";\n    for (let i = 0; i < this.moveplanesets.length; i++) {\n      let t = 0;\n      for (let j = 0; j < this.moveplanesets[i].length; j++) {\n        if (this.moveplanesets[i][j].faceside(face) > 0) {\n          t++;\n        }\n      }\n      s = s + \" \" + t;\n    }\n    return s;\n  }\n\n  public findcubie(face: Quat[]): number {\n    return this.facetocubies[this.findface(face)][0];\n  }\n\n  public findface(face: Quat[]): number {\n    const cm = centermassface(face);\n    const key = this.keyface(face);\n    for (let i = 0; i < this.facelisthash[key].length; i++) {\n      const face2 = this.facelisthash[key][i];\n      if (Math.abs(cm.dist(centermassface(this.faces[face2]))) < eps) {\n        return face2;\n      }\n    }\n    throw new Error(\"Could not find face.\");\n  }\n\n  public project2d(facen: number, edgen: number, targvec: Quat[]): any {\n    // calculate geometry to map a particular edge of a particular\n    //  face to a given 2D vector.  The face is given as an index into the\n    //  facenames/baseplane arrays, and the edge is given as an offset into\n    //  the vertices.\n    const face = this.facenames[facen][0];\n    const edgen2 = (edgen + 1) % face.length;\n    const plane = this.baseplanes[facen];\n    let x0 = face[edgen2].sub(face[edgen]);\n    const olen = x0.len();\n    x0 = x0.normalize();\n    const y0 = x0.cross(plane).normalize();\n    let delta = targvec[1].sub(targvec[0]);\n    const len = delta.len() / olen;\n    delta = delta.normalize();\n    const cosr = delta.b;\n    const sinr = delta.c;\n    const x1 = x0.smul(cosr).sub(y0.smul(sinr)).smul(len);\n    const y1 = y0.smul(cosr).sum(x0.smul(sinr)).smul(len);\n    const off = new Quat(\n      0,\n      targvec[0].b - x1.dot(face[edgen]),\n      targvec[0].c - y1.dot(face[edgen]),\n      0,\n    );\n    return [x1, y1, off];\n  }\n\n  public allstickers(): void {\n    // next step is to calculate all the stickers and orbits\n    // We do enough work here to display the cube on the screen.\n    // take our newly split base face and expand it by the rotation matrix.\n    // this generates our full set of \"stickers\".\n    this.faces = expandfaces(this.baseplanerot, this.faces);\n    if (this.verbose) {\n      console.log(\"# Total stickers is now \" + this.faces.length);\n    }\n    // Split moveplanes into a list of parallel planes.\n    const moveplanesets: Quat[][] = [];\n    const moveplanenormals: Quat[] = [];\n    // get the normals, first, from unfiltered moveplanes.\n    for (let i = 0; i < this.moveplanes.length; i++) {\n      const q = this.moveplanes[i];\n      const qnormal = q.makenormal();\n      let wasseen = false;\n      for (let j = 0; j < moveplanenormals.length; j++) {\n        if (qnormal.sameplane(moveplanenormals[j].makenormal())) {\n          wasseen = true;\n        }\n      }\n      if (!wasseen) {\n        moveplanenormals.push(qnormal);\n        moveplanesets.push([]);\n      }\n    }\n    for (let i = 0; i < this.moveplanes2.length; i++) {\n      const q = this.moveplanes2[i];\n      const qnormal = q.makenormal();\n      for (let j = 0; j < moveplanenormals.length; j++) {\n        if (qnormal.sameplane(moveplanenormals[j])) {\n          moveplanesets[j].push(q);\n          break;\n        }\n      }\n    }\n    // make the normals all face the same way in each set.\n    for (let i = 0; i < moveplanesets.length; i++) {\n      const q: Quat[] = moveplanesets[i].map((_) => _.normalizeplane());\n      const goodnormal = moveplanenormals[i];\n      for (let j = 0; j < q.length; j++) {\n        if (q[j].makenormal().dist(goodnormal) > eps) {\n          q[j] = q[j].smul(-1);\n        }\n      }\n      q.sort((a, b) => a.a - b.a);\n      moveplanesets[i] = q;\n    }\n    this.moveplanesets = moveplanesets;\n    this.moveplanenormals = moveplanenormals;\n    const sizes = moveplanesets.map((_) => _.length);\n    if (this.verbose) {\n      console.log(\"# Move plane sets: \" + sizes);\n    }\n    // for each of the move planes, find the rotations that are relevant\n    const moverotations: Quat[][] = [];\n    for (let i = 0; i < moveplanesets.length; i++) {\n      moverotations.push([]);\n    }\n    for (let i = 0; i < this.rotations.length; i++) {\n      const q: Quat = this.rotations[i];\n      if (Math.abs(Math.abs(q.a) - 1) < eps) {\n        continue;\n      }\n      const qnormal = q.makenormal();\n      for (let j = 0; j < moveplanesets.length; j++) {\n        if (qnormal.sameplane(moveplanenormals[j])) {\n          moverotations[j].push(q);\n          break;\n        }\n      }\n    }\n    this.moverotations = moverotations;\n    //  Sort the rotations by the angle of rotation.  A bit tricky because\n    //  while the norms should be the same, they need not be.  So we start\n    //  by making the norms the same, and then sorting.\n    for (let i = 0; i < moverotations.length; i++) {\n      const r = moverotations[i];\n      const goodnormal = r[0].makenormal();\n      for (let j = 0; j < r.length; j++) {\n        if (goodnormal.dist(r[j].makenormal()) > eps) {\n          r[j] = r[j].smul(-1);\n        }\n      }\n      r.sort((a, b) => a.angle() - b.angle());\n      if (moverotations[i][0].dot(moveplanenormals[i]) < 0) {\n        r.reverse();\n      }\n    }\n    const sizes2 = moverotations.map((_) => 1 + _.length);\n    this.movesetorders = sizes2;\n    const movesetgeos = [];\n    let gtype = \"?\";\n    for (let i = 0; i < moveplanesets.length; i++) {\n      const p0 = moveplanenormals[i];\n      let neg = null;\n      let pos = null;\n      for (let j = 0; j < this.geonormals.length; j++) {\n        const d = p0.dot(this.geonormals[j][0]);\n        if (Math.abs(d - 1) < eps) {\n          pos = [this.geonormals[j][1], this.geonormals[j][2]];\n          gtype = this.geonormals[j][2];\n        } else if (Math.abs(d + 1) < eps) {\n          neg = [this.geonormals[j][1], this.geonormals[j][2]];\n          gtype = this.geonormals[j][2];\n        }\n      }\n      if (pos === null || neg === null) {\n        throw new Error(\"Saw positive or negative sides as null\");\n      }\n      movesetgeos.push([\n        pos[0],\n        pos[1],\n        neg[0],\n        neg[1],\n        1 + moveplanesets[i].length,\n      ]);\n      if (this.addNotationMapper === \"NxNxNCubeMapper\" && gtype === \"f\") {\n        this.notationMapper = new NxNxNCubeMapper(1 + moveplanesets[i].length);\n        this.addNotationMapper = \"\";\n      }\n      if (this.addNotationMapper === \"Megaminx\" && gtype === \"f\") {\n        if (1 + moveplanesets[i].length === 3) {\n          this.notationMapper = new MegaminxScramblingNotationMapper(\n            this.notationMapper,\n          );\n        }\n        this.addNotationMapper = \"\";\n      }\n    }\n    this.movesetgeos = movesetgeos;\n    //  Cubies are split by move plane sets.  For each cubie we can\n    //  average its points to find a point on the interior of that\n    //  cubie.  We can then check that point against all the move\n    //  planes and from that derive a coordinate for the cubie.\n    //  This also works for faces; no face should ever lie on a move\n    //  plane.  This allows us to take a set of stickers and break\n    //  them up into cubie sets.\n    const cubiehash: any = {};\n    const facelisthash: any = {};\n    const cubiekey: any = {};\n    const cubiekeys = [];\n    const cubies: Quat[][][] = [];\n    const faces = this.faces;\n    for (let i = 0; i < faces.length; i++) {\n      const face = faces[i];\n      const s = this.keyface(face);\n      if (!cubiehash[s]) {\n        cubiekey[s] = cubies.length;\n        cubiekeys.push(s);\n        cubiehash[s] = [];\n        facelisthash[s] = [];\n        cubies.push(cubiehash[s]);\n      }\n      facelisthash[s].push(i);\n      cubiehash[s].push(face);\n      //  If we find a core cubie, split it up into multiple cubies,\n      //  because ksolve doesn't handle orientations that are not\n      //  cyclic, and the rotation group of the core is not cyclic.\n      if (facelisthash[s].length === this.basefacecount) {\n        if (this.verbose) {\n          console.log(\"# Splitting core.\");\n        }\n        for (let suff = 0; suff < this.basefacecount; suff++) {\n          const s2 = s + \" \" + suff;\n          facelisthash[s2] = [facelisthash[s][suff]];\n          cubiehash[s2] = [cubiehash[s][suff]];\n          cubiekeys.push(s2);\n          cubiekey[s2] = cubies.length;\n          cubies.push(cubiehash[s2]);\n        }\n        cubiehash[s] = [];\n        cubies[cubiekey[s]] = [];\n      }\n    }\n    this.cubiekey = cubiekey;\n    this.facelisthash = facelisthash;\n    this.cubiekeys = cubiekeys;\n    if (this.verbose) {\n      console.log(\"# Cubies: \" + Object.keys(cubiehash).length);\n    }\n    //  Sort the faces around each corner so they are clockwise.  Only\n    //  relevant for cubies that actually are corners (three or more\n    //  faces).  In general cubies might have many faces; for icosohedrons\n    //  there are five faces on the corner cubies.\n    this.cubies = cubies;\n    for (let k = 0; k < cubies.length; k++) {\n      const cubie = cubies[k];\n      if (cubie.length < 2) {\n        continue;\n      }\n      if (cubie.length === this.basefacecount) {\n        // looks like core?  don't sort\n        continue;\n      }\n      if (cubie.length > 5) {\n        throw new Error(\n          \"Bad math; too many faces on this cubie \" + cubie.length,\n        );\n      }\n      const s = this.keyface(cubie[0]);\n      const facelist = facelisthash[s];\n      const cm = cubie.map((_) => centermassface(_));\n      const cmall = centermassface(cm);\n      for (let looplimit = 0; cubie.length > 2; looplimit++) {\n        let changed = false;\n        for (let i = 0; i < cubie.length; i++) {\n          const j = (i + 1) % cubie.length;\n          // var ttt = cmall.dot(cm[i].cross(cm[j])) ; // TODO\n          if (cmall.dot(cm[i].cross(cm[j])) < 0) {\n            const t = cubie[i];\n            cubie[i] = cubie[j];\n            cubie[j] = t;\n            const u = cm[i];\n            cm[i] = cm[j];\n            cm[j] = u;\n            const v = facelist[i];\n            facelist[i] = facelist[j];\n            facelist[j] = v;\n            changed = true;\n          }\n        }\n        if (!changed) {\n          break;\n        }\n        if (looplimit > 1000) {\n          throw new Error(\"Bad epsilon math; too close to border\");\n        }\n      }\n      let mini = 0;\n      let minf = this.findface(cubie[mini]);\n      for (let i = 1; i < cubie.length; i++) {\n        const temp = this.findface(cubie[i]);\n        if (\n          this.faceprecedence[this.getfaceindex(temp)] <\n          this.faceprecedence[this.getfaceindex(minf)]\n        ) {\n          mini = i;\n          minf = temp;\n        }\n      }\n      if (mini !== 0) {\n        const ocubie = cubie.slice();\n        const ofacelist = facelist.slice();\n        for (let i = 0; i < cubie.length; i++) {\n          cubie[i] = ocubie[(mini + i) % cubie.length];\n          facelist[i] = ofacelist[(mini + i) % cubie.length];\n        }\n      }\n    }\n    //  Build an array that takes each face to a cubie ordinal and a\n    //  face number.\n    const facetocubies = [];\n    for (let i = 0; i < cubies.length; i++) {\n      const facelist = facelisthash[cubiekeys[i]];\n      for (let j = 0; j < facelist.length; j++) {\n        facetocubies[facelist[j]] = [i, j];\n      }\n    }\n    this.facetocubies = facetocubies;\n    //  Calculate the orbits of each cubie.  Assumes we do all moves.\n    //  Also calculates which cubies are identical.\n    const typenames = [\"?\", \"CENTERS\", \"EDGES\", \"CORNERS\", \"C4RNER\", \"C5RNER\"];\n    const cubiesetnames = [];\n    const cubietypecounts = [0, 0, 0, 0, 0, 0];\n    const orbitoris = [];\n    const seen = [];\n    let cubiesetnum = 0;\n    const cubiesetnums = [];\n    const cubieordnums = [];\n    const cubieords = [];\n    // var cubiesetnumhash = {} ; // TODO\n    const cubievaluemap = [];\n    // Later we will make this smarter to use a get color for face function\n    // so we support puzzles with multiple faces the same color\n    const getcolorkey = (cubienum: number): string => {\n      return cubies[cubienum]\n        .map((_) => this.getfaceindex(this.findface(_)))\n        .join(\" \");\n    };\n    const cubiesetcubies: any = [];\n    for (let i = 0; i < cubies.length; i++) {\n      if (seen[i]) {\n        continue;\n      }\n      const cubie = cubies[i];\n      if (cubie.length === 0) {\n        continue;\n      }\n      const cubiekeymap: any = {};\n      let cubievalueid = 0;\n      cubieords.push(0);\n      cubiesetcubies.push([]);\n      const facecnt = cubie.length;\n      const typectr = cubietypecounts[facecnt]++;\n      let typename = typenames[facecnt];\n      if (typename === undefined || facecnt === this.basefacecount) {\n        typename = \"CORE\";\n      }\n      typename = typename + (typectr === 0 ? \"\" : typectr + 1);\n      cubiesetnames[cubiesetnum] = typename;\n      orbitoris[cubiesetnum] = facecnt;\n      const queue = [i];\n      let qg = 0;\n      seen[i] = true;\n      while (qg < queue.length) {\n        const cind = queue[qg++];\n        const cubiecolorkey = getcolorkey(cind);\n        if (cubie.length > 1 || cubiekeymap[cubiecolorkey] === undefined) {\n          cubiekeymap[cubiecolorkey] = cubievalueid++;\n        }\n        cubievaluemap[cind] = cubiekeymap[cubiecolorkey];\n        cubiesetnums[cind] = cubiesetnum;\n        cubiesetcubies[cubiesetnum].push(cind);\n        cubieordnums[cind] = cubieords[cubiesetnum]++;\n        for (let j = 0; j < moverotations.length; j++) {\n          const tq = this.findcubie(\n            moverotations[j][0].rotateface(cubies[cind][0]),\n          );\n          if (!seen[tq]) {\n            queue.push(tq);\n            seen[tq] = true;\n          }\n        }\n      }\n      cubiesetnum++;\n    }\n    this.orbits = cubieords.length;\n    this.cubiesetnums = cubiesetnums;\n    this.cubieordnums = cubieordnums;\n    this.cubiesetnames = cubiesetnames;\n    this.cubieords = cubieords;\n    this.orbitoris = orbitoris;\n    this.cubievaluemap = cubievaluemap;\n    this.cubiesetcubies = cubiesetcubies;\n    // if we fix a cubie, find a cubie to fix\n    if (this.fixPiece !== \"\") {\n      for (let i = 0; i < cubies.length; i++) {\n        if (\n          (this.fixPiece === \"v\" && cubies[i].length > 2) ||\n          (this.fixPiece === \"e\" && cubies[i].length === 2) ||\n          (this.fixPiece === \"f\" && cubies[i].length === 1)\n        ) {\n          this.fixedCubie = i;\n          break;\n        }\n      }\n      if (this.fixedCubie < 0) {\n        throw new Error(\n          \"Could not find a cubie of type \" + this.fixPiece + \" to fix.\",\n        );\n      }\n    }\n    // show the orbits\n    if (this.verbose) {\n      console.log(\"# Cubie orbit sizes \" + cubieords);\n    }\n  }\n\n  public unswizzle(mv: BlockMove): string {\n    const newmv = this.notationMapper.notationToInternal(mv);\n    return this.swizzler.unswizzle(newmv.family);\n  }\n\n  // We use an extremely permissive parse here; any character but\n  // digits are allowed in a family name.\n  public stringToBlockMove(mv: string): BlockMove {\n    // parse a move from the command line\n    const re = RegExp(\"^(([0-9]+)-)?([0-9]+)?([^0-9]+)([0-9]+'?)?$\");\n    const p = mv.match(re);\n    if (p === null) {\n      throw new Error(\"Bad move passed \" + mv);\n    }\n    const grip = p[4];\n    let loslice = undefined;\n    let hislice = undefined;\n    if (p[2] !== undefined) {\n      if (p[3] === undefined) {\n        throw new Error(\"Missing second number in range\");\n      }\n      loslice = parseInt(p[2], 10);\n    }\n    if (p[3] !== undefined) {\n      hislice = parseInt(p[3], 10);\n    }\n    let amountstr = \"1\";\n    let amount = 1;\n    if (p[5] !== undefined) {\n      amountstr = p[5];\n      if (amountstr[0] === \"'\") {\n        amountstr = \"-\" + amountstr.substring(1);\n      }\n      amount = parseInt(amountstr, 10);\n    }\n    return new BlockMove(loslice, hislice, grip, amount);\n  }\n\n  public parseBlockMove(blockmove: BlockMove): any {\n    blockmove = this.notationMapper.notationToInternal(blockmove); // pluggable notation\n    let grip = blockmove.family;\n    let fullrotation = false;\n    if (grip.endsWith(\"v\") && grip[0] <= \"Z\") {\n      if (\n        blockmove.innerLayer !== undefined ||\n        blockmove.outerLayer !== undefined\n      ) {\n        throw new Error(\"Cannot use a prefix with full cube rotations\");\n      }\n      grip = grip.slice(0, -1);\n      fullrotation = true;\n    }\n    if (grip.endsWith(\"w\") && grip[0] <= \"Z\") {\n      grip = grip.slice(0, -1).toLowerCase();\n    }\n    let geo;\n    let msi = -1;\n    const geoname = this.swizzler.unswizzle(grip);\n    let firstgrip = false;\n    for (let i = 0; i < this.movesetgeos.length; i++) {\n      const g = this.movesetgeos[i];\n      if (geoname === g[0]) {\n        firstgrip = true;\n        geo = g;\n        msi = i;\n      }\n      if (geoname === g[2]) {\n        firstgrip = false;\n        geo = g;\n        msi = i;\n      }\n    }\n    let loslice = 1;\n    let hislice = 1;\n    if (grip.toUpperCase() !== grip) {\n      hislice = 2;\n    }\n    if (geo === undefined) {\n      throw new Error(\"Bad grip in move \" + blockmove.family);\n    }\n    if (blockmove.outerLayer !== undefined) {\n      loslice = blockmove.outerLayer;\n    }\n    if (blockmove.innerLayer !== undefined) {\n      if (blockmove.outerLayer === undefined) {\n        hislice = blockmove.innerLayer;\n        if (geoname === grip) {\n          loslice = hislice;\n        } else {\n          loslice = 1;\n        }\n      } else {\n        hislice = blockmove.innerLayer;\n      }\n    }\n    loslice--;\n    hislice--;\n    if (fullrotation) {\n      loslice = 0;\n      hislice = this.moveplanesets[msi].length;\n    }\n    if (\n      loslice < 0 ||\n      loslice > this.moveplanesets[msi].length ||\n      hislice < 0 ||\n      hislice > this.moveplanesets[msi].length\n    ) {\n      throw new Error(\"Bad slice spec \" + loslice + \" \" + hislice);\n    }\n    if (\n      !permissivieMoveParsing &&\n      loslice === 0 &&\n      hislice === this.moveplanesets[msi].length &&\n      !fullrotation\n    ) {\n      throw new Error(\n        \"! full puzzle rotations must be specified with v suffix.\",\n      );\n    }\n    const r = [undefined, msi, loslice, hislice, firstgrip, blockmove.amount];\n    return r;\n  }\n\n  public parsemove(mv: string): any {\n    const r = this.parseBlockMove(this.stringToBlockMove(mv));\n    r[0] = mv;\n    return r;\n  }\n\n  public genperms(): void {\n    // generate permutations for moves\n    if (this.cmovesbyslice.length > 0) {\n      // did this already?\n      return;\n    }\n    const cmovesbyslice = [];\n    // if orientCenters is set, we find all cubies that have only one\n    // sticker and that sticker is in the center of a face, and we\n    // introduce duplicate stickers so we can orient them properly.\n    if (this.orientCenters) {\n      for (let k = 0; k < this.cubies.length; k++) {\n        if (this.cubies[k].length === 1) {\n          const kk = this.findface(this.cubies[k][0]);\n          const i = this.getfaceindex(kk);\n          if (\n            centermassface(this.basefaces[i]).dist(\n              centermassface(this.faces[kk]),\n            ) < eps\n          ) {\n            const o = this.basefaces[i].length;\n            for (let m = 0; m < o; m++) {\n              this.cubies[k].push(this.cubies[k][0]);\n            }\n            this.duplicatedFaces[kk] = o;\n            this.duplicatedCubies[k] = o;\n            this.orbitoris[this.cubiesetnums[k]] = o;\n          }\n        }\n      }\n    }\n    for (let k = 0; k < this.moveplanesets.length; k++) {\n      const moveplaneset = this.moveplanesets[k];\n      const slicenum = [];\n      const slicecnts = [];\n      for (let i = 0; i < this.faces.length; i++) {\n        const face = this.faces[i];\n        let t = 0;\n        for (let j = 0; j < moveplaneset.length; j++) {\n          if (moveplaneset[j].faceside(face) < 0) {\n            t++;\n          }\n        }\n        slicenum.push(t);\n        while (slicecnts.length <= t) {\n          slicecnts.push(0);\n        }\n        slicecnts[t]++;\n      }\n      const axiscmoves = [];\n      for (let sc = 0; sc < slicecnts.length; sc++) {\n        const slicecmoves = [];\n        const cubiedone = [];\n        for (let i = 0; i < this.faces.length; i++) {\n          if (slicenum[i] !== sc) {\n            continue;\n          }\n          const b = this.facetocubies[i].slice();\n          let face = this.faces[i];\n          let fi2 = i;\n          for (;;) {\n            slicenum[fi2] = -1;\n            const face2 = this.moverotations[k][0].rotateface(face);\n            fi2 = this.findface(face2);\n            if (slicenum[fi2] < 0) {\n              break;\n            }\n            if (slicenum[fi2] !== sc) {\n              throw new Error(\"Bad movement?\");\n            }\n            const c = this.facetocubies[fi2];\n            b.push(c[0], c[1]);\n            face = face2;\n          }\n          // If an oriented center is moving, we need to figure out\n          // the appropriate new orientation.  Normally we use the cubie\n          // sticker identity to locate, but this doesn't work here.\n          // Instead we need to redo the geometry of the sticker itself\n          // rotating and figure out how that maps to the destination\n          // sticker.\n          //\n          // We only need to do this for central center stickers: those\n          // where the face vertex goes through the center.  The others\n          // don't actually need orientation because they can only be\n          // in one orientation by physical constraints.  (You can't spin\n          // a point or cross sticker on the 5x5x5, for example.)\n          //\n          // This also simplifies things because it means the actual\n          // remapping has the same order as the moves themselves.\n          //\n          // The center may or may not have been duplicated at this point.\n          //\n          // The move moving the center might not be the same modulo as the\n          // center itself.\n          if (\n            b.length > 2 &&\n            this.orientCenters &&\n            (this.cubies[b[0]].length === 1 ||\n              this.cubies[b[0]][0] === this.cubies[b[0]][1])\n          ) {\n            // is this a real center cubie, around an axis?\n            if (\n              centermassface(this.faces[i]).dist(\n                centermassface(this.basefaces[this.getfaceindex(i)]),\n              ) < eps\n            ) {\n              // how does remapping of the face/point set map to the original?\n              let face1 = this.cubies[b[0]][0];\n              for (let ii = 0; ii < b.length; ii += 2) {\n                const face0 = this.cubies[b[ii]][0];\n                let o = -1;\n                for (let jj = 0; jj < face1.length; jj++) {\n                  if (face0[jj].dist(face1[0]) < eps) {\n                    o = jj;\n                    break;\n                  }\n                }\n                if (o < 0) {\n                  throw new Error(\n                    \"Couldn't find rotation of center faces; ignoring for now.\",\n                  );\n                } else {\n                  b[ii + 1] = o;\n                  face1 = this.moverotations[k][0].rotateface(face1);\n                }\n              }\n            }\n          }\n          // b.length == 2 means a sticker is spinning in place.\n          // in this case we add duplicate stickers\n          // so that we can make it animate properly in a 3D world.\n          if (b.length === 2 && this.orientCenters) {\n            for (let ii = 1; ii < this.movesetorders[k]; ii++) {\n              if (sc === 0) {\n                b.push(b[0], ii);\n              } else {\n                b.push(\n                  b[0],\n                  (this.movesetorders[k] - ii) % this.movesetorders[k],\n                );\n              }\n            }\n          }\n          if (b.length > 2 && !cubiedone[b[0]]) {\n            if (b.length !== 2 * this.movesetorders[k]) {\n              throw new Error(\"Bad length in perm gen\");\n            }\n            for (let j = 0; j < b.length; j++) {\n              slicecmoves.push(b[j]);\n            }\n          }\n          for (let j = 0; j < b.length; j += 2) {\n            cubiedone[b[j]] = true;\n          }\n        }\n        axiscmoves.push(slicecmoves);\n      }\n      cmovesbyslice.push(axiscmoves);\n    }\n    this.cmovesbyslice = cmovesbyslice;\n    if (this.movelist !== undefined) {\n      const parsedmovelist: any[] = [];\n      // make sure the movelist makes sense based on the geos.\n      for (let i = 0; i < this.movelist.length; i++) {\n        parsedmovelist.push(this.parsemove(this.movelist[i]));\n      }\n      this.parsedmovelist = parsedmovelist;\n    }\n  }\n\n  public getfaces(): number[][][] {\n    // get the faces for 3d.\n    return this.faces.map((_) => {\n      return _.map((__) => [__.b, __.c, __.d]);\n    });\n  }\n\n  public getboundarygeometry(): any {\n    // get the boundary geometry\n    return {\n      baseplanes: this.baseplanes,\n      facenames: this.facenames,\n      faceplanes: this.faceplanes,\n      vertexnames: this.vertexnames,\n      edgenames: this.edgenames,\n      geonormals: this.geonormals,\n    };\n  }\n\n  public getmovesets(k: number): any {\n    // get the move sets we support based on slices\n    // for even values we omit the middle \"slice\".  This isn't perfect\n    // but it is what we do for now.\n    // if there was a move list specified, pull values from that\n    const slices = this.moveplanesets[k].length;\n    if (slices > 30) {\n      throw new Error(\"Too many slices for getmovesets bitmasks\");\n    }\n    let r = [];\n    if (this.parsedmovelist !== undefined) {\n      for (let i = 0; i < this.parsedmovelist.length; i++) {\n        const parsedmove = this.parsedmovelist[i];\n        if (parsedmove[1] !== k) {\n          continue;\n        }\n        if (parsedmove[4]) {\n          r.push((2 << parsedmove[3]) - (1 << parsedmove[2]));\n        } else {\n          r.push(\n            (2 << (slices - parsedmove[2])) - (1 << (slices - parsedmove[3])),\n          );\n        }\n        r.push(parsedmove[5]);\n      }\n    } else if (this.vertexmoves && !this.allmoves) {\n      const msg = this.movesetgeos[k];\n      if (msg[1] !== msg[3]) {\n        for (let i = 0; i < slices; i++) {\n          if (msg[1] !== \"v\") {\n            if (this.outerblockmoves) {\n              r.push((2 << slices) - (2 << i));\n            } else {\n              r.push(2 << i);\n            }\n            r.push(1);\n          } else {\n            if (this.outerblockmoves) {\n              r.push((2 << i) - 1);\n            } else {\n              r.push(1 << i);\n            }\n            r.push(1);\n          }\n        }\n      }\n    } else {\n      for (let i = 0; i <= slices; i++) {\n        if (!this.allmoves && i + i === slices) {\n          continue;\n        }\n        if (this.outerblockmoves) {\n          if (i + i > slices) {\n            r.push((2 << slices) - (1 << i));\n          } else {\n            r.push((2 << i) - 1);\n          }\n        } else {\n          r.push(1 << i);\n        }\n        r.push(1);\n      }\n    }\n    if (this.fixedCubie >= 0) {\n      const dep = 1 << +this.cubiekeys[this.fixedCubie].trim().split(\" \")[k];\n      const newr = [];\n      for (let i = 0; i < r.length; i += 2) {\n        let o = r[i];\n        if (o & dep) {\n          o = (2 << slices) - 1 - o;\n        }\n        let found = false;\n        for (let j = 0; j < newr.length; j += 2) {\n          if (newr[j] === o && newr[j + 1] === r[i + 1]) {\n            found = true;\n            break;\n          }\n        }\n        if (!found) {\n          newr.push(o);\n          newr.push(r[i + 1]);\n        }\n      }\n      r = newr;\n    }\n    return r;\n  }\n\n  public graybyori(cubie: number): boolean {\n    let ori = this.cubies[cubie].length;\n    if (this.duplicatedCubies[cubie]) {\n      ori = 1;\n    }\n    return (\n      (ori === 1 && (this.graycenters || !this.centersets)) ||\n      (ori === 2 && (this.grayedges || !this.edgesets)) ||\n      (ori > 2 && (this.graycorners || !this.cornersets))\n    );\n  }\n\n  public skipbyori(cubie: number): boolean {\n    let ori = this.cubies[cubie].length;\n    if (this.duplicatedCubies[cubie]) {\n      ori = 1;\n    }\n    return (\n      (ori === 1 && !this.centersets) ||\n      (ori === 2 && !this.edgesets) ||\n      (ori > 2 && !this.cornersets)\n    );\n  }\n\n  public skipcubie(fi: number): boolean {\n    return this.skipbyori(fi);\n  }\n\n  public skipset(set: number[]): boolean {\n    if (set.length === 0) {\n      return true;\n    }\n    const fi = set[0];\n    return this.skipbyori(this.facetocubies[fi][0]);\n  }\n\n  public header(comment: string): string {\n    return comment + copyright + \"\\n\" + comment + this.args + \"\\n\";\n  }\n\n  public writegap(): string {\n    // write out a gap set of generators\n    const os = this.getOrbitsDef(false);\n    const r = [];\n    const mvs = [];\n    for (let i = 0; i < os.moveops.length; i++) {\n      const movename = \"M_\" + os.movenames[i];\n      // gap doesn't like angle brackets in IDs\n      mvs.push(movename);\n      r.push(movename + \":=\" + os.moveops[i].toPerm().toGap() + \";\");\n    }\n    r.push(\"Gen:=[\");\n    r.push(mvs.join(\",\"));\n    r.push(\"];\");\n    const ip = os.solved.identicalPieces();\n    r.push(\n      \"ip:=[\" +\n        ip.map((_) => \"[\" + _.map((__) => __ + 1).join(\",\") + \"]\").join(\",\") +\n        \"];\",\n    );\n    r.push(\"\");\n    return this.header(\"# \") + r.join(\"\\n\");\n  }\n\n  public writeksolve(\n    name: string = \"PuzzleGeometryPuzzle\",\n    fortwisty: boolean = false,\n  ): string {\n    const od = this.getOrbitsDef(fortwisty);\n    if (fortwisty) {\n      return od.toKsolve(name, fortwisty).join(\"\\n\");\n    } else {\n      return this.header(\"# \") + od.toKsolve(name, fortwisty).join(\"\\n\");\n    }\n  }\n\n  public writekpuzzle(fortwisty: boolean = true): any {\n    const od = this.getOrbitsDef(fortwisty);\n    const r = od.toKpuzzle() as KPuzzleDefinition;\n    r.moveNotation = new PGNotation(this, od);\n    return r;\n  }\n\n  public getMoveFromBits(\n    movebits: number,\n    amount: number,\n    inverted: boolean,\n    axiscmoves: number[][],\n    setmoves: number[] | undefined,\n    movesetorder: number,\n  ): Transformation {\n    const moveorbits: Orbit[] = [];\n    const perms = [];\n    const oris = [];\n    for (let ii = 0; ii < this.cubiesetnames.length; ii++) {\n      perms.push(iota(this.cubieords[ii]));\n      oris.push(zeros(this.cubieords[ii]));\n    }\n    for (let m = 0; m < axiscmoves.length; m++) {\n      if (((movebits >> m) & 1) === 0) {\n        continue;\n      }\n      const slicecmoves = axiscmoves[m];\n      for (let j = 0; j < slicecmoves.length; j += 2 * movesetorder) {\n        const mperm = slicecmoves.slice(j, j + 2 * movesetorder);\n        const setnum = this.cubiesetnums[mperm[0]];\n        for (let ii = 0; ii < mperm.length; ii += 2) {\n          mperm[ii] = this.cubieordnums[mperm[ii]];\n        }\n        let inc = 2;\n        let oinc = 3;\n        if (inverted) {\n          inc = mperm.length - 2;\n          oinc = mperm.length - 1;\n        }\n        if (perms[setnum] === iota(this.cubieords[setnum])) {\n          perms[setnum] = perms[setnum].slice();\n          if (this.orbitoris[setnum] > 1 && !this.killorientation) {\n            oris[setnum] = oris[setnum].slice();\n          }\n        }\n        for (let ii = 0; ii < mperm.length; ii += 2) {\n          perms[setnum][mperm[(ii + inc) % mperm.length]] = mperm[ii];\n          if (this.orbitoris[setnum] > 1 && !this.killorientation) {\n            oris[setnum][mperm[ii]] =\n              (mperm[(ii + oinc) % mperm.length] -\n                mperm[(ii + 1) % mperm.length] +\n                2 * this.orbitoris[setnum]) %\n              this.orbitoris[setnum];\n          }\n        }\n      }\n    }\n    for (let ii = 0; ii < this.cubiesetnames.length; ii++) {\n      if (setmoves && !setmoves[ii]) {\n        continue;\n      }\n      if (this.orbitoris[ii] === 1 || this.killorientation) {\n        moveorbits.push(new Orbit(perms[ii], oris[ii], 1));\n      } else {\n        const no = new Array<number>(oris[ii].length);\n        // convert ksolve oris to our internal ori rep\n        for (let jj = 0; jj < perms[ii].length; jj++) {\n          no[jj] = oris[ii][perms[ii][jj]];\n        }\n        moveorbits.push(new Orbit(perms[ii], no, this.orbitoris[ii]));\n      }\n    }\n    let mv = new Transformation(moveorbits);\n    if (amount !== 1) {\n      mv = mv.mulScalar(amount);\n    }\n    return mv;\n  }\n\n  public getOrbitsDef(fortwisty: boolean): OrbitsDef {\n    // generate a representation of the puzzle\n    const setmoves = [];\n    const setnames: string[] = [];\n    const setdefs: OrbitDef[] = [];\n    for (let k = 0; k < this.moveplanesets.length; k++) {\n      const moveset = this.getmovesets(k);\n      const movesetorder = this.movesetorders[k];\n      // check there's no redundancy in moveset.\n      for (let i = 0; i < moveset.length; i += 2) {\n        for (let j = 0; j < i; j += 2) {\n          if (moveset[i] === moveset[j] && moveset[i + 1] === moveset[j + 1]) {\n            throw new Error(\"Redundant moves in moveset.\");\n          }\n        }\n      }\n      let allbits = 0;\n      for (let i = 0; i < moveset.length; i += 2) {\n        allbits |= moveset[i];\n      }\n      const axiscmoves = this.cmovesbyslice[k];\n      for (let i = 0; i < axiscmoves.length; i++) {\n        if (((allbits >> i) & 1) === 0) {\n          continue;\n        }\n        const slicecmoves = axiscmoves[i];\n        for (let j = 0; j < slicecmoves.length; j += 2 * movesetorder) {\n          if (this.skipcubie(slicecmoves[j])) {\n            continue;\n          }\n          const ind = this.cubiesetnums[slicecmoves[j]];\n          setmoves[ind] = 1;\n        }\n      }\n    }\n    for (let i = 0; i < this.cubiesetnames.length; i++) {\n      if (!setmoves[i]) {\n        continue;\n      }\n      setnames.push(this.cubiesetnames[i]);\n      setdefs.push(\n        new OrbitDef(\n          this.cubieords[i],\n          this.killorientation ? 1 : this.orbitoris[i],\n        ),\n      );\n    }\n    const solved: Orbit[] = [];\n    for (let i = 0; i < this.cubiesetnames.length; i++) {\n      if (!setmoves[i]) {\n        continue;\n      }\n      const p = [];\n      const o = [];\n      for (let j = 0; j < this.cubieords[i]; j++) {\n        if (fortwisty) {\n          p.push(j);\n        } else {\n          const cubie = this.cubiesetcubies[i][j];\n          p.push(this.cubievaluemap[cubie]);\n        }\n        o.push(0);\n      }\n      solved.push(\n        new Orbit(p, o, this.killorientation ? 1 : this.orbitoris[i]),\n      );\n    }\n    const movenames: string[] = [];\n    const moves: Transformation[] = [];\n    for (let k = 0; k < this.moveplanesets.length; k++) {\n      const moveplaneset = this.moveplanesets[k];\n      const slices = moveplaneset.length;\n      const moveset = this.getmovesets(k);\n      const movesetgeo = this.movesetgeos[k];\n      for (let i = 0; i < moveset.length; i += 2) {\n        const movebits = moveset[i];\n        const mna = getmovename(movesetgeo, movebits, slices);\n        const movename = mna[0];\n        const inverted = mna[1];\n        if (moveset[i + 1] === 1) {\n          movenames.push(movename);\n        } else {\n          movenames.push(movename + moveset[i + 1]);\n        }\n        const mv = this.getMoveFromBits(\n          movebits,\n          moveset[i + 1],\n          inverted,\n          this.cmovesbyslice[k],\n          setmoves,\n          this.movesetorders[k],\n        );\n        moves.push(mv);\n      }\n    }\n    this.ksolvemovenames = movenames; // hack!\n    let r = new OrbitsDef(\n      setnames,\n      setdefs,\n      new VisibleState(solved),\n      movenames,\n      moves,\n    );\n    if (this.optimize) {\n      r = r.optimize();\n    }\n    if (this.scramble !== 0) {\n      r.scramble(this.scramble);\n    }\n    return r;\n  }\n\n  public getMovesAsPerms(): Perm[] {\n    return this.getOrbitsDef(false).moveops.map((_: Transformation) =>\n      _.toPerm(),\n    );\n  }\n\n  public showcanon(disp: (s: string) => void): void {\n    // show information for canonical move derivation\n    showcanon(this.getOrbitsDef(false), disp);\n  }\n\n  public getsolved(): Perm {\n    // get a solved position\n    const r = [];\n    for (let i = 0; i < this.basefacecount; i++) {\n      for (let j = 0; j < this.stickersperface; j++) {\n        r.push(i);\n      }\n    }\n    return new Perm(r);\n  }\n\n  // Given a rotation description that says to align feature1\n  // with a given vector, and then as much as possible feature2\n  // with another given vector, return a Quaternion that\n  // performs this rotation.\n  public getOrientationRotation(desiredRotation: any[]): Quat {\n    const feature1name = desiredRotation[0];\n    const direction1 = new Quat(\n      0,\n      desiredRotation[1][0],\n      -desiredRotation[1][1],\n      desiredRotation[1][2],\n    );\n    const feature2name = desiredRotation[2];\n    const direction2 = new Quat(\n      0,\n      desiredRotation[3][0],\n      -desiredRotation[3][1],\n      desiredRotation[3][2],\n    );\n    let feature1: Quat | null = null;\n    let feature2: Quat | null = null;\n    const feature1geoname = this.swizzler.unswizzle(feature1name);\n    const feature2geoname = this.swizzler.unswizzle(feature2name);\n    for (const gn of this.geonormals) {\n      if (feature1geoname === gn[1]) {\n        feature1 = gn[0];\n      }\n      if (feature2geoname === gn[1]) {\n        feature2 = gn[0];\n      }\n    }\n    if (!feature1) {\n      throw new Error(\"Could not find feature \" + feature1name);\n    }\n    if (!feature2) {\n      throw new Error(\"Could not find feature \" + feature2name);\n    }\n    const r1 = feature1.pointrotation(direction1);\n    const feature2rot = feature2.rotatepoint(r1);\n    const r2 = feature2rot\n      .unproject(direction1)\n      .pointrotation(direction2.unproject(direction1));\n    return r2.mul(r1);\n  }\n\n  public getInitial3DRotation(): Quat {\n    const basefacecount = this.basefacecount;\n    let rotDesc: any = null;\n    if (this.puzzleOrientation) {\n      rotDesc = this.puzzleOrientation;\n    } else if (this.puzzleOrientations) {\n      rotDesc = this.puzzleOrientations[basefacecount];\n    }\n    // either no option specified or no matching key in\n    // puzzleOrientations.\n    if (!rotDesc) {\n      rotDesc = defaultOrientations()[basefacecount];\n    }\n    if (!rotDesc) {\n      throw new Error(\"No default orientation?\");\n    }\n    return this.getOrientationRotation(rotDesc);\n  }\n\n  public generatesvg(\n    w: number = 800,\n    h: number = 500,\n    trim: number = 10,\n    threed: boolean = false,\n  ): string {\n    // generate svg to interoperate with Lucas twistysim\n    w -= 2 * trim;\n    h -= 2 * trim;\n    function extendedges(a: number[][], n: number): void {\n      let dx = a[1][0] - a[0][0];\n      let dy = a[1][1] - a[0][1];\n      const ang = (2 * Math.PI) / n;\n      const cosa = Math.cos(ang);\n      const sina = Math.sin(ang);\n      for (let i = 2; i < n; i++) {\n        const ndx = dx * cosa + dy * sina;\n        dy = dy * cosa - dx * sina;\n        dx = ndx;\n        a.push([a[i - 1][0] + dx, a[i - 1][1] + dy]);\n      }\n    }\n    // if we don't add this noise to coordinate values, then Safari\n    // doesn't render our polygons correctly.  What a hack.\n    function noise(c: number): number {\n      return c + 0 * (Math.random() - 0.5);\n    }\n    function drawedges(id: string, pts: number[][], color: string): string {\n      return (\n        '<polygon id=\"' +\n        id +\n        '\" class=\"sticker\" style=\"fill: ' +\n        color +\n        '\" points=\"' +\n        pts.map((p) => noise(p[0]) + \" \" + noise(p[1])).join(\" \") +\n        '\"/>\\n'\n      );\n    }\n    // What grips do we need?  if rotations, add all grips.\n    let needvertexgrips = this.addrotations;\n    let neededgegrips = this.addrotations;\n    let needfacegrips = this.addrotations;\n    for (let i = 0; i < this.movesetgeos.length; i++) {\n      const msg = this.movesetgeos[i];\n      for (let j = 1; j <= 3; j += 2) {\n        if (msg[j] === \"v\") {\n          needvertexgrips = true;\n        }\n        if (msg[j] === \"f\") {\n          needfacegrips = true;\n        }\n        if (msg[j] === \"e\") {\n          neededgegrips = true;\n        }\n      }\n    }\n    // Find a net from a given face count.  Walk it, assuming we locate\n    // the first edge from (0,0) to (1,1) and compute the minimum and\n    // maximum vertex locations from this.  Then do a second walk, and\n    // assign the actual geometry.\n    this.genperms();\n    const boundarygeo = this.getboundarygeometry();\n    const face0 = boundarygeo.facenames[0][0];\n    const polyn = face0.length; // number of vertices; 3, 4, or 5\n    const net = this.net;\n    if (net === null) {\n      throw new Error(\"No net?\");\n    }\n    const edges: any = {};\n    let minx = 0;\n    let miny = 0;\n    let maxx = 1;\n    let maxy = 0;\n    edges[net[0][0]] = [\n      [1, 0],\n      [0, 0],\n    ];\n    extendedges(edges[net[0][0]], polyn);\n    for (let i = 0; i < net.length; i++) {\n      const f0 = net[i][0];\n      if (!edges[f0]) {\n        throw new Error(\"Bad edge description; first edge not connected.\");\n      }\n      for (let j = 1; j < net[i].length; j++) {\n        const f1 = net[i][j];\n        if (f1 === \"\" || edges[f1]) {\n          continue;\n        }\n        edges[f1] = [edges[f0][j % polyn], edges[f0][(j + polyn - 1) % polyn]];\n        extendedges(edges[f1], polyn);\n      }\n    }\n    for (const f in edges) {\n      const es = edges[f];\n      for (let i = 0; i < es.length; i++) {\n        minx = Math.min(minx, es[i][0]);\n        maxx = Math.max(maxx, es[i][0]);\n        miny = Math.min(miny, es[i][1]);\n        maxy = Math.max(maxy, es[i][1]);\n      }\n    }\n    const sc = Math.min(w / (maxx - minx), h / (maxy - miny));\n    const xoff = 0.5 * (w - sc * (maxx + minx));\n    const yoff = 0.5 * (h - sc * (maxy + miny));\n    const geos: any = {};\n    const bg = this.getboundarygeometry();\n    const edges2: any = {};\n    const initv = [\n      [sc + xoff, yoff],\n      [xoff, yoff],\n    ];\n    edges2[net[0][0]] = initv;\n    extendedges(edges2[net[0][0]], polyn);\n    geos[this.facenames[0][1]] = this.project2d(0, 0, [\n      new Quat(0, initv[0][0], initv[0][1], 0),\n      new Quat(0, initv[1][0], initv[1][1], 0),\n    ]);\n    const connectat = [];\n    connectat[0] = 0;\n    for (let i = 0; i < net.length; i++) {\n      const f0 = net[i][0];\n      if (!edges2[f0]) {\n        throw new Error(\"Bad edge description; first edge not connected.\");\n      }\n      let gfi = -1;\n      for (let j = 0; j < bg.facenames.length; j++) {\n        if (f0 === bg.facenames[j][1]) {\n          gfi = j;\n          break;\n        }\n      }\n      if (gfi < 0) {\n        throw new Error(\"Could not find first face name \" + f0);\n      }\n      const thisface = bg.facenames[gfi][0];\n      for (let j = 1; j < net[i].length; j++) {\n        const f1 = net[i][j];\n        if (f1 === \"\" || edges2[f1]) {\n          continue;\n        }\n        edges2[f1] = [\n          edges2[f0][j % polyn],\n          edges2[f0][(j + polyn - 1) % polyn],\n        ];\n        extendedges(edges2[f1], polyn);\n        // what edge are we at?\n        const caf0 = connectat[gfi];\n        const mp = thisface[(caf0 + j) % polyn]\n          .sum(thisface[(caf0 + j + polyn - 1) % polyn])\n          .smul(0.5);\n        const epi = findelement(bg.edgenames, mp);\n        const edgename = bg.edgenames[epi][1];\n        const el = splitByFaceNames(edgename, this.facenames);\n        const gf1 = el[f0 === el[0] ? 1 : 0];\n        let gf1i = -1;\n        for (let k = 0; k < bg.facenames.length; k++) {\n          if (gf1 === bg.facenames[k][1]) {\n            gf1i = k;\n            break;\n          }\n        }\n        if (gf1i < 0) {\n          throw new Error(\"Could not find second face name\");\n        }\n        const otherface = bg.facenames[gf1i][0];\n        for (let k = 0; k < otherface.length; k++) {\n          const mp2 = otherface[k].sum(otherface[(k + 1) % polyn]).smul(0.5);\n          if (mp2.dist(mp) <= eps) {\n            const p1 = edges2[f0][(j + polyn - 1) % polyn];\n            const p2 = edges2[f0][j % polyn];\n            connectat[gf1i] = k;\n            geos[gf1] = this.project2d(gf1i, k, [\n              new Quat(0, p2[0], p2[1], 0),\n              new Quat(0, p1[0], p1[1], 0),\n            ]);\n            break;\n          }\n        }\n      }\n    }\n    // Let's build arrays for faster rendering.  We want to map from geo\n    // base face number to color, and we want to map from geo face number\n    // to 2D geometry.  These can be reused as long as the puzzle overall\n    // orientation and canvas size remains unchanged.\n    const pos = this.getsolved();\n    const colormap = [];\n    const facegeo = [];\n    for (let i = 0; i < this.basefacecount; i++) {\n      colormap[i] = this.colors[this.facenames[i][1]];\n    }\n    let hix = 0;\n    let hiy = 0;\n    const rot = this.getInitial3DRotation();\n    for (let i = 0; i < this.faces.length; i++) {\n      let face = this.faces[i];\n      face = rot.rotateface(face);\n      for (let j = 0; j < face.length; j++) {\n        hix = Math.max(hix, Math.abs(face[j].b));\n        hiy = Math.max(hiy, Math.abs(face[j].c));\n      }\n    }\n    const sc2 = Math.min(h / hiy / 2, (w - trim) / hix / 4);\n    const mappt2d = (fn: number, q: Quat): number[] => {\n      if (threed) {\n        const xoff2 = 0.5 * trim + 0.25 * w;\n        const xmul = this.baseplanes[fn].rotateplane(rot).d < 0 ? 1 : -1;\n        return [\n          trim + w * 0.5 + xmul * (xoff2 - q.b * sc2),\n          trim + h * 0.5 + q.c * sc2,\n        ];\n      } else {\n        const g = geos[this.facenames[fn][1]];\n        return [trim + q.dot(g[0]) + g[2].b, trim + h - q.dot(g[1]) - g[2].c];\n      }\n    };\n    for (let i = 0; i < this.faces.length; i++) {\n      let face = this.faces[i];\n      const facenum = Math.floor(i / this.stickersperface);\n      if (threed) {\n        face = rot.rotateface(face);\n      }\n      facegeo.push(face.map((_: Quat) => mappt2d(facenum, _)));\n    }\n    const svg = [];\n    // group each base face so we can add a hover element\n    for (let j = 0; j < this.basefacecount; j++) {\n      svg.push(\"<g>\");\n      svg.push(\"<title>\" + this.facenames[j][1] + \"</title>\\n\");\n      for (let ii = 0; ii < this.stickersperface; ii++) {\n        const i = j * this.stickersperface + ii;\n        const cubie = this.facetocubies[i][0];\n        const cubieori = this.facetocubies[i][1];\n        const cubiesetnum = this.cubiesetnums[cubie];\n        const cubieord = this.cubieordnums[cubie];\n        const color = this.graybyori(cubie) ? \"#808080\" : colormap[pos.p[i]];\n        let id =\n          this.cubiesetnames[cubiesetnum] + \"-l\" + cubieord + \"-o\" + cubieori;\n        svg.push(drawedges(id, facegeo[i], color));\n        if (this.duplicatedFaces[i]) {\n          for (let jj = 1; jj < this.duplicatedFaces[i]; jj++) {\n            id = this.cubiesetnames[cubiesetnum] + \"-l\" + cubieord + \"-o\" + jj;\n            svg.push(drawedges(id, facegeo[i], color));\n          }\n        }\n      }\n      svg.push(\"</g>\");\n    }\n    const svggrips: any[] = [];\n    function addgrip(\n      onface: number,\n      name: string,\n      pt: Quat,\n      order: number,\n    ): void {\n      const pt2 = mappt2d(onface, pt);\n      for (let i = 0; i < svggrips.length; i++) {\n        if (\n          Math.hypot(pt2[0] - svggrips[i][0], pt2[1] - svggrips[i][1]) < eps\n        ) {\n          return;\n        }\n      }\n      svggrips.push([pt2[0], pt2[1], name, order]);\n    }\n    for (let i = 0; i < this.faceplanes.length; i++) {\n      const baseface = this.facenames[i][0];\n      let facecoords = baseface;\n      if (threed) {\n        facecoords = rot.rotateface(facecoords);\n      }\n      if (needfacegrips) {\n        let pt = this.faceplanes[i][0];\n        if (threed) {\n          pt = pt.rotatepoint(rot);\n        }\n        addgrip(i, this.faceplanes[i][1], pt, polyn);\n      }\n      for (let j = 0; j < baseface.length; j++) {\n        if (neededgegrips) {\n          const mp = baseface[j]\n            .sum(baseface[(j + 1) % baseface.length])\n            .smul(0.5);\n          const ep = findelement(this.edgenames, mp);\n          const mpc = facecoords[j]\n            .sum(facecoords[(j + 1) % baseface.length])\n            .smul(0.5);\n          addgrip(i, this.edgenames[ep][1], mpc, 2);\n        }\n        if (needvertexgrips) {\n          const vp = findelement(this.vertexnames, baseface[j]);\n          addgrip(i, this.vertexnames[vp][1], facecoords[j], this.cornerfaces);\n        }\n      }\n    }\n    const html =\n      '<svg id=\"svg\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" viewBox=\"0 0 800 500\">\\n' +\n      '<style type=\"text/css\"><![CDATA[' +\n      \".sticker { stroke: #000000; stroke-width: 1px; }\" +\n      \"]]></style>\\n\" +\n      svg.join(\"\") +\n      \"</svg>\";\n    this.svggrips = svggrips;\n    return html;\n  }\n\n  public dist(a: number[], b: number[]): number {\n    return Math.hypot(a[0] - b[0], a[1] - b[1], a[2] - b[2]);\n  }\n\n  public triarea(a: number[], b: number[], c: number[]): number {\n    const ab = this.dist(a, b);\n    const bc = this.dist(b, c);\n    const ac = this.dist(a, c);\n    const p = (ab + bc + ac) / 2;\n    return Math.sqrt(p * (p - ab) * (p - bc) * (p - ac));\n  }\n\n  public polyarea(coords: number[][]): number {\n    let sum = 0;\n    for (let i = 2; i < coords.length; i++) {\n      sum += this.triarea(coords[0], coords[1], coords[i]);\n    }\n    return sum;\n  }\n\n  // The colorfrac parameter says how much of the face should be\n  // colored (vs dividing lines); we default to 0.77 which seems\n  // to work pretty well.  It should be a number between probably\n  // 0.4 and 0.9.\n  public get3d(colorfrac: number = DEFAULT_COLOR_FRACTION): StickerDat {\n    const stickers: any = [];\n    const foundations: any = [];\n    const rot = this.getInitial3DRotation();\n    const faces: any = [];\n    const maxdist: number = 0.52 * this.basefaces[0][0].len();\n    let avgstickerarea = 0;\n    for (let i = 0; i < this.basefaces.length; i++) {\n      const coords = rot.rotateface(this.basefaces[i]);\n      const name = this.facenames[i][1];\n      faces.push({ coords: toFaceCoords(coords, maxdist), name });\n      avgstickerarea += this.polyarea(faces[i].coords);\n    }\n    avgstickerarea /= this.faces.length;\n    const trim = (Math.sqrt(avgstickerarea) * (1 - Math.sqrt(colorfrac))) / 2;\n    for (let i = 0; i < this.faces.length; i++) {\n      const facenum = Math.floor(i / this.stickersperface);\n      const cubie = this.facetocubies[i][0];\n      const cubieori = this.facetocubies[i][1];\n      const cubiesetnum = this.cubiesetnums[cubie];\n      const cubieord = this.cubieordnums[cubie];\n      const color = this.graybyori(cubie)\n        ? \"#808080\"\n        : this.colors[this.facenames[facenum][1]];\n      let coords = rot.rotateface(this.faces[i]);\n      foundations.push({\n        coords: toFaceCoords(coords, maxdist),\n        color,\n        orbit: this.cubiesetnames[cubiesetnum],\n        ord: cubieord,\n        ori: cubieori,\n      });\n      const fcoords = coords;\n      if (trim && trim > 0) {\n        coords = trimEdges(coords, trim);\n      }\n      stickers.push({\n        coords: toFaceCoords(coords, maxdist),\n        color,\n        orbit: this.cubiesetnames[cubiesetnum],\n        ord: cubieord,\n        ori: cubieori,\n      });\n      if (this.duplicatedFaces[i]) {\n        for (let jj = 1; jj < this.duplicatedFaces[i]; jj++) {\n          stickers.push({\n            coords: toFaceCoords(coords, maxdist),\n            color,\n            orbit: this.cubiesetnames[cubiesetnum],\n            ord: cubieord,\n            ori: jj,\n          });\n          foundations.push({\n            coords: toFaceCoords(fcoords, maxdist),\n            color,\n            orbit: this.cubiesetnames[cubiesetnum],\n            ord: cubieord,\n            ori: jj,\n          });\n        }\n      }\n    }\n    const grips: StickerDatAxis[] = [];\n    for (let i = 0; i < this.movesetgeos.length; i++) {\n      const msg = this.movesetgeos[i];\n      const order = this.movesetorders[i];\n      for (let j = 0; j < this.geonormals.length; j++) {\n        const gn = this.geonormals[j];\n        if (msg[0] === gn[1] && msg[1] === gn[2]) {\n          grips.push([toCoords(gn[0].rotatepoint(rot), 1), msg[0], order]);\n          grips.push([\n            toCoords(gn[0].rotatepoint(rot).smul(-1), 1),\n            msg[2],\n            order,\n          ]);\n        }\n      }\n    }\n    const f = (function () {\n      return function (mv: BlockMove): string {\n        return this.unswizzle(mv);\n      };\n    })().bind(this);\n    return {\n      stickers,\n      foundations,\n      faces,\n      axis: grips,\n      unswizzle: f,\n      notationMapper: this.notationMapper,\n    };\n  }\n\n  //  From the name of a geometric element (face, vertex, edge), get a\n  //  normal vector respecting the default orientation.  This is useful\n  //  to define the initial position of the camera in a 3D scene.  The\n  //  return value is normalized, so multiply it by the camera distance.\n  //  Returns undefined if no such geometric element.\n  public getGeoNormal(geoname: string): number[] | undefined {\n    const rot = this.getInitial3DRotation();\n    const grip = this.swizzler.unswizzle(geoname);\n    for (let j = 0; j < this.geonormals.length; j++) {\n      const gn = this.geonormals[j];\n      if (grip === gn[1]) {\n        const r = toCoords(gn[0].rotatepoint(rot), 1);\n        //  This routine is intended to use for the camera location.\n        //  If the camera location is vertical, and we give some\n        //  near-zero values for x and z, then the rotation in the\n        //  X/Z plane will be somewhat arbitrary.  So we clean up the\n        //  returned vector here.  We give a very slight positive\n        //  z value.\n        if (Math.abs(r[0]) < eps && Math.abs(r[2]) < eps) {\n          r[0] = 0.0;\n          r[2] = 1e-6;\n        }\n        return r;\n      }\n    }\n    return undefined;\n  }\n\n  private getfaceindex(facenum: number): number {\n    const divid = this.stickersperface;\n    return Math.floor(facenum / divid);\n  }\n}\n\nclass PGNotation implements MoveNotation {\n  private cache: { [key: string]: KTransformation } = {};\n  constructor(public pg: PuzzleGeometry, public od: OrbitsDef) {}\n\n  public lookupMove(move: BlockMove): KTransformation | undefined {\n    const key = this.blockMoveToString(move);\n    if (key in this.cache) {\n      return this.cache[key];\n    }\n    const mv = this.pg.parseBlockMove(move);\n    let bits = (2 << mv[3]) - (1 << mv[2]);\n    if (!mv[4]) {\n      const slices = this.pg.moveplanesets[mv[1]].length;\n      bits = (2 << (slices - mv[2])) - (1 << (slices - mv[3]));\n    }\n    const pgmv = this.pg.getMoveFromBits(\n      bits,\n      mv[5],\n      !mv[4],\n      this.pg.cmovesbyslice[mv[1]],\n      undefined,\n      this.pg.movesetorders[mv[1]],\n    );\n    const r = this.od.transformToKPuzzle(pgmv);\n    this.cache[key] = r;\n    return r;\n  }\n\n  // This is only used to construct keys, so does not need to be beautiful.\n  private blockMoveToString(mv: BlockMove): string {\n    let r = \"\";\n    if (mv.outerLayer) {\n      r = r + mv.outerLayer + \",\";\n    }\n    if (mv.innerLayer) {\n      r = r + mv.innerLayer + \",\";\n    }\n    r = r + mv.family + \",\" + mv.amount;\n    return r;\n  }\n}\n", "import { identity, Perm } from \"./Perm\";\n\nclass FactoredNumber {\n  public mult: number[];\n  constructor() {\n    this.mult = [];\n  }\n\n  public multiply(n: number): void {\n    for (let f = 2; f * f <= n; f++) {\n      while (n % f === 0) {\n        if (undefined !== this.mult[f]) {\n          this.mult[f]++;\n        } else {\n          this.mult[f] = 1;\n        }\n        n /= f;\n      }\n    }\n    if (n > 1) {\n      if (undefined !== this.mult[n]) {\n        this.mult[n]++;\n      } else {\n        this.mult[n] = 1;\n      }\n    }\n  }\n\n  public toString(): string {\n    let r = \"\";\n    for (let i = 0; i < this.mult.length; i++) {\n      if (undefined !== this.mult[i]) {\n        if (r !== \"\") {\n          r += \"*\";\n        }\n        r += i;\n        if (this.mult[i] > 1) {\n          r += \"^\" + this.mult[i];\n        }\n      }\n    }\n    return r;\n  }\n}\n\nexport function schreierSims(g: Perm[], disp: (s: string) => void): number {\n  const n = g[0].p.length;\n  const e = identity(n);\n  let sgs: Perm[][] = [];\n  let sgsi: Perm[][] = [];\n  let sgslen: number[][] = [];\n  let Tk: Perm[][] = [];\n  let Tklen: number[][] = [];\n  function resolve(p: Perm): boolean {\n    for (let i = p.p.length - 1; i >= 0; i--) {\n      const j = p.p[i];\n      if (j !== i) {\n        if (!sgs[i][j]) {\n          return false;\n        }\n        p = p.mul(sgsi[i][j]);\n      }\n    }\n    return true;\n  }\n  function knutha(k: number, p: Perm, len: number): void {\n    Tk[k].push(p);\n    Tklen[k].push(len);\n    for (let i = 0; i < sgs[k].length; i++) {\n      if (sgs[k][i]) {\n        knuthb(k, sgs[k][i].mul(p), len + sgslen[k][i]);\n      }\n    }\n  }\n  function knuthb(k: number, p: Perm, len: number): void {\n    const j = p.p[k];\n    if (!sgs[k][j]) {\n      sgs[k][j] = p;\n      sgsi[k][j] = p.inv();\n      sgslen[k][j] = len;\n      for (let i = 0; i < Tk[k].length; i++) {\n        knuthb(k, p.mul(Tk[k][i]), len + Tklen[k][i]);\n      }\n      return;\n    }\n    const p2 = p.mul(sgsi[k][j]);\n    if (!resolve(p2)) {\n      knutha(k - 1, p2, len + sgslen[k][j]);\n    }\n  }\n  function getsgs(): number {\n    sgs = [];\n    sgsi = [];\n    Tk = [];\n    sgslen = [];\n    Tklen = [];\n    for (let i = 0; i < n; i++) {\n      sgs.push([]);\n      sgsi.push([]);\n      sgslen.push([]);\n      Tk.push([]);\n      Tklen.push([]);\n      sgs[i][i] = e;\n      sgsi[i][i] = e;\n      sgslen[i][i] = 0;\n    }\n    let none = 0;\n    let sz = 1;\n    for (let i = 0; i < g.length; i++) {\n      knutha(n - 1, g[i], 1);\n      sz = 1;\n      let tks = 0;\n      let sollen = 0;\n      const avgs = [];\n      const mults = new FactoredNumber();\n      for (let j = 0; j < n; j++) {\n        let cnt = 0;\n        let lensum = 0;\n        for (let k = 0; k < n; k++) {\n          if (sgs[j][k]) {\n            cnt++;\n            lensum += sgslen[j][k];\n            if (j !== k) {\n              none++;\n            }\n          }\n        }\n        tks += Tk[j].length;\n        sz *= cnt;\n        if (cnt > 1) {\n          mults.multiply(cnt);\n        }\n        const avg = lensum / cnt;\n        avgs.push(avg);\n        sollen += avg;\n      }\n      disp(\n        \"\" +\n          i +\n          \": sz \" +\n          sz +\n          \" T \" +\n          tks +\n          \" sol \" +\n          sollen +\n          \" none \" +\n          none +\n          \" mults \" +\n          mults,\n      );\n    }\n    return sz;\n  }\n  return getsgs();\n}\n", "export {\n  ProxyEvent,\n  ProxyMoveEvent,\n  ProxyOrientationEvent,\n  ProxyResetEvent,\n} from \"./proxy-event\";\nexport {\n  WebSocketProxyReceiver,\n  WebSocketProxySender,\n} from \"./websocket-proxy\";\n", "import { MoveEvent } from \"../bluetooth\";\nimport { OrientationEvent } from \"../bluetooth/bluetooth-puzzle\";\nimport { ProxyEvent } from \"./proxy-event\";\n\nexport class WebSocketProxySender {\n  protected websocket: WebSocket;\n  constructor(url: string) {\n    this.websocket = new WebSocket(url);\n    this.websocket.onopen = this.onopen.bind(this);\n    this.websocket.onerror = this.onerror.bind(this);\n    this.websocket.onmessage = this.onmessage.bind(this);\n  }\n\n  public sendMoveEvent(e: MoveEvent): void {\n    this.sendProxyEvent({\n      event: \"move\",\n      data: e,\n    });\n  }\n\n  public sendOrientationEvent(e: OrientationEvent): void {\n    this.sendProxyEvent({\n      event: \"orientation\",\n      data: e,\n    });\n  }\n\n  public sendResetEvent(): void {\n    this.sendProxyEvent({ event: \"reset\" });\n  }\n\n  protected sendProxyEvent(proxyEvent: ProxyEvent): void {\n    this.websocket.send(JSON.stringify(proxyEvent));\n  }\n\n  protected onopen(): void {\n    console.log(\"Sending socket is open!\");\n  }\n\n  protected onerror(error: Error): void {\n    console.error(\"WebSocket sender error:\", error);\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars-experimental, @typescript-eslint/no-empty-function\n  protected onmessage(e: MessageEvent): void {}\n}\n\nexport abstract class WebSocketProxyReceiver {\n  protected websocket: WebSocket;\n  constructor(url: string, socketOrigin?: string) {\n    if (!socketOrigin) {\n      console.log(\"No socket origin specified. Will not attempt to connect.\");\n      return;\n    }\n    this.websocket = new WebSocket(url);\n    console.log(this.websocket);\n    this.websocket.onopen = this.onopen.bind(this);\n    this.websocket.onerror = this.onerror.bind(this);\n    this.websocket.onmessage = this.onmessage.bind(this);\n  }\n\n  protected onopen(): void {\n    console.log(\"Receiving socket is open!\");\n  }\n\n  protected onerror(error: Error): void {\n    console.error(\"WebSocket receiver error:\", error);\n  }\n\n  protected onmessage(e: MessageEvent): void {\n    this.onProxyEvent(JSON.parse(e.data));\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars-experimental\n  abstract onProxyEvent(e: ProxyEvent): void;\n}\n", "export { Twisty3DPuzzle } from \"./3D/puzzles/Twisty3DPuzzle\";\nexport {\n  experimentalSetShareAllNewRenderers,\n  experimentalShowRenderStats,\n  Twisty3DCanvas,\n} from \"./dom/viewers/Twisty3DCanvas\";\nexport { TwistyPlayer } from \"./dom/TwistyPlayer\";\nexport {\n  TwistyPlayerInitialConfig,\n  ExperimentalStickering,\n} from \"./dom/TwistyPlayerConfig\";\nexport { TimelineActionEvent } from \"./animation/Timeline\";\n\n// Old\nexport { Cube3D } from \"./3D/puzzles/Cube3D\";\nexport { PG3D } from \"./3D/puzzles/PG3D\";\nexport { AlgIndexer } from \"./animation/alg/AlgIndexer\";\nexport { SimpleAlgIndexer } from \"./animation/alg/SimpleAlgIndexer\";\nexport { TreeAlgIndexer } from \"./animation/alg/TreeAlgIndexer\";\nexport { KPuzzleWrapper as KSolvePuzzle } from \"./3D/puzzles/KPuzzleWrapper\";\nexport { toTimeline } from \"./animation/stream/timeline-move-calculation-draft\";\n\nimport \"./dom/element/ElementConfig\";\n", "import { PerspectiveCamera, Vector3, WebGLRenderer } from \"three\";\nimport { Twisty3DScene } from \"../../3D/Twisty3DScene\";\nimport { RenderScheduler } from \"../../animation/RenderScheduler\";\nimport { ManagedCustomElement } from \"../element/ManagedCustomElement\";\nimport { pixelRatio } from \"./canvas\";\nimport { twisty3DCanvasCSS } from \"./Twisty3DCanvas.css\";\nimport { TwistyOrbitControls } from \"./TwistyOrbitControls\";\nimport { TwistyViewerElement } from \"./TwistyViewerElement\";\nimport { customElementsShim } from \"../element/node-custom-element-shims\";\nimport Stats from \"../../../../vendor/node_modules/three/examples/jsm/libs/stats.module\";\n\nlet SHOW_STATS = false;\n// Show render stats for newly contructed renderers.\nexport function experimentalShowRenderStats(show: boolean): void {\n  SHOW_STATS = show;\n}\n\nlet resizeObserverWarningShown = false;\n\nlet shareAllNewRenderers: boolean = false;\n\n// WARNING: The current shared renderer implementation is not every efficient.\n// Avoid using for players that are likely to have dimensions approaching 1 megapixel or higher.\n// TODO: use a dedicated renderer while fullscreen?\nexport function experimentalSetShareAllNewRenderers(share: boolean): void {\n  shareAllNewRenderers = share;\n}\n\nlet sharedRenderer: WebGLRenderer | null = null;\n\nfunction newRenderer(): WebGLRenderer {\n  return new WebGLRenderer({\n    antialias: true,\n    alpha: true, // TODO\n  });\n}\n\nfunction newSharedRenderer(): WebGLRenderer {\n  return sharedRenderer ?? (sharedRenderer = newRenderer());\n}\n\n// <twisty-3d-canvas>\nexport class Twisty3DCanvas\n  extends ManagedCustomElement\n  implements TwistyViewerElement {\n  private scene: Twisty3DScene;\n  public canvas: HTMLCanvasElement;\n  public camera: PerspectiveCamera;\n  private legacyExperimentalShift: number = 0;\n  private orbitControls: TwistyOrbitControls;\n  private scheduler = new RenderScheduler(this.render.bind(this));\n  private resizePending: boolean = false;\n\n  private renderer: WebGLRenderer; // TODO: share renderers across elements? (issue: renderers are not designed to be constantly resized?)\n  private rendererIsShared: boolean;\n  private canvas2DContext: CanvasRenderingContext2D;\n\n  private stats: Stats | null = null;\n\n  // TODO: Are there any render duration performance concerns with removing this?\n  #invisible: boolean = false;\n  constructor(\n    scene?: Twisty3DScene,\n    options: { cameraPosition?: Vector3; negateCameraPosition?: boolean } = {},\n  ) {\n    super();\n    this.addCSS(twisty3DCanvasCSS);\n\n    this.scene = scene!;\n    this.scene.addRenderTarget(this);\n    if (SHOW_STATS) {\n      this.stats = Stats();\n      this.stats.dom.style.position = \"absolute\";\n      this.addElement(this.stats.dom);\n    }\n\n    // We rely on the resize logic to handle renderer dimensions.\n    this.rendererIsShared = shareAllNewRenderers;\n    this.renderer = this.rendererIsShared ? newSharedRenderer() : newRenderer();\n    this.canvas = this.rendererIsShared\n      ? document.createElement(\"canvas\")\n      : this.renderer.domElement;\n    this.canvas2DContext = this.canvas.getContext(\"2d\")!; // TODO: avoid saving unneeded?\n    this.addElement(this.canvas);\n\n    this.camera = new PerspectiveCamera(\n      20,\n      1, // We rely on the resize logic to handle this.\n      0.1,\n      1000,\n    );\n    this.camera.position.copy(options.cameraPosition ?? new Vector3(2, 4, 4));\n    if (options.negateCameraPosition) {\n      this.camera.position.multiplyScalar(-1);\n    }\n    this.camera.lookAt(new Vector3(0, 0, 0)); // TODO: Handle with `negateCameraPosition`\n    this.orbitControls = new TwistyOrbitControls(\n      this.camera,\n      this.canvas,\n      this.scheduleRender.bind(this),\n    );\n\n    // TODO: Remove this when enough Safari users have `ResizeObserver`.\n    if (window.ResizeObserver) {\n      const observer = new window.ResizeObserver(this.onResize.bind(this));\n      observer.observe(this.contentWrapper);\n    } else {\n      this.scheduleRender();\n      if (!resizeObserverWarningShown) {\n        console.warn(\n          \"You are using an older browser that does not support `ResizeObserver`. Displayed puzzles will not be rescaled.\",\n        );\n        resizeObserverWarningShown = true;\n      }\n    }\n  }\n\n  public setMirror(partner: Twisty3DCanvas): void {\n    this.orbitControls.setMirror(partner.orbitControls);\n    partner.orbitControls.setMirror(this.orbitControls);\n  }\n\n  protected connectedCallback(): void {\n    // Resize as soon as we're in the DOM, to avoid a flash of incorrectly sized content.\n    this.resize();\n    this.render();\n  }\n\n  scheduleRender(): void {\n    this.scheduler.requestAnimFrame();\n  }\n\n  // If the current size/state is incorrect, it may be preferable to hide it\n  // briefly, rather than flashing an incorrect version for one frame.\n  makeInvisibleUntilRender(): void {\n    this.contentWrapper.classList.add(\"invisible\");\n    this.#invisible = true;\n  }\n\n  private render(): void {\n    // Cancel any scheduled frame, since we're rendering right now.\n    // We don't need to re-render until something schedules again.\n    this.stats?.begin();\n    this.scheduler.cancelAnimFrame();\n    if (this.resizePending) {\n      this.resize();\n    }\n    this.orbitControls.updateAndSchedule();\n\n    if (this.rendererIsShared) {\n      this.renderer.setSize(this.canvas.width, this.canvas.height, false);\n      this.canvas2DContext.clearRect(\n        0,\n        0,\n        this.canvas.width,\n        this.canvas.height,\n      );\n    }\n    this.renderer.render(this.scene, this.camera);\n    if (this.rendererIsShared) {\n      this.canvas2DContext.drawImage(this.renderer.domElement, 0, 0);\n    }\n\n    if (this.#invisible) {\n      this.contentWrapper.classList.remove(\"invisible\");\n    }\n    this.stats?.end();\n  }\n\n  private onResize(): void {\n    this.resizePending = true;\n    this.scheduleRender();\n  }\n\n  private resize(): void {\n    this.resizePending = false;\n\n    const w = this.contentWrapper.clientWidth;\n    const h = this.contentWrapper.clientHeight;\n    let off = 0;\n    if (this.legacyExperimentalShift > 0) {\n      off = Math.max(0, Math.floor((w - h) * 0.5));\n    } else if (this.legacyExperimentalShift < 0) {\n      off = -Math.max(0, Math.floor((w - h) * 0.5));\n    }\n    let yoff = 0;\n    let excess = 0;\n    if (h > w) {\n      excess = h - w;\n      yoff = -Math.floor(0.5 * excess);\n    }\n    this.camera.aspect = w / h;\n    this.camera.setViewOffset(w, h - excess, off, yoff, w, h);\n    this.camera.updateProjectionMatrix(); // TODO\n\n    if (this.rendererIsShared) {\n      this.canvas.width = w * pixelRatio();\n      this.canvas.height = h * pixelRatio();\n      this.canvas.style.width = w.toString();\n      this.canvas.style.height = w.toString();\n    } else {\n      this.renderer.setPixelRatio(pixelRatio());\n      this.renderer.setSize(w, h, true);\n    }\n\n    this.scheduleRender();\n  }\n\n  // Square crop is useful for rending icons.\n  renderToDataURL(options: { squareCrop?: boolean } = {}): string {\n    // We don't preserve the drawing buffer, so we have to render again and then immediately read the canvas data.\n    // https://stackoverflow.com/a/30647502\n    this.render();\n\n    // TODO: can we assume that a central crop is similar enough to how a square canvas render would loook?\n    if (!options.squareCrop || this.canvas.width === this.canvas.height) {\n      // TODO: is this such an uncommon path taht we can skip it?\n      return this.canvas.toDataURL();\n    } else {\n      const tempCanvas = document.createElement(\"canvas\");\n      const squareSize = Math.min(this.canvas.width, this.canvas.height);\n      tempCanvas.width = squareSize;\n      tempCanvas.height = squareSize;\n      const tempCtx = tempCanvas.getContext(\"2d\")!; // TODO: can we assume this is always availab?E\n      tempCtx.drawImage(\n        this.canvas,\n        -(this.canvas.width - squareSize) / 2,\n        -(this.canvas.height - squareSize) / 2,\n      );\n      return tempCanvas.toDataURL();\n    }\n  }\n}\n\ncustomElementsShim.define(\"twisty-3d-canvas\", Twisty3DCanvas);\n", "// Debounces `requestAnimationFrame()`.\nexport class RenderScheduler {\n  private animFrameID: number | null = null;\n  private animFrame = this.animFrameWrapper.bind(this);\n  constructor(private callback: (timestamp: DOMHighResTimeStamp) => void) {}\n  requestAnimFrame(): void {\n    if (!this.animFrameID) {\n      this.animFrameID = requestAnimationFrame(this.animFrame);\n    }\n  }\n\n  cancelAnimFrame(): void {\n    if (this.animFrameID) {\n      cancelAnimationFrame(this.animFrameID);\n      this.animFrameID = 0;\n    }\n  }\n\n  private animFrameWrapper(timestamp: DOMHighResTimeStamp): void {\n    this.animFrameID = 0;\n    this.callback(timestamp);\n  }\n}\n", "// Workarounds for `node`.\n// TODO: figure out how to remove this.\n\n// This stub does not need to be callable, just constructable to satisfy the `node` loader.\nclass HTMLElementStub {}\n\nlet HTMLElementShim: typeof HTMLElement;\nif (typeof HTMLElement !== \"undefined\") {\n  HTMLElementShim = HTMLElement;\n} else {\n  HTMLElementShim = HTMLElementStub as any;\n}\n\nexport { HTMLElementShim };\n\nclass CustomElementsStub {\n  define(): void {\n    // nothing\n  }\n}\n\nlet customElementsShim: typeof customElements;\n\nif (typeof customElements !== \"undefined\") {\n  customElementsShim = customElements;\n} else {\n  customElementsShim = new CustomElementsStub() as any;\n}\n\nexport { customElementsShim };\n", "// Workarounds for `node`.\n// TODO: figure out how to remove this.\n\n// This stub does not need to be callable, just constructable to satisfy the `node` loader.\nclass HTMLElementStub {}\n\nlet HTMLElementShim: typeof HTMLElement;\nif (typeof HTMLElement !== \"undefined\") {\n  HTMLElementShim = HTMLElement;\n} else {\n  HTMLElementShim = HTMLElementStub as any;\n}\n\nexport { HTMLElementShim };\n\nclass CustomElementsStub {\n  define(): void {\n    // nothing\n  }\n}\n\nlet customElementsShim: typeof customElements;\n\nif (typeof customElements !== \"undefined\") {\n  customElementsShim = customElements;\n} else {\n  customElementsShim = new CustomElementsStub() as any;\n}\n\nexport { customElementsShim };\n", "import {\n  HTMLElementShim,\n  customElementsShim,\n} from \"./node-custom-element-shims\";\n\nexport class CSSSource {\n  constructor(private sourceText: string) {\n    // TODO: Replace with adopted style sheets some day if we can.\n    // const blob = new Blob([sourceText], {\n    //   type: \"text/utf8\",\n    // });\n    // this.url = URL.createObjectURL(blob);\n  }\n\n  getAsString(): string {\n    return this.sourceText;\n  }\n}\n\n// - Wrapped element\n//   - Shadow root\n//     - Content wrapper\nexport class ManagedCustomElement extends HTMLElementShim {\n  public shadow: ShadowRoot;\n  public contentWrapper: HTMLDivElement; // TODO: can we get rid of this wrapper?\n\n  private cssSourceMap: Map<CSSSource, HTMLStyleElement> = new Map();\n  constructor() {\n    super();\n    this.shadow = this.attachShadow({ mode: \"closed\" });\n\n    this.contentWrapper = document.createElement(\"div\");\n    this.contentWrapper.classList.add(\"wrapper\");\n    this.shadow.appendChild(this.contentWrapper);\n  }\n\n  // Add the source, if not already added.\n  public addCSS(cssSource: CSSSource): void {\n    if (this.cssSourceMap.get(cssSource)) {\n      return;\n    }\n\n    const cssElem: HTMLStyleElement = document.createElement(\"style\");\n    cssElem.textContent = cssSource.getAsString();\n\n    this.cssSourceMap.set(cssSource, cssElem);\n    this.shadow.appendChild(cssElem);\n  }\n\n  // Remove the source, if it's currently added.\n  public removeCSS(cssSource: CSSSource): void {\n    const cssElem = this.cssSourceMap.get(cssSource);\n    if (!cssElem) {\n      return;\n    }\n    this.shadow.removeChild(cssElem);\n    this.cssSourceMap.delete(cssSource);\n  }\n\n  public addElement<T extends Node>(element: T): T {\n    return this.contentWrapper.appendChild(element);\n  }\n\n  public prependElement<T extends Node>(element: T): void {\n    this.contentWrapper.prepend(element);\n  }\n\n  public removeElement<T extends Node>(element: T): T {\n    return this.contentWrapper.removeChild(element);\n  }\n}\n\ncustomElementsShim.define(\n  \"twisty-managed-custom-element\",\n  ManagedCustomElement,\n);\n", "// TODO: Handle if you move across screens?\nexport function pixelRatio(): number {\n  return devicePixelRatio || 1;\n}\n", "import { CSSSource } from \"../element/ManagedCustomElement\";\n\n// The `position` values are a hack for a bug in Safari where the canvas either\n// grows infinitely, or takes up the full `fr` of any encompassing grid (making\n// the contents of that element e.g. over 100% of its height). `contain:\n// content` is a good fix for this, but there is no indication that Safari will\n// support it soon. https://developer.mozilla.org/en-US/docs/Web/CSS/contain\n\nexport const twisty3DCanvasCSS = new CSSSource(`\n:host(twisty-3d-canvas) {\n  contain: content;\n  overflow: hidden;\n}\n\n.wrapper {\n  position: relative;\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  contain: content;\n}\n\n/* TODO: This is due to stats hack. Replace with \\`canvas\\`. */\n.wrapper > canvas {\n  position: absolute;\n  max-width: 100%;\n  max-height: 100%;\n}\n\n.wrapper.invisible {\n  opacity: 0;\n}\n`);\n", "// Note this `vendor` dir should be in another place, but it's here to avoid an `eslint` bug/error.\n\n// TODO: implement the parts we need in `TwistyOrbitControls.\n\n/* eslint-disable */\n\n/**\n * @author qiao / https://github.com/qiao\n * @author mrdoob / http://mrdoob.com\n * @author alteredq / http://alteredqualia.com/\n * @author WestLangley / http://github.com/WestLangley\n * @author erich666 / http://erichaines.com\n * @author ScieCode / http://github.com/sciecode\n */\n\nimport {\n  EventDispatcher,\n  MOUSE,\n  Quaternion,\n  Spherical,\n  TOUCH,\n  Vector2,\n  Vector3,\n} from \"three\";\n\n// This set of controls performs orbiting, dollying (zooming), and panning.\n// Unlike TrackballControls, it maintains the \"up\" direction object.up (+Y by default).\n//\n//    Orbit - left mouse / touch: one-finger move\n//    Zoom - middle mouse, or mousewheel / touch: two-finger spread or squish\n//    Pan - right mouse, or left mouse + ctrl/meta/shiftKey, or arrow keys / touch: two-finger move\n\nconst OrbitControls = function (object, domElement) {\n  if (domElement === undefined)\n    console.warn(\n      'THREE.OrbitControls: The second parameter \"domElement\" is now mandatory.',\n    );\n  if (domElement === document)\n    console.error(\n      'THREE.OrbitControls: \"document\" should not be used as the target \"domElement\". Please use \"renderer.domElement\" instead.',\n    );\n\n  this.object = object;\n  this.domElement = domElement;\n\n  // Set to false to disable this control\n  this.enabled = true;\n\n  // \"target\" sets the location of focus, where the object orbits around\n  this.target = new Vector3();\n\n  // How far you can dolly in and out ( PerspectiveCamera only )\n  this.minDistance = 0;\n  this.maxDistance = Infinity;\n\n  // How far you can zoom in and out ( OrthographicCamera only )\n  this.minZoom = 0;\n  this.maxZoom = Infinity;\n\n  // How far you can orbit vertically, upper and lower limits.\n  // Range is 0 to Math.PI radians.\n  this.minPolarAngle = 0; // radians\n  this.maxPolarAngle = Math.PI; // radians\n\n  // How far you can orbit horizontally, upper and lower limits.\n  // If set, the interval [ min, max ] must be a sub-interval of [ - 2 PI, 2 PI ], with ( max - min < 2 PI )\n  this.minAzimuthAngle = -Infinity; // radians\n  this.maxAzimuthAngle = Infinity; // radians\n\n  // Set to true to enable damping (inertia)\n  // If damping is enabled, you must call controls.update() in your animation loop\n  this.enableDamping = false;\n  this.dampingFactor = 0.05;\n\n  // This option actually enables dollying in and out; left as \"zoom\" for backwards compatibility.\n  // Set to false to disable zooming\n  this.enableZoom = true;\n  this.zoomSpeed = 1.0;\n\n  // Set to false to disable rotating\n  this.enableRotate = true;\n  this.rotateSpeed = 1.0;\n\n  // Set to false to disable panning\n  this.enablePan = true;\n  this.panSpeed = 1.0;\n  this.screenSpacePanning = true; // if false, pan orthogonal to world-space direction camera.up\n  this.keyPanSpeed = 7.0; // pixels moved per arrow key push\n\n  // Set to true to automatically rotate around the target\n  // If auto-rotate is enabled, you must call controls.update() in your animation loop\n  this.autoRotate = false;\n  this.autoRotateSpeed = 2.0; // 30 seconds per round when fps is 60\n\n  // Set to false to disable use of the keys\n  this.enableKeys = true;\n\n  // The four arrow keys\n  this.keys = { LEFT: 37, UP: 38, RIGHT: 39, BOTTOM: 40 };\n\n  // Mouse buttons\n  this.mouseButtons = {\n    LEFT: MOUSE.ROTATE,\n    MIDDLE: MOUSE.DOLLY,\n    RIGHT: MOUSE.PAN,\n  };\n\n  // Touch fingers\n  this.touches = { ONE: TOUCH.ROTATE, TWO: TOUCH.DOLLY_PAN };\n\n  // for reset\n  this.target0 = this.target.clone();\n  this.position0 = this.object.position.clone();\n  this.zoom0 = this.object.zoom;\n\n  //\n  // public methods\n  //\n\n  this.getPolarAngle = function () {\n    return spherical.phi;\n  };\n\n  this.getAzimuthalAngle = function () {\n    return spherical.theta;\n  };\n\n  this.saveState = function () {\n    scope.target0.copy(scope.target);\n    scope.position0.copy(scope.object.position);\n    scope.zoom0 = scope.object.zoom;\n  };\n\n  this.reset = function () {\n    scope.target.copy(scope.target0);\n    scope.object.position.copy(scope.position0);\n    scope.object.zoom = scope.zoom0;\n\n    scope.object.updateProjectionMatrix();\n    scope.dispatchEvent(changeEvent);\n\n    scope.update();\n\n    state = STATE.NONE;\n  };\n\n  // this method is exposed, but perhaps it would be better if we can make it private...\n  this.update = (function () {\n    const offset = new Vector3();\n\n    // so camera.up is the orbit axis\n    const quat = new Quaternion().setFromUnitVectors(\n      object.up,\n      new Vector3(0, 1, 0),\n    );\n    const quatInverse = quat.clone().inverse();\n\n    const lastPosition = new Vector3();\n    const lastQuaternion = new Quaternion();\n\n    const twoPI = 2 * Math.PI;\n\n    return function update() {\n      const position = scope.object.position;\n\n      offset.copy(position).sub(scope.target);\n\n      // rotate offset to \"y-axis-is-up\" space\n      offset.applyQuaternion(quat);\n\n      // angle from z-axis around y-axis\n      spherical.setFromVector3(offset);\n\n      if (scope.autoRotate && state === STATE.NONE) {\n        rotateLeft(getAutoRotationAngle());\n      }\n\n      if (scope.enableDamping) {\n        spherical.theta += sphericalDelta.theta * scope.dampingFactor;\n        spherical.phi += sphericalDelta.phi * scope.dampingFactor;\n      } else {\n        spherical.theta += sphericalDelta.theta;\n        spherical.phi += sphericalDelta.phi;\n      }\n\n      // restrict theta to be between desired limits\n\n      let min = scope.minAzimuthAngle;\n      let max = scope.maxAzimuthAngle;\n\n      if (isFinite(min) && isFinite(max)) {\n        if (min < -Math.PI) min += twoPI;\n        else if (min > Math.PI) min -= twoPI;\n\n        if (max < -Math.PI) max += twoPI;\n        else if (max > Math.PI) max -= twoPI;\n\n        if (min < max) {\n          spherical.theta = Math.max(min, Math.min(max, spherical.theta));\n        } else {\n          spherical.theta =\n            spherical.theta > (min + max) / 2\n              ? Math.max(min, spherical.theta)\n              : Math.min(max, spherical.theta);\n        }\n      }\n\n      // restrict phi to be between desired limits\n      spherical.phi = Math.max(\n        scope.minPolarAngle,\n        Math.min(scope.maxPolarAngle, spherical.phi),\n      );\n\n      spherical.makeSafe();\n\n      spherical.radius *= scale;\n\n      // restrict radius to be between desired limits\n      spherical.radius = Math.max(\n        scope.minDistance,\n        Math.min(scope.maxDistance, spherical.radius),\n      );\n\n      // move target to panned location\n\n      if (scope.enableDamping === true) {\n        scope.target.addScaledVector(panOffset, scope.dampingFactor);\n      } else {\n        scope.target.add(panOffset);\n      }\n\n      offset.setFromSpherical(spherical);\n\n      // rotate offset back to \"camera-up-vector-is-up\" space\n      offset.applyQuaternion(quatInverse);\n\n      position.copy(scope.target).add(offset);\n\n      scope.object.lookAt(scope.target);\n\n      if (scope.enableDamping === true) {\n        sphericalDelta.theta *= 1 - scope.dampingFactor;\n        sphericalDelta.phi *= 1 - scope.dampingFactor;\n\n        panOffset.multiplyScalar(1 - scope.dampingFactor);\n      } else {\n        sphericalDelta.set(0, 0, 0);\n\n        panOffset.set(0, 0, 0);\n      }\n\n      scale = 1;\n\n      // update condition is:\n      // min(camera displacement, camera rotation in radians)^2 > EPS\n      // using small-angle approximation cos(x/2) = 1 - x^2 / 8\n\n      if (\n        zoomChanged ||\n        lastPosition.distanceToSquared(scope.object.position) > EPS ||\n        8 * (1 - lastQuaternion.dot(scope.object.quaternion)) > EPS\n      ) {\n        scope.dispatchEvent(changeEvent);\n\n        lastPosition.copy(scope.object.position);\n        lastQuaternion.copy(scope.object.quaternion);\n        zoomChanged = false;\n\n        return true;\n      }\n\n      return false;\n    };\n  })();\n\n  this.dispose = function () {\n    scope.domElement.removeEventListener(\"contextmenu\", onContextMenu, false);\n    scope.domElement.removeEventListener(\"mousedown\", onMouseDown, false);\n    scope.domElement.removeEventListener(\"wheel\", onMouseWheel, false);\n\n    scope.domElement.removeEventListener(\"touchstart\", onTouchStart, false);\n    scope.domElement.removeEventListener(\"touchend\", onTouchEnd, false);\n    scope.domElement.removeEventListener(\"touchmove\", onTouchMove, false);\n\n    scope.domElement.ownerDocument.removeEventListener(\n      \"mousemove\",\n      onMouseMove,\n      false,\n    );\n    scope.domElement.ownerDocument.removeEventListener(\n      \"mouseup\",\n      onMouseUp,\n      false,\n    );\n\n    scope.domElement.removeEventListener(\"keydown\", onKeyDown, false);\n\n    //scope.dispatchEvent( { type: 'dispose' } ); // should this be added here?\n  };\n\n  //\n  // internals\n  //\n\n  var scope = this;\n\n  var changeEvent = { type: \"change\" };\n  const startEvent = { type: \"start\" };\n  const endEvent = { type: \"end\" };\n\n  var STATE = {\n    NONE: -1,\n    ROTATE: 0,\n    DOLLY: 1,\n    PAN: 2,\n    TOUCH_ROTATE: 3,\n    TOUCH_PAN: 4,\n    TOUCH_DOLLY_PAN: 5,\n    TOUCH_DOLLY_ROTATE: 6,\n  };\n\n  var state = STATE.NONE;\n\n  var EPS = 0.000001;\n\n  // current position in spherical coordinates\n  var spherical = new Spherical();\n  var sphericalDelta = new Spherical();\n\n  var scale = 1;\n  var panOffset = new Vector3();\n  var zoomChanged = false;\n\n  const rotateStart = new Vector2();\n  const rotateEnd = new Vector2();\n  const rotateDelta = new Vector2();\n\n  const panStart = new Vector2();\n  const panEnd = new Vector2();\n  const panDelta = new Vector2();\n\n  const dollyStart = new Vector2();\n  const dollyEnd = new Vector2();\n  const dollyDelta = new Vector2();\n\n  function getAutoRotationAngle() {\n    return ((2 * Math.PI) / 60 / 60) * scope.autoRotateSpeed;\n  }\n\n  function getZoomScale() {\n    return Math.pow(0.95, scope.zoomSpeed);\n  }\n\n  function rotateLeft(angle) {\n    sphericalDelta.theta -= angle;\n  }\n\n  function rotateUp(angle) {\n    sphericalDelta.phi -= angle;\n  }\n\n  const panLeft = (function () {\n    const v = new Vector3();\n\n    return function panLeft(distance, objectMatrix) {\n      v.setFromMatrixColumn(objectMatrix, 0); // get X column of objectMatrix\n      v.multiplyScalar(-distance);\n\n      panOffset.add(v);\n    };\n  })();\n\n  const panUp = (function () {\n    const v = new Vector3();\n\n    return function panUp(distance, objectMatrix) {\n      if (scope.screenSpacePanning === true) {\n        v.setFromMatrixColumn(objectMatrix, 1);\n      } else {\n        v.setFromMatrixColumn(objectMatrix, 0);\n        v.crossVectors(scope.object.up, v);\n      }\n\n      v.multiplyScalar(distance);\n\n      panOffset.add(v);\n    };\n  })();\n\n  // deltaX and deltaY are in pixels; right and down are positive\n  const pan = (function () {\n    const offset = new Vector3();\n\n    return function pan(deltaX, deltaY) {\n      const element = scope.domElement;\n\n      if (scope.object.isPerspectiveCamera) {\n        // perspective\n        const position = scope.object.position;\n        offset.copy(position).sub(scope.target);\n        let targetDistance = offset.length();\n\n        // half of the fov is center to top of screen\n        targetDistance *= Math.tan(((scope.object.fov / 2) * Math.PI) / 180.0);\n\n        // we use only clientHeight here so aspect ratio does not distort speed\n        panLeft(\n          (2 * deltaX * targetDistance) / element.clientHeight,\n          scope.object.matrix,\n        );\n        panUp(\n          (2 * deltaY * targetDistance) / element.clientHeight,\n          scope.object.matrix,\n        );\n      } else if (scope.object.isOrthographicCamera) {\n        // orthographic\n        panLeft(\n          (deltaX * (scope.object.right - scope.object.left)) /\n            scope.object.zoom /\n            element.clientWidth,\n          scope.object.matrix,\n        );\n        panUp(\n          (deltaY * (scope.object.top - scope.object.bottom)) /\n            scope.object.zoom /\n            element.clientHeight,\n          scope.object.matrix,\n        );\n      } else {\n        // camera neither orthographic nor perspective\n        console.warn(\n          \"WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.\",\n        );\n        scope.enablePan = false;\n      }\n    };\n  })();\n\n  function dollyOut(dollyScale) {\n    if (scope.object.isPerspectiveCamera) {\n      scale /= dollyScale;\n    } else if (scope.object.isOrthographicCamera) {\n      scope.object.zoom = Math.max(\n        scope.minZoom,\n        Math.min(scope.maxZoom, scope.object.zoom * dollyScale),\n      );\n      scope.object.updateProjectionMatrix();\n      zoomChanged = true;\n    } else {\n      console.warn(\n        \"WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.\",\n      );\n      scope.enableZoom = false;\n    }\n  }\n\n  function dollyIn(dollyScale) {\n    if (scope.object.isPerspectiveCamera) {\n      scale *= dollyScale;\n    } else if (scope.object.isOrthographicCamera) {\n      scope.object.zoom = Math.max(\n        scope.minZoom,\n        Math.min(scope.maxZoom, scope.object.zoom / dollyScale),\n      );\n      scope.object.updateProjectionMatrix();\n      zoomChanged = true;\n    } else {\n      console.warn(\n        \"WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.\",\n      );\n      scope.enableZoom = false;\n    }\n  }\n\n  //\n  // event callbacks - update the object state\n  //\n\n  function handleMouseDownRotate(event) {\n    rotateStart.set(event.clientX, event.clientY);\n  }\n\n  function handleMouseDownDolly(event) {\n    dollyStart.set(event.clientX, event.clientY);\n  }\n\n  function handleMouseDownPan(event) {\n    panStart.set(event.clientX, event.clientY);\n  }\n\n  function handleMouseMoveRotate(event) {\n    rotateEnd.set(event.clientX, event.clientY);\n\n    rotateDelta\n      .subVectors(rotateEnd, rotateStart)\n      .multiplyScalar(scope.rotateSpeed);\n\n    const element = scope.domElement;\n\n    rotateLeft((2 * Math.PI * rotateDelta.x) / element.clientHeight); // yes, height\n\n    rotateUp((2 * Math.PI * rotateDelta.y) / element.clientHeight);\n\n    rotateStart.copy(rotateEnd);\n\n    scope.update();\n  }\n\n  function handleMouseMoveDolly(event) {\n    dollyEnd.set(event.clientX, event.clientY);\n\n    dollyDelta.subVectors(dollyEnd, dollyStart);\n\n    if (dollyDelta.y > 0) {\n      dollyOut(getZoomScale());\n    } else if (dollyDelta.y < 0) {\n      dollyIn(getZoomScale());\n    }\n\n    dollyStart.copy(dollyEnd);\n\n    scope.update();\n  }\n\n  function handleMouseMovePan(event) {\n    panEnd.set(event.clientX, event.clientY);\n\n    panDelta.subVectors(panEnd, panStart).multiplyScalar(scope.panSpeed);\n\n    pan(panDelta.x, panDelta.y);\n\n    panStart.copy(panEnd);\n\n    scope.update();\n  }\n\n  function handleMouseUp(/*event*/) {\n    // no-op\n  }\n\n  function handleMouseWheel(event) {\n    if (event.deltaY < 0) {\n      dollyIn(getZoomScale());\n    } else if (event.deltaY > 0) {\n      dollyOut(getZoomScale());\n    }\n\n    scope.update();\n  }\n\n  function handleKeyDown(event) {\n    let needsUpdate = false;\n\n    switch (event.keyCode) {\n      case scope.keys.UP:\n        pan(0, scope.keyPanSpeed);\n        needsUpdate = true;\n        break;\n\n      case scope.keys.BOTTOM:\n        pan(0, -scope.keyPanSpeed);\n        needsUpdate = true;\n        break;\n\n      case scope.keys.LEFT:\n        pan(scope.keyPanSpeed, 0);\n        needsUpdate = true;\n        break;\n\n      case scope.keys.RIGHT:\n        pan(-scope.keyPanSpeed, 0);\n        needsUpdate = true;\n        break;\n    }\n\n    if (needsUpdate) {\n      // prevent the browser from scrolling on cursor keys\n      event.preventDefault();\n\n      scope.update();\n    }\n  }\n\n  function handleTouchStartRotate(event) {\n    if (event.touches.length == 1) {\n      rotateStart.set(event.touches[0].pageX, event.touches[0].pageY);\n    } else {\n      const x = 0.5 * (event.touches[0].pageX + event.touches[1].pageX);\n      const y = 0.5 * (event.touches[0].pageY + event.touches[1].pageY);\n\n      rotateStart.set(x, y);\n    }\n  }\n\n  function handleTouchStartPan(event) {\n    if (event.touches.length == 1) {\n      panStart.set(event.touches[0].pageX, event.touches[0].pageY);\n    } else {\n      const x = 0.5 * (event.touches[0].pageX + event.touches[1].pageX);\n      const y = 0.5 * (event.touches[0].pageY + event.touches[1].pageY);\n\n      panStart.set(x, y);\n    }\n  }\n\n  function handleTouchStartDolly(event) {\n    const dx = event.touches[0].pageX - event.touches[1].pageX;\n    const dy = event.touches[0].pageY - event.touches[1].pageY;\n\n    const distance = Math.sqrt(dx * dx + dy * dy);\n\n    dollyStart.set(0, distance);\n  }\n\n  function handleTouchStartDollyPan(event) {\n    if (scope.enableZoom) handleTouchStartDolly(event);\n\n    if (scope.enablePan) handleTouchStartPan(event);\n  }\n\n  function handleTouchStartDollyRotate(event) {\n    if (scope.enableZoom) handleTouchStartDolly(event);\n\n    if (scope.enableRotate) handleTouchStartRotate(event);\n  }\n\n  function handleTouchMoveRotate(event) {\n    if (event.touches.length == 1) {\n      rotateEnd.set(event.touches[0].pageX, event.touches[0].pageY);\n    } else {\n      const x = 0.5 * (event.touches[0].pageX + event.touches[1].pageX);\n      const y = 0.5 * (event.touches[0].pageY + event.touches[1].pageY);\n\n      rotateEnd.set(x, y);\n    }\n\n    rotateDelta\n      .subVectors(rotateEnd, rotateStart)\n      .multiplyScalar(scope.rotateSpeed);\n\n    const element = scope.domElement;\n\n    rotateLeft((2 * Math.PI * rotateDelta.x) / element.clientHeight); // yes, height\n\n    rotateUp((2 * Math.PI * rotateDelta.y) / element.clientHeight);\n\n    rotateStart.copy(rotateEnd);\n  }\n\n  function handleTouchMovePan(event) {\n    if (event.touches.length == 1) {\n      panEnd.set(event.touches[0].pageX, event.touches[0].pageY);\n    } else {\n      const x = 0.5 * (event.touches[0].pageX + event.touches[1].pageX);\n      const y = 0.5 * (event.touches[0].pageY + event.touches[1].pageY);\n\n      panEnd.set(x, y);\n    }\n\n    panDelta.subVectors(panEnd, panStart).multiplyScalar(scope.panSpeed);\n\n    pan(panDelta.x, panDelta.y);\n\n    panStart.copy(panEnd);\n  }\n\n  function handleTouchMoveDolly(event) {\n    const dx = event.touches[0].pageX - event.touches[1].pageX;\n    const dy = event.touches[0].pageY - event.touches[1].pageY;\n\n    const distance = Math.sqrt(dx * dx + dy * dy);\n\n    dollyEnd.set(0, distance);\n\n    dollyDelta.set(0, Math.pow(dollyEnd.y / dollyStart.y, scope.zoomSpeed));\n\n    dollyOut(dollyDelta.y);\n\n    dollyStart.copy(dollyEnd);\n  }\n\n  function handleTouchMoveDollyPan(event) {\n    if (scope.enableZoom) handleTouchMoveDolly(event);\n\n    if (scope.enablePan) handleTouchMovePan(event);\n  }\n\n  function handleTouchMoveDollyRotate(event) {\n    if (scope.enableZoom) handleTouchMoveDolly(event);\n\n    if (scope.enableRotate) handleTouchMoveRotate(event);\n  }\n\n  function handleTouchEnd(/*event*/) {\n    // no-op\n  }\n\n  //\n  // event handlers - FSM: listen for events and reset state\n  //\n\n  function onMouseDown(event) {\n    if (scope.enabled === false) return;\n\n    // Prevent the browser from scrolling.\n    event.preventDefault();\n\n    // Manually set the focus since calling preventDefault above\n    // prevents the browser from setting it automatically.\n\n    scope.domElement.focus ? scope.domElement.focus() : window.focus();\n\n    let mouseAction;\n\n    switch (event.button) {\n      case 0:\n        mouseAction = scope.mouseButtons.LEFT;\n        break;\n\n      case 1:\n        mouseAction = scope.mouseButtons.MIDDLE;\n        break;\n\n      case 2:\n        mouseAction = scope.mouseButtons.RIGHT;\n        break;\n\n      default:\n        mouseAction = -1;\n    }\n\n    switch (mouseAction) {\n      case MOUSE.DOLLY:\n        if (scope.enableZoom === false) return;\n\n        handleMouseDownDolly(event);\n\n        state = STATE.DOLLY;\n\n        break;\n\n      case MOUSE.ROTATE:\n        if (event.ctrlKey || event.metaKey || event.shiftKey) {\n          if (scope.enablePan === false) return;\n\n          handleMouseDownPan(event);\n\n          state = STATE.PAN;\n        } else {\n          if (scope.enableRotate === false) return;\n\n          handleMouseDownRotate(event);\n\n          state = STATE.ROTATE;\n        }\n\n        break;\n\n      case MOUSE.PAN:\n        if (event.ctrlKey || event.metaKey || event.shiftKey) {\n          if (scope.enableRotate === false) return;\n\n          handleMouseDownRotate(event);\n\n          state = STATE.ROTATE;\n        } else {\n          if (scope.enablePan === false) return;\n\n          handleMouseDownPan(event);\n\n          state = STATE.PAN;\n        }\n\n        break;\n\n      default:\n        state = STATE.NONE;\n    }\n\n    if (state !== STATE.NONE) {\n      scope.domElement.ownerDocument.addEventListener(\n        \"mousemove\",\n        onMouseMove,\n        false,\n      );\n      scope.domElement.ownerDocument.addEventListener(\n        \"mouseup\",\n        onMouseUp,\n        false,\n      );\n\n      scope.dispatchEvent(startEvent);\n    }\n  }\n\n  function onMouseMove(event) {\n    if (scope.enabled === false) return;\n\n    event.preventDefault();\n\n    switch (state) {\n      case STATE.ROTATE:\n        if (scope.enableRotate === false) return;\n\n        handleMouseMoveRotate(event);\n\n        break;\n\n      case STATE.DOLLY:\n        if (scope.enableZoom === false) return;\n\n        handleMouseMoveDolly(event);\n\n        break;\n\n      case STATE.PAN:\n        if (scope.enablePan === false) return;\n\n        handleMouseMovePan(event);\n\n        break;\n    }\n  }\n\n  function onMouseUp(event) {\n    if (scope.enabled === false) return;\n\n    handleMouseUp(event);\n\n    scope.domElement.ownerDocument.removeEventListener(\n      \"mousemove\",\n      onMouseMove,\n      false,\n    );\n    scope.domElement.ownerDocument.removeEventListener(\n      \"mouseup\",\n      onMouseUp,\n      false,\n    );\n\n    scope.dispatchEvent(endEvent);\n\n    state = STATE.NONE;\n  }\n\n  function onMouseWheel(event) {\n    if (\n      scope.enabled === false ||\n      scope.enableZoom === false ||\n      (state !== STATE.NONE && state !== STATE.ROTATE)\n    )\n      return;\n\n    event.preventDefault();\n    event.stopPropagation();\n\n    scope.dispatchEvent(startEvent);\n\n    handleMouseWheel(event);\n\n    scope.dispatchEvent(endEvent);\n  }\n\n  function onKeyDown(event) {\n    if (\n      scope.enabled === false ||\n      scope.enableKeys === false ||\n      scope.enablePan === false\n    )\n      return;\n\n    handleKeyDown(event);\n  }\n\n  function onTouchStart(event) {\n    if (scope.enabled === false) return;\n\n    event.preventDefault(); // prevent scrolling\n\n    switch (event.touches.length) {\n      case 1:\n        switch (scope.touches.ONE) {\n          case TOUCH.ROTATE:\n            if (scope.enableRotate === false) return;\n\n            handleTouchStartRotate(event);\n\n            state = STATE.TOUCH_ROTATE;\n\n            break;\n\n          case TOUCH.PAN:\n            if (scope.enablePan === false) return;\n\n            handleTouchStartPan(event);\n\n            state = STATE.TOUCH_PAN;\n\n            break;\n\n          default:\n            state = STATE.NONE;\n        }\n\n        break;\n\n      case 2:\n        switch (scope.touches.TWO) {\n          case TOUCH.DOLLY_PAN:\n            if (scope.enableZoom === false && scope.enablePan === false) return;\n\n            handleTouchStartDollyPan(event);\n\n            state = STATE.TOUCH_DOLLY_PAN;\n\n            break;\n\n          case TOUCH.DOLLY_ROTATE:\n            if (scope.enableZoom === false && scope.enableRotate === false)\n              return;\n\n            handleTouchStartDollyRotate(event);\n\n            state = STATE.TOUCH_DOLLY_ROTATE;\n\n            break;\n\n          default:\n            state = STATE.NONE;\n        }\n\n        break;\n\n      default:\n        state = STATE.NONE;\n    }\n\n    if (state !== STATE.NONE) {\n      scope.dispatchEvent(startEvent);\n    }\n  }\n\n  function onTouchMove(event) {\n    if (scope.enabled === false) return;\n\n    event.preventDefault(); // prevent scrolling\n    event.stopPropagation();\n\n    switch (state) {\n      case STATE.TOUCH_ROTATE:\n        if (scope.enableRotate === false) return;\n\n        handleTouchMoveRotate(event);\n\n        scope.update();\n\n        break;\n\n      case STATE.TOUCH_PAN:\n        if (scope.enablePan === false) return;\n\n        handleTouchMovePan(event);\n\n        scope.update();\n\n        break;\n\n      case STATE.TOUCH_DOLLY_PAN:\n        if (scope.enableZoom === false && scope.enablePan === false) return;\n\n        handleTouchMoveDollyPan(event);\n\n        scope.update();\n\n        break;\n\n      case STATE.TOUCH_DOLLY_ROTATE:\n        if (scope.enableZoom === false && scope.enableRotate === false) return;\n\n        handleTouchMoveDollyRotate(event);\n\n        scope.update();\n\n        break;\n\n      default:\n        state = STATE.NONE;\n    }\n  }\n\n  function onTouchEnd(event) {\n    if (scope.enabled === false) return;\n\n    handleTouchEnd(event);\n\n    scope.dispatchEvent(endEvent);\n\n    state = STATE.NONE;\n  }\n\n  function onContextMenu(event) {\n    if (scope.enabled === false) return;\n\n    event.preventDefault();\n  }\n\n  //\n\n  scope.domElement.addEventListener(\"contextmenu\", onContextMenu, false);\n\n  scope.domElement.addEventListener(\"mousedown\", onMouseDown, false);\n  scope.domElement.addEventListener(\"wheel\", onMouseWheel, false);\n\n  scope.domElement.addEventListener(\"touchstart\", onTouchStart, false);\n  scope.domElement.addEventListener(\"touchend\", onTouchEnd, false);\n  scope.domElement.addEventListener(\"touchmove\", onTouchMove, false);\n\n  scope.domElement.addEventListener(\"keydown\", onKeyDown, false);\n\n  // make sure element can receive keys.\n\n  if (scope.domElement.tabIndex === -1) {\n    scope.domElement.tabIndex = 0;\n  }\n\n  // force an update at start\n\n  this.update();\n};\n\nOrbitControls.prototype = Object.create(EventDispatcher.prototype);\nOrbitControls.prototype.constructor = OrbitControls;\n\n// This set of controls performs orbiting, dollying (zooming), and panning.\n// Unlike TrackballControls, it maintains the \"up\" direction object.up (+Y by default).\n// This is very similar to OrbitControls, another set of touch behavior\n//\n//    Orbit - right mouse, or left mouse + ctrl/meta/shiftKey / touch: two-finger rotate\n//    Zoom - middle mouse, or mousewheel / touch: two-finger spread or squish\n//    Pan - left mouse, or arrow keys / touch: one-finger move\n\nconst MapControls = function (object, domElement) {\n  OrbitControls.call(this, object, domElement);\n\n  this.screenSpacePanning = false; // pan orthogonal to world-space direction camera.up\n\n  this.mouseButtons.LEFT = MOUSE.PAN;\n  this.mouseButtons.RIGHT = MOUSE.ROTATE;\n\n  this.touches.ONE = TOUCH.PAN;\n  this.touches.TWO = TOUCH.DOLLY_ROTATE;\n};\n\nMapControls.prototype = Object.create(EventDispatcher.prototype);\nMapControls.prototype.constructor = MapControls;\n\nexport { OrbitControls, MapControls };\n", "import { Camera } from \"three\";\nimport { OrbitControls as ThreeOrbitControls } from \"./vendor/OrbitControls\";\n\nconst INERTIA_DEFAULT: boolean = true;\n\n// TODO: Support limiting altitudinal angle, similar to alg.cubing.net v1.\n// TODO: Allow locking vertical rotation if the mouse/touch hasn't moved much, similar to alg.cubing.net v1.\n// TODO: Use more damping during drag, and less damping after letting go.\nexport class TwistyOrbitControls {\n  threeOrbitControls: ThreeOrbitControls;\n  mirrorControls?: TwistyOrbitControls;\n  constructor(\n    private camera: Camera,\n    canvas: HTMLCanvasElement,\n    private scheduleRender: () => void,\n  ) {\n    this.threeOrbitControls = new ThreeOrbitControls(camera, canvas);\n    this.threeOrbitControls.enableDamping = INERTIA_DEFAULT;\n    this.threeOrbitControls.rotateSpeed = 0.5;\n    this.threeOrbitControls.enablePan = false;\n    this.threeOrbitControls.enableZoom = false;\n\n    // Note we can get a `change` event after `end` due to dampening.\n    const eventHandler = this.onOrbitControlEvent.bind(this);\n    this.threeOrbitControls.addEventListener(\"start\", eventHandler);\n    this.threeOrbitControls.addEventListener(\"change\", eventHandler);\n    this.threeOrbitControls.addEventListener(\"end\", eventHandler);\n  }\n\n  public setInertia(enabled: boolean): void {\n    this.threeOrbitControls.enableDamping = enabled;\n  }\n\n  public onOrbitControlEvent(): void {\n    this.scheduleRender();\n    this.mirrorControls?.updateMirroredCamera(this.camera);\n  }\n\n  public setMirror(m: TwistyOrbitControls): void {\n    this.mirrorControls = m;\n  }\n\n  updateMirroredCamera(c: Camera): void {\n    this.camera.position.copy(c.position);\n    this.camera.position.multiplyScalar(-1);\n    this.scheduleRender();\n  }\n\n  updateAndSchedule(): void {\n    // The return value tells us whether there was an update. If there was an\n    // update, we schedule a render to check next frame. This means we might\n    // render an extra frame at the end, but that's a fairly low cost for the\n    // simplicity of implementation.\n    if (this.threeOrbitControls.update()) {\n      this.scheduleRender();\n    }\n  }\n}\n", "/**\n * @author mrdoob / http://mrdoob.com/\n */\n\nvar Stats = function () {\n\n\tvar mode = 0;\n\n\tvar container = document.createElement( 'div' );\n\tcontainer.style.cssText = 'position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000';\n\tcontainer.addEventListener( 'click', function ( event ) {\n\n\t\tevent.preventDefault();\n\t\tshowPanel( ++ mode % container.children.length );\n\n\t}, false );\n\n\t//\n\n\tfunction addPanel( panel ) {\n\n\t\tcontainer.appendChild( panel.dom );\n\t\treturn panel;\n\n\t}\n\n\tfunction showPanel( id ) {\n\n\t\tfor ( var i = 0; i < container.children.length; i ++ ) {\n\n\t\t\tcontainer.children[ i ].style.display = i === id ? 'block' : 'none';\n\n\t\t}\n\n\t\tmode = id;\n\n\t}\n\n\t//\n\n\tvar beginTime = ( performance || Date ).now(), prevTime = beginTime, frames = 0;\n\n\tvar fpsPanel = addPanel( new Stats.Panel( 'FPS', '#0ff', '#002' ) );\n\tvar msPanel = addPanel( new Stats.Panel( 'MS', '#0f0', '#020' ) );\n\n\tif ( self.performance && self.performance.memory ) {\n\n\t\tvar memPanel = addPanel( new Stats.Panel( 'MB', '#f08', '#201' ) );\n\n\t}\n\n\tshowPanel( 0 );\n\n\treturn {\n\n\t\tREVISION: 16,\n\n\t\tdom: container,\n\n\t\taddPanel: addPanel,\n\t\tshowPanel: showPanel,\n\n\t\tbegin: function () {\n\n\t\t\tbeginTime = ( performance || Date ).now();\n\n\t\t},\n\n\t\tend: function () {\n\n\t\t\tframes ++;\n\n\t\t\tvar time = ( performance || Date ).now();\n\n\t\t\tmsPanel.update( time - beginTime, 200 );\n\n\t\t\tif ( time >= prevTime + 1000 ) {\n\n\t\t\t\tfpsPanel.update( ( frames * 1000 ) / ( time - prevTime ), 100 );\n\n\t\t\t\tprevTime = time;\n\t\t\t\tframes = 0;\n\n\t\t\t\tif ( memPanel ) {\n\n\t\t\t\t\tvar memory = performance.memory;\n\t\t\t\t\tmemPanel.update( memory.usedJSHeapSize / 1048576, memory.jsHeapSizeLimit / 1048576 );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn time;\n\n\t\t},\n\n\t\tupdate: function () {\n\n\t\t\tbeginTime = this.end();\n\n\t\t},\n\n\t\t// Backwards Compatibility\n\n\t\tdomElement: container,\n\t\tsetMode: showPanel\n\n\t};\n\n};\n\nStats.Panel = function ( name, fg, bg ) {\n\n\tvar min = Infinity, max = 0, round = Math.round;\n\tvar PR = round( window.devicePixelRatio || 1 );\n\n\tvar WIDTH = 80 * PR, HEIGHT = 48 * PR,\n\t\tTEXT_X = 3 * PR, TEXT_Y = 2 * PR,\n\t\tGRAPH_X = 3 * PR, GRAPH_Y = 15 * PR,\n\t\tGRAPH_WIDTH = 74 * PR, GRAPH_HEIGHT = 30 * PR;\n\n\tvar canvas = document.createElement( 'canvas' );\n\tcanvas.width = WIDTH;\n\tcanvas.height = HEIGHT;\n\tcanvas.style.cssText = 'width:80px;height:48px';\n\n\tvar context = canvas.getContext( '2d' );\n\tcontext.font = 'bold ' + ( 9 * PR ) + 'px Helvetica,Arial,sans-serif';\n\tcontext.textBaseline = 'top';\n\n\tcontext.fillStyle = bg;\n\tcontext.fillRect( 0, 0, WIDTH, HEIGHT );\n\n\tcontext.fillStyle = fg;\n\tcontext.fillText( name, TEXT_X, TEXT_Y );\n\tcontext.fillRect( GRAPH_X, GRAPH_Y, GRAPH_WIDTH, GRAPH_HEIGHT );\n\n\tcontext.fillStyle = bg;\n\tcontext.globalAlpha = 0.9;\n\tcontext.fillRect( GRAPH_X, GRAPH_Y, GRAPH_WIDTH, GRAPH_HEIGHT );\n\n\treturn {\n\n\t\tdom: canvas,\n\n\t\tupdate: function ( value, maxValue ) {\n\n\t\t\tmin = Math.min( min, value );\n\t\t\tmax = Math.max( max, value );\n\n\t\t\tcontext.fillStyle = bg;\n\t\t\tcontext.globalAlpha = 1;\n\t\t\tcontext.fillRect( 0, 0, WIDTH, GRAPH_Y );\n\t\t\tcontext.fillStyle = fg;\n\t\t\tcontext.fillText( round( value ) + ' ' + name + ' (' + round( min ) + '-' + round( max ) + ')', TEXT_X, TEXT_Y );\n\n\t\t\tcontext.drawImage( canvas, GRAPH_X + PR, GRAPH_Y, GRAPH_WIDTH - PR, GRAPH_HEIGHT, GRAPH_X, GRAPH_Y, GRAPH_WIDTH - PR, GRAPH_HEIGHT );\n\n\t\t\tcontext.fillRect( GRAPH_X + GRAPH_WIDTH - PR, GRAPH_Y, PR, GRAPH_HEIGHT );\n\n\t\t\tcontext.fillStyle = bg;\n\t\t\tcontext.globalAlpha = 0.9;\n\t\t\tcontext.fillRect( GRAPH_X + GRAPH_WIDTH - PR, GRAPH_Y, PR, round( ( 1 - ( value / maxValue ) ) * GRAPH_HEIGHT ) );\n\n\t\t}\n\n\t};\n\n};\n\nexport default Stats;\n", "import { PerspectiveCamera, Vector3, WebGLRenderer } from \"three\";\nimport { Twisty3DScene } from \"../../3D/Twisty3DScene\";\nimport { RenderScheduler } from \"../../animation/RenderScheduler\";\nimport { ManagedCustomElement } from \"../element/ManagedCustomElement\";\nimport { pixelRatio } from \"./canvas\";\nimport { twisty3DCanvasCSS } from \"./Twisty3DCanvas.css\";\nimport { TwistyOrbitControls } from \"./TwistyOrbitControls\";\nimport { TwistyViewerElement } from \"./TwistyViewerElement\";\nimport { customElementsShim } from \"../element/node-custom-element-shims\";\nimport Stats from \"../../../../vendor/node_modules/three/examples/jsm/libs/stats.module\";\n\nlet SHOW_STATS = false;\n// Show render stats for newly contructed renderers.\nexport function experimentalShowRenderStats(show: boolean): void {\n  SHOW_STATS = show;\n}\n\nlet resizeObserverWarningShown = false;\n\nlet shareAllNewRenderers: boolean = false;\n\n// WARNING: The current shared renderer implementation is not every efficient.\n// Avoid using for players that are likely to have dimensions approaching 1 megapixel or higher.\n// TODO: use a dedicated renderer while fullscreen?\nexport function experimentalSetShareAllNewRenderers(share: boolean): void {\n  shareAllNewRenderers = share;\n}\n\nlet sharedRenderer: WebGLRenderer | null = null;\n\nfunction newRenderer(): WebGLRenderer {\n  return new WebGLRenderer({\n    antialias: true,\n    alpha: true, // TODO\n  });\n}\n\nfunction newSharedRenderer(): WebGLRenderer {\n  return sharedRenderer ?? (sharedRenderer = newRenderer());\n}\n\n// <twisty-3d-canvas>\nexport class Twisty3DCanvas\n  extends ManagedCustomElement\n  implements TwistyViewerElement {\n  private scene: Twisty3DScene;\n  public canvas: HTMLCanvasElement;\n  public camera: PerspectiveCamera;\n  private legacyExperimentalShift: number = 0;\n  private orbitControls: TwistyOrbitControls;\n  private scheduler = new RenderScheduler(this.render.bind(this));\n  private resizePending: boolean = false;\n\n  private renderer: WebGLRenderer; // TODO: share renderers across elements? (issue: renderers are not designed to be constantly resized?)\n  private rendererIsShared: boolean;\n  private canvas2DContext: CanvasRenderingContext2D;\n\n  private stats: Stats | null = null;\n\n  // TODO: Are there any render duration performance concerns with removing this?\n  #invisible: boolean = false;\n  constructor(\n    scene?: Twisty3DScene,\n    options: { cameraPosition?: Vector3; negateCameraPosition?: boolean } = {},\n  ) {\n    super();\n    this.addCSS(twisty3DCanvasCSS);\n\n    this.scene = scene!;\n    this.scene.addRenderTarget(this);\n    if (SHOW_STATS) {\n      this.stats = Stats();\n      this.stats.dom.style.position = \"absolute\";\n      this.addElement(this.stats.dom);\n    }\n\n    // We rely on the resize logic to handle renderer dimensions.\n    this.rendererIsShared = shareAllNewRenderers;\n    this.renderer = this.rendererIsShared ? newSharedRenderer() : newRenderer();\n    this.canvas = this.rendererIsShared\n      ? document.createElement(\"canvas\")\n      : this.renderer.domElement;\n    this.canvas2DContext = this.canvas.getContext(\"2d\")!; // TODO: avoid saving unneeded?\n    this.addElement(this.canvas);\n\n    this.camera = new PerspectiveCamera(\n      20,\n      1, // We rely on the resize logic to handle this.\n      0.1,\n      1000,\n    );\n    this.camera.position.copy(options.cameraPosition ?? new Vector3(2, 4, 4));\n    if (options.negateCameraPosition) {\n      this.camera.position.multiplyScalar(-1);\n    }\n    this.camera.lookAt(new Vector3(0, 0, 0)); // TODO: Handle with `negateCameraPosition`\n    this.orbitControls = new TwistyOrbitControls(\n      this.camera,\n      this.canvas,\n      this.scheduleRender.bind(this),\n    );\n\n    // TODO: Remove this when enough Safari users have `ResizeObserver`.\n    if (window.ResizeObserver) {\n      const observer = new window.ResizeObserver(this.onResize.bind(this));\n      observer.observe(this.contentWrapper);\n    } else {\n      this.scheduleRender();\n      if (!resizeObserverWarningShown) {\n        console.warn(\n          \"You are using an older browser that does not support `ResizeObserver`. Displayed puzzles will not be rescaled.\",\n        );\n        resizeObserverWarningShown = true;\n      }\n    }\n  }\n\n  public setMirror(partner: Twisty3DCanvas): void {\n    this.orbitControls.setMirror(partner.orbitControls);\n    partner.orbitControls.setMirror(this.orbitControls);\n  }\n\n  protected connectedCallback(): void {\n    // Resize as soon as we're in the DOM, to avoid a flash of incorrectly sized content.\n    this.resize();\n    this.render();\n  }\n\n  scheduleRender(): void {\n    this.scheduler.requestAnimFrame();\n  }\n\n  // If the current size/state is incorrect, it may be preferable to hide it\n  // briefly, rather than flashing an incorrect version for one frame.\n  makeInvisibleUntilRender(): void {\n    this.contentWrapper.classList.add(\"invisible\");\n    this.#invisible = true;\n  }\n\n  private render(): void {\n    // Cancel any scheduled frame, since we're rendering right now.\n    // We don't need to re-render until something schedules again.\n    this.stats?.begin();\n    this.scheduler.cancelAnimFrame();\n    if (this.resizePending) {\n      this.resize();\n    }\n    this.orbitControls.updateAndSchedule();\n\n    if (this.rendererIsShared) {\n      this.renderer.setSize(this.canvas.width, this.canvas.height, false);\n      this.canvas2DContext.clearRect(\n        0,\n        0,\n        this.canvas.width,\n        this.canvas.height,\n      );\n    }\n    this.renderer.render(this.scene, this.camera);\n    if (this.rendererIsShared) {\n      this.canvas2DContext.drawImage(this.renderer.domElement, 0, 0);\n    }\n\n    if (this.#invisible) {\n      this.contentWrapper.classList.remove(\"invisible\");\n    }\n    this.stats?.end();\n  }\n\n  private onResize(): void {\n    this.resizePending = true;\n    this.scheduleRender();\n  }\n\n  private resize(): void {\n    this.resizePending = false;\n\n    const w = this.contentWrapper.clientWidth;\n    const h = this.contentWrapper.clientHeight;\n    let off = 0;\n    if (this.legacyExperimentalShift > 0) {\n      off = Math.max(0, Math.floor((w - h) * 0.5));\n    } else if (this.legacyExperimentalShift < 0) {\n      off = -Math.max(0, Math.floor((w - h) * 0.5));\n    }\n    let yoff = 0;\n    let excess = 0;\n    if (h > w) {\n      excess = h - w;\n      yoff = -Math.floor(0.5 * excess);\n    }\n    this.camera.aspect = w / h;\n    this.camera.setViewOffset(w, h - excess, off, yoff, w, h);\n    this.camera.updateProjectionMatrix(); // TODO\n\n    if (this.rendererIsShared) {\n      this.canvas.width = w * pixelRatio();\n      this.canvas.height = h * pixelRatio();\n      this.canvas.style.width = w.toString();\n      this.canvas.style.height = w.toString();\n    } else {\n      this.renderer.setPixelRatio(pixelRatio());\n      this.renderer.setSize(w, h, true);\n    }\n\n    this.scheduleRender();\n  }\n\n  // Square crop is useful for rending icons.\n  renderToDataURL(options: { squareCrop?: boolean } = {}): string {\n    // We don't preserve the drawing buffer, so we have to render again and then immediately read the canvas data.\n    // https://stackoverflow.com/a/30647502\n    this.render();\n\n    // TODO: can we assume that a central crop is similar enough to how a square canvas render would loook?\n    if (!options.squareCrop || this.canvas.width === this.canvas.height) {\n      // TODO: is this such an uncommon path taht we can skip it?\n      return this.canvas.toDataURL();\n    } else {\n      const tempCanvas = document.createElement(\"canvas\");\n      const squareSize = Math.min(this.canvas.width, this.canvas.height);\n      tempCanvas.width = squareSize;\n      tempCanvas.height = squareSize;\n      const tempCtx = tempCanvas.getContext(\"2d\")!; // TODO: can we assume this is always availab?E\n      tempCtx.drawImage(\n        this.canvas,\n        -(this.canvas.width - squareSize) / 2,\n        -(this.canvas.height - squareSize) / 2,\n      );\n      return tempCanvas.toDataURL();\n    }\n  }\n}\n\ncustomElementsShim.define(\"twisty-3d-canvas\", Twisty3DCanvas);\n", "import {\n  BlockMove,\n  Commutator,\n  Conjugate,\n  Pause,\n  Group,\n  NewLine,\n  Comment,\n  Sequence,\n  TraversalUp,\n} from \"../../src/cubing/alg/index\";\n\n/*\n *   For movecount, that understands puzzle rotations.  This code\n *   should be moved to the alg class, probably.\n */\nclass MoveCounter extends TraversalUp<number> {\n  constructor(private metric: (move: BlockMove) => number) {\n    super();\n  }\n\n  public traverseSequence(sequence: Sequence): number {\n    let r = 0;\n    for (let i = 0; i < sequence.nestedUnits.length; i++) {\n      r += this.traverse(sequence.nestedUnits[i]);\n    }\n    return r;\n  }\n\n  public traverseGroup(group: Group): number {\n    return this.traverse(group.nestedSequence) * Math.abs(group.amount);\n  }\n\n  public traverseBlockMove(move: BlockMove): number {\n    return this.metric(move);\n  }\n\n  public traverseCommutator(commutator: Commutator): number {\n    return (\n      Math.abs(commutator.amount) *\n      2 *\n      (this.traverse(commutator.A) + this.traverse(commutator.B))\n    );\n  }\n\n  public traverseConjugate(conjugate: Conjugate): number {\n    return (\n      Math.abs(conjugate.amount) *\n      (2 * this.traverse(conjugate.A) + this.traverse(conjugate.B))\n    );\n  }\n\n  // TODO: Remove spaces between repeated pauses (in traverseSequence)\n  public traversePause(_pause: Pause): number {\n    return 0;\n  }\n\n  public traverseNewLine(_newLine: NewLine): number {\n    return 0;\n  }\n\n  // TODO: Enforce being followed by a newline (or the end of the alg)?\n  public traverseComment(_comment: Comment): number {\n    return 0;\n  }\n}\n\nfunction isCharUppercase(c: string): boolean {\n  return \"A\" <= c && c <= \"Z\";\n}\n\nfunction baseMetric(move: BlockMove): number {\n  const fam = move.family;\n  if (\n    (isCharUppercase(fam[0]) && fam[fam.length - 1] === \"v\") ||\n    fam === \"x\" ||\n    fam === \"y\" ||\n    fam === \"z\"\n  ) {\n    return 0;\n  } else {\n    return 1;\n  }\n}\n\nconst baseCounter = new MoveCounter(baseMetric);\nexport const countMoves = baseCounter.traverse.bind(baseCounter);\n", "import {\n  BackSide,\n  BoxGeometry,\n  DoubleSide,\n  Euler,\n  Group,\n  Matrix4,\n  Mesh,\n  MeshBasicMaterial,\n  Object3D,\n  PlaneGeometry,\n  Quaternion,\n  Vector3,\n} from \"three\";\nimport { BlockMove } from \"../../../alg\";\nimport { Puzzles, Transformation } from \"../../../kpuzzle\";\nimport { AlgCursor } from \"../../animation/alg/AlgCursor\";\nimport { PuzzlePosition } from \"../../animation/alg/CursorTypes\";\nimport { smootherStep } from \"../../animation/easing\";\nimport {\n  ExperimentalStickering,\n  experimentalStickerings,\n  HintFaceletStyle,\n  hintFaceletStyles,\n} from \"../../dom/TwistyPlayerConfig\";\nimport { TAU } from \"../TAU\";\nimport { FaceletMeshAppearance, PuzzleAppearance } from \"./appearance\";\nimport { stickerings } from \"./stickerings\";\nimport { Twisty3DPuzzle } from \"./Twisty3DPuzzle\";\n\nconst ignoredMaterial = new MeshBasicMaterial({\n  color: 0x444444,\n  side: DoubleSide,\n});\n\nconst ignoredMaterialHint = new MeshBasicMaterial({\n  color: 0xcccccc,\n  side: BackSide,\n});\n\nconst invisibleMaterial = new MeshBasicMaterial({\n  visible: false,\n});\n\nconst orientedMaterial = new MeshBasicMaterial({\n  color: 0xff88ff,\n});\n\nconst orientedMaterialHint = new MeshBasicMaterial({\n  color: 0xff88ff,\n  side: BackSide,\n});\n\ninterface MaterialMap extends Record<FaceletMeshAppearance, MeshBasicMaterial> {\n  regular: MeshBasicMaterial;\n  dim: MeshBasicMaterial;\n  ignored: MeshBasicMaterial;\n  invisible: MeshBasicMaterial;\n}\n\nclass AxisInfo {\n  public stickerMaterial: MaterialMap;\n  public hintStickerMaterial: MaterialMap;\n  constructor(\n    public vector: Vector3,\n    public fromZ: Euler,\n    public color: number,\n    public dimColor: number,\n  ) {\n    // TODO: Make sticker material single-sided when cubie foundation is opaque?\n    this.stickerMaterial = {\n      regular: new MeshBasicMaterial({\n        color,\n        side: DoubleSide,\n      }),\n      dim: new MeshBasicMaterial({\n        color: dimColor,\n        side: DoubleSide,\n      }),\n      oriented: orientedMaterial,\n      ignored: ignoredMaterial,\n      invisible: invisibleMaterial,\n    };\n    this.hintStickerMaterial = {\n      regular: new MeshBasicMaterial({\n        color,\n        side: BackSide,\n      }),\n      dim: new MeshBasicMaterial({\n        color: dimColor,\n        side: BackSide,\n        transparent: true,\n        opacity: 0.75,\n      }),\n      oriented: orientedMaterialHint,\n      ignored: ignoredMaterialHint,\n      invisible: invisibleMaterial,\n    };\n  }\n}\n\nconst axesInfo: AxisInfo[] = [\n  new AxisInfo(\n    new Vector3(0, 1, 0),\n    new Euler(-TAU / 4, 0, 0),\n    0xffffff,\n    0xdddddd,\n  ),\n  new AxisInfo(\n    new Vector3(-1, 0, 0),\n    new Euler(0, -TAU / 4, 0),\n    0xff8800,\n    0x884400,\n  ),\n  new AxisInfo(new Vector3(0, 0, 1), new Euler(0, 0, 0), 0x00ff00, 0x008800),\n  new AxisInfo(\n    new Vector3(1, 0, 0),\n    new Euler(0, TAU / 4, 0),\n    0xff0000,\n    0x660000,\n  ),\n  new AxisInfo(\n    new Vector3(0, 0, -1),\n    new Euler(0, TAU / 2, 0),\n    0x0000ff,\n    0x000088,\n  ),\n  new AxisInfo(\n    new Vector3(0, -1, 0),\n    new Euler(TAU / 4, 0, 0),\n    0xffff00,\n    0x888800,\n  ),\n];\n\nconst face: { [s: string]: number } = {\n  U: 0,\n  L: 1,\n  F: 2,\n  R: 3,\n  B: 4,\n  D: 5,\n};\n\nconst familyToAxis: { [s: string]: number } = {\n  U: face.U,\n  u: face.U,\n  y: face.U,\n  L: face.L,\n  l: face.L,\n  M: face.L,\n  F: face.F,\n  f: face.F,\n  S: face.F,\n  z: face.F,\n  R: face.R,\n  r: face.R,\n  x: face.R,\n  B: face.B,\n  b: face.B,\n  D: face.D,\n  d: face.D,\n  E: face.D,\n};\n\nconst cubieDimensions = {\n  stickerWidth: 0.85,\n  stickerElevation: 0.501,\n  foundationWidth: 1,\n  hintStickerElevation: 1.45,\n};\n\ntype OptionKey = \"showMainStickers\" | \"hintFacelets\" | \"showFoundation\";\n\ninterface Cube3DOptions {\n  showMainStickers?: boolean;\n  hintFacelets?: HintFaceletStyle;\n  showFoundation?: boolean; // TODO: better name\n  experimentalStickering?: ExperimentalStickering;\n}\n\nconst cube3DOptionsDefaults: Cube3DOptions = {\n  showMainStickers: true,\n  hintFacelets: \"floating\",\n  showFoundation: true,\n  experimentalStickering: \"full\",\n};\n\n// TODO: Make internal foundation faces one-sided, facing to the outside of the cube.\nconst blackMesh = new MeshBasicMaterial({\n  color: 0x000000,\n  opacity: 0.3,\n  transparent: true,\n});\n\nclass CubieDef {\n  public matrix: Matrix4;\n  public stickerFaces: number[];\n  // stickerFaceNames can be e.g. [\"U\", \"F\", \"R\"], \"UFR\" if every face is a single letter.\n  constructor(\n    public orbit: string,\n    stickerFaceNames: string[] | string,\n    q: Quaternion,\n  ) {\n    const individualStickerFaceNames =\n      typeof stickerFaceNames === \"string\"\n        ? stickerFaceNames.split(\"\")\n        : stickerFaceNames;\n    this.stickerFaces = individualStickerFaceNames.map((s) => face[s]);\n    this.matrix = new Matrix4();\n    this.matrix.setPosition(firstPiecePosition[orbit]);\n    this.matrix.premultiply(new Matrix4().makeRotationFromQuaternion(q));\n  }\n}\n\nfunction t(v: Vector3, t4: number): Quaternion {\n  return new Quaternion().setFromAxisAngle(v, (TAU * t4) / 4);\n}\n\nconst r = {\n  O: new Vector3(0, 0, 0),\n  U: new Vector3(0, -1, 0),\n  L: new Vector3(1, 0, 0),\n  F: new Vector3(0, 0, -1),\n  R: new Vector3(-1, 0, 0),\n  B: new Vector3(0, 0, 1),\n  D: new Vector3(0, 1, 0),\n};\n\ninterface OrbitIndexed<T> {\n  [s: string]: T;\n}\ntype PieceIndexed<T> = OrbitIndexed<T[]>;\n\nconst firstPiecePosition: OrbitIndexed<Vector3> = {\n  EDGES: new Vector3(0, 1, 1),\n  CORNERS: new Vector3(1, 1, 1),\n  CENTERS: new Vector3(0, 1, 0),\n};\nconst orientationRotation: OrbitIndexed<Matrix4[]> = {\n  EDGES: [0, 1].map((i) =>\n    new Matrix4().makeRotationAxis(\n      firstPiecePosition.EDGES.clone().normalize(),\n      (-i * TAU) / 2,\n    ),\n  ),\n  CORNERS: [0, 1, 2].map((i) =>\n    new Matrix4().makeRotationAxis(\n      firstPiecePosition.CORNERS.clone().normalize(),\n      (-i * TAU) / 3,\n    ),\n  ),\n  CENTERS: [0, 1, 2, 3].map((i) =>\n    new Matrix4().makeRotationAxis(\n      firstPiecePosition.CENTERS.clone().normalize(),\n      (-i * TAU) / 4,\n    ),\n  ),\n};\nconst cubieStickerOrder = [face.U, face.F, face.R];\n\nconst pieceDefs: PieceIndexed<CubieDef> = {\n  EDGES: [\n    new CubieDef(\"EDGES\", \"UF\", t(r.O, 0)),\n    new CubieDef(\"EDGES\", \"UR\", t(r.U, 3)),\n    new CubieDef(\"EDGES\", \"UB\", t(r.U, 2)),\n    new CubieDef(\"EDGES\", \"UL\", t(r.U, 1)),\n    new CubieDef(\"EDGES\", \"DF\", t(r.F, 2)),\n    new CubieDef(\"EDGES\", \"DR\", t(r.F, 2).premultiply(t(r.D, 1))),\n    new CubieDef(\"EDGES\", \"DB\", t(r.F, 2).premultiply(t(r.D, 2))),\n    new CubieDef(\"EDGES\", \"DL\", t(r.F, 2).premultiply(t(r.D, 3))),\n    new CubieDef(\"EDGES\", \"FR\", t(r.U, 3).premultiply(t(r.R, 3))),\n    new CubieDef(\"EDGES\", \"FL\", t(r.U, 1).premultiply(t(r.R, 3))),\n    new CubieDef(\"EDGES\", \"BR\", t(r.U, 3).premultiply(t(r.R, 1))),\n    new CubieDef(\"EDGES\", \"BL\", t(r.U, 1).premultiply(t(r.R, 1))),\n  ],\n  CORNERS: [\n    new CubieDef(\"CORNERS\", \"UFR\", t(r.O, 0)),\n    new CubieDef(\"CORNERS\", \"URB\", t(r.U, 3)),\n    new CubieDef(\"CORNERS\", \"UBL\", t(r.U, 2)),\n    new CubieDef(\"CORNERS\", \"ULF\", t(r.U, 1)),\n    new CubieDef(\"CORNERS\", \"DRF\", t(r.F, 2).premultiply(t(r.D, 1))),\n    new CubieDef(\"CORNERS\", \"DFL\", t(r.F, 2).premultiply(t(r.D, 0))),\n    new CubieDef(\"CORNERS\", \"DLB\", t(r.F, 2).premultiply(t(r.D, 3))),\n    new CubieDef(\"CORNERS\", \"DBR\", t(r.F, 2).premultiply(t(r.D, 2))),\n  ],\n  CENTERS: [\n    new CubieDef(\"CENTERS\", \"U\", t(r.O, 0)),\n    new CubieDef(\"CENTERS\", \"L\", t(r.R, 3).premultiply(t(r.U, 1))),\n    new CubieDef(\"CENTERS\", \"F\", t(r.R, 3)),\n    new CubieDef(\"CENTERS\", \"R\", t(r.R, 3).premultiply(t(r.D, 1))),\n    new CubieDef(\"CENTERS\", \"B\", t(r.R, 3).premultiply(t(r.D, 2))),\n    new CubieDef(\"CENTERS\", \"D\", t(r.R, 2)),\n  ],\n};\n\nconst CUBE_SCALE = 1 / 3;\n\ninterface FaceletInfo {\n  faceIdx: number;\n  facelet: Mesh;\n  hintFacelet?: Mesh;\n}\n\n// TODO: Split into \"scene model\" and \"view\".\nexport class Cube3D extends Object3D implements Twisty3DPuzzle {\n  kpuzzleFaceletInfo: Record<string, FaceletInfo[][]>;\n  private pieces: PieceIndexed<Object3D> = {};\n  private options: Cube3DOptions;\n  // TODO: Keep track of option-based meshes better.\n  private experimentalHintStickerMeshes: Mesh[] = [];\n  private experimentalFoundationMeshes: Mesh[] = [];\n  constructor(\n    cursor?: AlgCursor,\n    private scheduleRenderCallback?: () => void,\n    options: Cube3DOptions = {},\n  ) {\n    super();\n\n    const def = Puzzles[\"3x3x3\"];\n\n    this.options = {};\n    for (const key in cube3DOptionsDefaults) {\n      // TODO:Don't use `any`.\n      this.options[key as OptionKey] =\n        key in options\n          ? (options as any)[key]\n          : (cube3DOptionsDefaults as any)[key];\n    }\n\n    if (def.name !== \"3x3x3\") {\n      throw new Error(\"Invalid puzzle for this Cube3D implementation.\");\n    }\n    this.kpuzzleFaceletInfo = {};\n    for (const orbit in pieceDefs) {\n      const orbitFaceletInfo: FaceletInfo[][] = [];\n      this.kpuzzleFaceletInfo[orbit] = orbitFaceletInfo;\n      this.pieces[orbit] = pieceDefs[orbit].map(\n        this.createCubie.bind(this, orbitFaceletInfo),\n      );\n    }\n    this.scale.set(CUBE_SCALE, CUBE_SCALE, CUBE_SCALE);\n\n    // TODO: Can we construct this directly instead of applying it later? Would that be more code-efficient?\n    if (options.experimentalStickering) {\n      this.setAppearance(stickerings[options.experimentalStickering]);\n    }\n\n    cursor!.addPositionListener(this);\n  }\n\n  setAppearance(appearance: PuzzleAppearance): void {\n    for (const [orbitName, orbitAppearance] of Object.entries(\n      appearance.orbits,\n    )) {\n      for (\n        let pieceIdx = 0;\n        pieceIdx < orbitAppearance.pieces.length;\n        pieceIdx++\n      ) {\n        const pieceAppearance = orbitAppearance.pieces[pieceIdx];\n        if (pieceAppearance) {\n          const pieceInfo = this.kpuzzleFaceletInfo[orbitName][pieceIdx];\n          for (\n            let faceletIdx = 0;\n            faceletIdx < pieceInfo.length;\n            faceletIdx++\n          ) {\n            const faceletAppearance = pieceAppearance.facelets[faceletIdx];\n            if (faceletAppearance) {\n              const faceletInfo = pieceInfo[faceletIdx];\n\n              const appearance =\n                typeof faceletAppearance === \"string\"\n                  ? faceletAppearance\n                  : faceletAppearance?.appearance;\n\n              faceletInfo.facelet.material =\n                axesInfo[faceletInfo.faceIdx].stickerMaterial[appearance];\n              // TODO\n              const hintAppearance =\n                typeof faceletAppearance === \"string\"\n                  ? appearance\n                  : faceletAppearance.hintAppearance ?? appearance;\n              if (faceletInfo.hintFacelet) {\n                faceletInfo.hintFacelet.material =\n                  axesInfo[faceletInfo.faceIdx].hintStickerMaterial[\n                    hintAppearance\n                  ];\n              }\n            }\n          }\n        }\n      }\n    }\n    if (this.scheduleRenderCallback) {\n      this.scheduleRenderCallback();\n    }\n  }\n\n  /** @deprecated */\n  public experimentalUpdateOptions(options: Cube3DOptions): void {\n    if (\"showMainStickers\" in options) {\n      throw new Error(\"Unimplemented\");\n    }\n\n    const showFoundation = options.showFoundation;\n    if (\n      typeof showFoundation !== \"undefined\" &&\n      this.options.showFoundation !== showFoundation\n    ) {\n      this.options.showFoundation = showFoundation;\n      for (const foundation of this.experimentalFoundationMeshes) {\n        foundation.visible = showFoundation;\n      }\n    }\n\n    const hintFacelets = options.hintFacelets;\n    if (\n      typeof hintFacelets !== \"undefined\" &&\n      this.options.hintFacelets !== hintFacelets &&\n      hintFaceletStyles[hintFacelets] // TODO: test this\n    ) {\n      this.options.hintFacelets = hintFacelets;\n      for (const hintSticker of this.experimentalHintStickerMeshes) {\n        hintSticker.visible = hintFacelets === \"floating\";\n      }\n      this.scheduleRenderCallback!(); // TODO\n    }\n\n    const experimentalStickering = options.experimentalStickering;\n    if (\n      typeof experimentalStickering !== \"undefined\" &&\n      this.options.experimentalStickering !== experimentalStickering &&\n      experimentalStickerings[experimentalStickering] // TODO: test this\n    ) {\n      this.options.experimentalStickering = experimentalStickering;\n      this.setAppearance(stickerings[experimentalStickering]);\n      this.scheduleRenderCallback!(); // TODO\n    }\n  }\n\n  public onPositionChange(p: PuzzlePosition): void {\n    const reid333 = p.state as Transformation;\n    for (const orbit in pieceDefs) {\n      const pieces = pieceDefs[orbit];\n      for (let i = 0; i < pieces.length; i++) {\n        const j = reid333[orbit].permutation[i];\n        this.pieces[orbit][j].matrix.copy(pieceDefs[orbit][i].matrix);\n        this.pieces[orbit][j].matrix.multiply(\n          orientationRotation[orbit][reid333[orbit].orientation[i]],\n        );\n      }\n      for (const moveProgress of p.movesInProgress) {\n        const blockMove = moveProgress.move as BlockMove;\n        const turnNormal = axesInfo[familyToAxis[blockMove.family]].vector;\n        const moveMatrix = new Matrix4().makeRotationAxis(\n          turnNormal,\n          (-this.ease(moveProgress.fraction) *\n            moveProgress.direction *\n            blockMove.amount *\n            TAU) /\n            4,\n        );\n        for (let i = 0; i < pieces.length; i++) {\n          const k =\n            Puzzles[\"3x3x3\"].moves[blockMove.family][orbit].permutation[i];\n          if (\n            i !== k ||\n            Puzzles[\"3x3x3\"].moves[blockMove.family][orbit].orientation[i] !== 0\n          ) {\n            const j = reid333[orbit].permutation[i];\n            this.pieces[orbit][j].matrix.premultiply(moveMatrix);\n          }\n        }\n      }\n    }\n    this.scheduleRenderCallback!();\n  }\n\n  // TODO: Always create (but sometimes hide parts) so we can show them later,\n  // or (better) support creating puzzle parts on demand.\n  private createCubie(\n    orbitFacelets: FaceletInfo[][],\n    piece: CubieDef,\n  ): Object3D {\n    const cubieFaceletInfo: FaceletInfo[] = [];\n    orbitFacelets.push(cubieFaceletInfo);\n    const cubie = new Group();\n    if (this.options.showFoundation) {\n      const foundation = this.createCubieFoundation();\n      cubie.add(foundation);\n      this.experimentalFoundationMeshes.push(foundation);\n    }\n    for (let i = 0; i < piece.stickerFaces.length; i++) {\n      const sticker = this.createSticker(\n        axesInfo[cubieStickerOrder[i]],\n        axesInfo[piece.stickerFaces[i]],\n        false,\n      );\n      const faceletInfo: FaceletInfo = {\n        faceIdx: piece.stickerFaces[i],\n        facelet: sticker,\n      };\n      cubie.add(sticker);\n      if (this.options.hintFacelets === \"floating\") {\n        const hintSticker = this.createSticker(\n          axesInfo[cubieStickerOrder[i]],\n          axesInfo[piece.stickerFaces[i]],\n          true,\n        );\n        cubie.add(hintSticker);\n        faceletInfo.hintFacelet = hintSticker;\n        this.experimentalHintStickerMeshes.push(hintSticker);\n      }\n\n      cubieFaceletInfo.push(faceletInfo);\n    }\n    cubie.matrix.copy(piece.matrix);\n    cubie.matrixAutoUpdate = false;\n    this.add(cubie);\n    return cubie;\n  }\n\n  // TODO: Support creating only the outward-facing parts?\n  private createCubieFoundation(): Mesh {\n    const box = new BoxGeometry(\n      cubieDimensions.foundationWidth,\n      cubieDimensions.foundationWidth,\n      cubieDimensions.foundationWidth,\n    );\n    return new Mesh(box, blackMesh);\n  }\n\n  private createSticker(\n    posAxisInfo: AxisInfo,\n    materialAxisInfo: AxisInfo,\n    isHint: boolean,\n  ): Mesh {\n    const geo = new PlaneGeometry(\n      cubieDimensions.stickerWidth,\n      cubieDimensions.stickerWidth,\n    );\n    const stickerMesh = new Mesh(\n      geo,\n      isHint\n        ? materialAxisInfo.hintStickerMaterial.regular\n        : materialAxisInfo.stickerMaterial.regular,\n    );\n    stickerMesh.setRotationFromEuler(posAxisInfo.fromZ);\n    stickerMesh.position.copy(posAxisInfo.vector);\n    stickerMesh.position.multiplyScalar(\n      isHint\n        ? cubieDimensions.hintStickerElevation\n        : cubieDimensions.stickerElevation,\n    );\n    return stickerMesh;\n  }\n\n  private ease(fraction: number): number {\n    return smootherStep(fraction);\n  }\n}\n", "export function smootherStep(x: number): number {\n  return x * x * x * (10 - x * (15 - 6 * x));\n}\n", "import { Vector3 } from \"three\";\nimport { Sequence } from \"../../alg\";\nimport {\n  AlgAttribute,\n  StringEnumAttribute,\n  Vector3Attribute,\n} from \"./element/ElementConfig\";\nimport type { TwistyPlayer } from \"./TwistyPlayer\";\nimport { BackViewLayout, backViewLayouts } from \"./viewers/TwistyViewerWrapper\";\n\nconst DEFAULT_CAMERA_Z = 5;\n// Golden ratio is perfect for FTO and Megaminx.\nconst DEFAULT_CAMERA_Y = DEFAULT_CAMERA_Z * (2 / (1 + Math.sqrt(5)));\n\nexport const centeredCameraPosition = new Vector3(\n  0,\n  DEFAULT_CAMERA_Y,\n  DEFAULT_CAMERA_Z,\n);\n\n// TODO\nexport const cubeCameraPosition = new Vector3(3, 4, 5);\n\n// TODO: turn these maps into lists?\nexport const visualizationFormats = {\n  \"3D\": true, // default\n  \"2D\": true,\n  \"PG3D\": true,\n};\nexport type VisualizationFormat = keyof typeof visualizationFormats;\n\nexport const backgroundThemes = {\n  checkered: true, // default\n  none: true,\n};\nexport type BackgroundTheme = keyof typeof backgroundThemes;\n\n// TODO: turn these maps into lists?\nexport const hintFaceletStyles = {\n  floating: true, // default\n  none: true,\n};\nexport type HintFaceletStyle = keyof typeof hintFaceletStyles;\n\n// TODO: turn these maps into lists?\n// TODO: alg.cubing.net parity\nexport const experimentalStickerings = {\n  \"full\": true, // default\n  \"centers-only\": true, // TODO\n  \"PLL\": true,\n  \"CLS\": true,\n  \"OLL\": true,\n  \"ELS\": true,\n  \"LL\": true,\n  \"F2L\": true,\n  \"ZBLL\": true,\n  \"ZBLS\": true,\n  \"WVLS\": true,\n  \"VLS\": true,\n  \"LS\": true,\n  \"EO\": true,\n  \"CMLL\": true,\n  \"L6E\": true,\n  \"L6EO\": true,\n  \"Daisy\": true,\n  \"Cross\": true,\n  \"2x2x2\": true,\n  \"2x2x3\": true,\n  \"Void Cube\": true,\n};\nexport type ExperimentalStickering = keyof typeof experimentalStickerings;\n\nexport const controlsLocations = {\n  \"bottom-row\": true, // default\n  \"none\": true,\n};\nexport type ControlsLocation = keyof typeof controlsLocations;\n\nexport const puzzleIDs = {\n  \"3x3x3\": true, // default\n  \"custom\": true,\n  \"2x2x2\": true,\n  \"4x4x4\": true,\n  \"5x5x5\": true,\n  \"6x6x6\": true,\n  \"7x7x7\": true,\n  \"megaminx\": true,\n  \"pyraminx\": true,\n  \"sq1\": true,\n  \"clock\": true,\n  \"skewb\": true,\n  \"FTO\": true,\n};\nexport type PuzzleID = keyof typeof puzzleIDs;\n\n// TODO: templatize\nexport interface ManagedAttribute<K> {\n  string: string;\n  value: K;\n  setString(s: string): boolean;\n  setValue(v: K): boolean;\n}\n\ntype AnyManagedAttribute = ManagedAttribute<any>;\n\ninterface TwistyPlayerAttributes extends Record<string, AnyManagedAttribute> {\n  // Alg\n  \"alg\": AlgAttribute;\n  \"experimental-start-setup\": AlgAttribute;\n\n  // Puzzle\n  \"puzzle\": StringEnumAttribute<PuzzleID>;\n  \"visualization\": StringEnumAttribute<VisualizationFormat>;\n  \"hint-facelets\": StringEnumAttribute<HintFaceletStyle>;\n  \"experimental-stickering\": StringEnumAttribute<ExperimentalStickering>;\n\n  // Background\n  \"background\": StringEnumAttribute<BackgroundTheme>;\n  \"controls\": StringEnumAttribute<ControlsLocation>;\n\n  // 3D config\n  \"back-view\": StringEnumAttribute<BackViewLayout>;\n  \"camera-position\": Vector3Attribute;\n}\n\nexport interface TwistyPlayerConfigValues {\n  alg: Sequence;\n  experimentalStartSetup: Sequence;\n\n  puzzle: PuzzleID;\n  visualization: VisualizationFormat;\n  hintFacelets: HintFaceletStyle;\n  experimentalStickering: ExperimentalStickering;\n\n  background: BackgroundTheme;\n  controls: ControlsLocation;\n\n  backView: BackViewLayout;\n  cameraPosition: Vector3;\n}\n\nexport type TwistyPlayerInitialConfig = Partial<TwistyPlayerConfigValues>;\n\nconst twistyPlayerAttributeMap: Record<\n  keyof TwistyPlayerAttributes,\n  keyof TwistyPlayerConfigValues\n> = {\n  \"alg\": \"alg\",\n  \"experimental-start-setup\": \"experimentalStartSetup\",\n\n  \"puzzle\": \"puzzle\",\n  \"visualization\": \"visualization\",\n  \"hint-facelets\": \"hintFacelets\",\n  \"experimental-stickering\": \"experimentalStickering\",\n\n  \"background\": \"background\",\n  \"controls\": \"controls\",\n\n  \"back-view\": \"backView\",\n  \"camera-position\": \"cameraPosition\",\n};\n\n// TODO: Can we avoid instantiating a new class for ech attribute, and would it help performance?\nexport class TwistyPlayerConfig {\n  attributes: TwistyPlayerAttributes;\n  constructor(\n    private twistyPlayer: TwistyPlayer, // TODO\n    initialValues: TwistyPlayerInitialConfig,\n  ) {\n    this.attributes = {\n      \"alg\": new AlgAttribute(initialValues.alg),\n      \"experimental-start-setup\": new AlgAttribute(\n        initialValues.experimentalStartSetup,\n      ),\n\n      \"puzzle\": new StringEnumAttribute(puzzleIDs, initialValues.puzzle),\n      \"visualization\": new StringEnumAttribute(\n        visualizationFormats,\n        initialValues.visualization,\n      ),\n      \"hint-facelets\": new StringEnumAttribute(\n        hintFaceletStyles,\n        initialValues.hintFacelets,\n      ),\n      \"experimental-stickering\": new StringEnumAttribute(\n        experimentalStickerings,\n        initialValues.experimentalStickering,\n      ),\n\n      \"background\": new StringEnumAttribute(\n        backgroundThemes,\n        initialValues.background,\n      ),\n      \"controls\": new StringEnumAttribute(\n        controlsLocations,\n        initialValues.controls,\n      ),\n      \"back-view\": new StringEnumAttribute(\n        backViewLayouts,\n        initialValues[\"backView\"],\n      ),\n      \"camera-position\": new Vector3Attribute(\n        null,\n        initialValues[\"cameraPosition\"],\n      ),\n    };\n  }\n\n  static get observedAttributes(): (keyof TwistyPlayerAttributes & string)[] {\n    return Object.keys(twistyPlayerAttributeMap);\n  }\n\n  attributeChangedCallback(\n    attributeName: string,\n    oldValue: string,\n    newValue: string,\n  ): void {\n    const managedAttribute = this.attributes[attributeName];\n    if (managedAttribute) {\n      // TODO: Handle `null` better.\n      if (oldValue !== null && managedAttribute.string !== oldValue) {\n        console.warn(\n          \"Attribute out of sync!\",\n          attributeName,\n          managedAttribute.string,\n          oldValue,\n        );\n      }\n      managedAttribute.setString(newValue);\n\n      // TODO: can we make this type-safe?\n      // TODO: avoid double-setting in recursive calls\n      const propertyName: keyof TwistyPlayerConfigValues =\n        twistyPlayerAttributeMap[attributeName];\n      // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n      // @ts-ignore\n      this.twistyPlayer[propertyName] = managedAttribute.value;\n    }\n  }\n}\n", "// // type ConfigAttributes = Record<string, any>;\n\nimport { Vector3 } from \"three\";\nimport { algToString, parse, Sequence } from \"../../../alg\";\n\nexport class AlgAttribute {\n  string: string;\n  value: Sequence;\n  constructor(initialValue?: Sequence) {\n    this.setValue(initialValue ?? this.defaultValue());\n  }\n\n  // Return value indicates if the attribute changed.\n  setString(str: string): boolean {\n    if (this.string === str) {\n      return false;\n    }\n    this.string = str;\n    this.value = this.toValue(str);\n    return true;\n  }\n\n  // Return value indicates if the attribute changed.\n  setValue(val: Sequence): boolean {\n    const str = this.toString(val);\n    if (this.string === str) {\n      return false;\n    }\n    this.string = str;\n    this.value = val;\n    return true;\n  }\n\n  private defaultValue(): Sequence {\n    return new Sequence([]);\n  }\n\n  private toValue(s: string): Sequence {\n    return parse(s);\n  }\n\n  private toString(s: Sequence): string {\n    return algToString(s);\n  }\n}\n\n// TODO: subset of string rather than `extends`\nexport class StringEnumAttribute<E extends string> {\n  string: string;\n  value: E;\n  valid: boolean;\n  constructor(private enumVal: { [key: string]: boolean }, initialValue?: E) {\n    this.setString(initialValue ?? this.defaultValue());\n  }\n\n  // Return value indicates if the attribute changed.\n  setString(str: string): boolean {\n    if (this.string === str) {\n      return false;\n    }\n    if (!(str in this.enumVal)) {\n      throw new Error(`Invalid string for attribute!: ${str}`);\n    }\n    this.string = str;\n    this.value = this.toValue(str);\n    return true;\n  }\n\n  // Return value indicates if the attribute changed.\n  setValue(val: string): boolean {\n    return this.setString(val);\n  }\n\n  private defaultValue(): string {\n    return Object.keys(this.enumVal)[0]; // TODO\n  }\n\n  private toValue(s: string): E {\n    return s as E;\n  }\n\n  // private toString(s: string): string {\n  //   return s;\n  // }\n}\n\n// TODO: subset of string rather than `extends`\nexport class StringFakeEnumAttribute<E extends string> {\n  string: string;\n  value: E;\n  valid: boolean;\n  constructor(private validStrings: string[], initialValue?: E) {\n    this.setString(initialValue ?? this.defaultValue());\n  }\n\n  // Return value indicates if the attribute changed.\n  setString(str: string): boolean {\n    if (this.string === str) {\n      return false;\n    }\n    if (!this.validStrings.includes(str)) {\n      throw new Error(`Invalid string for attribute!: ${str}`);\n    }\n    this.string = str;\n    this.value = this.toValue(str);\n    return true;\n  }\n\n  // Return value indicates if the attribute changed.\n  setValue(val: string): boolean {\n    return this.setString(val);\n  }\n\n  private defaultValue(): string {\n    return this.validStrings[0];\n  }\n\n  private toValue(s: string): E {\n    return s as E;\n  }\n\n  // private toString(s: string): string {\n  //   return s;\n  // }\n}\n\nexport class Vector3Attribute {\n  string: string;\n  value: Vector3 | null;\n  #defaultValue: Vector3 | null;\n  constructor(defaultValue: Vector3 | null, initialValue?: Vector3 | null) {\n    this.#defaultValue = defaultValue;\n    this.setValue(initialValue ?? this.defaultValue());\n  }\n\n  // Return value indicates if the attribute changed.\n  setString(str: string): boolean {\n    return this.setValue(str === \"\" ? null : this.toValue(str)); // TODO: test empty string\n  }\n\n  // Return value indicates if the attribute changed.\n  setValue(val: Vector3 | null): boolean {\n    const str = this.toString(val);\n    if (this.string === str) {\n      return false;\n    }\n    this.string = str;\n    this.value = val;\n    return true;\n  }\n\n  private defaultValue(): Vector3 | null {\n    return this.#defaultValue;\n  }\n\n  private toValue(s: string): Vector3 | null {\n    if (!s.startsWith(\"[\")) {\n      throw new Error(\"TODO\");\n    }\n    if (!s.endsWith(\"]\")) {\n      throw new Error(\"TODO\");\n    }\n    const coords = s.slice(1, s.length - 1).split(\",\");\n    if (coords.length !== 3) {\n      throw new Error(\"TODO\");\n    }\n    const [x, y, z] = coords.map((c) => parseInt(c, 10));\n    return new Vector3(x, y, z);\n  }\n\n  private toString(v: Vector3 | null): string {\n    return v ? `[${v.x}, ${v.y}, ${v.z}]` : \"\"; // TODO: empty string is not null\n  }\n}\n", "// // type ConfigAttributes = Record<string, any>;\n\nimport { Vector3 } from \"three\";\nimport { algToString, parse, Sequence } from \"../../../alg\";\n\nexport class AlgAttribute {\n  string: string;\n  value: Sequence;\n  constructor(initialValue?: Sequence) {\n    this.setValue(initialValue ?? this.defaultValue());\n  }\n\n  // Return value indicates if the attribute changed.\n  setString(str: string): boolean {\n    if (this.string === str) {\n      return false;\n    }\n    this.string = str;\n    this.value = this.toValue(str);\n    return true;\n  }\n\n  // Return value indicates if the attribute changed.\n  setValue(val: Sequence): boolean {\n    const str = this.toString(val);\n    if (this.string === str) {\n      return false;\n    }\n    this.string = str;\n    this.value = val;\n    return true;\n  }\n\n  private defaultValue(): Sequence {\n    return new Sequence([]);\n  }\n\n  private toValue(s: string): Sequence {\n    return parse(s);\n  }\n\n  private toString(s: Sequence): string {\n    return algToString(s);\n  }\n}\n\n// TODO: subset of string rather than `extends`\nexport class StringEnumAttribute<E extends string> {\n  string: string;\n  value: E;\n  valid: boolean;\n  constructor(private enumVal: { [key: string]: boolean }, initialValue?: E) {\n    this.setString(initialValue ?? this.defaultValue());\n  }\n\n  // Return value indicates if the attribute changed.\n  setString(str: string): boolean {\n    if (this.string === str) {\n      return false;\n    }\n    if (!(str in this.enumVal)) {\n      throw new Error(`Invalid string for attribute!: ${str}`);\n    }\n    this.string = str;\n    this.value = this.toValue(str);\n    return true;\n  }\n\n  // Return value indicates if the attribute changed.\n  setValue(val: string): boolean {\n    return this.setString(val);\n  }\n\n  private defaultValue(): string {\n    return Object.keys(this.enumVal)[0]; // TODO\n  }\n\n  private toValue(s: string): E {\n    return s as E;\n  }\n\n  // private toString(s: string): string {\n  //   return s;\n  // }\n}\n\n// TODO: subset of string rather than `extends`\nexport class StringFakeEnumAttribute<E extends string> {\n  string: string;\n  value: E;\n  valid: boolean;\n  constructor(private validStrings: string[], initialValue?: E) {\n    this.setString(initialValue ?? this.defaultValue());\n  }\n\n  // Return value indicates if the attribute changed.\n  setString(str: string): boolean {\n    if (this.string === str) {\n      return false;\n    }\n    if (!this.validStrings.includes(str)) {\n      throw new Error(`Invalid string for attribute!: ${str}`);\n    }\n    this.string = str;\n    this.value = this.toValue(str);\n    return true;\n  }\n\n  // Return value indicates if the attribute changed.\n  setValue(val: string): boolean {\n    return this.setString(val);\n  }\n\n  private defaultValue(): string {\n    return this.validStrings[0];\n  }\n\n  private toValue(s: string): E {\n    return s as E;\n  }\n\n  // private toString(s: string): string {\n  //   return s;\n  // }\n}\n\nexport class Vector3Attribute {\n  string: string;\n  value: Vector3 | null;\n  #defaultValue: Vector3 | null;\n  constructor(defaultValue: Vector3 | null, initialValue?: Vector3 | null) {\n    this.#defaultValue = defaultValue;\n    this.setValue(initialValue ?? this.defaultValue());\n  }\n\n  // Return value indicates if the attribute changed.\n  setString(str: string): boolean {\n    return this.setValue(str === \"\" ? null : this.toValue(str)); // TODO: test empty string\n  }\n\n  // Return value indicates if the attribute changed.\n  setValue(val: Vector3 | null): boolean {\n    const str = this.toString(val);\n    if (this.string === str) {\n      return false;\n    }\n    this.string = str;\n    this.value = val;\n    return true;\n  }\n\n  private defaultValue(): Vector3 | null {\n    return this.#defaultValue;\n  }\n\n  private toValue(s: string): Vector3 | null {\n    if (!s.startsWith(\"[\")) {\n      throw new Error(\"TODO\");\n    }\n    if (!s.endsWith(\"]\")) {\n      throw new Error(\"TODO\");\n    }\n    const coords = s.slice(1, s.length - 1).split(\",\");\n    if (coords.length !== 3) {\n      throw new Error(\"TODO\");\n    }\n    const [x, y, z] = coords.map((c) => parseInt(c, 10));\n    return new Vector3(x, y, z);\n  }\n\n  private toString(v: Vector3 | null): string {\n    return v ? `[${v.x}, ${v.y}, ${v.z}]` : \"\"; // TODO: empty string is not null\n  }\n}\n", "// // type ConfigAttributes = Record<string, any>;\n\nimport { Vector3 } from \"three\";\nimport { algToString, parse, Sequence } from \"../../../alg\";\n\nexport class AlgAttribute {\n  string: string;\n  value: Sequence;\n  constructor(initialValue?: Sequence) {\n    this.setValue(initialValue ?? this.defaultValue());\n  }\n\n  // Return value indicates if the attribute changed.\n  setString(str: string): boolean {\n    if (this.string === str) {\n      return false;\n    }\n    this.string = str;\n    this.value = this.toValue(str);\n    return true;\n  }\n\n  // Return value indicates if the attribute changed.\n  setValue(val: Sequence): boolean {\n    const str = this.toString(val);\n    if (this.string === str) {\n      return false;\n    }\n    this.string = str;\n    this.value = val;\n    return true;\n  }\n\n  private defaultValue(): Sequence {\n    return new Sequence([]);\n  }\n\n  private toValue(s: string): Sequence {\n    return parse(s);\n  }\n\n  private toString(s: Sequence): string {\n    return algToString(s);\n  }\n}\n\n// TODO: subset of string rather than `extends`\nexport class StringEnumAttribute<E extends string> {\n  string: string;\n  value: E;\n  valid: boolean;\n  constructor(private enumVal: { [key: string]: boolean }, initialValue?: E) {\n    this.setString(initialValue ?? this.defaultValue());\n  }\n\n  // Return value indicates if the attribute changed.\n  setString(str: string): boolean {\n    if (this.string === str) {\n      return false;\n    }\n    if (!(str in this.enumVal)) {\n      throw new Error(`Invalid string for attribute!: ${str}`);\n    }\n    this.string = str;\n    this.value = this.toValue(str);\n    return true;\n  }\n\n  // Return value indicates if the attribute changed.\n  setValue(val: string): boolean {\n    return this.setString(val);\n  }\n\n  private defaultValue(): string {\n    return Object.keys(this.enumVal)[0]; // TODO\n  }\n\n  private toValue(s: string): E {\n    return s as E;\n  }\n\n  // private toString(s: string): string {\n  //   return s;\n  // }\n}\n\n// TODO: subset of string rather than `extends`\nexport class StringFakeEnumAttribute<E extends string> {\n  string: string;\n  value: E;\n  valid: boolean;\n  constructor(private validStrings: string[], initialValue?: E) {\n    this.setString(initialValue ?? this.defaultValue());\n  }\n\n  // Return value indicates if the attribute changed.\n  setString(str: string): boolean {\n    if (this.string === str) {\n      return false;\n    }\n    if (!this.validStrings.includes(str)) {\n      throw new Error(`Invalid string for attribute!: ${str}`);\n    }\n    this.string = str;\n    this.value = this.toValue(str);\n    return true;\n  }\n\n  // Return value indicates if the attribute changed.\n  setValue(val: string): boolean {\n    return this.setString(val);\n  }\n\n  private defaultValue(): string {\n    return this.validStrings[0];\n  }\n\n  private toValue(s: string): E {\n    return s as E;\n  }\n\n  // private toString(s: string): string {\n  //   return s;\n  // }\n}\n\nexport class Vector3Attribute {\n  string: string;\n  value: Vector3 | null;\n  #defaultValue: Vector3 | null;\n  constructor(defaultValue: Vector3 | null, initialValue?: Vector3 | null) {\n    this.#defaultValue = defaultValue;\n    this.setValue(initialValue ?? this.defaultValue());\n  }\n\n  // Return value indicates if the attribute changed.\n  setString(str: string): boolean {\n    return this.setValue(str === \"\" ? null : this.toValue(str)); // TODO: test empty string\n  }\n\n  // Return value indicates if the attribute changed.\n  setValue(val: Vector3 | null): boolean {\n    const str = this.toString(val);\n    if (this.string === str) {\n      return false;\n    }\n    this.string = str;\n    this.value = val;\n    return true;\n  }\n\n  private defaultValue(): Vector3 | null {\n    return this.#defaultValue;\n  }\n\n  private toValue(s: string): Vector3 | null {\n    if (!s.startsWith(\"[\")) {\n      throw new Error(\"TODO\");\n    }\n    if (!s.endsWith(\"]\")) {\n      throw new Error(\"TODO\");\n    }\n    const coords = s.slice(1, s.length - 1).split(\",\");\n    if (coords.length !== 3) {\n      throw new Error(\"TODO\");\n    }\n    const [x, y, z] = coords.map((c) => parseInt(c, 10));\n    return new Vector3(x, y, z);\n  }\n\n  private toString(v: Vector3 | null): string {\n    return v ? `[${v.x}, ${v.y}, ${v.z}]` : \"\"; // TODO: empty string is not null\n  }\n}\n", "import { ManagedCustomElement } from \"./ManagedCustomElement\";\n\nexport class ClassListManager<SuffixType extends string> {\n  #currentClassName: string | null = null;\n  // The prefix should ideally end in a dash.\n  constructor(\n    private elem: ManagedCustomElement,\n    private prefix: string,\n    private validSuffixes: SuffixType[],\n  ) {}\n\n  // Does nothing if there was no value.\n  clearValue(): void {\n    if (this.#currentClassName) {\n      this.elem.contentWrapper.classList.remove(this.#currentClassName);\n    }\n    this.#currentClassName = null; // TODO: add test for this behaviour.\n  }\n\n  // Returns if the value changed\n  setValue(suffix: SuffixType): boolean {\n    if (!this.validSuffixes.includes(suffix)) {\n      throw new Error(`Invalid suffix: ${suffix}`);\n    }\n    const newClassName = `${this.prefix}${suffix}`;\n    const changed = this.#currentClassName !== newClassName;\n    if (changed) {\n      this.clearValue();\n      this.elem.contentWrapper.classList.add(newClassName);\n      this.#currentClassName = newClassName;\n    }\n    return changed;\n  }\n}\n", "import { CSSSource } from \"../element/ManagedCustomElement\";\n\nexport const twistyViewerWrapperCSS = new CSSSource(`\n.wrapper {\n  display: grid;\n  width: 100%;\n  height: 100%;\n  position: relative;\n  overflow: hidden;\n}\n\n.wrapper.back-view-side-by-side {\n  grid-template-columns: 1fr 1fr;\n}\n\n.wrapper > * {\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n}\n\n.wrapper.back-view-upper-right > :nth-child(2) {\n  position: absolute;\n  right: 0;\n  top: 0;\n  width: 25%;\n  height: 25%;\n}\n`);\n", "import { ClassListManager } from \"../element/ClassListManager\";\nimport { ManagedCustomElement } from \"../element/ManagedCustomElement\";\nimport { customElementsShim } from \"../element/node-custom-element-shims\";\nimport { twistyViewerWrapperCSS } from \"./TwistyViewerWrapper.css\";\n\nexport const backViewLayouts = {\n  \"none\": true, // default\n  \"side-by-side\": true,\n  \"upper-right\": true,\n};\nexport type BackViewLayout = keyof typeof backViewLayouts;\n\nexport interface TwistyViewerWrapperConfig {\n  backView?: BackViewLayout;\n}\n\nexport class TwistyViewerWrapper extends ManagedCustomElement {\n  #backViewClassListManager: ClassListManager<\n    BackViewLayout\n  > = new ClassListManager(this, \"back-view-\", [\n    \"none\",\n    \"side-by-side\",\n    \"upper-right\",\n  ]);\n\n  constructor(config: TwistyViewerWrapperConfig = {}) {\n    super();\n    this.addCSS(twistyViewerWrapperCSS);\n\n    if (config.backView && config.backView in backViewLayouts) {\n      this.#backViewClassListManager.setValue(config.backView);\n    }\n  }\n\n  // Returns if the value changed\n  /** @deprecated */\n  setBackView(backView: BackViewLayout): boolean {\n    return this.#backViewClassListManager.setValue(backView);\n  }\n}\n\ncustomElementsShim.define(\"twisty-viewer-wrapper\", TwistyViewerWrapper);\n", "import { Vector3 } from \"three\";\nimport { Sequence } from \"../../alg\";\nimport {\n  AlgAttribute,\n  StringEnumAttribute,\n  Vector3Attribute,\n} from \"./element/ElementConfig\";\nimport type { TwistyPlayer } from \"./TwistyPlayer\";\nimport { BackViewLayout, backViewLayouts } from \"./viewers/TwistyViewerWrapper\";\n\nconst DEFAULT_CAMERA_Z = 5;\n// Golden ratio is perfect for FTO and Megaminx.\nconst DEFAULT_CAMERA_Y = DEFAULT_CAMERA_Z * (2 / (1 + Math.sqrt(5)));\n\nexport const centeredCameraPosition = new Vector3(\n  0,\n  DEFAULT_CAMERA_Y,\n  DEFAULT_CAMERA_Z,\n);\n\n// TODO\nexport const cubeCameraPosition = new Vector3(3, 4, 5);\n\n// TODO: turn these maps into lists?\nexport const visualizationFormats = {\n  \"3D\": true, // default\n  \"2D\": true,\n  \"PG3D\": true,\n};\nexport type VisualizationFormat = keyof typeof visualizationFormats;\n\nexport const backgroundThemes = {\n  checkered: true, // default\n  none: true,\n};\nexport type BackgroundTheme = keyof typeof backgroundThemes;\n\n// TODO: turn these maps into lists?\nexport const hintFaceletStyles = {\n  floating: true, // default\n  none: true,\n};\nexport type HintFaceletStyle = keyof typeof hintFaceletStyles;\n\n// TODO: turn these maps into lists?\n// TODO: alg.cubing.net parity\nexport const experimentalStickerings = {\n  \"full\": true, // default\n  \"centers-only\": true, // TODO\n  \"PLL\": true,\n  \"CLS\": true,\n  \"OLL\": true,\n  \"ELS\": true,\n  \"LL\": true,\n  \"F2L\": true,\n  \"ZBLL\": true,\n  \"ZBLS\": true,\n  \"WVLS\": true,\n  \"VLS\": true,\n  \"LS\": true,\n  \"EO\": true,\n  \"CMLL\": true,\n  \"L6E\": true,\n  \"L6EO\": true,\n  \"Daisy\": true,\n  \"Cross\": true,\n  \"2x2x2\": true,\n  \"2x2x3\": true,\n  \"Void Cube\": true,\n};\nexport type ExperimentalStickering = keyof typeof experimentalStickerings;\n\nexport const controlsLocations = {\n  \"bottom-row\": true, // default\n  \"none\": true,\n};\nexport type ControlsLocation = keyof typeof controlsLocations;\n\nexport const puzzleIDs = {\n  \"3x3x3\": true, // default\n  \"custom\": true,\n  \"2x2x2\": true,\n  \"4x4x4\": true,\n  \"5x5x5\": true,\n  \"6x6x6\": true,\n  \"7x7x7\": true,\n  \"megaminx\": true,\n  \"pyraminx\": true,\n  \"sq1\": true,\n  \"clock\": true,\n  \"skewb\": true,\n  \"FTO\": true,\n};\nexport type PuzzleID = keyof typeof puzzleIDs;\n\n// TODO: templatize\nexport interface ManagedAttribute<K> {\n  string: string;\n  value: K;\n  setString(s: string): boolean;\n  setValue(v: K): boolean;\n}\n\ntype AnyManagedAttribute = ManagedAttribute<any>;\n\ninterface TwistyPlayerAttributes extends Record<string, AnyManagedAttribute> {\n  // Alg\n  \"alg\": AlgAttribute;\n  \"experimental-start-setup\": AlgAttribute;\n\n  // Puzzle\n  \"puzzle\": StringEnumAttribute<PuzzleID>;\n  \"visualization\": StringEnumAttribute<VisualizationFormat>;\n  \"hint-facelets\": StringEnumAttribute<HintFaceletStyle>;\n  \"experimental-stickering\": StringEnumAttribute<ExperimentalStickering>;\n\n  // Background\n  \"background\": StringEnumAttribute<BackgroundTheme>;\n  \"controls\": StringEnumAttribute<ControlsLocation>;\n\n  // 3D config\n  \"back-view\": StringEnumAttribute<BackViewLayout>;\n  \"camera-position\": Vector3Attribute;\n}\n\nexport interface TwistyPlayerConfigValues {\n  alg: Sequence;\n  experimentalStartSetup: Sequence;\n\n  puzzle: PuzzleID;\n  visualization: VisualizationFormat;\n  hintFacelets: HintFaceletStyle;\n  experimentalStickering: ExperimentalStickering;\n\n  background: BackgroundTheme;\n  controls: ControlsLocation;\n\n  backView: BackViewLayout;\n  cameraPosition: Vector3;\n}\n\nexport type TwistyPlayerInitialConfig = Partial<TwistyPlayerConfigValues>;\n\nconst twistyPlayerAttributeMap: Record<\n  keyof TwistyPlayerAttributes,\n  keyof TwistyPlayerConfigValues\n> = {\n  \"alg\": \"alg\",\n  \"experimental-start-setup\": \"experimentalStartSetup\",\n\n  \"puzzle\": \"puzzle\",\n  \"visualization\": \"visualization\",\n  \"hint-facelets\": \"hintFacelets\",\n  \"experimental-stickering\": \"experimentalStickering\",\n\n  \"background\": \"background\",\n  \"controls\": \"controls\",\n\n  \"back-view\": \"backView\",\n  \"camera-position\": \"cameraPosition\",\n};\n\n// TODO: Can we avoid instantiating a new class for ech attribute, and would it help performance?\nexport class TwistyPlayerConfig {\n  attributes: TwistyPlayerAttributes;\n  constructor(\n    private twistyPlayer: TwistyPlayer, // TODO\n    initialValues: TwistyPlayerInitialConfig,\n  ) {\n    this.attributes = {\n      \"alg\": new AlgAttribute(initialValues.alg),\n      \"experimental-start-setup\": new AlgAttribute(\n        initialValues.experimentalStartSetup,\n      ),\n\n      \"puzzle\": new StringEnumAttribute(puzzleIDs, initialValues.puzzle),\n      \"visualization\": new StringEnumAttribute(\n        visualizationFormats,\n        initialValues.visualization,\n      ),\n      \"hint-facelets\": new StringEnumAttribute(\n        hintFaceletStyles,\n        initialValues.hintFacelets,\n      ),\n      \"experimental-stickering\": new StringEnumAttribute(\n        experimentalStickerings,\n        initialValues.experimentalStickering,\n      ),\n\n      \"background\": new StringEnumAttribute(\n        backgroundThemes,\n        initialValues.background,\n      ),\n      \"controls\": new StringEnumAttribute(\n        controlsLocations,\n        initialValues.controls,\n      ),\n      \"back-view\": new StringEnumAttribute(\n        backViewLayouts,\n        initialValues[\"backView\"],\n      ),\n      \"camera-position\": new Vector3Attribute(\n        null,\n        initialValues[\"cameraPosition\"],\n      ),\n    };\n  }\n\n  static get observedAttributes(): (keyof TwistyPlayerAttributes & string)[] {\n    return Object.keys(twistyPlayerAttributeMap);\n  }\n\n  attributeChangedCallback(\n    attributeName: string,\n    oldValue: string,\n    newValue: string,\n  ): void {\n    const managedAttribute = this.attributes[attributeName];\n    if (managedAttribute) {\n      // TODO: Handle `null` better.\n      if (oldValue !== null && managedAttribute.string !== oldValue) {\n        console.warn(\n          \"Attribute out of sync!\",\n          attributeName,\n          managedAttribute.string,\n          oldValue,\n        );\n      }\n      managedAttribute.setString(newValue);\n\n      // TODO: can we make this type-safe?\n      // TODO: avoid double-setting in recursive calls\n      const propertyName: keyof TwistyPlayerConfigValues =\n        twistyPlayerAttributeMap[attributeName];\n      // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n      // @ts-ignore\n      this.twistyPlayer[propertyName] = managedAttribute.value;\n    }\n  }\n}\n", "export const TAU = Math.PI * 2;\n", "import { ExperimentalStickering } from \"../../dom/TwistyPlayerConfig\";\nimport { PieceAppearance, PuzzleAppearance } from \"./appearance\";\n\n// regular\nconst r: PieceAppearance = {\n  facelets: [\"regular\", \"regular\", \"regular\"],\n};\n\n// dim / (already) solved\nconst d: PieceAppearance = {\n  facelets: [\"dim\", \"dim\", \"dim\"],\n};\n\n// dim / (already) oriented\nconst di: PieceAppearance = {\n  facelets: [\"dim\", \"ignored\", \"ignored\"],\n};\n\n// PLL\nconst p: PieceAppearance = {\n  facelets: [\"dim\", \"regular\", \"regular\"],\n};\n\n// OLL\nconst o: PieceAppearance = {\n  facelets: [\"regular\", \"ignored\", \"ignored\"],\n};\n\n// ignored\nconst i: PieceAppearance = {\n  facelets: [\"ignored\", \"ignored\", \"ignored\"],\n};\n\n// oriented\nconst oi: PieceAppearance = {\n  facelets: [\"oriented\", \"ignored\", \"ignored\"],\n};\n\nconst invis: PieceAppearance = {\n  facelets: [\"invisible\", \"invisible\", \"invisible\"],\n};\n\n// TODO: generalize stickerings by performing e.g. intersection on orbit selectors\n// Example: OLL is `LL: orient, !LL: dim`\nexport const stickerings: Record<ExperimentalStickering, PuzzleAppearance> = {\n  \"full\": {\n    // TODO: Support elision for regular pieces.\n    orbits: {\n      EDGES: {\n        pieces: [r, r, r, r, r, r, r, r, r, r, r, r],\n      },\n      CORNERS: {\n        pieces: [r, r, r, r, r, r, r, r],\n      },\n      CENTERS: {\n        pieces: [r, r, r, r, r, r],\n      },\n    },\n  },\n\n  \"centers-only\": {\n    orbits: {\n      EDGES: {\n        pieces: [i, i, i, i, i, i, i, i, i, i, i, i],\n      },\n      CORNERS: {\n        pieces: [i, i, i, i, i, i, i, i],\n      },\n      CENTERS: {\n        pieces: [r, r, r, r, r, r],\n      },\n    },\n  },\n\n  \"PLL\": {\n    orbits: {\n      EDGES: {\n        pieces: [p, p, p, p, d, d, d, d, d, d, d, d],\n      },\n      CORNERS: {\n        pieces: [p, p, p, p, d, d, d, d],\n      },\n      CENTERS: {\n        pieces: [p, d, d, d, d, d],\n      },\n    },\n  },\n\n  \"CLS\": {\n    orbits: {\n      EDGES: {\n        pieces: [di, di, di, di, d, d, d, d, d, d, d, d],\n      },\n      CORNERS: {\n        pieces: [o, o, o, o, o, d, d, d],\n      },\n      CENTERS: {\n        pieces: [d, d, d, d, d, d],\n      },\n    },\n  },\n\n  \"OLL\": {\n    orbits: {\n      EDGES: {\n        pieces: [o, o, o, o, d, d, d, d, d, d, d, d],\n      },\n      CORNERS: {\n        pieces: [o, o, o, o, d, d, d, d],\n      },\n      CENTERS: {\n        pieces: [r, d, d, d, d, d],\n      },\n    },\n  },\n\n  \"ELS\": {\n    orbits: {\n      EDGES: {\n        pieces: [o, o, o, o, d, d, d, d, r, d, d, d],\n      },\n      CORNERS: {\n        pieces: [i, i, i, i, i, d, d, d],\n      },\n      CENTERS: {\n        pieces: [r, d, d, d, d, d],\n      },\n    },\n  },\n\n  \"LL\": {\n    orbits: {\n      EDGES: {\n        pieces: [r, r, r, r, d, d, d, d, d, d, d, d],\n      },\n      CORNERS: {\n        pieces: [r, r, r, r, d, d, d, d],\n      },\n      CENTERS: {\n        pieces: [r, d, d, d, d, d],\n      },\n    },\n  },\n\n  \"F2L\": {\n    orbits: {\n      EDGES: {\n        pieces: [i, i, i, i, r, r, r, r, r, r, r, r],\n      },\n      CORNERS: {\n        pieces: [i, i, i, i, r, r, r, r],\n      },\n      CENTERS: {\n        pieces: [d, r, r, r, r, r],\n      },\n    },\n  },\n\n  \"ZBLL\": {\n    orbits: {\n      EDGES: {\n        pieces: [p, p, p, p, d, d, d, d, d, d, d, d],\n      },\n      CORNERS: {\n        pieces: [r, r, r, r, d, d, d, d],\n      },\n      CENTERS: {\n        pieces: [r, d, d, d, d, d],\n      },\n    },\n  },\n\n  \"ZBLS\": {\n    orbits: {\n      EDGES: {\n        pieces: [o, o, o, o, d, d, d, d, r, d, d, d],\n      },\n      CORNERS: {\n        pieces: [i, i, i, i, r, d, d, d],\n      },\n      CENTERS: {\n        pieces: [r, d, d, d, d, d],\n      },\n    },\n  },\n\n  \"WVLS\": {\n    orbits: {\n      EDGES: {\n        pieces: [o, o, o, o, d, d, d, d, r, d, d, d],\n      },\n      CORNERS: {\n        pieces: [o, o, o, o, r, d, d, d],\n      },\n      CENTERS: {\n        pieces: [r, d, d, d, d, d],\n      },\n    },\n  },\n\n  \"VLS\": {\n    orbits: {\n      EDGES: {\n        pieces: [o, o, o, o, d, d, d, d, r, d, d, d],\n      },\n      CORNERS: {\n        pieces: [o, o, o, o, r, d, d, d],\n      },\n      CENTERS: {\n        pieces: [r, d, d, d, d, d],\n      },\n    },\n  },\n\n  \"LS\": {\n    orbits: {\n      EDGES: {\n        pieces: [i, i, i, i, d, d, d, d, r, d, d, d],\n      },\n      CORNERS: {\n        pieces: [i, i, i, i, r, d, d, d],\n      },\n      CENTERS: {\n        pieces: [d, d, d, d, d, d],\n      },\n    },\n  },\n\n  \"EO\": {\n    orbits: {\n      EDGES: {\n        pieces: [oi, oi, oi, oi, oi, oi, oi, oi, oi, oi, oi, oi],\n      },\n      CORNERS: {\n        pieces: [i, i, i, i, i, i, i, i],\n      },\n    },\n  },\n\n  \"CMLL\": {\n    orbits: {\n      EDGES: {\n        pieces: [i, i, i, i, i, d, i, d, d, d, d, d],\n      },\n      CORNERS: {\n        pieces: [r, r, r, r, d, d, d, d],\n      },\n      CENTERS: {\n        pieces: [i, d, i, d, i, i],\n      },\n    },\n  },\n\n  \"L6E\": {\n    orbits: {\n      EDGES: {\n        pieces: [r, r, r, r, r, d, r, d, d, d, d, d],\n      },\n      CORNERS: {\n        pieces: [d, d, d, d, d, d, d, d],\n      },\n      CENTERS: {\n        pieces: [r, d, r, d, r, r],\n      },\n    },\n  },\n\n  \"L6EO\": {\n    orbits: {\n      EDGES: {\n        pieces: [oi, oi, oi, oi, oi, d, oi, d, d, d, d, d],\n      },\n      CORNERS: {\n        pieces: [d, d, d, d, d, d, d, d],\n      },\n      CENTERS: {\n        pieces: [oi, d, i, d, i, oi],\n      },\n    },\n  },\n\n  \"Daisy\": {\n    orbits: {\n      EDGES: {\n        pieces: [o, o, o, o, i, i, i, i, i, i, i, i],\n      },\n      CORNERS: {\n        pieces: [i, i, i, i, i, i, i, i],\n      },\n      CENTERS: {\n        pieces: [d, d, d, d, d, o],\n      },\n    },\n  },\n\n  // TODO: U? This doesn't match daisy.\n  \"Cross\": {\n    orbits: {\n      EDGES: {\n        pieces: [i, i, i, i, r, r, r, r, i, i, i, i],\n      },\n      CORNERS: {\n        pieces: [i, i, i, i, i, i, i, i],\n      },\n      CENTERS: {\n        pieces: [d, d, d, d, d, r],\n      },\n    },\n  },\n\n  \"2x2x2\": {\n    orbits: {\n      EDGES: {\n        pieces: [i, i, i, i, i, i, r, r, i, i, i, r],\n      },\n      CORNERS: {\n        pieces: [i, i, i, i, i, i, r, i],\n      },\n      CENTERS: {\n        pieces: [d, r, d, d, r, r],\n      },\n    },\n  },\n\n  \"2x2x3\": {\n    orbits: {\n      EDGES: {\n        pieces: [i, i, i, i, r, i, d, d, i, r, i, d],\n      },\n      CORNERS: {\n        pieces: [i, i, i, i, i, r, d, i],\n      },\n      CENTERS: {\n        pieces: [d, d, r, d, d, d],\n      },\n    },\n  },\n\n  // TODO: remove foundations\n  \"Void Cube\": {\n    orbits: {\n      EDGES: {\n        pieces: [r, r, r, r, r, r, r, r, r, r, r, r],\n      },\n      CORNERS: {\n        pieces: [r, r, r, r, r, r, r, r],\n      },\n      CENTERS: {\n        pieces: [invis, invis, invis, invis, invis, invis],\n      },\n    },\n  },\n};\n", "import {\n  BackSide,\n  BoxGeometry,\n  DoubleSide,\n  Euler,\n  Group,\n  Matrix4,\n  Mesh,\n  MeshBasicMaterial,\n  Object3D,\n  PlaneGeometry,\n  Quaternion,\n  Vector3,\n} from \"three\";\nimport { BlockMove } from \"../../../alg\";\nimport { Puzzles, Transformation } from \"../../../kpuzzle\";\nimport { AlgCursor } from \"../../animation/alg/AlgCursor\";\nimport { PuzzlePosition } from \"../../animation/alg/CursorTypes\";\nimport { smootherStep } from \"../../animation/easing\";\nimport {\n  ExperimentalStickering,\n  experimentalStickerings,\n  HintFaceletStyle,\n  hintFaceletStyles,\n} from \"../../dom/TwistyPlayerConfig\";\nimport { TAU } from \"../TAU\";\nimport { FaceletMeshAppearance, PuzzleAppearance } from \"./appearance\";\nimport { stickerings } from \"./stickerings\";\nimport { Twisty3DPuzzle } from \"./Twisty3DPuzzle\";\n\nconst ignoredMaterial = new MeshBasicMaterial({\n  color: 0x444444,\n  side: DoubleSide,\n});\n\nconst ignoredMaterialHint = new MeshBasicMaterial({\n  color: 0xcccccc,\n  side: BackSide,\n});\n\nconst invisibleMaterial = new MeshBasicMaterial({\n  visible: false,\n});\n\nconst orientedMaterial = new MeshBasicMaterial({\n  color: 0xff88ff,\n});\n\nconst orientedMaterialHint = new MeshBasicMaterial({\n  color: 0xff88ff,\n  side: BackSide,\n});\n\ninterface MaterialMap extends Record<FaceletMeshAppearance, MeshBasicMaterial> {\n  regular: MeshBasicMaterial;\n  dim: MeshBasicMaterial;\n  ignored: MeshBasicMaterial;\n  invisible: MeshBasicMaterial;\n}\n\nclass AxisInfo {\n  public stickerMaterial: MaterialMap;\n  public hintStickerMaterial: MaterialMap;\n  constructor(\n    public vector: Vector3,\n    public fromZ: Euler,\n    public color: number,\n    public dimColor: number,\n  ) {\n    // TODO: Make sticker material single-sided when cubie foundation is opaque?\n    this.stickerMaterial = {\n      regular: new MeshBasicMaterial({\n        color,\n        side: DoubleSide,\n      }),\n      dim: new MeshBasicMaterial({\n        color: dimColor,\n        side: DoubleSide,\n      }),\n      oriented: orientedMaterial,\n      ignored: ignoredMaterial,\n      invisible: invisibleMaterial,\n    };\n    this.hintStickerMaterial = {\n      regular: new MeshBasicMaterial({\n        color,\n        side: BackSide,\n      }),\n      dim: new MeshBasicMaterial({\n        color: dimColor,\n        side: BackSide,\n        transparent: true,\n        opacity: 0.75,\n      }),\n      oriented: orientedMaterialHint,\n      ignored: ignoredMaterialHint,\n      invisible: invisibleMaterial,\n    };\n  }\n}\n\nconst axesInfo: AxisInfo[] = [\n  new AxisInfo(\n    new Vector3(0, 1, 0),\n    new Euler(-TAU / 4, 0, 0),\n    0xffffff,\n    0xdddddd,\n  ),\n  new AxisInfo(\n    new Vector3(-1, 0, 0),\n    new Euler(0, -TAU / 4, 0),\n    0xff8800,\n    0x884400,\n  ),\n  new AxisInfo(new Vector3(0, 0, 1), new Euler(0, 0, 0), 0x00ff00, 0x008800),\n  new AxisInfo(\n    new Vector3(1, 0, 0),\n    new Euler(0, TAU / 4, 0),\n    0xff0000,\n    0x660000,\n  ),\n  new AxisInfo(\n    new Vector3(0, 0, -1),\n    new Euler(0, TAU / 2, 0),\n    0x0000ff,\n    0x000088,\n  ),\n  new AxisInfo(\n    new Vector3(0, -1, 0),\n    new Euler(TAU / 4, 0, 0),\n    0xffff00,\n    0x888800,\n  ),\n];\n\nconst face: { [s: string]: number } = {\n  U: 0,\n  L: 1,\n  F: 2,\n  R: 3,\n  B: 4,\n  D: 5,\n};\n\nconst familyToAxis: { [s: string]: number } = {\n  U: face.U,\n  u: face.U,\n  y: face.U,\n  L: face.L,\n  l: face.L,\n  M: face.L,\n  F: face.F,\n  f: face.F,\n  S: face.F,\n  z: face.F,\n  R: face.R,\n  r: face.R,\n  x: face.R,\n  B: face.B,\n  b: face.B,\n  D: face.D,\n  d: face.D,\n  E: face.D,\n};\n\nconst cubieDimensions = {\n  stickerWidth: 0.85,\n  stickerElevation: 0.501,\n  foundationWidth: 1,\n  hintStickerElevation: 1.45,\n};\n\ntype OptionKey = \"showMainStickers\" | \"hintFacelets\" | \"showFoundation\";\n\ninterface Cube3DOptions {\n  showMainStickers?: boolean;\n  hintFacelets?: HintFaceletStyle;\n  showFoundation?: boolean; // TODO: better name\n  experimentalStickering?: ExperimentalStickering;\n}\n\nconst cube3DOptionsDefaults: Cube3DOptions = {\n  showMainStickers: true,\n  hintFacelets: \"floating\",\n  showFoundation: true,\n  experimentalStickering: \"full\",\n};\n\n// TODO: Make internal foundation faces one-sided, facing to the outside of the cube.\nconst blackMesh = new MeshBasicMaterial({\n  color: 0x000000,\n  opacity: 0.3,\n  transparent: true,\n});\n\nclass CubieDef {\n  public matrix: Matrix4;\n  public stickerFaces: number[];\n  // stickerFaceNames can be e.g. [\"U\", \"F\", \"R\"], \"UFR\" if every face is a single letter.\n  constructor(\n    public orbit: string,\n    stickerFaceNames: string[] | string,\n    q: Quaternion,\n  ) {\n    const individualStickerFaceNames =\n      typeof stickerFaceNames === \"string\"\n        ? stickerFaceNames.split(\"\")\n        : stickerFaceNames;\n    this.stickerFaces = individualStickerFaceNames.map((s) => face[s]);\n    this.matrix = new Matrix4();\n    this.matrix.setPosition(firstPiecePosition[orbit]);\n    this.matrix.premultiply(new Matrix4().makeRotationFromQuaternion(q));\n  }\n}\n\nfunction t(v: Vector3, t4: number): Quaternion {\n  return new Quaternion().setFromAxisAngle(v, (TAU * t4) / 4);\n}\n\nconst r = {\n  O: new Vector3(0, 0, 0),\n  U: new Vector3(0, -1, 0),\n  L: new Vector3(1, 0, 0),\n  F: new Vector3(0, 0, -1),\n  R: new Vector3(-1, 0, 0),\n  B: new Vector3(0, 0, 1),\n  D: new Vector3(0, 1, 0),\n};\n\ninterface OrbitIndexed<T> {\n  [s: string]: T;\n}\ntype PieceIndexed<T> = OrbitIndexed<T[]>;\n\nconst firstPiecePosition: OrbitIndexed<Vector3> = {\n  EDGES: new Vector3(0, 1, 1),\n  CORNERS: new Vector3(1, 1, 1),\n  CENTERS: new Vector3(0, 1, 0),\n};\nconst orientationRotation: OrbitIndexed<Matrix4[]> = {\n  EDGES: [0, 1].map((i) =>\n    new Matrix4().makeRotationAxis(\n      firstPiecePosition.EDGES.clone().normalize(),\n      (-i * TAU) / 2,\n    ),\n  ),\n  CORNERS: [0, 1, 2].map((i) =>\n    new Matrix4().makeRotationAxis(\n      firstPiecePosition.CORNERS.clone().normalize(),\n      (-i * TAU) / 3,\n    ),\n  ),\n  CENTERS: [0, 1, 2, 3].map((i) =>\n    new Matrix4().makeRotationAxis(\n      firstPiecePosition.CENTERS.clone().normalize(),\n      (-i * TAU) / 4,\n    ),\n  ),\n};\nconst cubieStickerOrder = [face.U, face.F, face.R];\n\nconst pieceDefs: PieceIndexed<CubieDef> = {\n  EDGES: [\n    new CubieDef(\"EDGES\", \"UF\", t(r.O, 0)),\n    new CubieDef(\"EDGES\", \"UR\", t(r.U, 3)),\n    new CubieDef(\"EDGES\", \"UB\", t(r.U, 2)),\n    new CubieDef(\"EDGES\", \"UL\", t(r.U, 1)),\n    new CubieDef(\"EDGES\", \"DF\", t(r.F, 2)),\n    new CubieDef(\"EDGES\", \"DR\", t(r.F, 2).premultiply(t(r.D, 1))),\n    new CubieDef(\"EDGES\", \"DB\", t(r.F, 2).premultiply(t(r.D, 2))),\n    new CubieDef(\"EDGES\", \"DL\", t(r.F, 2).premultiply(t(r.D, 3))),\n    new CubieDef(\"EDGES\", \"FR\", t(r.U, 3).premultiply(t(r.R, 3))),\n    new CubieDef(\"EDGES\", \"FL\", t(r.U, 1).premultiply(t(r.R, 3))),\n    new CubieDef(\"EDGES\", \"BR\", t(r.U, 3).premultiply(t(r.R, 1))),\n    new CubieDef(\"EDGES\", \"BL\", t(r.U, 1).premultiply(t(r.R, 1))),\n  ],\n  CORNERS: [\n    new CubieDef(\"CORNERS\", \"UFR\", t(r.O, 0)),\n    new CubieDef(\"CORNERS\", \"URB\", t(r.U, 3)),\n    new CubieDef(\"CORNERS\", \"UBL\", t(r.U, 2)),\n    new CubieDef(\"CORNERS\", \"ULF\", t(r.U, 1)),\n    new CubieDef(\"CORNERS\", \"DRF\", t(r.F, 2).premultiply(t(r.D, 1))),\n    new CubieDef(\"CORNERS\", \"DFL\", t(r.F, 2).premultiply(t(r.D, 0))),\n    new CubieDef(\"CORNERS\", \"DLB\", t(r.F, 2).premultiply(t(r.D, 3))),\n    new CubieDef(\"CORNERS\", \"DBR\", t(r.F, 2).premultiply(t(r.D, 2))),\n  ],\n  CENTERS: [\n    new CubieDef(\"CENTERS\", \"U\", t(r.O, 0)),\n    new CubieDef(\"CENTERS\", \"L\", t(r.R, 3).premultiply(t(r.U, 1))),\n    new CubieDef(\"CENTERS\", \"F\", t(r.R, 3)),\n    new CubieDef(\"CENTERS\", \"R\", t(r.R, 3).premultiply(t(r.D, 1))),\n    new CubieDef(\"CENTERS\", \"B\", t(r.R, 3).premultiply(t(r.D, 2))),\n    new CubieDef(\"CENTERS\", \"D\", t(r.R, 2)),\n  ],\n};\n\nconst CUBE_SCALE = 1 / 3;\n\ninterface FaceletInfo {\n  faceIdx: number;\n  facelet: Mesh;\n  hintFacelet?: Mesh;\n}\n\n// TODO: Split into \"scene model\" and \"view\".\nexport class Cube3D extends Object3D implements Twisty3DPuzzle {\n  kpuzzleFaceletInfo: Record<string, FaceletInfo[][]>;\n  private pieces: PieceIndexed<Object3D> = {};\n  private options: Cube3DOptions;\n  // TODO: Keep track of option-based meshes better.\n  private experimentalHintStickerMeshes: Mesh[] = [];\n  private experimentalFoundationMeshes: Mesh[] = [];\n  constructor(\n    cursor?: AlgCursor,\n    private scheduleRenderCallback?: () => void,\n    options: Cube3DOptions = {},\n  ) {\n    super();\n\n    const def = Puzzles[\"3x3x3\"];\n\n    this.options = {};\n    for (const key in cube3DOptionsDefaults) {\n      // TODO:Don't use `any`.\n      this.options[key as OptionKey] =\n        key in options\n          ? (options as any)[key]\n          : (cube3DOptionsDefaults as any)[key];\n    }\n\n    if (def.name !== \"3x3x3\") {\n      throw new Error(\"Invalid puzzle for this Cube3D implementation.\");\n    }\n    this.kpuzzleFaceletInfo = {};\n    for (const orbit in pieceDefs) {\n      const orbitFaceletInfo: FaceletInfo[][] = [];\n      this.kpuzzleFaceletInfo[orbit] = orbitFaceletInfo;\n      this.pieces[orbit] = pieceDefs[orbit].map(\n        this.createCubie.bind(this, orbitFaceletInfo),\n      );\n    }\n    this.scale.set(CUBE_SCALE, CUBE_SCALE, CUBE_SCALE);\n\n    // TODO: Can we construct this directly instead of applying it later? Would that be more code-efficient?\n    if (options.experimentalStickering) {\n      this.setAppearance(stickerings[options.experimentalStickering]);\n    }\n\n    cursor!.addPositionListener(this);\n  }\n\n  setAppearance(appearance: PuzzleAppearance): void {\n    for (const [orbitName, orbitAppearance] of Object.entries(\n      appearance.orbits,\n    )) {\n      for (\n        let pieceIdx = 0;\n        pieceIdx < orbitAppearance.pieces.length;\n        pieceIdx++\n      ) {\n        const pieceAppearance = orbitAppearance.pieces[pieceIdx];\n        if (pieceAppearance) {\n          const pieceInfo = this.kpuzzleFaceletInfo[orbitName][pieceIdx];\n          for (\n            let faceletIdx = 0;\n            faceletIdx < pieceInfo.length;\n            faceletIdx++\n          ) {\n            const faceletAppearance = pieceAppearance.facelets[faceletIdx];\n            if (faceletAppearance) {\n              const faceletInfo = pieceInfo[faceletIdx];\n\n              const appearance =\n                typeof faceletAppearance === \"string\"\n                  ? faceletAppearance\n                  : faceletAppearance?.appearance;\n\n              faceletInfo.facelet.material =\n                axesInfo[faceletInfo.faceIdx].stickerMaterial[appearance];\n              // TODO\n              const hintAppearance =\n                typeof faceletAppearance === \"string\"\n                  ? appearance\n                  : faceletAppearance.hintAppearance ?? appearance;\n              if (faceletInfo.hintFacelet) {\n                faceletInfo.hintFacelet.material =\n                  axesInfo[faceletInfo.faceIdx].hintStickerMaterial[\n                    hintAppearance\n                  ];\n              }\n            }\n          }\n        }\n      }\n    }\n    if (this.scheduleRenderCallback) {\n      this.scheduleRenderCallback();\n    }\n  }\n\n  /** @deprecated */\n  public experimentalUpdateOptions(options: Cube3DOptions): void {\n    if (\"showMainStickers\" in options) {\n      throw new Error(\"Unimplemented\");\n    }\n\n    const showFoundation = options.showFoundation;\n    if (\n      typeof showFoundation !== \"undefined\" &&\n      this.options.showFoundation !== showFoundation\n    ) {\n      this.options.showFoundation = showFoundation;\n      for (const foundation of this.experimentalFoundationMeshes) {\n        foundation.visible = showFoundation;\n      }\n    }\n\n    const hintFacelets = options.hintFacelets;\n    if (\n      typeof hintFacelets !== \"undefined\" &&\n      this.options.hintFacelets !== hintFacelets &&\n      hintFaceletStyles[hintFacelets] // TODO: test this\n    ) {\n      this.options.hintFacelets = hintFacelets;\n      for (const hintSticker of this.experimentalHintStickerMeshes) {\n        hintSticker.visible = hintFacelets === \"floating\";\n      }\n      this.scheduleRenderCallback!(); // TODO\n    }\n\n    const experimentalStickering = options.experimentalStickering;\n    if (\n      typeof experimentalStickering !== \"undefined\" &&\n      this.options.experimentalStickering !== experimentalStickering &&\n      experimentalStickerings[experimentalStickering] // TODO: test this\n    ) {\n      this.options.experimentalStickering = experimentalStickering;\n      this.setAppearance(stickerings[experimentalStickering]);\n      this.scheduleRenderCallback!(); // TODO\n    }\n  }\n\n  public onPositionChange(p: PuzzlePosition): void {\n    const reid333 = p.state as Transformation;\n    for (const orbit in pieceDefs) {\n      const pieces = pieceDefs[orbit];\n      for (let i = 0; i < pieces.length; i++) {\n        const j = reid333[orbit].permutation[i];\n        this.pieces[orbit][j].matrix.copy(pieceDefs[orbit][i].matrix);\n        this.pieces[orbit][j].matrix.multiply(\n          orientationRotation[orbit][reid333[orbit].orientation[i]],\n        );\n      }\n      for (const moveProgress of p.movesInProgress) {\n        const blockMove = moveProgress.move as BlockMove;\n        const turnNormal = axesInfo[familyToAxis[blockMove.family]].vector;\n        const moveMatrix = new Matrix4().makeRotationAxis(\n          turnNormal,\n          (-this.ease(moveProgress.fraction) *\n            moveProgress.direction *\n            blockMove.amount *\n            TAU) /\n            4,\n        );\n        for (let i = 0; i < pieces.length; i++) {\n          const k =\n            Puzzles[\"3x3x3\"].moves[blockMove.family][orbit].permutation[i];\n          if (\n            i !== k ||\n            Puzzles[\"3x3x3\"].moves[blockMove.family][orbit].orientation[i] !== 0\n          ) {\n            const j = reid333[orbit].permutation[i];\n            this.pieces[orbit][j].matrix.premultiply(moveMatrix);\n          }\n        }\n      }\n    }\n    this.scheduleRenderCallback!();\n  }\n\n  // TODO: Always create (but sometimes hide parts) so we can show them later,\n  // or (better) support creating puzzle parts on demand.\n  private createCubie(\n    orbitFacelets: FaceletInfo[][],\n    piece: CubieDef,\n  ): Object3D {\n    const cubieFaceletInfo: FaceletInfo[] = [];\n    orbitFacelets.push(cubieFaceletInfo);\n    const cubie = new Group();\n    if (this.options.showFoundation) {\n      const foundation = this.createCubieFoundation();\n      cubie.add(foundation);\n      this.experimentalFoundationMeshes.push(foundation);\n    }\n    for (let i = 0; i < piece.stickerFaces.length; i++) {\n      const sticker = this.createSticker(\n        axesInfo[cubieStickerOrder[i]],\n        axesInfo[piece.stickerFaces[i]],\n        false,\n      );\n      const faceletInfo: FaceletInfo = {\n        faceIdx: piece.stickerFaces[i],\n        facelet: sticker,\n      };\n      cubie.add(sticker);\n      if (this.options.hintFacelets === \"floating\") {\n        const hintSticker = this.createSticker(\n          axesInfo[cubieStickerOrder[i]],\n          axesInfo[piece.stickerFaces[i]],\n          true,\n        );\n        cubie.add(hintSticker);\n        faceletInfo.hintFacelet = hintSticker;\n        this.experimentalHintStickerMeshes.push(hintSticker);\n      }\n\n      cubieFaceletInfo.push(faceletInfo);\n    }\n    cubie.matrix.copy(piece.matrix);\n    cubie.matrixAutoUpdate = false;\n    this.add(cubie);\n    return cubie;\n  }\n\n  // TODO: Support creating only the outward-facing parts?\n  private createCubieFoundation(): Mesh {\n    const box = new BoxGeometry(\n      cubieDimensions.foundationWidth,\n      cubieDimensions.foundationWidth,\n      cubieDimensions.foundationWidth,\n    );\n    return new Mesh(box, blackMesh);\n  }\n\n  private createSticker(\n    posAxisInfo: AxisInfo,\n    materialAxisInfo: AxisInfo,\n    isHint: boolean,\n  ): Mesh {\n    const geo = new PlaneGeometry(\n      cubieDimensions.stickerWidth,\n      cubieDimensions.stickerWidth,\n    );\n    const stickerMesh = new Mesh(\n      geo,\n      isHint\n        ? materialAxisInfo.hintStickerMaterial.regular\n        : materialAxisInfo.stickerMaterial.regular,\n    );\n    stickerMesh.setRotationFromEuler(posAxisInfo.fromZ);\n    stickerMesh.position.copy(posAxisInfo.vector);\n    stickerMesh.position.multiplyScalar(\n      isHint\n        ? cubieDimensions.hintStickerElevation\n        : cubieDimensions.stickerElevation,\n    );\n    return stickerMesh;\n  }\n\n  private ease(fraction: number): number {\n    return smootherStep(fraction);\n  }\n}\n", "import {\n  Color,\n  DoubleSide,\n  Euler,\n  Face3,\n  Geometry,\n  Group,\n  Mesh,\n  MeshBasicMaterial,\n  Object3D,\n  Vector3,\n} from \"three\";\nimport { BlockMove, modifiedBlockMove } from \"../../../alg\";\nimport {\n  KPuzzleDefinition,\n  stateForBlockMove,\n  Transformation,\n} from \"../../../kpuzzle\";\nimport { StickerDat, StickerDatSticker } from \"../../../puzzle-geometry\";\nimport { AlgCursor } from \"../../animation/alg/AlgCursor\";\nimport { TAU } from \"../TAU\";\nimport { Twisty3DPuzzle } from \"./Twisty3DPuzzle\";\nimport { smootherStep } from \"../../animation/easing\";\nimport { PuzzlePosition } from \"../../animation/alg/CursorTypes\";\n\nconst foundationMaterial = new MeshBasicMaterial({\n  side: DoubleSide,\n  color: 0x000000,\n  // transparency doesn't work very well here\n  // with duplicated center stickers\n  //  transparent: true,\n  //  opacity: 0.75,\n});\nconst stickerMaterial = new MeshBasicMaterial({\n  vertexColors: true,\n  //    side: DoubleSide,\n});\nconst polyMaterial = new MeshBasicMaterial({\n  transparent: true,\n  opacity: 0,\n  color: 0x000000,\n});\n\nfunction makePoly(coords: number[][], color: Color): Geometry {\n  const geo = new Geometry();\n  const vertind: number[] = [];\n  for (const coord of coords) {\n    const v = new Vector3(coord[0], coord[1], coord[2]);\n    vertind.push(geo.vertices.length);\n    geo.vertices.push(v);\n  }\n  for (let g = 1; g + 1 < vertind.length; g++) {\n    const face = new Face3(vertind[0], vertind[g], vertind[g + 1]);\n    face.color = color;\n    geo.faces.push(face);\n  }\n  geo.computeFaceNormals();\n  return geo;\n}\n\nclass StickerDef {\n  public origColor: Color;\n  public faceColor: Color;\n  public cubie: Group;\n  protected geo: Geometry;\n  constructor(\n    stickerDat: StickerDatSticker,\n    foundationDat: StickerDatSticker | undefined,\n  ) {\n    this.origColor = new Color(stickerDat.color);\n    this.faceColor = new Color(stickerDat.color);\n    this.cubie = new Group();\n    this.geo = makePoly(stickerDat.coords as number[][], this.faceColor);\n    const obj = new Mesh(this.geo, stickerMaterial);\n    obj.userData.name =\n      stickerDat.orbit + \" \" + (1 + stickerDat.ord) + \" \" + stickerDat.ori;\n    this.cubie.add(obj);\n    if (foundationDat) {\n      const fgeo = makePoly(foundationDat.coords as number[][], this.faceColor);\n      const foundation = new Mesh(fgeo, foundationMaterial);\n      foundation.scale.setScalar(0.999); // TODO: hacky\n      this.cubie.add(foundation);\n    }\n  }\n\n  public setColor(c: Color): void {\n    this.geo.colorsNeedUpdate = true;\n    this.faceColor.copy(c);\n  }\n}\n\nclass HitPlaneDef {\n  public cubie: Group;\n  protected geo: Geometry;\n  constructor(hitface: any) {\n    this.cubie = new Group();\n    this.geo = new Geometry();\n    const coords = hitface.coords as number[][];\n    const vertind: number[] = [];\n    for (const coord of coords) {\n      const v = new Vector3(coord[0], coord[1], coord[2]);\n      vertind.push(this.geo.vertices.length);\n      this.geo.vertices.push(v);\n    }\n    for (let g = 1; g + 1 < vertind.length; g++) {\n      const face = new Face3(vertind[0], vertind[g], vertind[g + 1]);\n      this.geo.faces.push(face);\n    }\n    this.geo.computeFaceNormals();\n    const obj = new Mesh(this.geo, polyMaterial);\n    obj.userData.name = hitface.name;\n    this.cubie.scale.setScalar(0.99);\n    this.cubie.add(obj);\n  }\n}\n\nclass AxisInfo {\n  public axis: Vector3;\n  public order: number;\n  constructor(axisDat: any) {\n    const vec = axisDat[0] as number[];\n    this.axis = new Vector3(vec[0], vec[1], vec[2]);\n    this.order = axisDat[2];\n  }\n}\n\nconst PG_SCALE = 0.5;\n\n// TODO: Split into \"scene model\" and \"view\".\nexport class PG3D extends Object3D implements Twisty3DPuzzle {\n  private stickers: { [key: string]: StickerDef[][] };\n  private axesInfo: { [key: string]: AxisInfo };\n\n  private stickerTargets: Object3D[] = [];\n  private controlTargets: Object3D[] = [];\n\n  constructor(\n    cursor: AlgCursor,\n    private scheduleRenderCallback: () => void,\n    private definition: KPuzzleDefinition,\n    private pgdat: StickerDat,\n    showFoundation: boolean = false,\n  ) {\n    super();\n\n    this.axesInfo = {};\n    const axesDef = this.pgdat.axis as any[];\n    for (const axis of axesDef) {\n      this.axesInfo[axis[1]] = new AxisInfo(axis);\n    }\n    const stickers = this.pgdat.stickers as any[];\n    this.stickers = {};\n    for (let si = 0; si < stickers.length; si++) {\n      const sticker = stickers[si];\n      const foundation = showFoundation\n        ? this.pgdat.foundations[si]\n        : undefined;\n      const orbit = sticker.orbit as number;\n      const ord = sticker.ord as number;\n      const ori = sticker.ori as number;\n      if (!this.stickers[orbit]) {\n        this.stickers[orbit] = [];\n      }\n      if (!this.stickers[orbit][ori]) {\n        this.stickers[orbit][ori] = [];\n      }\n      const stickerdef = new StickerDef(sticker, foundation);\n      stickerdef.cubie.scale.set(PG_SCALE, PG_SCALE, PG_SCALE);\n      this.stickers[orbit][ori][ord] = stickerdef;\n      this.add(stickerdef.cubie);\n      this.stickerTargets.push(stickerdef.cubie.children[0]);\n    }\n    const hitfaces = this.pgdat.faces as any[];\n    for (const hitface of hitfaces) {\n      const facedef = new HitPlaneDef(hitface);\n      facedef.cubie.scale.set(PG_SCALE, PG_SCALE, PG_SCALE);\n      this.add(facedef.cubie);\n      this.controlTargets.push(facedef.cubie.children[0]);\n    }\n\n    cursor!.addPositionListener(this);\n  }\n\n  public experimentalGetStickerTargets(): Object3D[] {\n    return this.stickerTargets;\n  }\n\n  public experimentalGetControlTargets(): Object3D[] {\n    return this.controlTargets;\n  }\n\n  public onPositionChange(p: PuzzlePosition): void {\n    const pos = p.state as Transformation;\n    const noRotation = new Euler();\n    for (const orbit in this.stickers) {\n      const pieces = this.stickers[orbit];\n      const pos2 = pos[orbit];\n      const orin = pieces.length;\n      for (let ori = 0; ori < orin; ori++) {\n        const pieces2 = pieces[ori];\n        for (let i = 0; i < pieces2.length; i++) {\n          pieces2[i].cubie.rotation.copy(noRotation);\n          const nori = (ori + orin - pos2.orientation[i]) % orin;\n          const ni = pos2.permutation[i];\n          pieces2[i].setColor(pieces[nori][ni].origColor);\n        }\n      }\n    }\n    // FIXME tgr const kp = new KPuzzle(this.definition);\n    for (const moveProgress of p.movesInProgress) {\n      const externalBlockMove = moveProgress.move as BlockMove;\n      // TODO: unswizzle goes external to internal, and so does the call after that\n      // and so does the stateForBlockMove call\n      const unswizzled = this.pgdat.unswizzle(externalBlockMove);\n      const blockMove = this.pgdat.notationMapper.notationToInternal(\n        externalBlockMove,\n      );\n      const simpleMove = modifiedBlockMove(externalBlockMove, { amount: 1 });\n      const baseMove = stateForBlockMove(this.definition, simpleMove);\n      const ax = this.axesInfo[unswizzled];\n      const turnNormal = ax.axis;\n      const angle =\n        (-this.ease(moveProgress.fraction) *\n          moveProgress.direction *\n          blockMove.amount *\n          TAU) /\n        ax.order;\n      for (const orbit in this.stickers) {\n        const pieces = this.stickers[orbit];\n        const orin = pieces.length;\n        const bmv = baseMove[orbit];\n        for (let ori = 0; ori < orin; ori++) {\n          const pieces2 = pieces[ori];\n          for (let i = 0; i < pieces2.length; i++) {\n            const ni = bmv.permutation[i];\n            if (ni !== i || bmv.orientation[i] !== 0) {\n              pieces2[i].cubie.rotateOnAxis(turnNormal, angle);\n            }\n          }\n        }\n      }\n    }\n    this.scheduleRenderCallback!();\n  }\n\n  private ease(fraction: number): number {\n    return smootherStep(fraction);\n  }\n}\n", "import {\n  Color,\n  DoubleSide,\n  Euler,\n  Face3,\n  Geometry,\n  Group,\n  Mesh,\n  MeshBasicMaterial,\n  Object3D,\n  Vector3,\n} from \"three\";\nimport { BlockMove, modifiedBlockMove } from \"../../../alg\";\nimport {\n  KPuzzleDefinition,\n  stateForBlockMove,\n  Transformation,\n} from \"../../../kpuzzle\";\nimport { StickerDat, StickerDatSticker } from \"../../../puzzle-geometry\";\nimport { AlgCursor } from \"../../animation/alg/AlgCursor\";\nimport { TAU } from \"../TAU\";\nimport { Twisty3DPuzzle } from \"./Twisty3DPuzzle\";\nimport { smootherStep } from \"../../animation/easing\";\nimport { PuzzlePosition } from \"../../animation/alg/CursorTypes\";\n\nconst foundationMaterial = new MeshBasicMaterial({\n  side: DoubleSide,\n  color: 0x000000,\n  // transparency doesn't work very well here\n  // with duplicated center stickers\n  //  transparent: true,\n  //  opacity: 0.75,\n});\nconst stickerMaterial = new MeshBasicMaterial({\n  vertexColors: true,\n  //    side: DoubleSide,\n});\nconst polyMaterial = new MeshBasicMaterial({\n  transparent: true,\n  opacity: 0,\n  color: 0x000000,\n});\n\nfunction makePoly(coords: number[][], color: Color): Geometry {\n  const geo = new Geometry();\n  const vertind: number[] = [];\n  for (const coord of coords) {\n    const v = new Vector3(coord[0], coord[1], coord[2]);\n    vertind.push(geo.vertices.length);\n    geo.vertices.push(v);\n  }\n  for (let g = 1; g + 1 < vertind.length; g++) {\n    const face = new Face3(vertind[0], vertind[g], vertind[g + 1]);\n    face.color = color;\n    geo.faces.push(face);\n  }\n  geo.computeFaceNormals();\n  return geo;\n}\n\nclass StickerDef {\n  public origColor: Color;\n  public faceColor: Color;\n  public cubie: Group;\n  protected geo: Geometry;\n  constructor(\n    stickerDat: StickerDatSticker,\n    foundationDat: StickerDatSticker | undefined,\n  ) {\n    this.origColor = new Color(stickerDat.color);\n    this.faceColor = new Color(stickerDat.color);\n    this.cubie = new Group();\n    this.geo = makePoly(stickerDat.coords as number[][], this.faceColor);\n    const obj = new Mesh(this.geo, stickerMaterial);\n    obj.userData.name =\n      stickerDat.orbit + \" \" + (1 + stickerDat.ord) + \" \" + stickerDat.ori;\n    this.cubie.add(obj);\n    if (foundationDat) {\n      const fgeo = makePoly(foundationDat.coords as number[][], this.faceColor);\n      const foundation = new Mesh(fgeo, foundationMaterial);\n      foundation.scale.setScalar(0.999); // TODO: hacky\n      this.cubie.add(foundation);\n    }\n  }\n\n  public setColor(c: Color): void {\n    this.geo.colorsNeedUpdate = true;\n    this.faceColor.copy(c);\n  }\n}\n\nclass HitPlaneDef {\n  public cubie: Group;\n  protected geo: Geometry;\n  constructor(hitface: any) {\n    this.cubie = new Group();\n    this.geo = new Geometry();\n    const coords = hitface.coords as number[][];\n    const vertind: number[] = [];\n    for (const coord of coords) {\n      const v = new Vector3(coord[0], coord[1], coord[2]);\n      vertind.push(this.geo.vertices.length);\n      this.geo.vertices.push(v);\n    }\n    for (let g = 1; g + 1 < vertind.length; g++) {\n      const face = new Face3(vertind[0], vertind[g], vertind[g + 1]);\n      this.geo.faces.push(face);\n    }\n    this.geo.computeFaceNormals();\n    const obj = new Mesh(this.geo, polyMaterial);\n    obj.userData.name = hitface.name;\n    this.cubie.scale.setScalar(0.99);\n    this.cubie.add(obj);\n  }\n}\n\nclass AxisInfo {\n  public axis: Vector3;\n  public order: number;\n  constructor(axisDat: any) {\n    const vec = axisDat[0] as number[];\n    this.axis = new Vector3(vec[0], vec[1], vec[2]);\n    this.order = axisDat[2];\n  }\n}\n\nconst PG_SCALE = 0.5;\n\n// TODO: Split into \"scene model\" and \"view\".\nexport class PG3D extends Object3D implements Twisty3DPuzzle {\n  private stickers: { [key: string]: StickerDef[][] };\n  private axesInfo: { [key: string]: AxisInfo };\n\n  private stickerTargets: Object3D[] = [];\n  private controlTargets: Object3D[] = [];\n\n  constructor(\n    cursor: AlgCursor,\n    private scheduleRenderCallback: () => void,\n    private definition: KPuzzleDefinition,\n    private pgdat: StickerDat,\n    showFoundation: boolean = false,\n  ) {\n    super();\n\n    this.axesInfo = {};\n    const axesDef = this.pgdat.axis as any[];\n    for (const axis of axesDef) {\n      this.axesInfo[axis[1]] = new AxisInfo(axis);\n    }\n    const stickers = this.pgdat.stickers as any[];\n    this.stickers = {};\n    for (let si = 0; si < stickers.length; si++) {\n      const sticker = stickers[si];\n      const foundation = showFoundation\n        ? this.pgdat.foundations[si]\n        : undefined;\n      const orbit = sticker.orbit as number;\n      const ord = sticker.ord as number;\n      const ori = sticker.ori as number;\n      if (!this.stickers[orbit]) {\n        this.stickers[orbit] = [];\n      }\n      if (!this.stickers[orbit][ori]) {\n        this.stickers[orbit][ori] = [];\n      }\n      const stickerdef = new StickerDef(sticker, foundation);\n      stickerdef.cubie.scale.set(PG_SCALE, PG_SCALE, PG_SCALE);\n      this.stickers[orbit][ori][ord] = stickerdef;\n      this.add(stickerdef.cubie);\n      this.stickerTargets.push(stickerdef.cubie.children[0]);\n    }\n    const hitfaces = this.pgdat.faces as any[];\n    for (const hitface of hitfaces) {\n      const facedef = new HitPlaneDef(hitface);\n      facedef.cubie.scale.set(PG_SCALE, PG_SCALE, PG_SCALE);\n      this.add(facedef.cubie);\n      this.controlTargets.push(facedef.cubie.children[0]);\n    }\n\n    cursor!.addPositionListener(this);\n  }\n\n  public experimentalGetStickerTargets(): Object3D[] {\n    return this.stickerTargets;\n  }\n\n  public experimentalGetControlTargets(): Object3D[] {\n    return this.controlTargets;\n  }\n\n  public onPositionChange(p: PuzzlePosition): void {\n    const pos = p.state as Transformation;\n    const noRotation = new Euler();\n    for (const orbit in this.stickers) {\n      const pieces = this.stickers[orbit];\n      const pos2 = pos[orbit];\n      const orin = pieces.length;\n      for (let ori = 0; ori < orin; ori++) {\n        const pieces2 = pieces[ori];\n        for (let i = 0; i < pieces2.length; i++) {\n          pieces2[i].cubie.rotation.copy(noRotation);\n          const nori = (ori + orin - pos2.orientation[i]) % orin;\n          const ni = pos2.permutation[i];\n          pieces2[i].setColor(pieces[nori][ni].origColor);\n        }\n      }\n    }\n    // FIXME tgr const kp = new KPuzzle(this.definition);\n    for (const moveProgress of p.movesInProgress) {\n      const externalBlockMove = moveProgress.move as BlockMove;\n      // TODO: unswizzle goes external to internal, and so does the call after that\n      // and so does the stateForBlockMove call\n      const unswizzled = this.pgdat.unswizzle(externalBlockMove);\n      const blockMove = this.pgdat.notationMapper.notationToInternal(\n        externalBlockMove,\n      );\n      const simpleMove = modifiedBlockMove(externalBlockMove, { amount: 1 });\n      const baseMove = stateForBlockMove(this.definition, simpleMove);\n      const ax = this.axesInfo[unswizzled];\n      const turnNormal = ax.axis;\n      const angle =\n        (-this.ease(moveProgress.fraction) *\n          moveProgress.direction *\n          blockMove.amount *\n          TAU) /\n        ax.order;\n      for (const orbit in this.stickers) {\n        const pieces = this.stickers[orbit];\n        const orin = pieces.length;\n        const bmv = baseMove[orbit];\n        for (let ori = 0; ori < orin; ori++) {\n          const pieces2 = pieces[ori];\n          for (let i = 0; i < pieces2.length; i++) {\n            const ni = bmv.permutation[i];\n            if (ni !== i || bmv.orientation[i] !== 0) {\n              pieces2[i].cubie.rotateOnAxis(turnNormal, angle);\n            }\n          }\n        }\n      }\n    }\n    this.scheduleRenderCallback!();\n  }\n\n  private ease(fraction: number): number {\n    return smootherStep(fraction);\n  }\n}\n", "import { Scene as ThreeScene, PointLight } from \"three\";\nimport { Twisty3DRenderTarget } from \"./Twisty3DRenderTarget\";\nimport { Twisty3DPuzzle } from \"./puzzles/Twisty3DPuzzle\";\n\nexport class Twisty3DScene extends ThreeScene implements Twisty3DRenderTarget {\n  private renderTargets: Set<Twisty3DRenderTarget> = new Set();\n  public twisty3Ds: Set<Twisty3DPuzzle> = new Set();\n\n  constructor() {\n    super();\n\n    const lights = [];\n    lights[0] = new PointLight(0xffffff, 1, 0);\n    lights[1] = new PointLight(0xffffff, 1, 0);\n    lights[2] = new PointLight(0xffffff, 1, 0);\n\n    lights[0].position.set(0, 200, 0);\n    lights[1].position.set(100, 200, 100);\n    lights[2].position.set(-100, -200, -100);\n\n    this.add(lights[0]);\n    this.add(lights[1]);\n    this.add(lights[2]);\n  }\n\n  addRenderTarget(renderTarget: Twisty3DRenderTarget): void {\n    this.renderTargets.add(renderTarget);\n  }\n\n  scheduleRender(): void {\n    for (const renderTarget of this.renderTargets) {\n      renderTarget.scheduleRender();\n    }\n  }\n\n  addTwisty3DPuzzle(twisty3DPuzzle: Twisty3DPuzzle): void {\n    this.twisty3Ds.add(twisty3DPuzzle);\n    this.add(twisty3DPuzzle);\n  }\n\n  removeTwisty3DPuzzle(twisty3DPuzzle: Twisty3DPuzzle): void {\n    this.twisty3Ds.delete(twisty3DPuzzle);\n    this.remove(twisty3DPuzzle);\n  }\n}\n", "import { BlockMove, blockMoveToString } from \"../../../alg\";\nimport {\n  Combine,\n  EquivalentStates,\n  IdentityTransformation,\n  Invert,\n  KPuzzleDefinition,\n  Puzzles,\n  stateForBlockMove,\n  Transformation,\n} from \"../../../kpuzzle\";\n\nexport type MoveName = string;\n\nexport interface MoveProgress {\n  blockMove: BlockMove;\n  fraction: number;\n}\n\n// tslint:disable-next-line no-empty-interfaces\n// eslint-disable-next-line @typescript-eslint/no-empty-interface, @typescript-eslint/no-unused-vars-experimental\nexport interface State<T extends PuzzleWrapper> {}\n\nexport abstract class PuzzleWrapper {\n  public abstract startState(): State<PuzzleWrapper>;\n  public abstract invert(state: State<PuzzleWrapper>): State<PuzzleWrapper>;\n  public abstract combine(\n    s1: State<PuzzleWrapper>,\n    s2: State<PuzzleWrapper>,\n  ): State<PuzzleWrapper>;\n\n  public multiply(\n    state: State<PuzzleWrapper>,\n    amount: number,\n  ): State<PuzzleWrapper> {\n    if (amount < 0) {\n      return this.invert(this.multiply(state, -amount));\n    }\n\n    let newState = this.identity();\n    while (amount > 0) {\n      if (amount % 2 === 1) {\n        newState = this.combine(newState, state);\n      }\n      amount = Math.floor(amount / 2);\n      state = this.combine(state, state);\n    }\n    return newState;\n  }\n\n  public abstract stateFromMove(blockMove: BlockMove): State<PuzzleWrapper>;\n  public abstract identity(): State<PuzzleWrapper>;\n  public abstract equivalent(\n    s1: State<PuzzleWrapper>,\n    s2: State<PuzzleWrapper>,\n  ): boolean;\n}\n\ninterface KSolvePuzzleState extends Transformation, State<KPuzzleWrapper> {}\n\nexport class KPuzzleWrapper extends PuzzleWrapper {\n  // don't work the underlying kdefinition/multiply so hard\n  public static fromID(id: string): KPuzzleWrapper {\n    return new KPuzzleWrapper(Puzzles[id]);\n  }\n\n  public moveStash: { [key: string]: Transformation } = {};\n  constructor(private definition: KPuzzleDefinition) {\n    super();\n  }\n\n  public startState(): KSolvePuzzleState {\n    return this.definition.startPieces;\n  }\n\n  public invert(state: KSolvePuzzleState): KSolvePuzzleState {\n    return Invert(this.definition, state);\n  }\n\n  public combine(\n    s1: KSolvePuzzleState,\n    s2: KSolvePuzzleState,\n  ): KSolvePuzzleState {\n    return Combine(this.definition, s1, s2);\n  }\n\n  public stateFromMove(blockMove: BlockMove): KSolvePuzzleState {\n    const key = blockMoveToString(blockMove);\n    if (!this.moveStash[key]) {\n      this.moveStash[key] = stateForBlockMove(this.definition, blockMove);\n    }\n    return this.moveStash[key];\n  }\n\n  public identity(): KSolvePuzzleState {\n    return IdentityTransformation(this.definition);\n  }\n\n  public equivalent(s1: KSolvePuzzleState, s2: KSolvePuzzleState): boolean {\n    return EquivalentStates(this.definition, s1, s2);\n  }\n}\n\nclass QTMCounterState implements State<QTMCounterPuzzle> {\n  constructor(public value: number) {}\n}\n\nexport class QTMCounterPuzzle extends PuzzleWrapper {\n  public startState(): QTMCounterState {\n    return new QTMCounterState(0);\n  }\n\n  public invert(state: QTMCounterState): QTMCounterState {\n    return new QTMCounterState(-state.value);\n  }\n\n  public combine(s1: QTMCounterState, s2: QTMCounterState): QTMCounterState {\n    return new QTMCounterState(s1.value + s2.value);\n  }\n\n  public stateFromMove(blockMove: BlockMove): QTMCounterState {\n    return new QTMCounterState(Math.abs(blockMove.amount));\n  }\n\n  public identity(): QTMCounterState {\n    return new QTMCounterState(0);\n  }\n\n  public equivalent(s1: QTMCounterState, s2: QTMCounterState): boolean {\n    return s1.value === s2.value;\n  }\n}\n", "import { AlgPart } from \"../../../alg\";\nimport { Transformation as KPuzzleState } from \"../../../kpuzzle\";\n\nexport type MillisecondTimestamp = number;\n\n// TODO: unify duration/timstamp types\nexport type Duration = MillisecondTimestamp; // Duration in milliseconds\n// TODO: Extend `number`, introduce MoveSequenceTimestamp vs. EpochTimestamp,\n// force Duration to be a difference.\nexport type Timestamp = MillisecondTimestamp; // Duration since a particular epoch.\n\nexport type Fraction = number; // Value from 0 to 1.\n\n// 1, 0, -1 are used as scalars for `directionScalar` below.\nexport enum Direction {\n  Forwards = 1,\n  Paused = 0,\n  Backwards = -1,\n}\n\nexport function directionScalar(direction: Direction): MillisecondTimestamp {\n  return direction;\n}\n\nexport interface MoveInProgress {\n  move: AlgPart;\n  direction: Direction;\n  fraction: number;\n}\n\nexport type PuzzlePosition = {\n  state: KPuzzleState;\n  movesInProgress: MoveInProgress[];\n};\n\nexport enum BoundaryType {\n  Move,\n  EntireTimeline,\n}\n\nexport type DurationForAmount = (amount: number) => Duration;\n// eslint-disable-next-line no-inner-declarations\n\nexport function ConstantDurationForAmount(_amount: number): Duration {\n  return 1000;\n}\n\n// eslint-disable-next-line no-inner-declarations\nexport function DefaultDurationForAmount(amount: number): Duration {\n  switch (Math.abs(amount)) {\n    case 0:\n      return 0;\n    case 1:\n      return 1000;\n    case 2:\n      return 1500;\n    default:\n      return 2000;\n  }\n}\n// eslint-disable-next-line no-inner-declarations\nexport function ExperimentalScaledDefaultDurationForAmount(\n  scale: number,\n  amount: number,\n): Duration {\n  switch (Math.abs(amount)) {\n    case 0:\n      return 0;\n    case 1:\n      return scale * 1000;\n    case 2:\n      return scale * 1500;\n    default:\n      return scale * 2000;\n  }\n}\n", "import { AlgPart } from \"../../../alg\";\nimport { Transformation as KPuzzleState } from \"../../../kpuzzle\";\n\nexport type MillisecondTimestamp = number;\n\n// TODO: unify duration/timstamp types\nexport type Duration = MillisecondTimestamp; // Duration in milliseconds\n// TODO: Extend `number`, introduce MoveSequenceTimestamp vs. EpochTimestamp,\n// force Duration to be a difference.\nexport type Timestamp = MillisecondTimestamp; // Duration since a particular epoch.\n\nexport type Fraction = number; // Value from 0 to 1.\n\n// 1, 0, -1 are used as scalars for `directionScalar` below.\nexport enum Direction {\n  Forwards = 1,\n  Paused = 0,\n  Backwards = -1,\n}\n\nexport function directionScalar(direction: Direction): MillisecondTimestamp {\n  return direction;\n}\n\nexport interface MoveInProgress {\n  move: AlgPart;\n  direction: Direction;\n  fraction: number;\n}\n\nexport type PuzzlePosition = {\n  state: KPuzzleState;\n  movesInProgress: MoveInProgress[];\n};\n\nexport enum BoundaryType {\n  Move,\n  EntireTimeline,\n}\n\nexport type DurationForAmount = (amount: number) => Duration;\n// eslint-disable-next-line no-inner-declarations\n\nexport function ConstantDurationForAmount(_amount: number): Duration {\n  return 1000;\n}\n\n// eslint-disable-next-line no-inner-declarations\nexport function DefaultDurationForAmount(amount: number): Duration {\n  switch (Math.abs(amount)) {\n    case 0:\n      return 0;\n    case 1:\n      return 1000;\n    case 2:\n      return 1500;\n    default:\n      return 2000;\n  }\n}\n// eslint-disable-next-line no-inner-declarations\nexport function ExperimentalScaledDefaultDurationForAmount(\n  scale: number,\n  amount: number,\n): Duration {\n  switch (Math.abs(amount)) {\n    case 0:\n      return 0;\n    case 1:\n      return scale * 1000;\n    case 2:\n      return scale * 1500;\n    default:\n      return scale * 2000;\n  }\n}\n", "import {\n  BlockMove,\n  Comment,\n  Commutator,\n  Conjugate,\n  Group,\n  NewLine,\n  Pause,\n  Sequence,\n  TraversalUp,\n} from \"../../../alg\";\nimport { Duration, DefaultDurationForAmount } from \"./CursorTypes\";\nexport class AlgDuration extends TraversalUp<Duration> {\n  // TODO: Pass durationForAmount as Down type instead?\n  constructor(\n    public durationForAmount: (\n      amount: number,\n    ) => Duration = DefaultDurationForAmount,\n  ) {\n    super();\n  }\n\n  public traverseSequence(sequence: Sequence): Duration {\n    let total = 0;\n    for (const alg of sequence.nestedUnits) {\n      total += this.traverse(alg);\n    }\n    return total;\n  }\n\n  public traverseGroup(group: Group): Duration {\n    return group.amount * this.traverse(group.nestedSequence);\n  }\n\n  public traverseBlockMove(blockMove: BlockMove): Duration {\n    return this.durationForAmount(blockMove.amount);\n  }\n\n  public traverseCommutator(commutator: Commutator): Duration {\n    return (\n      commutator.amount *\n      2 *\n      (this.traverse(commutator.A) + this.traverse(commutator.B))\n    );\n  }\n\n  public traverseConjugate(conjugate: Conjugate): Duration {\n    return (\n      conjugate.amount *\n      (2 * this.traverse(conjugate.A) + this.traverse(conjugate.B))\n    );\n  }\n\n  public traversePause(_pause: Pause): Duration {\n    return this.durationForAmount(1);\n  }\n\n  public traverseNewLine(_newLine: NewLine): Duration {\n    return this.durationForAmount(1);\n  }\n\n  public traverseComment(_comment: Comment): Duration {\n    return this.durationForAmount(0);\n  }\n}\n", "import {\n  AlgPart,\n  BlockMove,\n  Comment,\n  Commutator,\n  Conjugate,\n  Group,\n  NewLine,\n  Pause,\n  Sequence,\n  TraversalDownUp,\n  TraversalUp,\n  Unit,\n} from \"../../../alg\";\nimport { PuzzleWrapper, State } from \"../../3D/puzzles/KPuzzleWrapper\";\nimport { Timestamp, Duration, DefaultDurationForAmount } from \"./CursorTypes\";\nimport { AlgDuration } from \"./AlgDuration\";\n\n// TODO: Include Pause.\nclass CountAnimatedMoves extends TraversalUp<number> {\n  public traverseSequence(sequence: Sequence): number {\n    let total = 0;\n    for (const part of sequence.nestedUnits) {\n      total += this.traverse(part);\n    }\n    return total;\n  }\n\n  public traverseGroup(group: Group): number {\n    return this.traverseSequence(group.nestedSequence);\n  }\n\n  public traverseBlockMove(_blockMove: BlockMove): number {\n    return 1;\n  }\n\n  public traverseCommutator(commutator: Commutator): number {\n    return (\n      2 *\n      (this.traverseSequence(commutator.A) +\n        this.traverseSequence(commutator.B))\n    );\n  }\n\n  public traverseConjugate(conjugate: Conjugate): number {\n    return (\n      2 * this.traverseSequence(conjugate.A) +\n      this.traverseSequence(conjugate.B)\n    );\n  }\n\n  public traversePause(_pause: Pause): number {\n    return 0;\n  }\n\n  public traverseNewLine(_newLine: NewLine): number {\n    return 0;\n  }\n\n  public traverseComment(_comment: Comment): number {\n    return 0;\n  }\n}\n\nexport interface AlgIndexer<P extends PuzzleWrapper> {\n  getMove(index: number): BlockMove;\n  indexToMoveStartTimestamp(index: number): Timestamp;\n  stateAtIndex(index: number, startTransformation?: State<P>): State<P>;\n  transformAtIndex(index: number): State<P>;\n  numMoves(): number;\n  timestampToIndex(timestamp: Timestamp): number;\n  algDuration(): Duration;\n  moveDuration(index: number): number;\n}\n\nexport class AlgPartDecoration<P extends PuzzleWrapper> {\n  constructor(\n    _puz: PuzzleWrapper,\n    public moveCount: number,\n    public duration: number,\n    public forward: State<P>,\n    public backward: State<P>,\n    public children: Array<AlgPartDecoration<P>> = [],\n  ) {}\n}\nexport class DecoratorConstructor<P extends PuzzleWrapper> extends TraversalUp<\n  AlgPartDecoration<P>\n> {\n  private identity: State<P>;\n  private dummyLeaf: AlgPartDecoration<P>;\n  private durationFn: TraversalUp<Duration> = new AlgDuration(\n    DefaultDurationForAmount,\n  );\n\n  constructor(private puz: PuzzleWrapper) {\n    super();\n    this.identity = puz.identity();\n    this.dummyLeaf = new AlgPartDecoration<P>(\n      puz,\n      0,\n      0,\n      this.identity,\n      this.identity,\n      [],\n    );\n  }\n\n  public traverseSequence(sequence: Sequence): AlgPartDecoration<P> {\n    let moveCount = 0;\n    let duration = 0;\n    let state = this.identity;\n    const child: Array<AlgPartDecoration<P>> = [];\n    for (const part of sequence.nestedUnits) {\n      const apd = this.traverse(part);\n      moveCount += apd.moveCount;\n      duration += apd.duration;\n      state = this.puz.combine(state, apd.forward);\n      child.push(apd);\n    }\n    return new AlgPartDecoration<P>(\n      this.puz,\n      moveCount,\n      duration,\n      state,\n      this.puz.invert(state),\n      child,\n    );\n  }\n\n  public traverseGroup(group: Group): AlgPartDecoration<P> {\n    const dec = this.traverseSequence(group.nestedSequence);\n    return this.mult(dec, group.amount, [dec]);\n  }\n\n  public traverseBlockMove(blockMove: BlockMove): AlgPartDecoration<P> {\n    return new AlgPartDecoration<P>(\n      this.puz,\n      1,\n      this.durationFn.traverse(blockMove),\n      this.puz.stateFromMove(blockMove),\n      this.puz.stateFromMove(invertBlockMove(blockMove)),\n    );\n  }\n\n  public traverseCommutator(commutator: Commutator): AlgPartDecoration<P> {\n    const decA = this.traverseSequence(commutator.A);\n    const decB = this.traverseSequence(commutator.B);\n    const AB = this.puz.combine(decA.forward, decB.forward);\n    const ApBp = this.puz.combine(decA.backward, decB.backward);\n    const ABApBp = this.puz.combine(AB, ApBp);\n    const dec = new AlgPartDecoration<P>(\n      this.puz,\n      2 * (decA.moveCount + decB.moveCount),\n      2 * (decA.duration + decB.duration),\n      ABApBp,\n      this.puz.invert(ABApBp),\n      [decA, decB],\n    );\n    return this.mult(dec, commutator.amount, [dec, decA, decB]);\n  }\n\n  public traverseConjugate(conjugate: Conjugate): AlgPartDecoration<P> {\n    const decA = this.traverseSequence(conjugate.A);\n    const decB = this.traverseSequence(conjugate.B);\n    const AB = this.puz.combine(decA.forward, decB.forward);\n    const ABAp = this.puz.combine(AB, decA.backward);\n    const dec = new AlgPartDecoration<P>(\n      this.puz,\n      2 * decA.moveCount + decB.moveCount,\n      2 * decA.duration + decB.duration,\n      ABAp,\n      this.puz.invert(ABAp),\n      [decA, decB],\n    );\n    return this.mult(dec, conjugate.amount, [dec, decA, decB]);\n  }\n\n  public traversePause(pause: Pause): AlgPartDecoration<P> {\n    return new AlgPartDecoration<P>(\n      this.puz,\n      1,\n      this.durationFn.traverse(pause),\n      this.identity,\n      this.identity,\n    );\n  }\n\n  public traverseNewLine(_newLine: NewLine): AlgPartDecoration<P> {\n    return this.dummyLeaf;\n  }\n\n  public traverseComment(_comment: Comment): AlgPartDecoration<P> {\n    return this.dummyLeaf;\n  }\n\n  private mult(\n    apd: AlgPartDecoration<P>,\n    n: number,\n    child: Array<AlgPartDecoration<P>>,\n  ): AlgPartDecoration<P> {\n    const absn = Math.abs(n);\n    const st = this.puz.multiply(apd.forward, n);\n    return new AlgPartDecoration<P>(\n      this.puz,\n      apd.moveCount * absn,\n      apd.duration * absn,\n      st,\n      this.puz.invert(st),\n      child,\n    );\n  }\n}\nclass WalkerDown<P extends PuzzleWrapper> {\n  constructor(public apd: AlgPartDecoration<P>, public back: boolean) {\n    /**/\n  }\n}\nexport class AlgWalker<P extends PuzzleWrapper> extends TraversalDownUp<\n  WalkerDown<P>,\n  boolean\n> {\n  public mv?: Unit;\n  public moveDur: number;\n  public back: boolean;\n  public st: State<P>;\n  public root: WalkerDown<P>;\n  public i: number;\n  public dur: number;\n  private goali: number;\n  private goaldur: number;\n  constructor(\n    public puz: P,\n    public alg: AlgPart,\n    public apd: AlgPartDecoration<P>,\n  ) {\n    super();\n    this.i = -1;\n    this.dur = -1;\n    this.goali = -1;\n    this.goaldur = -1;\n    this.mv = undefined;\n    this.back = false;\n    this.moveDur = 0;\n    this.st = this.puz.identity();\n    this.root = new WalkerDown(this.apd, false);\n  }\n\n  public moveByIndex(loc: number): boolean {\n    if (this.i >= 0 && this.i === loc) {\n      return this.mv !== undefined;\n    }\n    return this.dosearch(loc, Infinity);\n  }\n\n  public moveByDuration(dur: number): boolean {\n    if (this.dur >= 0 && this.dur < dur && this.dur + this.moveDur >= dur) {\n      return this.mv !== undefined;\n    }\n    return this.dosearch(Infinity, dur);\n  }\n\n  public dosearch(loc: number, dur: number): boolean {\n    this.goali = loc;\n    this.goaldur = dur;\n    this.i = 0;\n    this.dur = 0;\n    this.mv = undefined;\n    this.moveDur = 0;\n    this.back = false;\n    this.st = this.puz.identity();\n    const r = this.traverse(this.alg, this.root);\n    return r;\n  }\n\n  public traverseSequence(sequence: Sequence, wd: WalkerDown<P>): boolean {\n    if (!this.firstcheck(wd)) {\n      return false;\n    }\n    if (wd.back) {\n      for (let i = sequence.nestedUnits.length - 1; i >= 0; i--) {\n        const part = sequence.nestedUnits[i];\n        if (this.traverse(part, new WalkerDown(wd.apd.children[i], wd.back))) {\n          return true;\n        }\n      }\n    } else {\n      for (let i = 0; i < sequence.nestedUnits.length; i++) {\n        const part = sequence.nestedUnits[i];\n        if (this.traverse(part, new WalkerDown(wd.apd.children[i], wd.back))) {\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n\n  public traverseGroup(group: Group, wd: WalkerDown<P>): boolean {\n    if (!this.firstcheck(wd)) {\n      return false;\n    }\n    const back = this.domult(wd, group.amount);\n    return this.traverse(\n      group.nestedSequence,\n      new WalkerDown(wd.apd.children[0], back),\n    );\n  }\n\n  public traverseBlockMove(blockMove: BlockMove, wd: WalkerDown<P>): boolean {\n    if (!this.firstcheck(wd)) {\n      return false;\n    }\n    this.mv = blockMove;\n    this.moveDur = wd.apd.duration;\n    this.back = wd.back;\n    return true;\n  }\n\n  public traverseCommutator(\n    commutator: Commutator,\n    wd: WalkerDown<P>,\n  ): boolean {\n    if (!this.firstcheck(wd)) {\n      return false;\n    }\n    const back = this.domult(wd, commutator.amount);\n    if (back) {\n      return (\n        this.traverse(\n          commutator.B,\n          new WalkerDown(wd.apd.children[2], !back),\n        ) ||\n        this.traverse(\n          commutator.A,\n          new WalkerDown(wd.apd.children[1], !back),\n        ) ||\n        this.traverse(commutator.B, new WalkerDown(wd.apd.children[2], back)) ||\n        this.traverse(commutator.A, new WalkerDown(wd.apd.children[1], back))\n      );\n    } else {\n      return (\n        this.traverse(commutator.A, new WalkerDown(wd.apd.children[1], back)) ||\n        this.traverse(commutator.B, new WalkerDown(wd.apd.children[2], back)) ||\n        this.traverse(\n          commutator.A,\n          new WalkerDown(wd.apd.children[1], !back),\n        ) ||\n        this.traverse(commutator.B, new WalkerDown(wd.apd.children[2], !back))\n      );\n    }\n  }\n\n  public traverseConjugate(conjugate: Conjugate, wd: WalkerDown<P>): boolean {\n    if (!this.firstcheck(wd)) {\n      return false;\n    }\n    const back = this.domult(wd, conjugate.amount);\n    if (back) {\n      return (\n        this.traverse(conjugate.A, new WalkerDown(wd.apd.children[1], !back)) ||\n        this.traverse(conjugate.B, new WalkerDown(wd.apd.children[2], back)) ||\n        this.traverse(conjugate.A, new WalkerDown(wd.apd.children[1], back))\n      );\n    } else {\n      return (\n        this.traverse(conjugate.A, new WalkerDown(wd.apd.children[1], back)) ||\n        this.traverse(conjugate.B, new WalkerDown(wd.apd.children[2], back)) ||\n        this.traverse(conjugate.A, new WalkerDown(wd.apd.children[1], !back))\n      );\n    }\n  }\n\n  public traversePause(pause: Pause, wd: WalkerDown<P>): boolean {\n    if (!this.firstcheck(wd)) {\n      return false;\n    }\n    this.mv = pause;\n    this.moveDur = wd.apd.duration;\n    this.back = wd.back;\n    return true;\n  }\n\n  public traverseNewLine(_newLine: NewLine, _wd: WalkerDown<P>): boolean {\n    return false;\n  }\n\n  public traverseComment(_comment: Comment, _wd: WalkerDown<P>): boolean {\n    return false;\n  }\n\n  private firstcheck(wd: WalkerDown<P>): boolean {\n    if (\n      wd.apd.moveCount + this.i <= this.goali &&\n      wd.apd.duration + this.dur < this.goaldur\n    ) {\n      return this.keepgoing(wd);\n    }\n    return true;\n  }\n\n  private domult(wd: WalkerDown<P>, amount: number): boolean {\n    let back = wd.back;\n    if (amount === 0) {\n      // I don't believe this will ever happen\n      return back;\n    }\n    if (amount < 0) {\n      back = !back;\n      amount = -amount;\n    }\n    const base = wd.apd.children[0];\n    const full = Math.min(\n      Math.floor((this.goali - this.i) / base.moveCount),\n      Math.ceil((this.goaldur - this.dur) / base.duration - 1),\n    );\n    if (full > 0) {\n      this.keepgoing(new WalkerDown<P>(base, back), full);\n    }\n    return back;\n  }\n\n  private keepgoing(wd: WalkerDown<P>, mul: number = 1): boolean {\n    this.i += mul * wd.apd.moveCount;\n    this.dur += mul * wd.apd.duration;\n    if (mul !== 1) {\n      if (wd.back) {\n        this.st = this.puz.combine(\n          this.st,\n          this.puz.multiply(wd.apd.backward, mul),\n        );\n      } else {\n        this.st = this.puz.combine(\n          this.st,\n          this.puz.multiply(wd.apd.forward, mul),\n        );\n      }\n    } else {\n      if (wd.back) {\n        this.st = this.puz.combine(this.st, wd.apd.backward);\n      } else {\n        this.st = this.puz.combine(this.st, wd.apd.forward);\n      }\n    }\n    return false;\n  }\n}\nexport function invertBlockMove(bm: BlockMove): BlockMove {\n  return new BlockMove(bm.outerLayer, bm.innerLayer, bm.family, -bm.amount);\n}\nconst countAnimatedMovesInstance = new CountAnimatedMoves();\nexport const countAnimatedMoves = countAnimatedMovesInstance.traverse.bind(\n  countAnimatedMovesInstance,\n);\n", "import { BlockMove, Sequence } from \"../../../alg\";\nimport { PuzzleWrapper, State } from \"../../3D/puzzles/KPuzzleWrapper\";\nimport {\n  AlgIndexer,\n  AlgPartDecoration,\n  AlgWalker,\n  DecoratorConstructor,\n  invertBlockMove,\n} from \"./AlgIndexer\";\nimport { Timestamp, Duration } from \"./CursorTypes\";\n\nexport class TreeAlgIndexer<P extends PuzzleWrapper> implements AlgIndexer<P> {\n  private decoration: AlgPartDecoration<P>;\n  private walker: AlgWalker<P>;\n  constructor(private puzzle: P, alg: Sequence) {\n    const deccon = new DecoratorConstructor<P>(this.puzzle);\n    this.decoration = deccon.traverse(alg);\n    this.walker = new AlgWalker<P>(this.puzzle, alg, this.decoration);\n  }\n\n  public getMove(index: number): BlockMove {\n    // FIXME need to support Pause\n    if (this.walker.moveByIndex(index)) {\n      if (!this.walker.mv) {\n        throw new Error(\"`this.walker.mv` missing\");\n      }\n      const bm = this.walker.mv as BlockMove;\n      // TODO: this type of negation needs to be in alg\n      if (this.walker.back) {\n        return invertBlockMove(bm);\n      }\n      return bm;\n    }\n    throw new Error(\"Out of algorithm: index \" + index);\n  }\n\n  public indexToMoveStartTimestamp(index: number): Timestamp {\n    if (this.walker.moveByIndex(index) || this.walker.i === index) {\n      return this.walker.dur;\n    }\n    throw new Error(\"Out of algorithm: index \" + index);\n  }\n\n  public stateAtIndex(index: number, startTransformation?: State<P>): State<P> {\n    this.walker.moveByIndex(index);\n    return this.puzzle.combine(\n      startTransformation ?? this.puzzle.startState(),\n      this.walker.st,\n    );\n  }\n\n  // TransformAtIndex does not reflect the start state; it only reflects\n  // the change from the start state to the current move index.  If you\n  // want the actual state, use stateAtIndex.\n  public transformAtIndex(index: number): State<P> {\n    this.walker.moveByIndex(index);\n    return this.walker.st;\n  }\n\n  public numMoves(): number {\n    return this.decoration.moveCount;\n  }\n\n  public timestampToIndex(timestamp: Timestamp): number {\n    this.walker.moveByDuration(timestamp);\n    return this.walker.i;\n  }\n\n  public algDuration(): Duration {\n    return this.decoration.duration;\n  }\n\n  public moveDuration(index: number): number {\n    this.walker.moveByIndex(index);\n    return this.walker.moveDur;\n  }\n}\n", "/* eslint-disable no-case-declarations */\n// TODO: private vs. public properties/methods.\n// TODO: optional construtor arguments for DOM elements\n// TODO: figure out what can be moved into a worker using OffscreenCanvas https://developers.google.com/web/updates/2018/08/offscreen-canvas\n\n/* eslint-disable @typescript-eslint/no-empty-interface */\n\n// start of imports\nimport { Sequence } from \"../../../alg\";\nimport { KPuzzle, KPuzzleDefinition, Transformation } from \"../../../kpuzzle\";\nimport { KPuzzleWrapper } from \"../../3D/puzzles/KPuzzleWrapper\";\nimport { Timeline, TimelineTimestampListener } from \"../Timeline\";\nimport {\n  Direction,\n  directionScalar,\n  PuzzlePosition,\n  MillisecondTimestamp,\n} from \"./CursorTypes\";\nimport { TreeAlgIndexer } from \"./TreeAlgIndexer\";\n// end of imports\n\n// Model\n\nexport interface PositionListener {\n  onPositionChange(position: PuzzlePosition): void;\n}\n\nexport interface PositionDispatcher {\n  addPositionListener(positionListener: PositionListener): void;\n}\n\nexport interface TimeRange {\n  start: MillisecondTimestamp;\n  end: MillisecondTimestamp;\n}\n\nexport class AlgCursor\n  implements TimelineTimestampListener, PositionDispatcher {\n  private todoIndexer: TreeAlgIndexer<KPuzzleWrapper>;\n  private positionListeners: Set<PositionListener> = new Set(); // TODO: accessor instead of direct access\n  private ksolvePuzzle: KPuzzleWrapper;\n  private startState: Transformation;\n  constructor(\n    private timeline: Timeline,\n    private def: KPuzzleDefinition,\n    private alg: Sequence,\n    startStateSequence?: Sequence, // TODO: accept actual start state\n  ) {\n    timeline.addTimestampListener(this);\n    this.ksolvePuzzle = new KPuzzleWrapper(def);\n    this.todoIndexer = new TreeAlgIndexer(this.ksolvePuzzle, alg);\n    this.startState = startStateSequence\n      ? this.algToState(startStateSequence)\n      : this.ksolvePuzzle.startState();\n  }\n\n  setStartState(startState: Transformation): void {\n    this.startState = startState;\n    this.dispatchPositionForTimestamp(this.timeline.timestamp);\n  }\n\n  /** @deprecated */\n  algToState(s: Sequence): Transformation {\n    const kpuzzle = new KPuzzle(this.def);\n    kpuzzle.applyAlg(s);\n    return this.ksolvePuzzle.combine(this.def.startPieces, kpuzzle.state);\n  }\n\n  timeRange(): TimeRange {\n    return {\n      start: 0,\n      end: this.todoIndexer.algDuration(),\n    };\n  }\n\n  /** @deprecated */\n  experimentalTimestampForStartOfLastMove(): MillisecondTimestamp {\n    const numMoves = this.todoIndexer.numMoves();\n    if (numMoves > 0) {\n      return this.todoIndexer.indexToMoveStartTimestamp(numMoves - 1);\n    }\n    return 0;\n  }\n\n  addPositionListener(positionListener: PositionListener): void {\n    this.positionListeners.add(positionListener);\n    this.dispatchPositionForTimestamp(this.timeline.timestamp, [\n      positionListener,\n    ]); // TODO: should this be a separate dispatch, or should the listener manually ask for the position?\n  }\n\n  removePositionListener(positionListener: PositionListener): void {\n    this.positionListeners.delete(positionListener);\n  }\n\n  onTimelineTimestampChange(timestamp: MillisecondTimestamp): void {\n    this.dispatchPositionForTimestamp(timestamp);\n  }\n\n  private dispatchPositionForTimestamp(\n    timestamp: MillisecondTimestamp,\n    listeners: PositionListener[] | Set<PositionListener> = this\n      .positionListeners,\n  ): void {\n    const idx = this.todoIndexer.timestampToIndex(timestamp);\n    const state = this.todoIndexer.stateAtIndex(idx, this.startState) as any; // TODO\n    const position: PuzzlePosition = {\n      state,\n      movesInProgress: [],\n    };\n\n    if (this.todoIndexer.numMoves() > 0) {\n      const fraction =\n        (timestamp - this.todoIndexer.indexToMoveStartTimestamp(idx)) /\n        this.todoIndexer.moveDuration(idx);\n      if (fraction === 1) {\n        // TODO: push this into the indexer\n        position.state = this.ksolvePuzzle.combine(\n          state,\n          this.ksolvePuzzle.stateFromMove(this.todoIndexer.getMove(idx)),\n        ) as Transformation;\n      } else if (fraction > 0) {\n        position.movesInProgress.push({\n          move: this.todoIndexer.getMove(idx),\n          direction: Direction.Forwards,\n          fraction,\n        });\n      }\n    }\n\n    for (const listener of listeners) {\n      listener.onPositionChange(position);\n    }\n  }\n\n  onTimeRangeChange(_timeRange: TimeRange): void {\n    // nothing to do\n  }\n\n  setAlg(alg: Sequence): void {\n    this.todoIndexer = new TreeAlgIndexer(this.ksolvePuzzle, alg);\n    this.timeline.onCursorChange(this);\n    this.dispatchPositionForTimestamp(this.timeline.timestamp);\n    // TODO: Handle state change.\n  }\n\n  moveBoundary(\n    timestamp: MillisecondTimestamp,\n    direction: Direction.Backwards | Direction.Forwards,\n  ): MillisecondTimestamp | null {\n    if (this.todoIndexer.numMoves() === 0) {\n      return null;\n    }\n    // TODO: define semantics of indexing edge cases and remove this hack.\n    const offsetHack = directionScalar(direction) * 0.001;\n    const idx = this.todoIndexer.timestampToIndex(timestamp + offsetHack);\n    const moveStart = this.todoIndexer.indexToMoveStartTimestamp(idx);\n\n    if (direction === Direction.Backwards) {\n      return timestamp >= moveStart ? moveStart : null;\n    } else {\n      const moveEnd = moveStart + this.todoIndexer.moveDuration(idx);\n      return timestamp <= moveEnd ? moveEnd : null;\n    }\n  }\n\n  setPuzzle(\n    def: KPuzzleDefinition,\n    alg: Sequence = this.alg,\n    startStateSequence?: Sequence,\n  ): void {\n    this.ksolvePuzzle = new KPuzzleWrapper(def);\n    this.def = def;\n    this.todoIndexer = new TreeAlgIndexer(this.ksolvePuzzle, alg);\n    if (alg !== this.alg) {\n      this.timeline.onCursorChange(this);\n    }\n    this.setStartState(\n      startStateSequence\n        ? this.algToState(startStateSequence)\n        : this.ksolvePuzzle.startState(),\n    );\n    this.alg = alg;\n  }\n}\n", "import { RenderScheduler } from \"./RenderScheduler\";\nimport { AlgCursor, TimeRange } from \"./alg/AlgCursor\";\nimport {\n  BoundaryType,\n  Direction,\n  directionScalar,\n  MillisecondTimestamp,\n} from \"./alg/CursorTypes\";\n\n// TODO: We use symbols to avoid exposing `number` values. Is this performant enough? Should/can we use symbols?\nexport enum TimelineAction {\n  StartingToPlay = \"StartingToPlay\", // TODO playing backwards.\n  Pausing = \"Pausing\",\n  Jumping = \"Jumping\",\n}\n\n// TODO: We use symbols to avoid exposing `number` values. Is this performant enough? Should/can we use symbols?\nexport enum TimestampLocationType {\n  StartOfTimeline = \"Start\",\n  EndOfTimeline = \"End\",\n  StartOfMove = \"StartOfMove\",\n  EndOfMove = \"EndOfMove\",\n  MiddleOfMove = \"MiddleOfMove\",\n  BetweenMoves = \"BetweenMoves\",\n}\n\nexport interface TimelineActionEvent {\n  action: TimelineAction;\n  locationType: TimestampLocationType;\n}\n\n// This should be used by classes that (directly or indirectly) update puzzle\n// state based on a timestamp. It fires every time the timestamp is changed for\n// a new render (e.g. 60 times a second during animation), and only fires if the\n// timestamp has changed since the last call. This means you can use it as a\n// reliable callback telling you when to schedule a new render.\nexport interface TimelineTimestampListener {\n  onTimelineTimestampChange(timestamp: MillisecondTimestamp): void;\n  onTimeRangeChange(timeRange: TimeRange): void;\n}\n\n// This should be used by classes that (directly or indirectly) update UI (e.g.\n// pause/play buttons).\n//\n// Note: the action events of a `Timeline` are not necessarily coordinated with\n// the timestamp events, since timestamp events are tied to animation frames.\n// For example, if you receive a \"pausing\" event, the final frame may already\n// have been drawn, or may be drawn in the near future.\nexport interface TimelineActionListener {\n  onTimelineAction(actionEvent: TimelineActionEvent): void;\n}\n\nexport interface TimelineTimestampDispatcher {\n  addTimestampListener(timestampListener: TimelineTimestampListener): void;\n}\n\nexport interface TimelineActionDispatcher {\n  addActionListener(actionListener: TimelineActionListener): void;\n}\n\n// `performance.now()` is rounded for security concerns, so it's usually not\n// accurate to the millisecond. So we round it, which lets us work with whole ms\n// everywhere.\nfunction getNow(): MillisecondTimestamp {\n  return Math.round(performance.now());\n}\n\nexport class Timeline\n  implements TimelineTimestampDispatcher, TimelineActionDispatcher {\n  animating: boolean = false;\n  tempoScale: number = 1;\n  private cursors: Set<AlgCursor> = new Set();\n  private timestampListeners: Set<TimelineTimestampListener> = new Set();\n  private actionListeners: Set<TimelineActionListener> = new Set();\n  timestamp: number = 0;\n  lastAnimFrameNow: DOMHighResTimeStamp = 0;\n  lastAnimFrameTimestamp: MillisecondTimestamp;\n  private scheduler: RenderScheduler;\n\n  direction: Direction.Backwards | Direction.Forwards = Direction.Forwards; // TODO: handle pausing here?\n\n  boundaryType: BoundaryType = BoundaryType.EntireTimeline;\n  cachedNextBoundary: MillisecondTimestamp;\n\n  constructor() {\n    const animFrame = (_now: MillisecondTimestamp): void => {\n      if (this.animating) {\n        const now = getNow(); // TODO: See if we can use the rAF value without monotonicity issues.;\n        this.timestamp =\n          this.timestamp +\n          this.tempoScale *\n            directionScalar(this.direction) *\n            (now - this.lastAnimFrameNow);\n        this.lastAnimFrameNow = now;\n\n        const atOrPastBoundary =\n          this.direction === Direction.Backwards\n            ? this.timestamp <= this.cachedNextBoundary\n            : this.timestamp >= this.cachedNextBoundary;\n        if (atOrPastBoundary) {\n          this.timestamp = this.cachedNextBoundary;\n          if (this.animating) {\n            this.animating = false;\n            this.dispatchAction(TimelineAction.Pausing);\n          }\n        }\n      }\n\n      if (this.timestamp !== this.lastAnimFrameTimestamp) {\n        this.dispatchTimestamp();\n        this.lastAnimFrameTimestamp = this.timestamp;\n      }\n\n      if (this.animating) {\n        this.scheduler.requestAnimFrame();\n      }\n    };\n    this.scheduler = new RenderScheduler(animFrame);\n  }\n\n  public addCursor(cursor: AlgCursor): void {\n    this.cursors.add(cursor);\n    this.dispatchTimeRange();\n  }\n\n  removeCursor(cursor: AlgCursor): void {\n    this.cursors.delete(cursor);\n    this.clampTimestampToRange();\n    this.dispatchTimeRange();\n  }\n\n  // TODO: test\n  private clampTimestampToRange(): void {\n    const timeRange = this.timeRange();\n    if (this.timestamp < timeRange.start) {\n      this.setTimestamp(timeRange.start);\n    }\n    if (this.timestamp > timeRange.end) {\n      this.setTimestamp(timeRange.end);\n    }\n  }\n\n  // In the future, this might do some calculations or caching.\n  public onCursorChange(_cursor: AlgCursor): void {\n    if (this.timestamp > this.maxTimestamp()) {\n      this.timestamp = this.maxTimestamp();\n    }\n    this.dispatchTimeRange();\n  }\n\n  timeRange(): TimeRange {\n    let start = 0;\n    let end = 0;\n    for (const cursor of this.cursors) {\n      const cursorTimeRange = cursor.timeRange();\n      start = Math.min(start, cursorTimeRange.start);\n      end = Math.max(end, cursorTimeRange.end);\n    }\n\n    return { start, end };\n  }\n\n  minTimestamp(): number {\n    // TODO: Calculate and cache this value every time there's a new cursor.\n    return this.timeRange().start;\n  }\n\n  maxTimestamp(): number {\n    // TODO: Calculate and cache this value every time there's a new cursor.\n    return this.timeRange().end;\n  }\n\n  private dispatchTimeRange(): void {\n    const timeRange = this.timeRange();\n    for (const listener of this.cursors) {\n      // TODO: dedup in case the timestamp hasn't changed sine last time.\n      listener.onTimeRangeChange(timeRange);\n    }\n    // TODO: Combine loops without extra memory?\n    for (const listener of this.timestampListeners) {\n      // TODO: dedup in case the timestamp hasn't changed sine last time.\n      listener.onTimeRangeChange(timeRange);\n    }\n  }\n\n  private dispatchTimestamp(): void {\n    for (const listener of this.cursors) {\n      // TODO: dedup in case the timestamp hasn't changed sine last time.\n      listener.onTimelineTimestampChange(this.timestamp);\n    }\n    // TODO: Combine loops without extra memory?\n    for (const listener of this.timestampListeners) {\n      // TODO: dedup in case the timestamp hasn't changed sine last time.\n      listener.onTimelineTimestampChange(this.timestamp);\n    }\n  }\n\n  addTimestampListener(timestampListener: TimelineTimestampListener): void {\n    this.timestampListeners.add(timestampListener);\n  }\n\n  removeTimestampListener(timestampListener: TimelineTimestampListener): void {\n    this.timestampListeners.delete(timestampListener);\n  }\n\n  addActionListener(actionListener: TimelineActionListener): void {\n    this.actionListeners.add(actionListener);\n  }\n\n  removeActionListener(actionListener: TimelineActionListener): void {\n    this.actionListeners.delete(actionListener);\n  }\n\n  play(): void {\n    this.experimentalPlay(Direction.Forwards, BoundaryType.EntireTimeline);\n  }\n\n  experimentalPlay(\n    direction: Direction.Backwards | Direction.Forwards,\n    boundaryType: BoundaryType = BoundaryType.EntireTimeline,\n  ): void {\n    this.direction = direction;\n    this.boundaryType = boundaryType;\n    const nextBoundary = this.nextBoundary(\n      this.timestamp,\n      direction,\n      this.boundaryType,\n    );\n    if (nextBoundary === null) {\n      return; // Nowhere to end, so we don't animate.\n    }\n    this.cachedNextBoundary = nextBoundary;\n    if (!this.animating) {\n      this.animating = true;\n      this.lastAnimFrameNow = getNow();\n      this.dispatchAction(TimelineAction.StartingToPlay);\n      this.scheduler.requestAnimFrame();\n    }\n  }\n\n  // Non-inclusive\n  private nextBoundary(\n    timestamp: MillisecondTimestamp,\n    direction: Direction.Backwards | Direction.Forwards,\n    boundaryType: BoundaryType = BoundaryType.EntireTimeline,\n  ): MillisecondTimestamp | null {\n    switch (boundaryType) {\n      case BoundaryType.EntireTimeline: {\n        switch (direction) {\n          case Direction.Backwards:\n            return timestamp <= this.minTimestamp()\n              ? null\n              : this.minTimestamp();\n          case Direction.Forwards:\n            return timestamp >= this.maxTimestamp()\n              ? null\n              : this.maxTimestamp();\n          default:\n            throw new Error(\"invalid direction\");\n        }\n      }\n      case BoundaryType.Move: {\n        let result: null | MillisecondTimestamp = null;\n        for (const cursor of this.cursors) {\n          const boundaryTimestamp = cursor.moveBoundary(timestamp, direction);\n          if (boundaryTimestamp !== null) {\n            switch (direction) {\n              case Direction.Backwards: {\n                result = Math.min(\n                  result ?? boundaryTimestamp,\n                  boundaryTimestamp,\n                );\n                break;\n              }\n              case Direction.Forwards: {\n                result = Math.max(\n                  result ?? boundaryTimestamp,\n                  boundaryTimestamp,\n                );\n                break;\n              }\n              default:\n                throw new Error(\"invalid direction\");\n            }\n          }\n        }\n        return result;\n      }\n      default:\n        throw new Error(\"invalid boundary type\");\n    }\n  }\n\n  // One more render may be dispatched after this.\n  pause(): void {\n    // TODO: error if already paused?\n    if (this.animating) {\n      this.animating = false;\n      this.dispatchAction(TimelineAction.Pausing);\n      this.scheduler.requestAnimFrame();\n    }\n  }\n\n  playPause(): void {\n    if (this.animating) {\n      this.pause();\n    } else {\n      if (this.timestamp >= this.maxTimestamp()) {\n        this.timestamp = 0;\n      }\n      this.experimentalPlay(Direction.Forwards, BoundaryType.EntireTimeline);\n    }\n  }\n\n  setTimestamp(timestamp: MillisecondTimestamp): void {\n    this.animating = false;\n    const oldTimestamp = this.timestamp;\n    this.timestamp = timestamp;\n    this.lastAnimFrameNow = getNow();\n\n    if (oldTimestamp !== timestamp) {\n      this.dispatchAction(TimelineAction.Jumping);\n      this.scheduler.requestAnimFrame();\n    }\n  }\n\n  jumpToStart(): void {\n    this.setTimestamp(this.minTimestamp());\n  }\n\n  jumpToEnd(): void {\n    this.setTimestamp(this.maxTimestamp());\n  }\n\n  /** @deprecated */\n  experimentalJumpToLastMove(): void {\n    let max: MillisecondTimestamp = 0;\n    for (const cursor of this.cursors) {\n      max = Math.max(\n        max,\n        cursor.experimentalTimestampForStartOfLastMove() ?? 0,\n      );\n    }\n    this.setTimestamp(max);\n  }\n\n  private dispatchAction(event: TimelineAction): void {\n    let locationType = TimestampLocationType.MiddleOfMove; // TODO\n    switch (this.timestamp) {\n      // TODO\n      case this.minTimestamp():\n        locationType = TimestampLocationType.StartOfTimeline;\n        break;\n      case this.maxTimestamp():\n        locationType = TimestampLocationType.EndOfTimeline;\n        break;\n    }\n\n    const actionEvent: TimelineActionEvent = {\n      action: event,\n      locationType,\n    };\n    for (const listener of this.actionListeners) {\n      listener.onTimelineAction(actionEvent);\n    }\n  }\n}\n", "import { CSSSource } from \"../element/ManagedCustomElement\";\n\nexport const buttonGridCSS = new CSSSource(`\n.wrapper {\n  width: 100%;\n  height: 100%;\n\n  display: grid;\n  grid-template-columns: repeat(6, 1fr);\n}\n`);\n\nexport const buttonCSS = new CSSSource(`\n.wrapper {\n  width: 100%;\n  height: 100%;\n}\n\nbutton {\n  width: 100%;\n  height: 100%;\n  border: none;\n  \n  background-position: center;\n  background-repeat: no-repeat;\n  background-size: contain;\n\n  background-color: rgba(196, 196, 196, 0.75);\n}\n\nbutton:enabled {\n  background-color: rgba(196, 196, 196, 0.75)\n}\n\nbutton:disabled {\n  background-color: rgba(0, 0, 0, 0.4);\n  opacity: 0.25;\n}\n\nbutton:enabled:hover {\n  background-color: rgba(255, 255, 255, 0.75);\n  box-shadow: 0 0 1em rgba(0, 0, 0, 0.25);\n  cursor: pointer;\n}\n\n/* TODO: fullscreen icons have too much padding?? */\nbutton.svg-skip-to-start {\n  background-image: url(\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzNTg0IiBoZWlnaHQ9IjM1ODQiIHZpZXdCb3g9IjAgMCAzNTg0IDM1ODQiPjxwYXRoIGQ9Ik0yNjQzIDEwMzdxMTktMTkgMzItMTN0MTMgMzJ2MTQ3MnEwIDI2LTEzIDMydC0zMi0xM2wtNzEwLTcxMHEtOS05LTEzLTE5djcxMHEwIDI2LTEzIDMydC0zMi0xM2wtNzEwLTcxMHEtOS05LTEzLTE5djY3OHEwIDI2LTE5IDQ1dC00NSAxOUg5NjBxLTI2IDAtNDUtMTl0LTE5LTQ1VjEwODhxMC0yNiAxOS00NXQ0NS0xOWgxMjhxMjYgMCA0NSAxOXQxOSA0NXY2NzhxNC0xMSAxMy0xOWw3MTAtNzEwcTE5LTE5IDMyLTEzdDEzIDMydjcxMHE0LTExIDEzLTE5eiIvPjwvc3ZnPg==\");\n}\n\nbutton.svg-skip-to-end {\n  background-image: url(\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzNTg0IiBoZWlnaHQ9IjM1ODQiIHZpZXdCb3g9IjAgMCAzNTg0IDM1ODQiPjxwYXRoIGQ9Ik05NDEgMjU0N3EtMTkgMTktMzIgMTN0LTEzLTMyVjEwNTZxMC0yNiAxMy0zMnQzMiAxM2w3MTAgNzEwcTggOCAxMyAxOXYtNzEwcTAtMjYgMTMtMzJ0MzIgMTNsNzEwIDcxMHE4IDggMTMgMTl2LTY3OHEwLTI2IDE5LTQ1dDQ1LTE5aDEyOHEyNiAwIDQ1IDE5dDE5IDQ1djE0MDhxMCAyNi0xOSA0NXQtNDUgMTloLTEyOHEtMjYgMC00NS0xOXQtMTktNDV2LTY3OHEtNSAxMC0xMyAxOWwtNzEwIDcxMHEtMTkgMTktMzIgMTN0LTEzLTMydi03MTBxLTUgMTAtMTMgMTl6Ii8+PC9zdmc+\");\n}\n\nbutton.svg-step-forward {\n  background-image: url(\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzNTg0IiBoZWlnaHQ9IjM1ODQiIHZpZXdCb3g9IjAgMCAzNTg0IDM1ODQiPjxwYXRoIGQ9Ik0yNjg4IDE1NjhxMCAyNi0xOSA0NWwtNTEyIDUxMnEtMTkgMTktNDUgMTl0LTQ1LTE5cS0xOS0xOS0xOS00NXYtMjU2aC0yMjRxLTk4IDAtMTc1LjUgNnQtMTU0IDIxLjVxLTc2LjUgMTUuNS0xMzMgNDIuNXQtMTA1LjUgNjkuNXEtNDkgNDIuNS04MCAxMDF0LTQ4LjUgMTM4LjVxLTE3LjUgODAtMTcuNSAxODEgMCA1NSA1IDEyMyAwIDYgMi41IDIzLjV0Mi41IDI2LjVxMCAxNS04LjUgMjV0LTIzLjUgMTBxLTE2IDAtMjgtMTctNy05LTEzLTIydC0xMy41LTMwcS03LjUtMTctMTAuNS0yNC0xMjctMjg1LTEyNy00NTEgMC0xOTkgNTMtMzMzIDE2Mi00MDMgODc1LTQwM2gyMjR2LTI1NnEwLTI2IDE5LTQ1dDQ1LTE5cTI2IDAgNDUgMTlsNTEyIDUxMnExOSAxOSAxOSA0NXoiLz48L3N2Zz4=\");\n}\n\nbutton.svg-step-backward {\n  background-image: url(\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzNTg0IiBoZWlnaHQ9IjM1ODQiIHZpZXdCb3g9IjAgMCAzNTg0IDM1ODQiPjxwYXRoIGQ9Ik0yNjg4IDIwNDhxMCAxNjYtMTI3IDQ1MS0zIDctMTAuNSAyNHQtMTMuNSAzMHEtNiAxMy0xMyAyMi0xMiAxNy0yOCAxNy0xNSAwLTIzLjUtMTB0LTguNS0yNXEwLTkgMi41LTI2LjV0Mi41LTIzLjVxNS02OCA1LTEyMyAwLTEwMS0xNy41LTE4MXQtNDguNS0xMzguNXEtMzEtNTguNS04MC0xMDF0LTEwNS41LTY5LjVxLTU2LjUtMjctMTMzLTQyLjV0LTE1NC0yMS41cS03Ny41LTYtMTc1LjUtNmgtMjI0djI1NnEwIDI2LTE5IDQ1dC00NSAxOXEtMjYgMC00NS0xOWwtNTEyLTUxMnEtMTktMTktMTktNDV0MTktNDVsNTEyLTUxMnExOS0xOSA0NS0xOXQ0NSAxOXExOSAxOSAxOSA0NXYyNTZoMjI0cTcxMyAwIDg3NSA0MDMgNTMgMTM0IDUzIDMzM3oiLz48L3N2Zz4=\");\n}\n\nbutton.svg-pause {\n  background-image: url(\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzNTg0IiBoZWlnaHQ9IjM1ODQiIHZpZXdCb3g9IjAgMCAzNTg0IDM1ODQiPjxwYXRoIGQ9Ik0yNTYwIDEwODh2MTQwOHEwIDI2LTE5IDQ1dC00NSAxOWgtNTEycS0yNiAwLTQ1LTE5dC0xOS00NVYxMDg4cTAtMjYgMTktNDV0NDUtMTloNTEycTI2IDAgNDUgMTl0MTkgNDV6bS04OTYgMHYxNDA4cTAgMjYtMTkgNDV0LTQ1IDE5aC01MTJxLTI2IDAtNDUtMTl0LTE5LTQ1VjEwODhxMC0yNiAxOS00NXQ0NS0xOWg1MTJxMjYgMCA0NSAxOXQxOSA0NXoiLz48L3N2Zz4=\");\n}\n\nbutton.svg-play {\n  background-image: url(\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzNTg0IiBoZWlnaHQ9IjM1ODQiIHZpZXdCb3g9IjAgMCAzNTg0IDM1ODQiPjxwYXRoIGQ9Ik0yNDcyLjUgMTgyM2wtMTMyOCA3MzhxLTIzIDEzLTM5LjUgM3QtMTYuNS0zNlYxMDU2cTAtMjYgMTYuNS0zNnQzOS41IDNsMTMyOCA3MzhxMjMgMTMgMjMgMzF0LTIzIDMxeiIvPjwvc3ZnPg==\");\n}\n\nbutton.svg-enter-fullscreen {\n  background-image: url(\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMjgiIHZpZXdCb3g9IjAgMCAyOCAyOCIgd2lkdGg9IjI4Ij48cGF0aCBkPSJNMiAyaDI0djI0SDJ6IiBmaWxsPSJub25lIi8+PHBhdGggZD0iTTkgMTZIN3Y1aDV2LTJIOXYtM3ptLTItNGgyVjloM1Y3SDd2NXptMTIgN2gtM3YyaDV2LTVoLTJ2M3pNMTYgN3YyaDN2M2gyVjdoLTV6Ii8+PC9zdmc+\");\n}\n\nbutton.svg-exit-fullscreen {\n  background-image: url(\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMjgiIHZpZXdCb3g9IjAgMCAyOCAyOCIgd2lkdGg9IjI4Ij48cGF0aCBkPSJNMiAyaDI0djI0SDJ6IiBmaWxsPSJub25lIi8+PHBhdGggZD0iTTcgMThoM3YzaDJ2LTVIN3Yyem0zLThIN3YyaDVWN2gtMnYzem02IDExaDJ2LTNoM3YtMmgtNXY1em0yLTExVjdoLTJ2NWg1di0yaC0zeiIvPjwvc3ZnPg==\");\n}\n`);\n", "import { TimeRange } from \"../../animation/alg/AlgCursor\";\nimport {\n  BoundaryType,\n  Direction,\n  MillisecondTimestamp,\n} from \"../../animation/alg/CursorTypes\";\nimport {\n  Timeline,\n  TimelineAction,\n  TimelineActionEvent,\n  TimestampLocationType,\n} from \"../../animation/Timeline\";\nimport { ManagedCustomElement } from \"../element/ManagedCustomElement\";\nimport { customElementsShim } from \"../element/node-custom-element-shims\";\nimport { buttonCSS, buttonGridCSS } from \"./buttons.css\";\nimport { TwistyControlElement } from \"./TwistyControlElement.ts\";\n\ntype TimelineCommand =\n  | \"fullscreen\"\n  | \"jump-to-start\"\n  | \"play-pause\" // TODO: toggle-play?\n  // | \"play\"\n  // | \"play-backwards\"\n  | \"play-step-backwards\"\n  | \"play-step\"\n  | \"jump-to-end\";\n\n// TODO: combine this with disabled status and label in a state machine?\ntype ButtonIconName =\n  | \"skip-to-start\"\n  | \"skip-to-end\"\n  | \"step-forward\"\n  | \"step-backward\"\n  | \"pause\"\n  | \"play\"\n  | \"enter-fullscreen\"\n  | \"exit-fullscreen\";\n\nclass TwistyControlButton\n  extends ManagedCustomElement\n  implements TwistyControlElement {\n  private timeline: Timeline;\n  private timelineCommand: TimelineCommand;\n  private currentIconName: string | null = null;\n  protected button: HTMLButtonElement = document.createElement(\"button\");\n  constructor(\n    timeline?: Timeline,\n    timelineCommand?: TimelineCommand,\n    private fullscreenElement?: Element, // TODO: reflect as an element attribute?\n  ) {\n    super();\n\n    if (!timeline) {\n      console.log(\"Must have timeline!\"); // TODO\n    }\n    this.timeline = timeline!;\n    if (!timelineCommand) {\n      console.log(\"Must have timelineCommand!\"); // TODO\n    }\n    this.timelineCommand = timelineCommand!;\n\n    this.addCSS(buttonCSS);\n    this.setIcon(this.initialIcon());\n    this.setHoverTitle(this.initialHoverTitle());\n    this.addElement(this.button);\n    this.addEventListener(\"click\", this.onPress.bind(this));\n\n    switch (this.timelineCommand!) {\n      case \"fullscreen\":\n        if (!document.fullscreenEnabled) {\n          this.button.disabled = true;\n        }\n        break;\n      case \"jump-to-start\":\n      case \"play-step-backwards\":\n        this.button.disabled = true;\n        break;\n    }\n\n    this.timeline!.addActionListener(this);\n    switch (this.timelineCommand!) {\n      case \"play-pause\":\n      case \"play-step-backwards\":\n      case \"play-step\":\n        this.timeline!.addTimestampListener(this);\n        break;\n    }\n\n    this.autoSetTimelineBasedDisabled();\n  }\n\n  // TODO: Can we avoid duplicate calculations?\n  private autoSetTimelineBasedDisabled(): void {\n    switch (this.timelineCommand!) {\n      case \"jump-to-start\":\n      case \"play-pause\":\n      case \"play-step-backwards\":\n      case \"play-step\":\n      case \"jump-to-end\": {\n        const timeRange = this.timeline.timeRange();\n        if (timeRange.start === timeRange.end) {\n          this.button.disabled = true;\n          return;\n        }\n        switch (this.timelineCommand!) {\n          case \"jump-to-start\":\n          case \"play-step-backwards\":\n            this.button.disabled =\n              this.timeline.timestamp < this.timeline.maxTimestamp();\n            break;\n          case \"jump-to-end\":\n          case \"play-step\":\n            this.button.disabled =\n              this.timeline.timestamp > this.timeline.minTimestamp();\n            break;\n          default:\n            this.button.disabled = false;\n        }\n        break;\n      }\n    }\n  }\n\n  setIcon(buttonIconName: ButtonIconName): void {\n    if (this.currentIconName === buttonIconName) {\n      return;\n    }\n    if (this.currentIconName) {\n      this.button.classList.remove(`svg-${this.currentIconName}`);\n    }\n    this.button.classList.add(`svg-${buttonIconName}`);\n    this.currentIconName = buttonIconName;\n  }\n\n  private initialIcon(): ButtonIconName {\n    const map: Record<TimelineCommand, ButtonIconName> = {\n      \"jump-to-start\": \"skip-to-start\",\n      \"play-pause\": \"play\",\n      \"play-step\": \"step-forward\",\n      \"play-step-backwards\": \"step-backward\",\n      \"jump-to-end\": \"skip-to-end\",\n      \"fullscreen\": \"enter-fullscreen\",\n    };\n    return map[this.timelineCommand];\n  }\n\n  private initialHoverTitle(): string {\n    const map: Record<TimelineCommand, string> = {\n      \"jump-to-start\": \"Restart\",\n      \"play-pause\": \"Play\",\n      \"play-step\": \"Step forward\",\n      \"play-step-backwards\": \"Step backward\",\n      \"jump-to-end\": \"Skip to End\",\n      \"fullscreen\": \"Enter fullscreen\",\n    };\n    return map[this.timelineCommand];\n  }\n\n  private setHoverTitle(title: string): void {\n    this.button.title = title;\n  }\n\n  onPress(): void {\n    switch (this.timelineCommand!) {\n      case \"fullscreen\":\n        if (document.fullscreenElement === this.fullscreenElement) {\n          document.exitFullscreen();\n          // this.setIcon(\"enter-fullscreen\");\n        } else {\n          this.setIcon(\"exit-fullscreen\");\n          this.fullscreenElement!.requestFullscreen().then(() => {\n            const onFullscreen = (): void => {\n              if (document.fullscreenElement !== this.fullscreenElement) {\n                this.setIcon(\"enter-fullscreen\");\n                window.removeEventListener(\"fullscreenchange\", onFullscreen);\n              }\n            };\n            window.addEventListener(\"fullscreenchange\", onFullscreen);\n          });\n        }\n        break;\n      case \"jump-to-start\":\n        this.timeline.setTimestamp(0);\n        break;\n      case \"jump-to-end\":\n        this.timeline.jumpToEnd();\n        break;\n      case \"play-pause\":\n        this.timeline.playPause();\n        break;\n      case \"play-step\":\n        this.timeline.experimentalPlay(Direction.Forwards, BoundaryType.Move);\n        break;\n      case \"play-step-backwards\":\n        this.timeline.experimentalPlay(Direction.Backwards, BoundaryType.Move);\n        break;\n    }\n  }\n\n  onTimelineAction(actionEvent: TimelineActionEvent): void {\n    switch (this.timelineCommand!) {\n      case \"jump-to-start\":\n        // TODO: what if you're already playing?\n        this.button.disabled =\n          actionEvent.locationType === TimestampLocationType.StartOfTimeline &&\n          actionEvent.action !== TimelineAction.StartingToPlay;\n        break;\n      case \"jump-to-end\":\n        this.button.disabled =\n          actionEvent.locationType === TimestampLocationType.EndOfTimeline &&\n          actionEvent.action !== TimelineAction.StartingToPlay;\n        break;\n      case \"play-pause\":\n        // Always enabled, since we will jump to the start if needed.\n        switch (actionEvent.action) {\n          case TimelineAction.Pausing:\n            this.setIcon(\"play\");\n            this.setHoverTitle(\"Play\");\n            break;\n          case TimelineAction.StartingToPlay:\n            this.setIcon(\"pause\");\n            this.setHoverTitle(\"Pause\");\n            break;\n          // TODO: does jumping mean pause?\n        }\n        break;\n      case \"play-step\":\n        // TODO: refine this\n        this.button.disabled =\n          actionEvent.locationType === TimestampLocationType.EndOfTimeline &&\n          actionEvent.action !== TimelineAction.StartingToPlay;\n        break;\n      case \"play-step-backwards\":\n        // TODO: refine this\n        this.button.disabled =\n          actionEvent.locationType === TimestampLocationType.StartOfTimeline &&\n          actionEvent.action !== TimelineAction.StartingToPlay;\n        break;\n    }\n  }\n\n  onTimelineTimestampChange(_timestamp: MillisecondTimestamp): void {\n    // Nothing\n  }\n\n  onTimeRangeChange(_timeRange: TimeRange): void {\n    // TODO\n    this.autoSetTimelineBasedDisabled();\n  }\n}\n\ncustomElementsShim.define(\"twisty-control-button\", TwistyControlButton);\n\n// <twisty-control-button-grid>\n// Usually a horizontal line.\nexport class TwistyControlButtonPanel\n  extends ManagedCustomElement\n  implements TwistyControlElement {\n  constructor(timeline?: Timeline, fullscreenElement?: Element) {\n    super();\n    this.addCSS(buttonGridCSS);\n\n    // this.addElement(new TwistyControlButton(timeline!, fullscreenElement!));\n    this.addElement(\n      new TwistyControlButton(timeline!, \"fullscreen\", fullscreenElement),\n    );\n    this.addElement(new TwistyControlButton(timeline!, \"jump-to-start\"));\n    this.addElement(new TwistyControlButton(timeline!, \"play-step-backwards\"));\n    this.addElement(new TwistyControlButton(timeline!, \"play-pause\"));\n    this.addElement(new TwistyControlButton(timeline!, \"play-step\"));\n    this.addElement(new TwistyControlButton(timeline!, \"jump-to-end\"));\n    /*...*/\n  }\n}\n\ncustomElementsShim.define(\n  \"twisty-control-button-panel\",\n  TwistyControlButtonPanel,\n);\n", "import { CSSSource } from \"../element/ManagedCustomElement\";\n\nexport const twistyScrubberCSS = new CSSSource(`\n:host(twisty-scrubber) {\n  width: 384px;\n  height: 16px;\n  contain: content;\n  display: grid;\n\n  background: rgba(196, 196, 196, 0.5);\n}\n\ninput {\n  margin: 0; width: 100%;\n}\n`);\n", "// <twisty-scrubber>\n\nimport { TimeRange } from \"../../animation/alg/AlgCursor\";\nimport { MillisecondTimestamp } from \"../../animation/alg/CursorTypes\";\nimport { Timeline, TimelineTimestampListener } from \"../../animation/Timeline\";\nimport { ManagedCustomElement } from \"../element/ManagedCustomElement\";\nimport { customElementsShim } from \"../element/node-custom-element-shims\";\nimport { TwistyControlElement } from \"./TwistyControlElement.ts\";\nimport { twistyScrubberCSS } from \"./TwistyScrubber.css\";\n\n// Usually a horizontal line.\nexport class TwistyScrubber\n  extends ManagedCustomElement\n  implements TwistyControlElement, TimelineTimestampListener {\n  private timeline: Timeline;\n  range: HTMLInputElement = document.createElement(\"input\"); // type=\"range\"\n  constructor(timeline?: Timeline) {\n    super();\n    this.timeline = timeline!; // TODO\n\n    this.addCSS(twistyScrubberCSS);\n\n    this.timeline!.addTimestampListener(this);\n    this.range.type = \"range\";\n\n    this.range.step = (1).toString();\n    this.range.min = this.timeline!.minTimestamp().toString();\n    this.range.max = this.timeline!.maxTimestamp().toString();\n    this.range.value = this.timeline.timestamp.toString();\n    this.range.addEventListener(\"input\", this.onInput.bind(this));\n\n    this.addElement(this.range);\n  }\n\n  onTimelineTimestampChange(timestamp: MillisecondTimestamp): void {\n    this.range.value = timestamp.toString();\n  }\n\n  onTimeRangeChange(timeRange: TimeRange): void {\n    this.range.min = timeRange.start.toString();\n    this.range.max = timeRange.end.toString();\n  }\n\n  private onInput(): void {\n    this.timeline!.setTimestamp(parseInt(this.range.value, 10));\n  }\n}\n\ncustomElementsShim.define(\"twisty-scrubber\", TwistyScrubber);\n", "import { CSSSource } from \"./element/ManagedCustomElement\";\n\n// TODO: figure out why `:host(twisty-player):fullscreen { background-color: white }` doesn't work.\nexport const twistyPlayerCSS = new CSSSource(`\n:host(twisty-player) {\n  width: 384px;\n  height: 256px;\n  contain: content;\n  display: grid;\n  box-sizing: border-box;\n  border: 1px solid rgba(0, 0, 0, 0.1);\n}\n\n.wrapper {\n  display: grid;\n  grid-template-rows: 7fr 1em 1fr;\n  overflow: hidden;\n}\n\n.wrapper.controls-none {\n  grid-template-rows: 7fr;\n}\n\n.wrapper.controls-none twisty-scrubber,\n.wrapper.controls-none twisty-control-button-panel {\n  display: none;\n}\n\ntwisty-viewer-wrapper {\n  overflow: hidden;\n}\n\ntwisty-scrubber {\n  width: 100%;\n}\n\n.wrapper.checkered {\n  background-color: #EAEAEA;\n  background-image: linear-gradient(45deg, #DDD 25%, transparent 25%, transparent 75%, #DDD 75%, #DDD),\n    linear-gradient(45deg, #DDD 25%, transparent 25%, transparent 75%, #DDD 75%, #DDD);\n  background-size: 32px 32px;\n  background-position: 0 0, 16px 16px;\n}\n`);\n", "import { CSSSource } from \"../element/ManagedCustomElement\";\n\n// TODO: Can we do this without so much nesting, and styling all the nested elems?\nexport const twisty2DSVGCSS = new CSSSource(`\n.wrapper,\n.svg-wrapper,\ntwisty-2d-svg,\nsvg {\n  width: 100%;\n  height: 100%;\n  display: grid;\n  min-height: 0;\n}\n`);\n", "import { BlockMove } from \"../../../alg\";\nimport {\n  Combine,\n  KPuzzleDefinition,\n  Puzzles,\n  stateForBlockMove,\n  SVG,\n  Transformation,\n} from \"../../../kpuzzle\";\nimport {\n  PositionDispatcher,\n  PositionListener,\n} from \"../../animation/alg/AlgCursor\";\nimport { RenderScheduler } from \"../../animation/RenderScheduler\";\nimport { ManagedCustomElement } from \"../element/ManagedCustomElement\";\nimport { twisty2DSVGCSS } from \"./Twisty2DSVGView.css\";\nimport { TwistyViewerElement } from \"./TwistyViewerElement\";\nimport { PuzzlePosition } from \"../../animation/alg/CursorTypes\";\nimport { customElementsShim } from \"../element/node-custom-element-shims\";\n\n// <twisty-2d-svg>\nexport class Twisty2DSVG\n  extends ManagedCustomElement\n  implements TwistyViewerElement, PositionListener {\n  private definition: KPuzzleDefinition;\n  private svg: SVG;\n  private scheduler = new RenderScheduler(this.render.bind(this));\n  constructor(\n    cursor?: PositionDispatcher,\n    def: KPuzzleDefinition = Puzzles[\"3x3x3\"],\n  ) {\n    super();\n    this.addCSS(twisty2DSVGCSS);\n\n    this.definition = def;\n    this.svg = new SVG(this.definition);\n    this.addElement(this.svg.element);\n    cursor!.addPositionListener(this);\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars-experimental\n  onPositionChange(position: PuzzlePosition): void {\n    if (position.movesInProgress.length > 0) {\n      const move = position.movesInProgress[0].move as BlockMove;\n\n      const def = this.definition;\n      const partialMove = new BlockMove(\n        move.outerLayer,\n        move.innerLayer,\n        move.family,\n        move.amount * position.movesInProgress[0].direction,\n      );\n      const newState = Combine(\n        def,\n        position.state as Transformation,\n        stateForBlockMove(def, partialMove),\n      );\n      // TODO: move to render()\n      this.svg.draw(\n        this.definition,\n        position.state as Transformation,\n        newState,\n        position.movesInProgress[0].fraction,\n      );\n    } else {\n      this.svg.draw(this.definition, position.state as Transformation);\n    }\n  }\n\n  scheduleRender(): void {\n    this.scheduler.requestAnimFrame();\n  }\n\n  private render(): void {\n    /*...*/\n  }\n}\n\ncustomElementsShim.define(\"twisty-2d-svg\", Twisty2DSVG);\n", "import { Vector3 } from \"three\";\nimport { countMoves } from \"../../../../app/twizzle/move-counter\"; // TODO\nimport { BlockMove, experimentalAppendBlockMove, Sequence } from \"../../alg\";\nimport { parse } from \"../../alg/parser/parser\";\nimport { KPuzzleDefinition, Puzzles } from \"../../kpuzzle\";\nimport {\n  getPuzzleGeometryByName,\n  PuzzleGeometry,\n  StickerDat,\n} from \"../../puzzle-geometry\";\nimport { Cube3D } from \"../3D/puzzles/Cube3D\";\nimport { PG3D } from \"../3D/puzzles/PG3D\";\nimport { Twisty3DPuzzle } from \"../3D/puzzles/Twisty3DPuzzle\";\nimport { Twisty3DScene } from \"../3D/Twisty3DScene\";\nimport { AlgCursor } from \"../animation/alg/AlgCursor\";\nimport {\n  Timeline,\n  TimelineAction,\n  TimelineActionEvent,\n  TimestampLocationType,\n} from \"../animation/Timeline\";\nimport { TwistyControlButtonPanel } from \"./controls/buttons\";\nimport { TwistyControlElement } from \"./controls/TwistyControlElement.ts\";\nimport { TwistyScrubber } from \"./controls/TwistyScrubber\";\nimport { ClassListManager } from \"./element/ClassListManager\";\nimport { ManagedCustomElement } from \"./element/ManagedCustomElement\";\nimport { customElementsShim } from \"./element/node-custom-element-shims\";\nimport { twistyPlayerCSS } from \"./TwistyPlayer.css\";\nimport {\n  BackgroundTheme,\n  centeredCameraPosition,\n  ControlsLocation,\n  cubeCameraPosition,\n  ExperimentalStickering,\n  HintFaceletStyle,\n  PuzzleID,\n  TwistyPlayerConfig,\n  TwistyPlayerInitialConfig,\n  VisualizationFormat,\n} from \"./TwistyPlayerConfig\";\nimport { Twisty2DSVG } from \"./viewers/Twisty2DSVG\";\nimport { Twisty3DCanvas } from \"./viewers/Twisty3DCanvas\";\nimport { TwistyViewerElement } from \"./viewers/TwistyViewerElement\";\nimport {\n  BackViewLayout,\n  TwistyViewerWrapper,\n} from \"./viewers/TwistyViewerWrapper\";\n\nexport interface LegacyExperimentalPG3DViewConfig {\n  def: KPuzzleDefinition;\n  stickerDat: StickerDat;\n  experimentalPolarVantages?: boolean;\n  showFoundation?: boolean;\n}\n\nfunction createPG(puzzleName: string): PuzzleGeometry {\n  const pg = getPuzzleGeometryByName(puzzleName, [\n    \"allmoves\",\n    \"true\",\n    \"orientcenters\",\n    \"true\",\n  ]);\n  return pg;\n}\n\nfunction is3DVisualization(visualizationFormat: VisualizationFormat): boolean {\n  return [\"3D\", \"PG3D\"].includes(visualizationFormat);\n}\n\n// <twisty-player>\nexport class TwistyPlayer extends ManagedCustomElement {\n  #config: TwistyPlayerConfig;\n\n  timeline: Timeline;\n  cursor: AlgCursor;\n  scene: Twisty3DScene | null = null;\n  twisty3D: Twisty3DPuzzle | null = null;\n\n  viewerElems: TwistyViewerElement[] = []; // TODO: can we represent the intermediate state better?\n  controlElems: TwistyControlElement[] = []; // TODO: can we represent the intermediate state better?\n\n  #hackyPendingFinalMoveCoalesce: boolean = false;\n\n  #viewerWrapper: TwistyViewerWrapper;\n  public legacyExperimentalCoalesceModFunc: (mv: BlockMove) => number = (\n    _mv: BlockMove,\n  ): number => 0;\n\n  #controlsClassListManager: ClassListManager<\n    ControlsLocation\n  > = new ClassListManager(this, \"controls-\", [\"none\", \"bottom-row\"]);\n\n  /** @deprecated */\n  public legacyExperimentalPG3D: PG3D | null = null;\n  /** @deprecated */\n  private legacyExperimentalPG3DViewConfig: LegacyExperimentalPG3DViewConfig | null;\n  // TODO: support config from DOM.\n  constructor(\n    initialConfig: TwistyPlayerInitialConfig = {},\n    legacyExperimentalPG3DViewConfig: LegacyExperimentalPG3DViewConfig | null = null,\n  ) {\n    super();\n    this.addCSS(twistyPlayerCSS);\n    this.#config = new TwistyPlayerConfig(this, initialConfig);\n\n    // We also do this in connectedCallback, but for now we also do it here so\n    // that there is some visual change even if the rest of construction or\n    // initialization fails.\n    this.contentWrapper.classList.add(\"checkered\");\n\n    this.legacyExperimentalPG3DViewConfig = legacyExperimentalPG3DViewConfig;\n  }\n\n  set alg(seq: Sequence) {\n    // TODO: do validation for other algs as well.\n    if (seq?.type !== \"sequence\") {\n      // TODO: document `.setAttribute(\"experimental-start-setup\", \"R U R'\")` as a workaround.\n      console.warn(\n        \"`alg` for a `TwistyPlayer` was set using a string. It should be set using a `Sequence`!\",\n      );\n      seq = parse((seq as unknown) as string) as Sequence;\n    }\n    this.#config.attributes[\"alg\"].setValue(seq);\n    this.cursor?.setAlg(seq); // TODO: can we ensure the cursor already exists?\n  }\n\n  get alg(): Sequence {\n    return this.#config.attributes[\"alg\"].value;\n  }\n\n  set experimentalStartSetup(seq: Sequence) {\n    // TODO: do validation for other algs as well.\n    if (seq?.type !== \"sequence\") {\n      // TODO: document `.setAttribute(\"experimental-start-setup\", \"R U R'\")` as a workaround.\n      console.warn(\n        \"`experimentalStartSetup` for a `TwistyPlayer` was set using a string. It should be set using a `Sequence`!\",\n      );\n      seq = parse((seq as unknown) as string) as Sequence;\n    }\n    this.#config.attributes[\"experimental-start-setup\"].setValue(seq);\n    if (this.cursor) {\n      this.cursor.setStartState(this.cursor.algToState(seq)); // TODO\n    }\n  }\n\n  get experimentalStartSetup(): Sequence {\n    return this.#config.attributes[\"experimental-start-setup\"].value;\n  }\n\n  set puzzle(puzzle: PuzzleID) {\n    if (this.#config.attributes[\"puzzle\"].setValue(puzzle)) {\n      this.setPuzzle(puzzle);\n    }\n  }\n\n  get puzzle(): PuzzleID {\n    return this.#config.attributes[\"puzzle\"].value as PuzzleID;\n  }\n\n  set visualization(visualization: VisualizationFormat) {\n    if (this.#config.attributes[\"visualization\"].setValue(visualization)) {\n      this.setPuzzle(this.puzzle);\n    }\n  }\n\n  get visualization(): VisualizationFormat {\n    return this.#config.attributes[\"visualization\"]\n      .value as VisualizationFormat;\n  }\n\n  set hintFacelets(hintFacelets: HintFaceletStyle) {\n    // TODO: implement this for PG3D.\n    if (this.#config.attributes[\"hint-facelets\"].setValue(hintFacelets)) {\n      if (this.twisty3D instanceof Cube3D) {\n        this.twisty3D.experimentalUpdateOptions({ hintFacelets });\n      }\n    }\n  }\n\n  get hintFacelets(): HintFaceletStyle {\n    return this.#config.attributes[\"hint-facelets\"].value as HintFaceletStyle;\n  }\n\n  // TODO: Implement for PG3D\n  /** @deprecated */\n  get experimentalStickering(): ExperimentalStickering {\n    return this.#config.attributes[\"experimental-stickering\"]\n      .value as ExperimentalStickering;\n  }\n\n  // TODO: Implement for PG3D\n  /** @deprecated */\n  set experimentalStickering(experimentalStickering: ExperimentalStickering) {\n    if (\n      this.#config.attributes[\"experimental-stickering\"].setValue(\n        experimentalStickering,\n      )\n    ) {\n      if (this.twisty3D instanceof Cube3D) {\n        this.twisty3D.experimentalUpdateOptions({\n          experimentalStickering,\n        });\n      }\n    }\n  }\n\n  set background(background: BackgroundTheme) {\n    if (this.#config.attributes[\"background\"].setValue(background)) {\n      this.contentWrapper.classList.toggle(\n        \"checkered\",\n        background === \"checkered\",\n      );\n    }\n  }\n\n  get background(): BackgroundTheme {\n    return this.#config.attributes[\"background\"].value as BackgroundTheme;\n  }\n\n  set controls(controls: ControlsLocation) {\n    this.#controlsClassListManager.setValue(controls);\n  }\n\n  get controls(): ControlsLocation {\n    return this.#config.attributes[\"controls\"].value as ControlsLocation;\n  }\n\n  set backView(backView: BackViewLayout) {\n    if (backView !== \"none\" && this.viewerElems.length === 1) {\n      this.createBackViewer();\n    }\n    if (backView === \"none\" && this.viewerElems.length > 1) {\n      this.removeBackViewerElem();\n    }\n    if (this.#viewerWrapper && this.#viewerWrapper.setBackView(backView)) {\n      for (const viewer of this.viewerElems as Twisty3DCanvas[]) {\n        viewer.makeInvisibleUntilRender(); // TODO: can we do this more elegantly?\n      }\n    }\n  }\n\n  get backView(): BackViewLayout {\n    return this.#config.attributes[\"back-view\"].value as BackViewLayout;\n  }\n\n  set cameraPosition(cameraPosition: Vector3 | null) {\n    this.#config.attributes[\"camera-position\"].setValue(cameraPosition);\n    if (\n      this.viewerElems &&\n      [\"3D\", \"PG3D\"].includes(this.#config.attributes[\"visualization\"].value)\n    ) {\n      (this.viewerElems[0] as Twisty3DCanvas)?.camera.position.copy(\n        this.effectiveCameraPosition,\n      );\n      this.viewerElems[0]?.scheduleRender();\n      // Back view may or may not exist.\n      (this.viewerElems[1] as Twisty3DCanvas)?.camera.position\n        .copy(this.effectiveCameraPosition)\n        .multiplyScalar(-1);\n      this.viewerElems[1]?.scheduleRender();\n    }\n  }\n\n  get cameraPosition(): Vector3 | null {\n    return this.#config.attributes[\"camera-position\"].value;\n  }\n\n  get effectiveCameraPosition(): Vector3 {\n    return this.cameraPosition ?? this.defaultCameraPosition;\n  }\n\n  // TODO\n  get defaultCameraPosition(): Vector3 {\n    return this.puzzle[1] === \"x\" ? cubeCameraPosition : centeredCameraPosition;\n  }\n\n  static get observedAttributes(): string[] {\n    return TwistyPlayerConfig.observedAttributes;\n  }\n\n  attributeChangedCallback(\n    attributeName: string,\n    oldValue: string,\n    newValue: string,\n  ): void {\n    this.#config.attributeChangedCallback(attributeName, oldValue, newValue);\n  }\n\n  // TODO: It seems this called after the `attributeChangedCallback`s for initial values. Can we rely on this?\n  protected connectedCallback(): void {\n    this.timeline = new Timeline();\n    this.timeline.addActionListener(this);\n\n    this.contentWrapper.classList.toggle(\n      \"checkered\",\n      this.background === \"checkered\",\n    );\n\n    // TODO: specify exactly when back views are possible.\n    // TODO: Are there any SVGs where we'd want a separate back view?\n    const setBackView: boolean = this.backView && this.visualization !== \"2D\";\n    const backView: BackViewLayout = setBackView\n      ? (this.backView as BackViewLayout)\n      : \"none\";\n    this.#viewerWrapper = new TwistyViewerWrapper({\n      backView,\n    });\n    this.addElement(this.#viewerWrapper);\n\n    this.createViewers(\n      this.timeline,\n      this.alg,\n      this.visualization,\n      this.puzzle,\n      this.backView !== \"none\",\n    );\n    const scrubber = new TwistyScrubber(this.timeline);\n    const controlButtonGrid = new TwistyControlButtonPanel(this.timeline, this);\n\n    this.controlElems = [scrubber, controlButtonGrid];\n\n    this.#controlsClassListManager.setValue(this.controls);\n\n    this.addElement(this.controlElems[0]);\n    this.addElement(this.controlElems[1]);\n  }\n\n  protected createViewers(\n    timeline: Timeline,\n    alg: Sequence,\n    visualization: VisualizationFormat,\n    puzzleName: string,\n    backView: boolean,\n  ): void {\n    switch (visualization) {\n      case \"2D\": {\n        try {\n          this.cursor = new AlgCursor(\n            timeline,\n            Puzzles[puzzleName],\n            alg,\n            this.experimentalStartSetup,\n          );\n        } catch (e) {\n          // TODO: Deduplicate fallback.\n          this.cursor = new AlgCursor(\n            timeline,\n            Puzzles[puzzleName],\n            new Sequence([]),\n            this.experimentalStartSetup,\n          );\n        }\n        this.cursor.setStartState(\n          this.cursor.algToState(this.experimentalStartSetup),\n        );\n\n        this.timeline.addCursor(this.cursor);\n        if (this.experimentalStartSetup.nestedUnits.length === 0) {\n          // TODO: find better way to configure when to start where (e.g. initialTimestamp: \"start\" | \"end\" | \"setup\")\n          this.timeline.jumpToEnd();\n        }\n        const mainViewer = new Twisty2DSVG(this.cursor, Puzzles[puzzleName]);\n        this.viewerElems = [mainViewer];\n        this.#viewerWrapper.addElement(mainViewer);\n        return;\n      }\n      case \"3D\":\n        if (puzzleName === \"3x3x3\") {\n          // TODO: fold 3D and PG3D into this.\n          try {\n            this.cursor = new AlgCursor(\n              timeline,\n              Puzzles[puzzleName],\n              alg,\n              this.experimentalStartSetup,\n            );\n          } catch (e) {\n            // TODO: Deduplicate fallback.\n            this.cursor = new AlgCursor(\n              timeline,\n              Puzzles[puzzleName],\n              new Sequence([]),\n              this.experimentalStartSetup,\n            );\n          }\n          this.cursor.setStartState(\n            this.cursor.algToState(this.experimentalStartSetup),\n          );\n          this.scene = new Twisty3DScene();\n          this.twisty3D = new Cube3D(\n            this.cursor,\n            this.scene.scheduleRender.bind(this.scene),\n            {\n              hintFacelets: this.hintFacelets,\n              experimentalStickering: this.experimentalStickering,\n            },\n          );\n          this.scene.addTwisty3DPuzzle(this.twisty3D);\n          const mainViewer = new Twisty3DCanvas(this.scene, {\n            cameraPosition: this.effectiveCameraPosition,\n          });\n          this.#viewerWrapper.addElement(mainViewer);\n          this.viewerElems = [mainViewer];\n          if (backView) {\n            this.createBackViewer();\n            // const partner = new Twisty3DCanvas(this.scene, {\n            //   // cameraPosition, // TODO\n            //   negateCameraPosition: true,\n            // });\n            // this.viewerElems.push(partner);\n            // mainViewer.setMirror(partner);\n          }\n          this.timeline.addCursor(this.cursor);\n          if (this.experimentalStartSetup.nestedUnits.length === 0) {\n            // TODO: find better way to configure when to start where (e.g. initialTimestamp: \"start\" | \"end\" | \"setup\")\n            this.timeline.jumpToEnd();\n          }\n          return;\n        }\n      // fallthrough for 3D when not 3x3x3\n      case \"PG3D\": {\n        const [kpuzzleDef, stickerDat] = this.pgHelper(puzzleName);\n\n        try {\n          this.cursor = new AlgCursor(\n            timeline,\n            kpuzzleDef,\n            alg,\n            this.experimentalStartSetup,\n          );\n        } catch (e) {\n          // TODO: Deduplicate fallback.\n          this.cursor = new AlgCursor(\n            timeline,\n            kpuzzleDef,\n            new Sequence([]),\n            this.experimentalStartSetup,\n          );\n        }\n\n        this.scene = new Twisty3DScene();\n        const pg3d = new PG3D(\n          this.cursor,\n          this.scene.scheduleRender.bind(this.scene),\n          kpuzzleDef,\n          stickerDat,\n          this.legacyExperimentalPG3DViewConfig?.showFoundation ?? true,\n        );\n        this.twisty3D = pg3d;\n        this.legacyExperimentalPG3D = pg3d;\n        this.scene.addTwisty3DPuzzle(this.twisty3D);\n        const mainViewer = new Twisty3DCanvas(this.scene, {\n          cameraPosition: this.effectiveCameraPosition,\n        });\n        this.viewerElems = [mainViewer];\n        this.#viewerWrapper.addElement(mainViewer);\n        if (backView) {\n          this.createBackViewer();\n        }\n        this.timeline.addCursor(this.cursor);\n        if (this.experimentalStartSetup.nestedUnits.length === 0) {\n          // TODO: find better way to configure when to start where (e.g. initialTimestamp: \"start\" | \"end\" | \"setup\")\n          this.timeline.jumpToEnd();\n        }\n        return;\n      }\n      default:\n        throw new Error(\"Unknown visualization\");\n    }\n  }\n\n  // TODO: Distribute this code better.\n  private pgHelper(puzzleName: string): [KPuzzleDefinition, StickerDat] {\n    let kpuzzleDef: KPuzzleDefinition;\n    let stickerDat: StickerDat;\n    if (this.legacyExperimentalPG3DViewConfig) {\n      kpuzzleDef = this.legacyExperimentalPG3DViewConfig.def;\n      stickerDat = this.legacyExperimentalPG3DViewConfig.stickerDat;\n      // experimentalPolarVantages ?: boolean;\n      // sideBySide ?: boolean;\n      // showFoundation ?: boolean;;\n    } else {\n      const pg = createPG(puzzleName);\n      stickerDat = pg.get3d();\n      kpuzzleDef = pg.writekpuzzle();\n    }\n    return [kpuzzleDef, stickerDat];\n  }\n\n  private createBackViewer(): void {\n    if (!is3DVisualization(this.visualization)) {\n      throw new Error(\"Back viewer requires a 3D visualization\");\n    }\n\n    const backViewer = new Twisty3DCanvas(this.scene!, {\n      cameraPosition: this.effectiveCameraPosition,\n      negateCameraPosition: true,\n    });\n    this.viewerElems.push(backViewer);\n    (this.viewerElems[0] as Twisty3DCanvas).setMirror(backViewer);\n    this.#viewerWrapper.addElement(backViewer);\n  }\n\n  private removeBackViewerElem(): void {\n    // TODO: Validate visualization.\n    if (this.viewerElems.length !== 2) {\n      throw new Error(\"Tried to remove non-existent back view!\");\n    }\n    this.#viewerWrapper.removeElement(this.viewerElems.pop()!);\n  }\n\n  setPuzzle(\n    puzzleName: string,\n    legacyExperimentalPG3DViewConfig?: LegacyExperimentalPG3DViewConfig,\n  ): void {\n    this.puzzle = puzzleName as PuzzleID;\n    this.legacyExperimentalPG3DViewConfig =\n      legacyExperimentalPG3DViewConfig ?? null;\n    switch (this.visualization) {\n      // TODO: Swap out both 3D implementations with each other.\n      case \"PG3D\": {\n        const scene = this.scene!;\n        scene.remove(this.twisty3D!);\n        this.cursor.removePositionListener(this.twisty3D!);\n        const [def, dat /*, _*/] = this.pgHelper(this.puzzle);\n        this.cursor.setPuzzle(def, undefined, this.experimentalStartSetup);\n        const pg3d = new PG3D(\n          this.cursor,\n          scene.scheduleRender.bind(scene),\n          def,\n          dat,\n          this.legacyExperimentalPG3DViewConfig?.showFoundation,\n        );\n        scene.addTwisty3DPuzzle(pg3d);\n        this.twisty3D = pg3d;\n        this.legacyExperimentalPG3D = pg3d;\n        for (const viewer of this.viewerElems) {\n          viewer.scheduleRender();\n        }\n        return;\n      }\n\n      // this.#cursor.set\n      // return;\n    }\n\n    // Fallback\n    const oldCursor = this.cursor;\n    for (const oldViewer of this.viewerElems) {\n      this.#viewerWrapper.removeElement(oldViewer);\n    }\n    this.createViewers(\n      this.timeline,\n      this.alg,\n      this.visualization,\n      puzzleName,\n      this.backView !== \"none\",\n    );\n    this.timeline.removeCursor(oldCursor);\n    this.timeline.removeTimestampListener(oldCursor);\n  }\n\n  // TODO: Handle playing the new move vs. just modying the alg.\n  // Note: setting `coalesce`\n  experimentalAddMove(\n    move: BlockMove,\n    coalesce: boolean = false,\n    coalesceDelayed: boolean = false,\n  ): void {\n    if (this.#hackyPendingFinalMoveCoalesce) {\n      this.hackyCoalescePending();\n    }\n    const oldNumMoves = countMoves(this.alg); // TODO\n    const newAlg = experimentalAppendBlockMove(\n      this.alg,\n      move,\n      coalesce && !coalesceDelayed,\n      this.legacyExperimentalCoalesceModFunc(move),\n    );\n    if (coalesce && coalesceDelayed) {\n      this.#hackyPendingFinalMoveCoalesce = true;\n    }\n\n    this.alg = newAlg;\n    // TODO\n    if (oldNumMoves <= countMoves(newAlg)) {\n      this.timeline.experimentalJumpToLastMove();\n    } else {\n      this.timeline.jumpToEnd();\n    }\n    this.timeline.play();\n  }\n\n  onTimelineAction(actionEvent: TimelineActionEvent): void {\n    if (\n      actionEvent.action === TimelineAction.Pausing &&\n      actionEvent.locationType === TimestampLocationType.EndOfTimeline &&\n      this.#hackyPendingFinalMoveCoalesce\n    ) {\n      this.hackyCoalescePending();\n      this.timeline.jumpToEnd();\n    }\n  }\n\n  private hackyCoalescePending(): void {\n    const units = this.alg.nestedUnits;\n    const length = units.length;\n    const pending = this.#hackyPendingFinalMoveCoalesce;\n    this.#hackyPendingFinalMoveCoalesce = false;\n    if (pending && length > 1 && units[length - 1].type === \"blockMove\") {\n      const finalMove = units[length - 1] as BlockMove;\n      const newAlg = experimentalAppendBlockMove(\n        new Sequence(units.slice(0, length - 1)),\n        finalMove,\n        true,\n        this.legacyExperimentalCoalesceModFunc(finalMove),\n      );\n      this.alg = newAlg;\n    }\n  }\n\n  fullscreen(): void {\n    this.requestFullscreen();\n  }\n}\n\ncustomElementsShim.define(\"twisty-player\", TwistyPlayer);\n", "import { BlockMove, expand, Sequence, TraversalUp } from \"../../../alg\";\nimport { PuzzleWrapper, State } from \"../../3D/puzzles/KPuzzleWrapper\";\nimport { AlgIndexer, countAnimatedMoves } from \"./AlgIndexer\";\nimport { Duration, Timestamp, DefaultDurationForAmount } from \"./CursorTypes\";\nimport { AlgDuration } from \"./AlgDuration\";\n\nexport class SimpleAlgIndexer<P extends PuzzleWrapper>\n  implements AlgIndexer<P> {\n  private moves: Sequence;\n  // TODO: Allow custom `durationFn`.\n  private durationFn: TraversalUp<Duration> = new AlgDuration(\n    DefaultDurationForAmount,\n  );\n\n  constructor(private puzzle: P, alg: Sequence) {\n    this.moves = expand(alg);\n    // TODO: Avoid assuming all base moves are block moves.\n  }\n\n  public getMove(index: number): BlockMove {\n    return this.moves.nestedUnits[index] as BlockMove;\n  }\n\n  public indexToMoveStartTimestamp(index: number): Timestamp {\n    const seq = new Sequence(this.moves.nestedUnits.slice(0, index));\n    return this.durationFn.traverse(seq);\n  }\n\n  public timestampToIndex(timestamp: Timestamp): number {\n    let cumulativeTime = 0;\n    let i;\n    for (i = 0; i < this.numMoves(); i++) {\n      cumulativeTime += this.durationFn.traverseBlockMove(this.getMove(i));\n      if (cumulativeTime >= timestamp) {\n        return i;\n      }\n    }\n    return i;\n  }\n\n  public stateAtIndex(index: number): State<P> {\n    return this.puzzle.combine(\n      this.puzzle.startState(),\n      this.transformAtIndex(index),\n    );\n  }\n\n  public transformAtIndex(index: number): State<P> {\n    let state = this.puzzle.identity();\n    for (const move of this.moves.nestedUnits.slice(0, index)) {\n      state = this.puzzle.combine(\n        state,\n        this.puzzle.stateFromMove(move as BlockMove),\n      );\n    }\n    return state;\n  }\n\n  public algDuration(): Duration {\n    return this.durationFn.traverse(this.moves);\n  }\n\n  public numMoves(): number {\n    // TODO: Cache internally once performance matters.\n    return countAnimatedMoves(this.moves);\n  }\n\n  public moveDuration(index: number): number {\n    return this.durationFn.traverseBlockMove(this.getMove(index));\n  }\n}\n", "import { BlockMove } from \"../../../alg\";\nimport { experimentalBlockMoveQuantumName } from \"../../../alg/traversal\";\nimport { Timestamp, Duration } from \"../alg/CursorTypes\";\n\ninterface Event {\n  timeStamp: Timestamp;\n  move: BlockMove;\n}\n\nexport interface TimelineEntry {\n  event: Event;\n  start: Timestamp;\n  end: Timestamp;\n}\n\ntype Timeline = TimelineEntry[];\n\nfunction isSameAxis(move1: BlockMove, move2: BlockMove): boolean {\n  const familyRoots =\n    move1.family[0].toLowerCase() + move2.family[0].toLowerCase();\n  // console.log(familyRoots);\n  return ![\n    \"uu\",\n    \"ud\",\n    \"du\",\n    \"dd\",\n    \"ll\",\n    \"lr\",\n    \"rl\",\n    \"rr\",\n    \"ff\",\n    \"fb\",\n    \"bf\",\n    \"bb\",\n  ].includes(familyRoots);\n}\n\nexport function toAxes(\n  events: Event[],\n  diameterMs: Duration,\n): TimelineEntry[][] {\n  const axes: TimelineEntry[][] = [];\n  const axisMoveTracker = new Map();\n  let lastEntry: TimelineEntry | null = null;\n  for (const event of events) {\n    if (!lastEntry) {\n      lastEntry = {\n        event,\n        start: event.timeStamp - diameterMs / 2,\n        end: event.timeStamp + diameterMs / 2,\n      };\n      axes.push([lastEntry]);\n      axisMoveTracker.set(\n        experimentalBlockMoveQuantumName(lastEntry.event.move),\n        lastEntry,\n      );\n      continue;\n    }\n    const newEntry: TimelineEntry = {\n      event,\n      start: event.timeStamp - diameterMs / 2,\n      end: event.timeStamp + diameterMs / 2,\n    };\n    if (isSameAxis(lastEntry.event.move, event.move)) {\n      const quarterName = experimentalBlockMoveQuantumName(newEntry.event.move);\n      // console.log(quarterName);\n      const prev = axisMoveTracker.get(quarterName);\n      // console.log(\"prev\", prev);\n      if (\n        prev &&\n        prev.end > newEntry.start &&\n        Math.sign(prev.event.move.amount) ===\n          Math.sign(newEntry.event.move.amount)\n      ) {\n        prev.event.move = new BlockMove(\n          prev.event.move.outerLayer,\n          prev.event.move.innerLayer,\n          prev.event.move.family,\n          prev.event.move.amount + newEntry.event.move.amount,\n        );\n      } else {\n        axes[axes.length - 1].push(newEntry);\n        axisMoveTracker.set(quarterName, newEntry);\n      }\n    } else {\n      // console.log(\"--\", algPartToStringForTesting(newEntry.event.move));\n      axes.push([newEntry]);\n      axisMoveTracker.clear();\n      axisMoveTracker.set(\n        experimentalBlockMoveQuantumName(newEntry.event.move),\n        newEntry,\n      );\n      if (newEntry.start < lastEntry.end) {\n        const midpoint = (newEntry.start + lastEntry.end) / 2;\n        newEntry.start = midpoint;\n        lastEntry.end = midpoint;\n      }\n    }\n    lastEntry = newEntry;\n  }\n  return axes;\n}\n\n// TODO: turn into an optional param\nconst defaultDiameterMs: Duration = 200;\n\nexport function toTimeline(\n  events: Event[],\n  diameterMs: number = defaultDiameterMs,\n): Timeline {\n  const axes: TimelineEntry[][] = toAxes(events, diameterMs);\n  // console.log(axes);\n  return axes.flat();\n}\n\n/*\n\nInput: list of {move: {base, amount}}, centerTime} events sorted by centerTime of halfway through \"quarter\" turns.\nOutput list of {move, centerTime, start, end}\nOptions:\n  - radius # milliseconds\n  - maxImbalance # maximum ratio of (centerTime - end)/(centerTime - start)\n\neventsToTimeline(events):\n  frontier = empty set # only needed for performance, not correctness\n  for e of events:\n    add event to timeline with range {start: e.centerTime - radius, end: e.centerTime + radius}\n    for each event d of the frontier:\n      if d.base == e.base && sign(d.amount) == sign(e.amount): # d and e have the same base move in the same direction:\n        coalesce(d, e)\n        continue outer loop\n      if d.end > e.start and conflicts(d, e):\n        d.end   = min(e.end, (d.centerTime + e.centerTime) / 2)\n        e.start = max(e.end, (d.centerTime + e.centerTime) / 2)\n        remove d from the frontier\n      if d.centerTime < e.centerTime - radius\n        drop d from the frontier # optimization: too old to overlap with future events\n    e.end = min(e.end, e.centerTime + maxImbalance * (e.centerTime - e.start))\n    add e to the frontier\n\ncoalesce(d, e):\n  {\n    start: d.start\n    centerTime: weighted_avg(\n      d.centerTime with weight abs(d.amount)\n      e.centerTime with weight abs(e.amount)\n    )\n    end: e.end\n  }\n\nconflicts(d, e):\n  if d.base == e.base && sign(d.amount) != sign(e.amount):\n    return true\n  # else, depends on the puzzle\n\nThoughts:\n- Alternative to max imbalance: animate first and second part separately?\n- Fingertrick mode: allow an optional overlap amount between any two conflicting moves (possibly depending on the moves)\n\nProperties:\n- An event's start time will never change after it is added.\n- An event might take up less time than it \"can\".\n  - i.e. its start and/or end time could be extended after the algorithm finishes, without overlapping with conflicting moves.\n  - This is an acceptable compromise for simplicity.\n- As written, moves are only removed from the frontier opportunistically. This shouldn't be a problem.\n\n*/\n"],
  "mappings": "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AA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;ACAf,IAAO,8BAAQ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACAf,IAAO,+BAAQ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACAf,IAAO,qCAAQ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACAf,IAAO,4BAAQ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;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",
  "names": []
}
